{"ast":null,"code":"/**\n * @license\n * KLineChart v7.5.0\n * Copyright (c) 2019 lihu.\n * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.klinecharts = {}));\n})(this, function (exports) {\n  'use strict';\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 成交均线\n   */\n\n  var averagePrice = {\n    name: 'AVP',\n    series: 'price',\n    precision: 2,\n    plots: [{\n      key: 'avp',\n      title: 'AVP: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList) {\n      var totalTurnover = 0;\n      var totalVolume = 0;\n      return dataList.map(function (kLineData) {\n        var avp = {};\n        var turnover = kLineData.turnover || 0;\n        var volume = kLineData.volume || 0;\n        totalTurnover += turnover;\n        totalVolume += volume;\n\n        if (totalVolume !== 0) {\n          avp.avp = totalTurnover / totalVolume;\n        }\n\n        return avp;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 多空指标\n   * 公式: BBI = (MA(CLOSE, M) + MA(CLOSE, N) + MA(CLOSE, O) + MA(CLOSE, P)) / 4\n   *\n   */\n\n  var bullAndBearIndex = {\n    name: 'BBI',\n    series: 'price',\n    precision: 2,\n    calcParams: [3, 6, 12, 24],\n    shouldCheckParamCount: true,\n    shouldOhlc: true,\n    plots: [{\n      key: 'bbi',\n      title: 'BBI: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(kLineDataList, calcParams) {\n      var maxParam = Math.max.apply(null, calcParams);\n      var closeSums = [];\n      var mas = [];\n      return kLineDataList.map(function (kLineData, i) {\n        var bbi = {};\n        var close = kLineData.close;\n        calcParams.forEach(function (param, index) {\n          closeSums[index] = (closeSums[index] || 0) + close;\n\n          if (i >= param - 1) {\n            mas[index] = closeSums[index] / param;\n            closeSums[index] -= kLineDataList[i - (param - 1)].close;\n          }\n        });\n\n        if (i >= maxParam - 1) {\n          var maSum = 0;\n          mas.forEach(function (ma) {\n            maSum += ma;\n          });\n          bbi.bbi = maSum / 4;\n        }\n\n        return bbi;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * DMA\n   * 公式：DIF:MA(CLOSE,N1)-MA(CLOSE,N2);DIFMA:MA(DIF,M)\n   */\n\n  var differentOfMovingAverage = {\n    name: 'DMA',\n    calcParams: [10, 50, 10],\n    plots: [{\n      key: 'dma',\n      title: 'DMA: ',\n      type: 'line'\n    }, {\n      key: 'ama',\n      title: 'AMA: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var maxParam = Math.max(calcParams[0], calcParams[1]);\n      var closeSum1 = 0;\n      var closeSum2 = 0;\n      var dmaSum = 0;\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var dma = {};\n        var close = kLineData.close;\n        closeSum1 += close;\n        closeSum2 += close;\n        var ma1;\n        var ma2;\n\n        if (i >= calcParams[0] - 1) {\n          ma1 = closeSum1 / calcParams[0];\n          closeSum1 -= dataList[i - (calcParams[0] - 1)].close;\n        }\n\n        if (i >= calcParams[1] - 1) {\n          ma2 = closeSum2 / calcParams[1];\n          closeSum2 -= dataList[i - (calcParams[1] - 1)].close;\n        }\n\n        if (i >= maxParam - 1) {\n          var dif = ma1 - ma2;\n          dma.dma = dif;\n          dmaSum += dif;\n\n          if (i >= maxParam + calcParams[2] - 2) {\n            dma.ama = dmaSum / calcParams[2];\n            dmaSum -= result[i - (calcParams[2] - 1)].dma;\n          }\n        }\n\n        result.push(dma);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * DMI\n   *\n   * MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N)\n   * HD :=HIGH-REF(HIGH,1);\n   * LD :=REF(LOW,1)-LOW;\n   * DMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);\n   * DMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);\n   *\n   * PDI: DMP*100/MTR;\n   * MDI: DMM*100/MTR;\n   * ADX: EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);\n   * ADXR:EXPMEMA(ADX,MM);\n   * 公式含义：\n   * MTR赋值:最高价-最低价和最高价-昨收的绝对值的较大值和昨收-最低价的绝对值的较大值的N日指数平滑移动平均\n   * HD赋值:最高价-昨日最高价\n   * LD赋值:昨日最低价-最低价\n   * DMP赋值:如果HD>0并且HD>LD,返回HD,否则返回0的N日指数平滑移动平均\n   * DMM赋值:如果LD>0并且LD>HD,返回LD,否则返回0的N日指数平滑移动平均\n   * 输出PDI:DMP*100/MTR\n   * 输出MDI:DMM*100/MTR\n   * 输出ADX:MDI-PDI的绝对值/(MDI+PDI)*100的MM日指数平滑移动平均\n   * 输出ADXR:ADX的MM日指数平滑移动平均\n   *\n   */\n\n  var directionalMovementIndex = {\n    name: 'DMI',\n    calcParams: [14, 6],\n    plots: [{\n      key: 'pdi',\n      title: 'PDI: ',\n      type: 'line'\n    }, {\n      key: 'mdi',\n      title: 'MDI: ',\n      type: 'line'\n    }, {\n      key: 'adx',\n      title: 'ADX: ',\n      type: 'line'\n    }, {\n      key: 'adxr',\n      title: 'ADXR: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var trSum = 0;\n      var hSum = 0;\n      var lSum = 0;\n      var mtr = 0;\n      var dmp = 0;\n      var dmm = 0;\n      var dxSum = 0;\n      var adx = 0;\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var dmi = {};\n        var preKLineData = dataList[i - 1] || kLineData;\n        var preClose = preKLineData.close;\n        var high = kLineData.high;\n        var low = kLineData.low;\n        var hl = high - low;\n        var hcy = Math.abs(high - preClose);\n        var lcy = Math.abs(preClose - low);\n        var hhy = high - preKLineData.high;\n        var lyl = preKLineData.low - low;\n        var tr = Math.max(Math.max(hl, hcy), lcy);\n        var h = hhy > 0 && hhy > lyl ? hhy : 0;\n        var l = lyl > 0 && lyl > hhy ? lyl : 0;\n        trSum += tr;\n        hSum += h;\n        lSum += l;\n\n        if (i >= calcParams[0] - 1) {\n          if (i > calcParams[0] - 1) {\n            mtr = mtr - mtr / calcParams[0] + tr;\n            dmp = dmp - dmp / calcParams[0] + h;\n            dmm = dmm - dmm / calcParams[0] + l;\n          } else {\n            mtr = trSum;\n            dmp = hSum;\n            dmm = lSum;\n          }\n\n          var pdi = 0;\n          var mdi = 0;\n\n          if (mtr !== 0) {\n            pdi = dmp * 100 / mtr;\n            mdi = dmm * 100 / mtr;\n          }\n\n          dmi.pdi = pdi;\n          dmi.mdi = mdi;\n          var dx = 0;\n\n          if (mdi + pdi !== 0) {\n            dx = Math.abs(mdi - pdi) / (mdi + pdi) * 100;\n          }\n\n          dxSum += dx;\n\n          if (i >= calcParams[0] * 2 - 2) {\n            if (i > calcParams[0] * 2 - 2) {\n              adx = (adx * (calcParams[0] - 1) + dx) / calcParams[0];\n            } else {\n              adx = dxSum / calcParams[0];\n            }\n\n            dmi.adx = adx;\n\n            if (i >= calcParams[0] * 2 + calcParams[1] - 3) {\n              dmi.adxr = (result[i - (calcParams[1] - 1)].adx + adx) / 2;\n            }\n          }\n        }\n\n        result.push(dmi);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   *\n   * EMV 简易波动指标\n   * 公式：\n   * A=（今日最高+今日最低）/2\n   * B=（前日最高+前日最低）/2\n   * C=今日最高-今日最低\n   * EM=（A-B）*C/今日成交额\n   * EMV=N日内EM的累和\n   * MAEMV=EMV的M日的简单移动平均\n   *\n   */\n\n  var easeOfMovementValue = {\n    name: 'EMV',\n    calcParams: [14, 9],\n    plots: [{\n      key: 'emv',\n      title: 'EMV: ',\n      type: 'line'\n    }, {\n      key: 'maEmv',\n      title: 'MAEMV: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var emSum = 0;\n      var emvSum = 0;\n      var emList = [];\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var emv = {};\n        var preKLineData = dataList[i - 1] || kLineData;\n        var high = kLineData.high;\n        var low = kLineData.low;\n        var turnover = kLineData.turnover || 0;\n        var halfHl = (high + low) / 2;\n        var preHalfHl = (preKLineData.high + preKLineData.low) / 2;\n        var hl = high - low;\n        var em = 0;\n\n        if (turnover !== 0) {\n          em = (halfHl - preHalfHl) * hl / turnover;\n        }\n\n        emList.push(em);\n        emSum += em;\n\n        if (i >= calcParams[0] - 1) {\n          emv.emv = emSum;\n          emSum -= emList[i - (calcParams[0] - 1)];\n          emvSum += emv.emv;\n\n          if (i >= calcParams[0] + calcParams[1] - 2) {\n            emv.maEmv = emvSum / calcParams[1];\n            emvSum -= result[i - (calcParams[1] - 1)].emv;\n          }\n        }\n\n        result.push(emv);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * EMA 指数移动平均\n   */\n\n  var exponentialMovingAverage = {\n    name: 'EMA',\n    series: 'price',\n    calcParams: [6, 12, 20],\n    precision: 2,\n    shouldCheckParamCount: false,\n    shouldOhlc: true,\n    plots: [{\n      key: 'ema6',\n      title: 'EMA6: ',\n      type: 'line'\n    }, {\n      key: 'ema12',\n      title: 'EMA12: ',\n      type: 'line'\n    }, {\n      key: 'ema20',\n      title: 'EMA20: ',\n      type: 'line'\n    }],\n    regeneratePlots: function regeneratePlots(params) {\n      return params.map(function (p) {\n        return {\n          key: \"ema\".concat(p),\n          title: \"EMA\".concat(p, \": \"),\n          type: 'line'\n        };\n      });\n    },\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams, plots) {\n      var closeSum = 0;\n      var emaValues = [];\n      return dataList.map(function (kLineData, i) {\n        var ema = {};\n        var close = kLineData.close;\n        closeSum += close;\n        calcParams.forEach(function (param, j) {\n          if (i >= param - 1) {\n            if (i > param - 1) {\n              emaValues[j] = (2 * close + (param - 1) * emaValues[j]) / (param + 1);\n            } else {\n              emaValues[j] = closeSum / param;\n            }\n\n            ema[plots[j].key] = emaValues[j];\n          }\n        });\n        return ema;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * MA 移动平均\n   */\n\n  var movingAverage = {\n    name: 'MA',\n    series: 'price',\n    calcParams: [5, 10, 30, 60],\n    precision: 2,\n    shouldCheckParamCount: false,\n    shouldOhlc: true,\n    plots: [{\n      key: 'ma5',\n      title: 'MA5: ',\n      type: 'line'\n    }, {\n      key: 'ma10',\n      title: 'MA10: ',\n      type: 'line'\n    }, {\n      key: 'ma30',\n      title: 'MA30: ',\n      type: 'line'\n    }, {\n      key: 'ma60',\n      title: 'MA60: ',\n      type: 'line'\n    }],\n    regeneratePlots: function regeneratePlots(params) {\n      return params.map(function (p) {\n        return {\n          key: \"ma\".concat(p),\n          title: \"MA\".concat(p, \": \"),\n          type: 'line'\n        };\n      });\n    },\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams, plots) {\n      var closeSums = [];\n      return dataList.map(function (kLineData, i) {\n        var ma = {};\n        var close = kLineData.close;\n        calcParams.forEach(function (param, j) {\n          closeSums[j] = (closeSums[j] || 0) + close;\n\n          if (i >= param - 1) {\n            ma[plots[j].key] = closeSums[j] / param;\n            closeSums[j] -= dataList[i - (param - 1)].close;\n          }\n        });\n        return ma;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * MACD：参数快线移动平均、慢线移动平均、移动平均，\n   * 默认参数值12、26、9。\n   * 公式：⒈首先分别计算出收盘价12日指数平滑移动平均线与26日指数平滑移动平均线，分别记为EMA(12）与EMA(26）。\n   * ⒉求这两条指数平滑移动平均线的差，即：DIFF=EMA（SHORT）－EMA（LONG）。\n   * ⒊再计算DIFF的M日的平均的指数平滑移动平均线，记为DEA。\n   * ⒋最后用DIFF减DEA，得MACD。MACD通常绘制成围绕零轴线波动的柱形图。MACD柱状大于0涨颜色，小于0跌颜色。\n   */\n\n  var movingAverageConvergenceDivergence = {\n    name: 'MACD',\n    calcParams: [12, 26, 9],\n    baseValue: 0,\n    plots: [{\n      key: 'dif',\n      title: 'DIF: ',\n      type: 'line'\n    }, {\n      key: 'dea',\n      title: 'DEA: ',\n      type: 'line'\n    }, {\n      key: 'macd',\n      title: 'MACD: ',\n      type: 'bar',\n      color: function color(data, options) {\n        var currentData = data.currentData;\n        var macd = (currentData.technicalIndicatorData || {}).macd;\n\n        if (macd > 0) {\n          return options.bar.upColor;\n        } else if (macd < 0) {\n          return options.bar.downColor;\n        } else {\n          return options.bar.noChangeColor;\n        }\n      },\n      isStroke: function isStroke(data) {\n        var preData = data.preData,\n            currentData = data.currentData;\n        var macd = (currentData.technicalIndicatorData || {}).macd;\n        var preMacd = (preData.technicalIndicatorData || {}).macd;\n        return preMacd < macd;\n      }\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var closeSum = 0;\n      var emaShort;\n      var emaLong;\n      var dif = 0;\n      var difSum = 0;\n      var dea = 0;\n      var maxPeriod = Math.max(calcParams[0], calcParams[1]);\n      return dataList.map(function (kLineData, i) {\n        var macd = {};\n        var close = kLineData.close;\n        closeSum += close;\n\n        if (i >= calcParams[0] - 1) {\n          if (i > calcParams[0] - 1) {\n            emaShort = (2 * close + (calcParams[0] - 1) * emaShort) / (calcParams[0] + 1);\n          } else {\n            emaShort = closeSum / calcParams[0];\n          }\n        }\n\n        if (i >= calcParams[1] - 1) {\n          if (i > calcParams[1] - 1) {\n            emaLong = (2 * close + (calcParams[1] - 1) * emaLong) / (calcParams[1] + 1);\n          } else {\n            emaLong = closeSum / calcParams[1];\n          }\n        }\n\n        if (i >= maxPeriod - 1) {\n          dif = emaShort - emaLong;\n          macd.dif = dif;\n          difSum += dif;\n\n          if (i >= maxPeriod + calcParams[2] - 2) {\n            if (i > maxPeriod + calcParams[2] - 2) {\n              dea = (dif * 2 + dea * (calcParams[2] - 1)) / (calcParams[2] + 1);\n            } else {\n              dea = difSum / calcParams[2];\n            }\n\n            macd.macd = (dif - dea) * 2;\n            macd.dea = dea;\n          }\n        }\n\n        return macd;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * sma\n   */\n\n  var simpleMovingAverage = {\n    name: 'SMA',\n    calcParams: [12, 2],\n    series: 'price',\n    precision: 2,\n    plots: [{\n      key: 'sma',\n      title: 'SMA: ',\n      type: 'line'\n    }],\n    shouldCheckParamCount: true,\n    shouldOhlc: true,\n    calcTechnicalIndicator: function calcTechnicalIndicator(kLineDataList, calcParams) {\n      var closeSum = 0;\n      var smaValue = 0;\n      return kLineDataList.map(function (kLineData, i) {\n        var sma = {};\n        var close = kLineData.close;\n        closeSum += close;\n\n        if (i >= calcParams[0] - 1) {\n          if (i > calcParams[0] - 1) {\n            smaValue = (close * calcParams[1] + smaValue * (calcParams[0] - calcParams[1] + 1)) / (calcParams[0] + 1);\n          } else {\n            smaValue = closeSum / calcParams[0];\n          }\n\n          sma.sma = smaValue;\n        }\n\n        return sma;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http:*www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * trix\n   *\n   * TR=收盘价的N日指数移动平均的N日指数移动平均的N日指数移动平均；\n   * TRIX=(TR-昨日TR)/昨日TR*100；\n   * MATRIX=TRIX的M日简单移动平均；\n   * 默认参数N设为12，默认参数M设为9；\n   * 默认参数12、9\n   * 公式：MTR:=EMA(EMA(EMA(CLOSE,N),N),N)\n   * TRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\n   * TRMA:MA(TRIX,M)\n   *\n   */\n\n  var tripleExponentiallySmoothedAverage = {\n    name: 'TRIX',\n    calcParams: [12, 9],\n    plots: [{\n      key: 'trix',\n      title: 'TRIX: ',\n      type: 'line'\n    }, {\n      key: 'maTrix',\n      title: 'MATRIX: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var closeSum = 0;\n      var ema1;\n      var ema2;\n      var oldTr;\n      var ema1Sum = 0;\n      var ema2Sum = 0;\n      var trixSum = 0;\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var trix = {};\n        var close = kLineData.close;\n        closeSum += close;\n\n        if (i >= calcParams[0] - 1) {\n          if (i > calcParams[0] - 1) {\n            ema1 = (2 * close + (calcParams[0] - 1) * ema1) / (calcParams[0] + 1);\n          } else {\n            ema1 = closeSum / calcParams[0];\n          }\n\n          ema1Sum += ema1;\n\n          if (i >= calcParams[0] * 2 - 2) {\n            if (i > calcParams[0] * 2 - 2) {\n              ema2 = (2 * ema1 + (calcParams[0] - 1) * ema2) / (calcParams[0] + 1);\n            } else {\n              ema2 = ema1Sum / calcParams[0];\n            }\n\n            ema2Sum += ema2;\n\n            if (i >= calcParams[0] * 3 - 3) {\n              var tr;\n              var trixValue = 0;\n\n              if (i > calcParams[0] * 3 - 3) {\n                tr = (2 * ema2 + (calcParams[0] - 1) * oldTr) / (calcParams[0] + 1);\n                trixValue = (tr - oldTr) / oldTr * 100;\n              } else {\n                tr = ema2Sum / calcParams[0];\n              }\n\n              oldTr = tr;\n              trix.trix = trixValue;\n              trixSum += trixValue;\n\n              if (i >= calcParams[0] * 3 + calcParams[1] - 4) {\n                trix.maTrix = trixSum / calcParams[1];\n                trixSum -= result[i - (calcParams[1] - 1)].trix;\n              }\n            }\n          }\n        }\n\n        result.push(trix);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * BRAR\n   * 默认参数是26。\n   * 公式N日BR=N日内（H－CY）之和除以N日内（CY－L）之和*100，\n   * 其中，H为当日最高价，L为当日最低价，CY为前一交易日的收盘价，N为设定的时间参数。\n   * N日AR=(N日内（H－O）之和除以N日内（O－L）之和)*100，\n   * 其中，H为当日最高价，L为当日最低价，O为当日开盘价，N为设定的时间参数\n   *\n   */\n\n  var brar = {\n    name: 'BRAR',\n    calcParams: [26],\n    plots: [{\n      key: 'br',\n      title: 'BR: ',\n      type: 'line'\n    }, {\n      key: 'ar',\n      title: 'AR: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var hcy = 0;\n      var cyl = 0;\n      var ho = 0;\n      var ol = 0;\n      return dataList.map(function (kLineData, i) {\n        var brar = {};\n        var high = kLineData.high;\n        var low = kLineData.low;\n        var open = kLineData.open;\n        var preClose = (dataList[i - 1] || kLineData).close;\n        ho += high - open;\n        ol += open - low;\n        hcy += high - preClose;\n        cyl += preClose - low;\n\n        if (i >= calcParams[0] - 1) {\n          if (ol !== 0) {\n            brar.ar = ho / ol * 100;\n          } else {\n            brar.ar = 0;\n          }\n\n          if (cyl !== 0) {\n            brar.br = hcy / cyl * 100;\n          } else {\n            brar.br = 0;\n          }\n\n          var agoKLineData = dataList[i - (calcParams[0] - 1)];\n          var agoHigh = agoKLineData.high;\n          var agoLow = agoKLineData.low;\n          var agoOpen = agoKLineData.open;\n          var agoPreClose = (dataList[i - calcParams[0]] || dataList[i - (calcParams[0] - 1)]).close;\n          hcy -= agoHigh - agoPreClose;\n          cyl -= agoPreClose - agoLow;\n          ho -= agoHigh - agoOpen;\n          ol -= agoOpen - agoLow;\n        }\n\n        return brar;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http:*www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * MID:=REF(HIGH+LOW,1)/2;\n   * CR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\n   * MA1:REF(MA(CR,M1),M1/2.5+1);\n   * MA2:REF(MA(CR,M2),M2/2.5+1);\n   * MA3:REF(MA(CR,M3),M3/2.5+1);\n   * MA4:REF(MA(CR,M4),M4/2.5+1);\n   * MID赋值:(昨日最高价+昨日最低价)/2\n   * 输出带状能量线:0和最高价-MID的较大值的N日累和/0和MID-最低价的较大值的N日累和*100\n   * 输出MA1:M1(5)/2.5+1日前的CR的M1(5)日简单移动平均\n   * 输出MA2:M2(10)/2.5+1日前的CR的M2(10)日简单移动平均\n   * 输出MA3:M3(20)/2.5+1日前的CR的M3(20)日简单移动平均\n   * 输出MA4:M4/2.5+1日前的CR的M4日简单移动平均\n   *\n   */\n\n  var currentRatio = {\n    name: 'CR',\n    calcParams: [26, 10, 20, 40, 60],\n    plots: [{\n      key: 'cr',\n      title: 'CR: ',\n      type: 'line'\n    }, {\n      key: 'ma1',\n      title: 'MA1: ',\n      type: 'line'\n    }, {\n      key: 'ma2',\n      title: 'MA2: ',\n      type: 'line'\n    }, {\n      key: 'ma3',\n      title: 'MA3: ',\n      type: 'line'\n    }, {\n      key: 'ma4',\n      title: 'MA4: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var ma1ForwardPeriod = Math.ceil(calcParams[1] / 2.5 + 1);\n      var ma2ForwardPeriod = Math.ceil(calcParams[2] / 2.5 + 1);\n      var ma3ForwardPeriod = Math.ceil(calcParams[3] / 2.5 + 1);\n      var ma4ForwardPeriod = Math.ceil(calcParams[4] / 2.5 + 1);\n      var ma1Sum = 0;\n      var ma1List = [];\n      var ma2Sum = 0;\n      var ma2List = [];\n      var ma3Sum = 0;\n      var ma3List = [];\n      var ma4Sum = 0;\n      var ma4List = [];\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var cr = {};\n        var preData = dataList[i - 1] || kLineData;\n        var preMid = (preData.high + preData.close + preData.low + preData.open) / 4;\n        var highSubPreMid = Math.max(0, kLineData.high - preMid);\n        var preMidSubLow = Math.max(0, preMid - kLineData.low);\n\n        if (i >= calcParams[0] - 1) {\n          if (preMidSubLow !== 0) {\n            cr.cr = highSubPreMid / preMidSubLow * 100;\n          } else {\n            cr.cr = 0;\n          }\n\n          ma1Sum += cr.cr;\n          ma2Sum += cr.cr;\n          ma3Sum += cr.cr;\n          ma4Sum += cr.cr;\n\n          if (i >= calcParams[0] + calcParams[1] - 2) {\n            ma1List.push(ma1Sum / calcParams[1]);\n\n            if (i >= calcParams[0] + calcParams[1] + ma1ForwardPeriod - 3) {\n              cr.ma1 = ma1List[ma1List.length - 1 - ma1ForwardPeriod];\n            }\n\n            ma1Sum -= result[i - (calcParams[1] - 1)].cr;\n          }\n\n          if (i >= calcParams[0] + calcParams[2] - 2) {\n            ma2List.push(ma2Sum / calcParams[2]);\n\n            if (i >= calcParams[0] + calcParams[2] + ma2ForwardPeriod - 3) {\n              cr.ma2 = ma2List[ma2List.length - 1 - ma2ForwardPeriod];\n            }\n\n            ma2Sum -= result[i - (calcParams[2] - 1)].cr;\n          }\n\n          if (i >= calcParams[0] + calcParams[3] - 2) {\n            ma3List.push(ma3Sum / calcParams[3]);\n\n            if (i >= calcParams[0] + calcParams[3] + ma3ForwardPeriod - 3) {\n              cr.ma3 = ma3List[ma3List.length - 1 - ma3ForwardPeriod];\n            }\n\n            ma3Sum -= result[i - (calcParams[3] - 1)].cr;\n          }\n\n          if (i >= calcParams[0] + calcParams[4] - 2) {\n            ma4List.push(ma4Sum / calcParams[4]);\n\n            if (i >= calcParams[0] + calcParams[4] + ma4ForwardPeriod - 3) {\n              cr.ma4 = ma4List[ma4List.length - 1 - ma4ForwardPeriod];\n            }\n\n            ma4Sum -= result[i - (calcParams[4] - 1)].cr;\n          }\n        }\n\n        result.push(cr);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * mtm\n   * 公式 MTM（N日）=C－CN\n   */\n\n  var momentum = {\n    name: 'MTM',\n    calcParams: [12, 6],\n    plots: [{\n      key: 'mtm',\n      title: 'MTM: ',\n      type: 'line'\n    }, {\n      key: 'maMtm',\n      title: 'MAMTM: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var mtmSum = 0;\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var mtm = {};\n\n        if (i >= calcParams[0]) {\n          var close = kLineData.close;\n          var agoClose = dataList[i - calcParams[0]].close;\n          mtm.mtm = close - agoClose;\n          mtmSum += mtm.mtm;\n\n          if (i >= calcParams[0] + calcParams[1] - 1) {\n            mtm.maMtm = mtmSum / calcParams[1];\n            mtmSum -= result[i - (calcParams[1] - 1)].mtm;\n          }\n        }\n\n        result.push(mtm);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * PSY\n   * 公式：PSY=N日内的上涨天数/N×100%。\n   */\n\n  var psychologicalLine = {\n    name: 'PSY',\n    calcParams: [12, 6],\n    plots: [{\n      key: 'psy',\n      title: 'PSY: ',\n      type: 'line'\n    }, {\n      key: 'maPsy',\n      title: 'MAPSY: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var upCount = 0;\n      var psySum = 0;\n      var upList = [];\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var psy = {};\n        var preClose = (dataList[i - 1] || kLineData).close;\n        var upFlag = kLineData.close - preClose > 0 ? 1 : 0;\n        upList.push(upFlag);\n        upCount += upFlag;\n\n        if (i >= calcParams[0] - 1) {\n          psy.psy = upCount / calcParams[0] * 100;\n          psySum += psy.psy;\n\n          if (i >= calcParams[0] + calcParams[1] - 2) {\n            psy.maPsy = psySum / calcParams[1];\n            psySum -= result[i - (calcParams[1] - 1)].psy;\n          }\n\n          upCount -= upList[i - (calcParams[0] - 1)];\n        }\n\n        result.push(psy);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 变动率指标\n   * 公式：ROC = (CLOSE - REF(CLOSE, N)) / REF(CLOSE, N)\n   */\n\n  var rateOfChange = {\n    name: 'ROC',\n    calcParams: [12, 6],\n    shouldCheckParamCount: true,\n    plots: [{\n      key: 'roc',\n      title: 'ROC: ',\n      type: 'line'\n    }, {\n      key: 'maRoc',\n      title: 'MAROC: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(kLineDataList, calcParams) {\n      var result = [];\n      var rocSum = 0;\n      kLineDataList.forEach(function (kLineData, i) {\n        var roc = {};\n\n        if (i >= calcParams[0] - 1) {\n          var close = kLineData.close;\n          var agoClose = (kLineDataList[i - calcParams[0]] || kLineDataList[i - (calcParams[0] - 1)]).close;\n\n          if (agoClose !== 0) {\n            roc.roc = (close - agoClose) / agoClose * 100;\n          } else {\n            roc.roc = 0;\n          }\n\n          rocSum += roc.roc;\n\n          if (i >= calcParams[0] - 1 + calcParams[1] - 1) {\n            roc.maRoc = rocSum / calcParams[1];\n            rocSum -= result[i - (calcParams[1] - 1)].roc;\n          }\n        }\n\n        result.push(roc);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * VR\n   * VR=（UVS+1/2PVS）/（DVS+1/2PVS）\n   * 24天以来凡是股价上涨那一天的成交量都称为AV，将24天内的AV总和相加后称为UVS\n   * 24天以来凡是股价下跌那一天的成交量都称为BV，将24天内的BV总和相加后称为DVS\n   * 24天以来凡是股价不涨不跌，则那一天的成交量都称为CV，将24天内的CV总和相加后称为PVS\n   *\n   */\n\n  var volumeRatio = {\n    name: 'VR',\n    calcParams: [26, 6],\n    plots: [{\n      key: 'vr',\n      title: 'VR: ',\n      type: 'line'\n    }, {\n      key: 'maVr',\n      title: 'MAVR: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var uvs = 0;\n      var dvs = 0;\n      var pvs = 0;\n      var vrSum = 0;\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var vr = {};\n        var close = kLineData.close;\n        var preClose = (dataList[i - 1] || kLineData).close;\n        var volume = kLineData.volume;\n\n        if (close > preClose) {\n          uvs += volume;\n        } else if (close < preClose) {\n          dvs += volume;\n        } else {\n          pvs += volume;\n        }\n\n        if (i >= calcParams[0] - 1) {\n          var halfPvs = pvs / 2;\n\n          if (dvs + halfPvs === 0) {\n            vr.vr = 0;\n          } else {\n            vr.vr = (uvs + halfPvs) / (dvs + halfPvs) * 100;\n          }\n\n          vrSum += vr.vr;\n\n          if (i >= calcParams[0] + calcParams[1] - 2) {\n            vr.maVr = vrSum / calcParams[1];\n            vrSum -= result[i - (calcParams[1] - 1)].vr;\n          }\n\n          var agoData = dataList[i - (calcParams[0] - 1)];\n          var agoPreData = dataList[i - calcParams[0]] || agoData;\n          var agoClose = agoData.close;\n          var agoVolume = agoData.volume;\n\n          if (agoClose > agoPreData.close) {\n            uvs -= agoVolume;\n          } else if (agoClose < agoPreData.close) {\n            dvs -= agoVolume;\n          } else {\n            pvs -= agoVolume;\n          }\n        }\n\n        result.push(vr);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var awesomeOscillator = {\n    name: 'AO',\n    calcParams: [5, 34],\n    shouldCheckParamCount: true,\n    plots: [{\n      key: 'ao',\n      title: 'AO: ',\n      type: 'bar',\n      color: function color(data, technicalIndicatorOptions) {\n        var preData = data.preData,\n            currentData = data.currentData;\n        var preAo = (preData.technicalIndicatorData || {}).ao;\n        var ao = (currentData.technicalIndicatorData || {}).ao;\n\n        if (ao > preAo) {\n          return technicalIndicatorOptions.bar.upColor;\n        } else {\n          return technicalIndicatorOptions.bar.downColor;\n        }\n      },\n      isStroke: function isStroke(data) {\n        var preData = data.preData,\n            currentData = data.currentData;\n        var preAo = (preData.technicalIndicatorData || {}).ao;\n        var ao = (currentData.technicalIndicatorData || {}).ao;\n        return ao > preAo;\n      }\n    }],\n    baseValue: 0,\n    calcTechnicalIndicator: function calcTechnicalIndicator(kLineDataList, calcParams) {\n      var maxParam = Math.max(calcParams[0], calcParams[1]);\n      var shortSum = 0;\n      var longSum = 0;\n      var short = 0;\n      var long = 0;\n      return kLineDataList.map(function (kLineData, i) {\n        var ao = {};\n        var middle = (kLineData.low + kLineData.high) / 2;\n        shortSum += middle;\n        longSum += middle;\n\n        if (i >= calcParams[0] - 1) {\n          short = shortSum / calcParams[0];\n          var agoKLineData = kLineDataList[i - (calcParams[0] - 1)];\n          shortSum -= (agoKLineData.low + agoKLineData.high) / 2;\n        }\n\n        if (i >= calcParams[1] - 1) {\n          long = longSum / calcParams[1];\n          var _agoKLineData = kLineDataList[i - (calcParams[1] - 1)];\n          longSum -= (_agoKLineData.low + _agoKLineData.high) / 2;\n        }\n\n        if (i >= maxParam - 1) {\n          ao.ao = short - long;\n        }\n\n        return ao;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * BIAS\n   * 乖离率=[(当日收盘价-N日平均价)/N日平均价]*100%\n   */\n\n  var bias = {\n    name: 'BIAS',\n    calcParams: [6, 12, 24],\n    shouldCheckParamCount: false,\n    plots: [{\n      key: 'bias6',\n      title: 'BIAS6: ',\n      type: 'line'\n    }, {\n      key: 'bias12',\n      title: 'BIAS12: ',\n      type: 'line'\n    }, {\n      key: 'bias24',\n      title: 'BIAS24: ',\n      type: 'line'\n    }],\n    regeneratePlots: function regeneratePlots(params) {\n      return params.map(function (p) {\n        return {\n          key: \"bias\".concat(p),\n          title: \"BIAS\".concat(p, \": \"),\n          type: 'line'\n        };\n      });\n    },\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams, plots) {\n      var closeSums = [];\n      return dataList.map(function (kLineData, i) {\n        var bias = {};\n        var close = kLineData.close;\n        calcParams.forEach(function (param, j) {\n          closeSums[j] = (closeSums[j] || 0) + close;\n\n          if (i >= param - 1) {\n            var mean = closeSums[j] / calcParams[j];\n            bias[plots[j].key] = (close - mean) / mean * 100;\n            closeSums[j] -= dataList[i - (param - 1)].close;\n          }\n        });\n        return bias;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * CCI\n   * CCI（N日）=（TP－MA）÷MD÷0.015\n   * 其中，TP=（最高价+最低价+收盘价）÷3\n   * MA=近N日TP价的累计之和÷N\n   * MD=近N日TP - 当前MA绝对值的累计之和÷N\n   *\n   */\n\n  var commodityChannelIndex = {\n    name: 'CCI',\n    calcParams: [20],\n    plots: [{\n      key: 'cci',\n      title: 'CCI: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var p = calcParams[0] - 1;\n      var tpSum = 0;\n      var tpList = [];\n      return dataList.map(function (kLineData, i) {\n        var cci = {};\n        var tp = (kLineData.high + kLineData.low + kLineData.close) / 3;\n        tpSum += tp;\n        tpList.push(tp);\n\n        if (i >= p) {\n          var maTp = tpSum / calcParams[0];\n          var sliceTpList = tpList.slice(i - p, i + 1);\n          var sum = 0;\n          sliceTpList.forEach(function (tp) {\n            sum += Math.abs(tp - maTp);\n          });\n          var md = sum / calcParams[0];\n          cci.cci = md !== 0 ? (tp - maTp) / md / 0.015 : 0;\n          var agoTp = (dataList[i - p].high + dataList[i - p].low + dataList[i - p].close) / 3;\n          tpSum -= agoTp;\n        }\n\n        return cci;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * RSI\n   * RSI = SUM(MAX(CLOSE - REF(CLOSE,1),0),N) / SUM(ABS(CLOSE - REF(CLOSE,1)),N) × 100\n   */\n\n  var relativeStrengthIndex = {\n    name: 'RSI',\n    calcParams: [6, 12, 24],\n    shouldCheckParamCount: false,\n    plots: [{\n      key: 'rsi1',\n      title: 'RSI1: ',\n      type: 'line'\n    }, {\n      key: 'rsi2',\n      title: 'RSI2: ',\n      type: 'line'\n    }, {\n      key: 'rsi3',\n      title: 'RSI3: ',\n      type: 'line'\n    }],\n    regeneratePlots: function regeneratePlots(params) {\n      return params.map(function (_, index) {\n        var num = index + 1;\n        return {\n          key: \"rsi\".concat(num),\n          title: \"RSI\".concat(num, \": \"),\n          type: 'line'\n        };\n      });\n    },\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams, plots) {\n      var sumCloseAs = [];\n      var sumCloseBs = [];\n      return dataList.map(function (kLineData, i) {\n        var rsi = {};\n        var preClose = (dataList[i - 1] || kLineData).close;\n        var tmp = kLineData.close - preClose;\n        calcParams.forEach(function (param, j) {\n          if (tmp > 0) {\n            sumCloseAs[j] = (sumCloseAs[j] || 0) + tmp;\n          } else {\n            sumCloseBs[j] = (sumCloseBs[j] || 0) + Math.abs(tmp);\n          }\n\n          if (i >= param - 1) {\n            if (sumCloseBs[j] !== 0) {\n              rsi[plots[j].key] = 100 - 100.0 / (1 + sumCloseAs[j] / sumCloseBs[j]);\n            } else {\n              rsi[plots[j].key] = 0;\n            }\n\n            var agoData = dataList[i - (param - 1)];\n            var agoPreData = dataList[i - param] || agoData;\n            var agoTmp = agoData.close - agoPreData.close;\n\n            if (agoTmp > 0) {\n              sumCloseAs[j] -= agoTmp;\n            } else {\n              sumCloseBs[j] -= Math.abs(agoTmp);\n            }\n          }\n        });\n        return rsi;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 计算n周期内最高和最低\n   * @param dataList\n   * @returns {{ln: number, hn: number}}\n   */\n\n  function calcHnLn() {\n    var dataList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var hn = Number.MIN_SAFE_INTEGER;\n    var ln = Number.MAX_SAFE_INTEGER;\n    dataList.forEach(function (data) {\n      hn = Math.max(data.high, hn);\n      ln = Math.min(data.low, ln);\n    });\n    return {\n      hn: hn,\n      ln: ln\n    };\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * KDJ\n   *\n   * 当日K值=2/3×前一日K值+1/3×当日RSV\n   * 当日D值=2/3×前一日D值+1/3×当日K值\n   * 若无前一日K 值与D值，则可分别用50来代替。\n   * J值=3*当日K值-2*当日D值\n   */\n\n\n  var stockIndicatorKDJ = {\n    name: 'KDJ',\n    calcParams: [9, 3, 3],\n    plots: [{\n      key: 'k',\n      title: 'K: ',\n      type: 'line'\n    }, {\n      key: 'd',\n      title: 'D: ',\n      type: 'line'\n    }, {\n      key: 'j',\n      title: 'J: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var kdj = {};\n        var close = kLineData.close;\n\n        if (i >= calcParams[0] - 1) {\n          var lhn = calcHnLn(dataList.slice(i - (calcParams[0] - 1), i + 1));\n          var ln = lhn.ln;\n          var hn = lhn.hn;\n          var hnSubLn = hn - ln;\n          var rsv = (close - ln) / (hnSubLn === 0 ? 1 : hnSubLn) * 100;\n          kdj.k = ((calcParams[1] - 1) * (result[i - 1].k || 50) + rsv) / calcParams[1];\n          kdj.d = ((calcParams[2] - 1) * (result[i - 1].d || 50) + kdj.k) / calcParams[2];\n          kdj.j = 3.0 * kdj.k - 2.0 * kdj.d;\n        }\n\n        result.push(kdj);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * WR\n   * 公式 WR(N) = 100 * [ C - HIGH(N) ] / [ HIGH(N)-LOW(N) ]\n   */\n\n  var williamsR = {\n    name: 'WR',\n    calcParams: [6, 10, 14],\n    shouldCheckParamCount: false,\n    plots: [{\n      key: 'wr1',\n      title: 'WR1: ',\n      type: 'line'\n    }, {\n      key: 'wr2',\n      title: 'WR2: ',\n      type: 'line'\n    }, {\n      key: 'wr3',\n      title: 'WR3: ',\n      type: 'line'\n    }],\n    regeneratePlots: function regeneratePlots(params) {\n      return params.map(function (_, i) {\n        return {\n          key: \"wr\".concat(i + 1),\n          title: \"WR\".concat(i + 1, \": \"),\n          type: 'line'\n        };\n      });\n    },\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams, plots) {\n      return dataList.map(function (kLineData, i) {\n        var wr = {};\n        var close = kLineData.close;\n        calcParams.forEach(function (param, index) {\n          var p = param - 1;\n\n          if (i >= p) {\n            var hln = calcHnLn(dataList.slice(i - p, i + 1));\n            var hn = hln.hn;\n            var ln = hln.ln;\n            var hnSubLn = hn - ln;\n            wr[plots[index].key] = hnSubLn === 0 ? 0 : (close - hn) / hnSubLn * 100;\n          }\n        });\n        return wr;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 计算布林指标中的标准差\n   * @param dataList\n   * @param ma\n   * @return {number}\n   */\n\n  function getBollMd(dataList, ma) {\n    var dataSize = dataList.length;\n    var sum = 0;\n    dataList.forEach(function (data) {\n      var closeMa = data.close - ma;\n      sum += closeMa * closeMa;\n    });\n    var b = sum > 0;\n    sum = Math.abs(sum);\n    var md = Math.sqrt(sum / dataSize);\n    return b ? md : -1 * md;\n  }\n  /**\n   * BOLL\n   */\n\n\n  var bollingerBands = {\n    name: 'BOLL',\n    series: 'price',\n    calcParams: [20, 2],\n    calcParamsAllowDecimal: {\n      1: true\n    },\n    precision: 2,\n    shouldOhlc: true,\n    plots: [{\n      key: 'up',\n      title: 'UP: ',\n      type: 'line'\n    }, {\n      key: 'mid',\n      title: 'MID: ',\n      type: 'line'\n    }, {\n      key: 'dn',\n      title: 'DN: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var p = calcParams[0] - 1;\n      var closeSum = 0;\n      return dataList.map(function (kLineData, i) {\n        var close = kLineData.close;\n        var boll = {};\n        closeSum += close;\n\n        if (i >= p) {\n          boll.mid = closeSum / calcParams[0];\n          var md = getBollMd(dataList.slice(i - p, i + 1), boll.mid);\n          boll.up = boll.mid + calcParams[1] * md;\n          boll.dn = boll.mid - calcParams[1] * md;\n          closeSum -= dataList[i - p].close;\n        }\n\n        return boll;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var stopAndReverse = {\n    name: 'SAR',\n    series: 'price',\n    calcParams: [2, 2, 20],\n    precision: 2,\n    shouldOhlc: true,\n    plots: [{\n      key: 'sar',\n      title: 'SAR: ',\n      type: 'circle',\n      color: function color(data, options) {\n        var currentData = data.currentData;\n        var kLineData = currentData.kLineData || {};\n        var technicalIndicatorData = currentData.technicalIndicatorData || {};\n        var halfHL = (kLineData.high + kLineData.low) / 2;\n\n        if (technicalIndicatorData.sar < halfHL) {\n          return options.circle.upColor;\n        }\n\n        return options.circle.downColor;\n      }\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var startAf = calcParams[0] / 100;\n      var step = calcParams[1] / 100;\n      var maxAf = calcParams[2] / 100; // 加速因子\n\n      var af = startAf; // 极值\n\n      var ep = -100; // 判断是上涨还是下跌  false：下跌\n\n      var isIncreasing = false;\n      var sar = 0;\n      return dataList.map(function (kLineData, i) {\n        // 上一个周期的sar\n        var preSar = sar;\n        var high = kLineData.high;\n        var low = kLineData.low;\n\n        if (isIncreasing) {\n          // 上涨\n          if (ep === -100 || ep < high) {\n            // 重新初始化值\n            ep = high;\n            af = Math.min(af + step, maxAf);\n          }\n\n          sar = preSar + af * (ep - preSar);\n          var lowMin = Math.min(dataList[Math.max(1, i) - 1].low, low);\n\n          if (sar > kLineData.low) {\n            sar = ep; // 重新初始化值\n\n            af = startAf;\n            ep = -100;\n            isIncreasing = !isIncreasing;\n          } else if (sar > lowMin) {\n            sar = lowMin;\n          }\n        } else {\n          if (ep === -100 || ep > low) {\n            // 重新初始化值\n            ep = low;\n            af = Math.min(af + step, maxAf);\n          }\n\n          sar = preSar + af * (ep - preSar);\n          var highMax = Math.max(dataList[Math.max(1, i) - 1].high, high);\n\n          if (sar < kLineData.high) {\n            sar = ep; // 重新初始化值\n\n            af = 0;\n            ep = -100;\n            isIncreasing = !isIncreasing;\n          } else if (sar < highMax) {\n            sar = highMax;\n          }\n        }\n\n        return {\n          sar: sar\n        };\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * OBV\n   * OBV = REF(OBV) + sign * V\n   */\n\n  var onBalanceVolume = {\n    name: 'OBV',\n    calcParams: [30],\n    plots: [{\n      key: 'obv',\n      title: 'OBV: ',\n      type: 'line'\n    }, {\n      key: 'maObv',\n      title: 'MAOBV: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams) {\n      var obvSum = 0;\n      var oldObv = 0;\n      var result = [];\n      dataList.forEach(function (kLineData, i) {\n        var preKLineData = dataList[i - 1] || kLineData;\n\n        if (kLineData.close < preKLineData.close) {\n          oldObv -= kLineData.volume;\n        } else if (kLineData.close > preKLineData.close) {\n          oldObv += kLineData.volume;\n        }\n\n        var obv = {\n          obv: oldObv\n        };\n        obvSum += oldObv;\n\n        if (i >= calcParams[0] - 1) {\n          obv.maObv = obvSum / calcParams[0];\n          obvSum -= result[i - (calcParams[0] - 1)].obv;\n        }\n\n        result.push(obv);\n      });\n      return result;\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 价量趋势指标\n   * 公式:\n   * X = (CLOSE - REF(CLOSE, 1)) / REF(CLOSE, 1) * VOLUME\n   * PVT = SUM(X)\n   *\n   */\n\n  var priceAndVolumeTrend = {\n    name: 'PVT',\n    plots: [{\n      key: 'pvt',\n      title: 'PVT: ',\n      type: 'line'\n    }],\n    calcTechnicalIndicator: function calcTechnicalIndicator(kLineDataList) {\n      var sum = 0;\n      return kLineDataList.map(function (kLineData, i) {\n        var pvt = {};\n        var close = kLineData.close;\n        var volume = kLineData.volume;\n        var preClose = (kLineDataList[i - 1] || kLineData).close;\n        var x = 0;\n\n        if (preClose !== 0) {\n          x = (close - preClose) / preClose * volume;\n        }\n\n        sum += x;\n        pvt.pvt = sum;\n        return pvt;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var volume = {\n    name: 'VOL',\n    series: 'volume',\n    calcParams: [5, 10, 20],\n    shouldCheckParamCount: false,\n    shouldFormatBigNumber: true,\n    precision: 0,\n    baseValue: 0,\n    minValue: 0,\n    plots: [{\n      key: 'ma5',\n      title: 'MA5: ',\n      type: 'line'\n    }, {\n      key: 'ma10',\n      title: 'MA10: ',\n      type: 'line'\n    }, {\n      key: 'ma20',\n      title: 'MA20: ',\n      type: 'line'\n    }, {\n      key: 'volume',\n      title: 'VOLUME: ',\n      type: 'bar',\n      color: function color(data, options) {\n        var kLineData = data.currentData.kLineData || {};\n\n        if (kLineData.close > kLineData.open) {\n          return options.bar.upColor;\n        } else if (kLineData.close < kLineData.open) {\n          return options.bar.downColor;\n        }\n\n        return options.bar.noChangeColor;\n      }\n    }],\n    regeneratePlots: function regeneratePlots(params) {\n      var plots = params.map(function (p) {\n        return {\n          key: \"ma\".concat(p),\n          title: \"MA\".concat(p, \": \"),\n          type: 'line'\n        };\n      });\n      plots.push({\n        key: 'volume',\n        title: 'VOLUME: ',\n        type: 'bar',\n        color: function color(data, options) {\n          var kLineData = data.currentData.kLineData || {};\n\n          if (kLineData.close > kLineData.open) {\n            return options.bar.upColor;\n          } else if (kLineData.close < kLineData.open) {\n            return options.bar.downColor;\n          }\n\n          return options.bar.noChangeColor;\n        }\n      });\n      return plots;\n    },\n    calcTechnicalIndicator: function calcTechnicalIndicator(dataList, calcParams, plots) {\n      var volSums = [];\n      return dataList.map(function (kLineData, i) {\n        var volume = kLineData.volume || 0;\n        var vol = {\n          volume: volume\n        };\n        calcParams.forEach(function (param, j) {\n          volSums[j] = (volSums[j] || 0) + volume;\n\n          if (i >= param - 1) {\n            vol[plots[j].key] = volSums[j] / param;\n            volSums[j] -= dataList[i - (param - 1)].volume;\n          }\n        });\n        return vol;\n      });\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var extension = {\n    technicalIndicatorExtensions: {},\n    graphicMarkExtensions: {},\n    addTechnicalIndicator: function addTechnicalIndicator(technicalIndicators) {\n      var _this = this;\n\n      if (technicalIndicators) {\n        [].concat(technicalIndicators).forEach(function (technicalIndicator) {\n          if (technicalIndicator.name) {\n            _this.technicalIndicatorExtensions[technicalIndicator.name] = technicalIndicator;\n          }\n        });\n      }\n    },\n    addGraphicMark: function addGraphicMark(graphicMarks) {\n      var _this2 = this;\n\n      if (graphicMarks) {\n        [].concat(graphicMarks).forEach(function (graphicMark) {\n          if (graphicMark.name) {\n            _this2.graphicMarkExtensions[graphicMark.name] = graphicMark;\n          }\n        });\n      }\n    }\n  };\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n\n      if (enumerableOnly) {\n        symbols = symbols.filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n        });\n      }\n\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n          result;\n\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== \"undefined\" && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _createForOfIteratorHelper(o, allowArrayLike) {\n    var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n    if (!it) {\n      if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n        if (it) o = it;\n        var i = 0;\n\n        var F = function () {};\n\n        return {\n          s: F,\n          n: function () {\n            if (i >= o.length) return {\n              done: true\n            };\n            return {\n              done: false,\n              value: o[i++]\n            };\n          },\n          e: function (e) {\n            throw e;\n          },\n          f: F\n        };\n      }\n\n      throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n    }\n\n    var normalCompletion = true,\n        didErr = false,\n        err;\n    return {\n      s: function () {\n        it = it.call(o);\n      },\n      n: function () {\n        var step = it.next();\n        normalCompletion = step.done;\n        return step;\n      },\n      e: function (e) {\n        didErr = true;\n        err = e;\n      },\n      f: function () {\n        try {\n          if (!normalCompletion && it.return != null) it.return();\n        } finally {\n          if (didErr) throw err;\n        }\n      }\n    };\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 合并\n   * @param target\n   * @param source\n   */\n\n\n  function merge(target, source) {\n    if (!isObject(target) || !isObject(source)) {\n      return;\n    }\n\n    for (var key in source) {\n      if (key in target) {\n        var targetProp = target[key];\n        var sourceProp = source[key];\n\n        if (isObject(sourceProp) && isObject(targetProp) && !isArray(sourceProp) && !isArray(targetProp)) {\n          merge(targetProp, sourceProp);\n        } else {\n          if (isValid(source[key])) {\n            target[key] = source[key];\n          }\n        }\n      }\n    }\n  }\n  /**\n   * 克隆\n   * @param target\n   * @return {{}|*}\n   */\n\n\n  function clone(target) {\n    if (!isObject(target)) {\n      return target;\n    }\n\n    var copy;\n\n    if (isArray(target)) {\n      copy = [];\n    } else {\n      copy = {};\n    }\n\n    for (var key in target) {\n      if (target.hasOwnProperty(key)) {\n        var v = target[key];\n\n        if (isObject(v)) {\n          copy[key] = clone(v);\n        } else {\n          copy[key] = v;\n        }\n      }\n    }\n\n    return copy;\n  }\n  /**\n   * 是否是数组\n   * @param value\n   * @return {boolean}\n   */\n\n\n  function isArray(value) {\n    return Object.prototype.toString.call(value) === '[object Array]';\n  }\n  /**\n   * 是否是方法\n   * @param {*} value\n   * @return {boolean}\n   */\n\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * 是否是对象\n   * @param {*} value\n   * @return {boolean}\n   */\n\n\n  function isObject(value) {\n    return !!value && _typeof(value) === 'object';\n  }\n  /**\n   * 判断是否是数字\n   * @param value\n   * @returns {boolean}\n   */\n\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * 判断是否有效\n   * @param value\n   * @returns {boolean}\n   */\n\n\n  function isValid(value) {\n    return value !== null && value !== undefined;\n  }\n  /**\n   * 判断是否是boolean\n   * @param value\n   * @returns {boolean}\n   */\n\n\n  function isBoolean(value) {\n    return typeof value === 'boolean';\n  }\n  /**\n   * 是否是字符串\n   * @param value\n   * @return {boolean}\n   */\n\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * 是否是容器元素\n   * @param dom\n   * @return {boolean}\n   */\n\n\n  function isContainerDom(dom) {\n    return dom && dom instanceof HTMLElement && dom.appendChild && typeof dom.appendChild === 'function';\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 线的样式\n   * @type {{DASH: string, SOLID: string}}\n   */\n\n\n  var LineStyle = {\n    DASH: 'dash',\n    SOLID: 'solid'\n  };\n  /**\n   * y轴位置\n   * @type {{LEFT: string, RIGHT: string}}\n   */\n\n  var YAxisPosition = {\n    LEFT: 'left',\n    RIGHT: 'right'\n  };\n  /**\n   * y轴类型\n   * @type {{PERCENTAGE: string, NORMAL: string}}\n   */\n\n  var YAxisType = {\n    NORMAL: 'normal',\n    PERCENTAGE: 'percentage',\n    LOG: 'log'\n  };\n  /**\n   * 蜡烛图样式\n   * @type {{AREA: string, OHLC: string, CANDLE_STROKE: string, CANDLE_SOLID: string, CANDLE_DOWN_STROKE: string, CANDLE_UP_STROKE: string}}\n   */\n\n  var CandleType = {\n    CANDLE_SOLID: 'candle_solid',\n    CANDLE_STROKE: 'candle_stroke',\n    CANDLE_UP_STROKE: 'candle_up_stroke',\n    CANDLE_DOWN_STROKE: 'candle_down_stroke',\n    OHLC: 'ohlc',\n    AREA: 'area'\n  };\n  /**\n   * 说明显示规则\n   * @type {{FOLLOW_CROSS: string, NONE: string, ALWAYS: string}}\n   */\n\n  var TooltipShowRule = {\n    ALWAYS: 'always',\n    FOLLOW_CROSS: 'follow_cross',\n    NONE: 'none'\n  };\n  /**\n   * 数据提示显示类型\n   * @type {{RECT: string, STANDARD: string}}\n   */\n\n  var TooltipShowType = {\n    RECT: 'rect',\n    STANDARD: 'standard'\n  };\n  /**\n   * 注解标识类似\n   * @type {{RECT: string, TRIANGLE: string, DIAMOND: string, CUSTOM: string, NONE: string, CIRCLE: string}}\n   */\n\n  var AnnotationSymbolType = {\n    CIRCLE: 'circle',\n    RECT: 'rect',\n    TRIANGLE: 'triangle',\n    DIAMOND: 'diamond',\n    CUSTOM: 'custom',\n    NONE: 'none'\n  };\n  /**\n   * 覆盖物位置\n   * @type {{TOP: string, BOTTOM: string, POINT: string}}\n   */\n\n  var OverlayPosition = {\n    POINT: 'point',\n    TOP: 'top',\n    BOTTOM: 'bottom'\n  };\n  /**\n   * 默认网格配置\n   * @type {{horizontal: {size: number, color: string, dashValue: number[], show: boolean, style: string}, show: boolean, vertical: {size: number, color: string, dashValue: number[], show: boolean, style: string}}}\n   */\n\n  var defaultGrid = {\n    show: true,\n    horizontal: {\n      show: true,\n      size: 1,\n      color: '#EDEDED',\n      style: LineStyle.DASH,\n      dashValue: [2, 2]\n    },\n    vertical: {\n      show: true,\n      size: 1,\n      color: '#EDEDED',\n      style: LineStyle.DASH,\n      dashValue: [2, 2]\n    }\n  };\n  /**\n   * 默认蜡烛柱图样式配置\n   * @type {{area: {fillColor: [{offset: number, color: string}, {offset: number, color: string}], lineColor: string, lineSize: number, value: string}, bar: {noChangeColor: string, upColor: string, downColor: string}, tooltip: {rect: {offsetTop: number, fillColor: string, borderColor: string, paddingBottom: number, borderRadius: number, paddingRight: number, borderSize: number, offsetLeft: number, paddingTop: number, paddingLeft: number, offsetRight: number}, showRule: string, values: null, showType: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, labels: string[]}, type: string, priceMark: {high: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, last: {noChangeColor: string, upColor: string, line: {dashValue: number[], size: number, show: boolean, style: string}, show: boolean, text: {paddingBottom: number, size: number, color: string, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}, downColor: string}, low: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, show: boolean}}}\n   */\n\n  var defaultCandle = {\n    margin: {\n      top: 0.2,\n      bottom: 0.1\n    },\n    type: CandleType.CANDLE_SOLID,\n    bar: {\n      /**\n       * 上涨颜色\n       */\n      upColor: '#26A69A',\n\n      /**\n       * 下跌颜色\n       */\n      downColor: '#EF5350',\n\n      /**\n       * 无变化时颜色\n       */\n      noChangeColor: '#999999'\n    },\n    area: {\n      lineSize: 2,\n      lineColor: '#2196F3',\n      value: 'close',\n      fillColor: [{\n        offset: 0,\n        color: 'rgba(33, 150, 243, 0.01)'\n      }, {\n        offset: 1,\n        color: 'rgba(33, 150, 243, 0.2)'\n      }]\n    },\n    priceMark: {\n      show: true,\n      high: {\n        show: true,\n        color: '#76808F',\n        textMargin: 5,\n        textSize: 10,\n        textFamily: 'Helvetica Neue',\n        textWeight: 'normal'\n      },\n      low: {\n        show: true,\n        color: '#76808F',\n        textMargin: 5,\n        textSize: 10,\n        textFamily: 'Helvetica Neue',\n        textWeight: 'normal'\n      },\n      last: {\n        show: true,\n        upColor: '#26A69A',\n        downColor: '#EF5350',\n        noChangeColor: '#888888',\n        line: {\n          show: true,\n          style: LineStyle.DASH,\n          dashValue: [4, 4],\n          size: 1\n        },\n        text: {\n          show: true,\n          size: 12,\n          paddingLeft: 2,\n          paddingTop: 2,\n          paddingRight: 2,\n          paddingBottom: 2,\n          color: '#FFFFFF',\n          family: 'Helvetica Neue',\n          weight: 'normal',\n          borderRadius: 2\n        }\n      }\n    },\n    tooltip: {\n      showRule: TooltipShowRule.ALWAYS,\n      showType: TooltipShowType.STANDARD,\n      labels: ['时间: ', '开: ', '收: ', '高: ', '低: ', '成交量: '],\n      values: null,\n      defaultValue: 'n/a',\n      rect: {\n        paddingLeft: 0,\n        paddingRight: 0,\n        paddingTop: 0,\n        paddingBottom: 6,\n        offsetLeft: 8,\n        offsetTop: 8,\n        offsetRight: 8,\n        borderRadius: 4,\n        borderSize: 1,\n        borderColor: '#F2F3F5',\n        fillColor: '#FEFEFE'\n      },\n      text: {\n        size: 12,\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        color: '#76808F',\n        marginLeft: 8,\n        marginTop: 6,\n        marginRight: 8,\n        marginBottom: 0\n      }\n    }\n  };\n  /**\n   * 默认的技术指标样式配置\n   * @type {{bar: {noChangeColor: string, upColor: string, downColor: string}, line: {size: number, colors: [string, string, string, string, string]}, tooltip: {showParams: boolean, showName: boolean, showRule: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}}, circle: {noChangeColor: string, upColor: string, downColor: string}, lastValueMark: {show: boolean, text: {paddingBottom: number, color: string, size: number, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}}}}\n   */\n\n  var defaultTechnicalIndicator = {\n    margin: {\n      top: 0.2,\n      bottom: 0.1\n    },\n    bar: {\n      upColor: 'rgba(38, 166, 154, .65)',\n      downColor: 'rgba(239, 83, 80, .65)',\n      noChangeColor: '#888888'\n    },\n    line: {\n      size: 1,\n      colors: ['#FF9600', '#9D65C9', '#2196F3', '#E11D74', '#01C5C4']\n    },\n    circle: {\n      upColor: 'rgba(38, 166, 154, .65)',\n      downColor: 'rgba(239, 83, 80, .65)',\n      noChangeColor: '#888888'\n    },\n    lastValueMark: {\n      show: false,\n      text: {\n        show: false,\n        color: '#FFFFFF',\n        size: 12,\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        paddingLeft: 3,\n        paddingTop: 2,\n        paddingRight: 3,\n        paddingBottom: 2,\n        borderRadius: 2\n      }\n    },\n    tooltip: {\n      showRule: TooltipShowRule.ALWAYS,\n      showType: TooltipShowType.STANDARD,\n      showName: true,\n      showParams: true,\n      defaultValue: 'n/a',\n      text: {\n        size: 12,\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        color: '#76808F',\n        marginTop: 6,\n        marginRight: 8,\n        marginBottom: 0,\n        marginLeft: 8\n      }\n    }\n  };\n  /**\n   * 默认x轴配置\n   * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, tickText: {paddingBottom: number, color: string, size: number, show: boolean, weight: string, paddingTop: number, family: string}, height: null, tickLine: {size: number, color: string, show: boolean, length: number}}}\n   */\n\n  var defaultXAxis = {\n    /**\n     * 是否显示整个轴\n     */\n    show: true,\n\n    /**\n     * 高度\n     */\n    height: null,\n\n    /**\n     * 轴线配置\n     */\n    axisLine: {\n      show: true,\n      color: '#DDDDDD',\n      size: 1\n    },\n\n    /**\n     * tick文字\n     */\n    tickText: {\n      show: true,\n      color: '#76808F',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingTop: 3,\n      paddingBottom: 6\n    },\n    // tick线\n    tickLine: {\n      show: true,\n      size: 1,\n      length: 3,\n      color: '#DDDDDD'\n    }\n  };\n  /**\n   * 默认y轴配置\n   * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, width: null, position: string, tickText: {color: string, size: number, paddingRight: number, show: boolean, weight: string, family: string, paddingLeft: number}, type: string, inside: boolean, tickLine: {size: number, color: string, show: boolean, length: number}}}\n   */\n\n  var defaultYAxis = {\n    /**\n     * 是否显示整个轴\n     */\n    show: true,\n\n    /**\n     * 宽度\n     */\n    width: null,\n\n    /**\n     * y轴类型\n     */\n    type: YAxisType.NORMAL,\n\n    /**\n     * 轴位置\n     */\n    position: YAxisPosition.RIGHT,\n\n    /**\n     * 轴是否在内部\n     */\n    inside: false,\n\n    /**\n     * 轴线配置\n     */\n    axisLine: {\n      show: true,\n      color: '#DDDDDD',\n      size: 1\n    },\n\n    /**\n     * tick文字\n     */\n    tickText: {\n      show: true,\n      color: '#76808F',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 3,\n      paddingRight: 6\n    },\n    // tick线\n    tickLine: {\n      show: true,\n      size: 1,\n      length: 3,\n      color: '#DDDDDD'\n    }\n  };\n  var defaultCrosshair = {\n    show: true,\n    horizontal: {\n      show: true,\n      line: {\n        show: true,\n        style: LineStyle.DASH,\n        dashValue: [4, 2],\n        size: 1,\n        color: '#76808F'\n      },\n      text: {\n        show: true,\n        color: '#FFFFFF',\n        size: 12,\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        paddingLeft: 2,\n        paddingRight: 2,\n        paddingTop: 2,\n        paddingBottom: 2,\n        borderSize: 1,\n        borderColor: '#686D76',\n        borderRadius: 2,\n        backgroundColor: '#686D76'\n      }\n    },\n    vertical: {\n      show: true,\n      line: {\n        show: true,\n        style: LineStyle.DASH,\n        dashValue: [4, 2],\n        size: 1,\n        color: '#76808F'\n      },\n      text: {\n        show: true,\n        color: '#FFFFFF',\n        size: 12,\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        paddingLeft: 2,\n        paddingRight: 2,\n        paddingTop: 2,\n        paddingBottom: 2,\n        borderSize: 1,\n        borderRadius: 2,\n        borderColor: '#686D76',\n        backgroundColor: '#686D76'\n      }\n    }\n  };\n  /**\n   * 默认图形标记配置\n   * @type {{arc: {fill: {color: string}, stroke: {size: number, color: string}}, polygon: {fill: {color: string}, stroke: {size: number, color: string}}, line: {color: string, size: number}, text: {marginRight: number, color: string, size: number, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, point: {backgroundColor: string, borderColor: string, activeBorderSize: number, activeRadius: number, activeBorderColor: string, activeBackgroundColor: string, borderSize: number, radius: number}}}\n   */\n\n  var defaultGraphicMark = {\n    point: {\n      backgroundColor: '#2196F3',\n      borderColor: 'rgba(33, 150, 243, 0.35)',\n      borderSize: 1,\n      radius: 5,\n      activeBackgroundColor: '#2196F3',\n      activeBorderColor: 'rgba(33, 150, 243, 0.35)',\n      activeBorderSize: 3,\n      activeRadius: 5\n    },\n    line: {\n      color: '#2196F3',\n      size: 1,\n      dashValue: [2, 2]\n    },\n    polygon: {\n      stroke: {\n        size: 1,\n        color: '#2196F3'\n      },\n      fill: {\n        color: 'rgba(33, 150, 243, 0.1)'\n      }\n    },\n    arc: {\n      stroke: {\n        size: 1,\n        color: '#2196F3'\n      },\n      fill: {\n        color: 'rgba(33, 150, 243, 0.1)'\n      }\n    },\n    text: {\n      color: '#2196F3',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      marginLeft: 2,\n      marginRight: 2,\n      marginTop: 2,\n      marginBottom: 6\n    }\n  };\n  /**\n   * 默认注解信息配置\n   * @type {{}}\n   */\n\n  var defaultAnnotation = {\n    symbol: {\n      type: AnnotationSymbolType.DIAMOND,\n      position: OverlayPosition.TOP,\n      size: 8,\n      color: '#2196F3',\n      activeSize: 10,\n      activeColor: '#FF9600',\n      offset: [0, 20]\n    }\n  };\n  var defaultTag = {\n    position: OverlayPosition.POINT,\n    offset: 0,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#2196F3'\n    },\n    text: {\n      color: '#FFFFFF',\n      backgroundColor: '#2196F3',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderRadius: 2\n    },\n    mark: {\n      color: '#FFFFFF',\n      backgroundColor: '#2196F3',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderRadius: 2\n    }\n  };\n  /**\n   * 图表之间默认分割配置\n   * @type {{size: number, color: string}}\n   */\n\n  var defaultSeparator = {\n    size: 1,\n    color: '#DDDDDD',\n    fill: true,\n    activeBackgroundColor: 'rgba(33, 150, 243, 0.08)'\n  };\n  var defaultStyleOptions = {\n    grid: defaultGrid,\n    candle: defaultCandle,\n    technicalIndicator: defaultTechnicalIndicator,\n    xAxis: defaultXAxis,\n    yAxis: defaultYAxis,\n    separator: defaultSeparator,\n    crosshair: defaultCrosshair,\n    graphicMark: defaultGraphicMark,\n    annotation: defaultAnnotation,\n    tag: defaultTag\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 格式化值\n   * @param data\n   * @param key\n   * @param defaultValue\n   * @returns {string|*}\n   */\n\n  function formatValue(data, key) {\n    var defaultValue = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '--';\n\n    if (isObject(data)) {\n      var value = data[key];\n\n      if (isValid(value)) {\n        return value;\n      }\n    }\n\n    return defaultValue;\n  }\n  /**\n   * 格式化时间\n   * @param dateTimeFormat\n   * @param timestamp\n   * @param format\n   * @returns {string}\n   */\n\n\n  function formatDate(dateTimeFormat, timestamp) {\n    var format = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'MM-DD hh:mm';\n\n    if (isNumber(timestamp)) {\n      var dateTimeString = dateTimeFormat.format(new Date(timestamp));\n      var dateTimeStringArray = dateTimeString.split(', ');\n      var dateStringArray = dateTimeStringArray[0].split('/');\n      var date = {\n        YYYY: dateStringArray[2],\n        MM: dateStringArray[0],\n        DD: dateStringArray[1],\n        'hh:mm': dateTimeStringArray[1].match(/^[\\d]{2}/)[0] === '24' ? dateTimeStringArray[1].replace(/^[\\d]{2}/, '00') : dateTimeStringArray[1]\n      };\n      return format.replace(/YYYY|MM|DD|(hh:mm)/g, function (key) {\n        return date[key];\n      });\n    }\n\n    return '--';\n  }\n  /**\n   * 格式化精度\n   */\n\n\n  function formatPrecision(value) {\n    var precision = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;\n    var v = +value;\n\n    if ((v || v === 0) && isNumber(v)) {\n      return v.toFixed(precision);\n    }\n\n    return \"\".concat(v);\n  }\n  /**\n   * 格式化大数据\n   * @param value\n   */\n\n\n  function formatBigNumber(value) {\n    if (isNumber(+value)) {\n      if (value > 1000000000) {\n        return \"\".concat(+(value / 1000000000).toFixed(3), \"B\");\n      }\n\n      if (value > 1000000) {\n        return \"\".concat(+(value / 1000000).toFixed(3), \"M\");\n      }\n\n      if (value > 1000) {\n        return \"\".concat(+(value / 1000).toFixed(3), \"K\");\n      }\n\n      return value;\n    }\n\n    return '--';\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 二分查找最接近的数\n   * @param dataList\n   * @param valueKey\n   * @param targetNumber\n   * @return {number}\n   */\n\n\n  function binarySearchNearest(dataList, valueKey, targetNumber) {\n    var left = 0;\n    var right = 0;\n\n    for (right = dataList.length - 1; left !== right;) {\n      var midIndex = Math.floor((right + left) / 2);\n      var mid = right - left;\n      var midValue = dataList[midIndex][valueKey];\n\n      if (targetNumber === dataList[left][valueKey]) {\n        return left;\n      }\n\n      if (targetNumber === dataList[right][valueKey]) {\n        return right;\n      }\n\n      if (targetNumber === midValue) {\n        return midIndex;\n      }\n\n      if (targetNumber > midValue) {\n        left = midIndex;\n      } else {\n        right = midIndex;\n      }\n\n      if (mid <= 2) {\n        break;\n      }\n    }\n\n    return left;\n  }\n  /**\n   * 优化数字\n   * @param value\n   * @return {number|number}\n   */\n\n\n  function nice(value) {\n    var exponent = Math.floor(log10(value));\n    var exp10 = index10(exponent);\n    var f = value / exp10; // 1 <= f < 10\n\n    var nf = 0;\n\n    if (f < 1.5) {\n      nf = 1;\n    } else if (f < 2.5) {\n      nf = 2;\n    } else if (f < 3.5) {\n      nf = 3;\n    } else if (f < 4.5) {\n      nf = 4;\n    } else if (f < 5.5) {\n      nf = 5;\n    } else if (f < 6.5) {\n      nf = 6;\n    } else {\n      nf = 8;\n    }\n\n    value = nf * exp10;\n    return exponent >= -20 ? +value.toFixed(exponent < 0 ? -exponent : 0) : value;\n  }\n  /**\n   * 四和五入\n   * @param value\n   * @param precision\n   * @return {number}\n   */\n\n\n  function round(value, precision) {\n    if (precision == null) {\n      precision = 10;\n    }\n\n    precision = Math.min(Math.max(0, precision), 20);\n    value = (+value).toFixed(precision);\n    return +value;\n  }\n  /**\n   * 获取小数位数\n   * @param value\n   * @return {number|number}\n   */\n\n\n  function getPrecision(value) {\n    var str = value.toString();\n    var eIndex = str.indexOf('e');\n\n    if (eIndex > 0) {\n      var precision = +str.slice(eIndex + 1);\n      return precision < 0 ? -precision : 0;\n    } else {\n      var dotIndex = str.indexOf('.');\n      return dotIndex < 0 ? 0 : str.length - 1 - dotIndex;\n    }\n  }\n  /**\n   * 10为低的对数函数\n   * @param value\n   * @return {number}\n   */\n\n\n  function log10(value) {\n    return Math.log(value) / Math.log(10);\n  }\n  /**\n   * 10的指数函数\n   * @param value\n   * @return {number}\n   */\n\n\n  function index10(value) {\n    return Math.pow(10, value);\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 打印警告日志\n   * @param api\n   * @param invalidParam\n   * @param append\n   */\n\n\n  function logWarn(api, invalidParam) {\n    var append = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n    {\n      console.log('%c😑 klinecharts warning: \\n%s%s%s', 'color:#fcaf17;font-weight:bold', api ? \"Call api \".concat(api).concat(invalidParam || append ? ', ' : '.') : '', invalidParam ? \"invalid parameter \".concat(invalidParam).concat(append ? ', ' : '.') : '', append ? \"\".concat(append) : '');\n    }\n  }\n  /**\n   * 打印错误日志\n   * @param api\n   * @param invalidParam\n   * @param append\n   */\n\n\n  function logError(api, invalidParam) {\n    var append = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n    {\n      console.log('%c😟 klinecharts error: \\n%s%s%s', 'color:#ed1941;font-weight:bold', api ? \"Call api \".concat(api).concat(invalidParam || append ? ', ' : '.', \",\") : '', invalidParam ? \"invalid parameter \".concat(invalidParam).concat(append ? ', ' : '.') : '', append ? \"\".concat(append) : '');\n    }\n  }\n  /**\n   * 打印标识\n   */\n\n\n  function logTag() {\n    {\n      console.log('%c❤️ Welcome to klinecharts. Version is 7.5.0', 'border-radius:2px;border:dashed 1px #2196F3;padding:26px 20px;font-size:14px;color:#2196F3');\n    }\n  }\n  /**\n   * 技术指标系列\n   * @type {{PRICE: string, VOLUME: string, NORMAL: string}}\n   */\n\n\n  var TechnicalIndicatorSeries = {\n    PRICE: 'price',\n    VOLUME: 'volume',\n    NORMAL: 'normal'\n  };\n  /**\n   * 绘制类型\n   * @type {{BAR: string, LINE: string, CIRCLE: string}}\n   */\n\n  var TechnicalIndicatorPlotType = {\n    LINE: 'line',\n    BAR: 'bar',\n    CIRCLE: 'circle'\n  };\n\n  var TechnicalIndicator = /*#__PURE__*/function () {\n    function TechnicalIndicator(_ref) {\n      var name = _ref.name,\n          series = _ref.series,\n          calcParams = _ref.calcParams,\n          plots = _ref.plots,\n          precision = _ref.precision,\n          calcParamsAllowDecimal = _ref.calcParamsAllowDecimal,\n          shouldCheckParamCount = _ref.shouldCheckParamCount,\n          shouldOhlc = _ref.shouldOhlc,\n          shouldFormatBigNumber = _ref.shouldFormatBigNumber,\n          baseValue = _ref.baseValue,\n          minValue = _ref.minValue,\n          maxValue = _ref.maxValue,\n          styles = _ref.styles;\n\n      _classCallCheck(this, TechnicalIndicator); // 指标名\n\n\n      this.name = name || ''; // 指标系列，值有 'price', 'volume', 'normal\n\n      this.series = series || 'normal'; // 精度\n\n      this.precision = isNumber(precision) && precision >= 0 ? precision : 4; // 计算参数\n\n      this.calcParams = isArray(calcParams) ? calcParams : []; // 数据信息\n\n      this.plots = isArray(plots) ? plots : []; // 计算参数是否允许小数\n\n      this.calcParamsAllowDecimal = isObject(calcParamsAllowDecimal) ? calcParamsAllowDecimal : {}; // 是否需要检查参数\n\n      this.shouldCheckParamCount = isBoolean(shouldCheckParamCount) ? shouldCheckParamCount : true; // 是否需要ohlc\n\n      this.shouldOhlc = shouldOhlc; // 是否需要格式化大数据值，从1000开始格式化，比如100000是否需要格式化100K\n\n      this.shouldFormatBigNumber = shouldFormatBigNumber; // 基础比对数据\n\n      this.baseValue = isNumber(baseValue) ? baseValue : null; // 指定的最小值\n\n      this.minValue = minValue; // 指定的最大值\n\n      this.maxValue = maxValue; // 样式\n\n      this.styles = styles;\n    }\n\n    _createClass(TechnicalIndicator, [{\n      key: \"setPrecision\",\n      value: function setPrecision(precision) {\n        if (isNumber(precision) && precision >= 0) {\n          this.precision = parseInt(precision, 10);\n          return true;\n        }\n\n        return false;\n      }\n      /**\n       * 设置计算参数是否允许小数\n       * @param calcParamsAllowDecimal\n       */\n\n    }, {\n      key: \"setCalcParamsAllowDecimal\",\n      value: function setCalcParamsAllowDecimal(calcParamsAllowDecimal) {\n        if (isObject(calcParamsAllowDecimal)) {\n          this.calcParamsAllowDecimal = calcParamsAllowDecimal;\n        }\n      }\n    }, {\n      key: \"setCalcParams\",\n      value: function setCalcParams(params) {\n        if (!isArray(params)) {\n          return false;\n        }\n\n        if (this.shouldCheckParamCount && params.length !== this.calcParams.length) {\n          return false;\n        }\n\n        for (var i = 0; i < params.length; i++) {\n          var v = params[i];\n\n          if (!isNumber(v) || v <= 0 || !this.calcParamsAllowDecimal[i] && parseInt(v, 10) !== v) {\n            return false;\n          }\n        }\n\n        this.calcParams = clone(params);\n        var plots = this.regeneratePlots(params);\n\n        if (plots && isArray(plots)) {\n          this.plots = plots;\n        }\n\n        return true;\n      }\n    }, {\n      key: \"setStyles\",\n      value: function setStyles(styles, defaultStyles) {\n        if (!isObject(styles)) {\n          return false;\n        }\n\n        if (!this.styles) {\n          this.styles = {\n            bar: clone(defaultStyles.bar),\n            line: clone(defaultStyles.line),\n            circle: clone(defaultStyles.circle)\n          };\n        }\n\n        merge(this.styles, styles);\n        return true;\n      }\n      /**\n       * 计算技术指标\n       */\n\n    }, {\n      key: \"calcTechnicalIndicator\",\n      value: function calcTechnicalIndicator(dataList, calcParams) {}\n      /**\n       * 重新生成各项数据\n       * @private\n       */\n\n    }, {\n      key: \"regeneratePlots\",\n      value: function regeneratePlots(params) {}\n    }]);\n\n    return TechnicalIndicator;\n  }();\n  /**\n   * 创建技术指标映射\n   * @return {{}}\n   */\n\n\n  function createTechnicalIndicatorMapping() {\n    var mapping = {};\n    var technicalIndicatorExtensions = extension.technicalIndicatorExtensions;\n\n    for (var name in technicalIndicatorExtensions) {\n      var technicalIndicatorInstance = createTechnicalIndicatorInstance(technicalIndicatorExtensions[name]);\n\n      if (technicalIndicatorInstance) {\n        mapping[name] = technicalIndicatorInstance;\n      }\n    }\n\n    return mapping;\n  }\n  /**\n   * 创建一个新的技术指标\n   * @param name\n   * @param series\n   * @param calcParams\n   * @param plots\n   * @param precision\n   * @param calcParamsAllowDecimal\n   * @param shouldCheckParamCount\n   * @param shouldOhlc\n   * @param shouldFormatBigNumber\n   * @param baseValue\n   * @param minValue\n   * @param maxValue\n   * @param styles\n   * @param calcTechnicalIndicator\n   * @param regeneratePlots\n   * @param render\n   * @returns {TechnicalIndicatorClass|null}\n   */\n\n\n  function createTechnicalIndicatorInstance(_ref) {\n    var name = _ref.name,\n        series = _ref.series,\n        calcParams = _ref.calcParams,\n        plots = _ref.plots,\n        precision = _ref.precision,\n        calcParamsAllowDecimal = _ref.calcParamsAllowDecimal,\n        shouldCheckParamCount = _ref.shouldCheckParamCount,\n        shouldOhlc = _ref.shouldOhlc,\n        shouldFormatBigNumber = _ref.shouldFormatBigNumber,\n        baseValue = _ref.baseValue,\n        minValue = _ref.minValue,\n        maxValue = _ref.maxValue,\n        styles = _ref.styles,\n        calcTechnicalIndicator = _ref.calcTechnicalIndicator,\n        regeneratePlots = _ref.regeneratePlots,\n        render = _ref.render;\n\n    if (!name || !isFunction(calcTechnicalIndicator)) {\n      logWarn('', '', 'The required attribute \"name\" and method \"calcTechnicalIndicator\" are missing, and new technical indicator cannot be generated!!!');\n      return null;\n    }\n\n    var TechnicalIndicatorClass = /*#__PURE__*/function (_TechnicalIndicator) {\n      _inherits(TechnicalIndicatorClass, _TechnicalIndicator);\n\n      var _super = _createSuper(TechnicalIndicatorClass);\n\n      function TechnicalIndicatorClass() {\n        _classCallCheck(this, TechnicalIndicatorClass);\n\n        return _super.call(this, {\n          name: name,\n          series: series,\n          calcParams: calcParams,\n          plots: plots,\n          precision: precision,\n          calcParamsAllowDecimal: calcParamsAllowDecimal,\n          shouldCheckParamCount: shouldCheckParamCount,\n          shouldOhlc: shouldOhlc,\n          shouldFormatBigNumber: shouldFormatBigNumber,\n          baseValue: baseValue,\n          minValue: minValue,\n          maxValue: maxValue,\n          styles: styles\n        });\n      }\n\n      return TechnicalIndicatorClass;\n    }(TechnicalIndicator);\n\n    TechnicalIndicatorClass.prototype.calcTechnicalIndicator = calcTechnicalIndicator;\n\n    if (regeneratePlots && isFunction(regeneratePlots)) {\n      TechnicalIndicatorClass.prototype.regeneratePlots = regeneratePlots;\n    }\n\n    if (render && isFunction(render)) {\n      TechnicalIndicatorClass.prototype.render = render;\n    }\n\n    return new TechnicalIndicatorClass();\n  }\n  /**\n   * 获取技术指标信息\n   * @param technicalIndicator\n   * @return {{series, calcParams, precision, name, styles}}\n   */\n\n\n  function createTechnicalIndicatorInfo(technicalIndicator) {\n    return {\n      name: technicalIndicator.name,\n      series: technicalIndicator.series,\n      calcParams: technicalIndicator.calcParams,\n      calcParamsAllowDecimal: technicalIndicator.calcParamsAllowDecimal,\n      shouldCheckParamCount: technicalIndicator.shouldCheckParamCount,\n      shouldOhlc: technicalIndicator.shouldOhlc,\n      shouldFormatBigNumber: technicalIndicator.shouldFormatBigNumber,\n      precision: technicalIndicator.precision,\n      styles: technicalIndicator.styles,\n      result: technicalIndicator.result || []\n    };\n  }\n  /**\n   * 获取技术指标提示数据\n   * @param technicalIndicatorData\n   * @param technicalIndicator\n   * @return {{calcParamText: string, values: [], name: string}}\n   */\n\n\n  function getTechnicalIndicatorTooltipData() {\n    var technicalIndicatorData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var technicalIndicator = arguments.length > 1 ? arguments[1] : undefined;\n    var calcParams = technicalIndicator.calcParams;\n    var plots = technicalIndicator.plots;\n    var precision = technicalIndicator.precision;\n    var shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber;\n    var values = [];\n    var name = '';\n    var calcParamText = '';\n\n    if (plots.length > 0) {\n      name = technicalIndicator.name;\n    }\n\n    if (calcParams.length > 0) {\n      calcParamText = \"(\".concat(calcParams.join(','), \")\");\n    }\n\n    plots.forEach(function (plot) {\n      var data = {};\n\n      if (isValid(plot.title)) {\n        var value = technicalIndicatorData[plot.key];\n\n        if (isValid(value)) {\n          value = formatPrecision(value, precision);\n\n          if (shouldFormatBigNumber) {\n            value = formatBigNumber(value);\n          }\n        }\n\n        data.title = plot.title;\n        data.value = value;\n      }\n\n      values.push(data);\n    });\n    return {\n      values: values,\n      name: name,\n      calcParamText: calcParamText\n    };\n  }\n  /**\n   * 覆盖物\n   */\n\n\n  var Overlay = /*#__PURE__*/function () {\n    function Overlay(_ref) {\n      var id = _ref.id,\n          chartData = _ref.chartData,\n          xAxis = _ref.xAxis,\n          yAxis = _ref.yAxis;\n\n      _classCallCheck(this, Overlay);\n\n      this._id = id;\n      this._chartData = chartData;\n      this._xAxis = xAxis;\n      this._yAxis = yAxis;\n      this._styles = null;\n    }\n    /**\n     * 绘制\n     * @param ctx\n     */\n\n\n    _createClass(Overlay, [{\n      key: \"draw\",\n      value: function draw(ctx) {}\n      /**\n       * 设置样式\n       * @param styles\n       * @param defaultStyles\n       */\n\n    }, {\n      key: \"setStyles\",\n      value: function setStyles(styles, defaultStyles) {\n        if (!isObject(styles)) {\n          return false;\n        }\n\n        if (!this._styles) {\n          this._styles = clone(defaultStyles);\n        }\n\n        merge(this._styles, styles);\n        return true;\n      }\n      /**\n       * 获取id\n       * @return {*}\n       */\n\n    }, {\n      key: \"id\",\n      value: function id() {\n        return this._id;\n      }\n      /**\n       * 获取样式\n       * @return {null}\n       */\n\n    }, {\n      key: \"styles\",\n      value: function styles() {\n        return this._styles;\n      }\n      /**\n       * 检查鼠标点是否在图形上\n       * @param point\n       */\n\n    }, {\n      key: \"checkMousePointOnGraphic\",\n      value: function checkMousePointOnGraphic(point) {} // -------------------- 事件开始 -------------------\n\n      /**\n       * 点击事件\n       * @param id\n       * @param points\n       * @param event\n       */\n\n    }, {\n      key: \"onClick\",\n      value: function onClick(_ref2) {\n        _ref2.id;\n        _ref2.points;\n        _ref2.event;\n      }\n      /**\n       * 右击事件\n       * @param id\n       * @param points\n       * @param event\n       */\n\n    }, {\n      key: \"onRightClick\",\n      value: function onRightClick(_ref3) {\n        _ref3.id;\n        _ref3.points;\n        _ref3.event;\n      }\n      /**\n       * 鼠标进入事件\n       * @param id\n       * @param points\n       * @param event\n       */\n\n    }, {\n      key: \"onMouseEnter\",\n      value: function onMouseEnter(_ref4) {\n        _ref4.id;\n        _ref4.points;\n        _ref4.event;\n      }\n      /**\n       * 鼠标离开事件\n       * @param id\n       * @param points\n       * @param event\n       */\n\n    }, {\n      key: \"onMouseLeave\",\n      value: function onMouseLeave(_ref5) {\n        _ref5.id;\n        _ref5.points;\n        _ref5.event;\n      } // -------------------- 事件结束 -------------------\n\n    }]);\n\n    return Overlay;\n  }();\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 绘制实心圆\n   * @param ctx\n   * @param fillColor\n   * @param circlePoint\n   * @param radius\n   */\n\n\n  function renderFillCircle(ctx, fillColor, circlePoint, radius) {\n    ctx.fillStyle = fillColor;\n    ctx.beginPath();\n    ctx.arc(circlePoint.x, circlePoint.y, radius, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n\n  var DEVIATION = 2;\n  /**\n   * 根据三角形三个点获取三角形面积\n   * @param point1\n   * @param point2\n   * @param point3\n   * @return {number}\n   */\n\n  function getTriangleSquare(point1, point2, point3) {\n    var x1 = Math.abs(point2.x - point1.x);\n    var y1 = Math.abs(point2.y - point1.y);\n    var x2 = Math.abs(point3.x - point1.x);\n    var y2 = Math.abs(point3.y - point1.y);\n    return Math.abs(x1 * y2 - x2 * y1) / 2;\n  }\n  /**\n   * 获取一次函数斜率和截距，即 y = kx + b 中的k值和b值\n   * @param point1\n   * @param point2\n   */\n\n\n  function getLinearSlopeIntercept(point1, point2) {\n    var difX = point1.x - point2.x;\n\n    if (difX !== 0) {\n      var k = (point1.y - point2.y) / difX;\n      var b = point1.y - k * point1.x;\n      return {\n        k: k,\n        b: b\n      };\n    }\n  }\n  /**\n   * 获取点在两点决定的一次函数上的y值\n   * @param point1\n   * @param point2\n   * @param targetPoint\n   */\n\n\n  function getLinearYFromPoints(point1, point2, targetPoint) {\n    var kb = getLinearSlopeIntercept(point1, point2);\n    return getLinearYFromSlopeIntercept(kb, targetPoint);\n  }\n  /**\n   * 获取点在斜率和截距确定的线上的y值\n   * @param kb\n   * @param targetPoint\n   */\n\n\n  function getLinearYFromSlopeIntercept(kb, targetPoint) {\n    if (kb) {\n      return targetPoint.x * kb.k + kb.b;\n    }\n\n    return targetPoint.y;\n  }\n  /**\n   * 点是否在线上\n   * @param point1\n   * @param point2\n   * @param targetPoint\n   */\n\n\n  function checkPointOnStraightLine(point1, point2, targetPoint) {\n    if (!targetPoint || !point1 || !point2) {\n      return false;\n    }\n\n    if (point1.x === point2.x) {\n      return Math.abs(targetPoint.x - point1.x) < DEVIATION;\n    }\n\n    var kb = getLinearSlopeIntercept(point1, point2);\n    var y = getLinearYFromSlopeIntercept(kb, targetPoint);\n    var yDif = Math.abs(y - targetPoint.y);\n    return yDif * yDif / (kb.k * kb.k + 1) < DEVIATION * DEVIATION;\n  }\n  /**\n   * 点是否在线段上\n   * @param point1\n   * @param point2\n   * @param targetPoint\n   * @returns {boolean}\n   */\n\n\n  function checkPointOnRayLine(point1, point2, targetPoint) {\n    if (checkPointOnStraightLine(point1, point2, targetPoint)) {\n      if (point1.x === point2.x) {\n        if (point1.y < point2.y) {\n          return point1.y - targetPoint.y < DEVIATION;\n        } else {\n          return targetPoint.y - point1.y < DEVIATION;\n        }\n      }\n\n      if (point1.x < point2.x) {\n        return point1.x - targetPoint.x < DEVIATION;\n      } else {\n        return targetPoint.x - point1.x < DEVIATION;\n      }\n    }\n\n    return false;\n  }\n  /**\n   * 判断点是否在线段上面\n   * @param point1\n   * @param point2\n   * @param targetPoint\n   */\n\n\n  function checkPointOnSegment(point1, point2, targetPoint) {\n    if (checkPointOnStraightLine(point1, point2, targetPoint)) {\n      if (point1.x === point2.x) {\n        return Math.abs(point1.y - targetPoint.y) + Math.abs(point2.y - targetPoint.y) - Math.abs(point1.y - point2.y) < DEVIATION * 2;\n      }\n\n      return Math.abs(point1.x - targetPoint.x) + Math.abs(point2.x - targetPoint.x) - Math.abs(point1.x - point2.x) < DEVIATION * 2;\n    }\n\n    return false;\n  }\n  /**\n   * 点是否在圆内\n   * @param circleCenterPoint\n   * @param radius\n   * @param targetPoint\n   * @returns {boolean}\n   */\n\n\n  function checkPointInCircle(circleCenterPoint, radius, targetPoint) {\n    if (!targetPoint) {\n      return false;\n    }\n\n    var difX = targetPoint.x - circleCenterPoint.x;\n    var difY = targetPoint.y - circleCenterPoint.y;\n    return !(difX * difX + difY * difY > radius * radius);\n  }\n  /**\n   * 检查点是否在三角形内部\n   * @param trianglePoints\n   * @param targetPoint\n   * @return {boolean}\n   */\n\n\n  function checkPointInTriangle(trianglePoints, targetPoint) {\n    var square = getTriangleSquare(trianglePoints[0], trianglePoints[1], trianglePoints[2]);\n    var compareSquare = getTriangleSquare(trianglePoints[0], trianglePoints[1], targetPoint) + getTriangleSquare(trianglePoints[0], trianglePoints[2], targetPoint) + getTriangleSquare(trianglePoints[1], trianglePoints[2], targetPoint);\n    return Math.abs(square - compareSquare) < DEVIATION;\n  }\n  /**\n   * 检查点是否在三角形菱形内部\n   * @param centerPoint\n   * @param width\n   * @param height\n   * @param targetPoint\n   * @return {boolean}\n   */\n\n\n  function checkPointInDiamond(centerPoint, width, height, targetPoint) {\n    var xDis = Math.abs(centerPoint.x - targetPoint.x);\n    var yDis = Math.abs(centerPoint.y - targetPoint.y);\n    return xDis * height + yDis * width < width * height / 2 + DEVIATION;\n  }\n  /**\n   * 检查点是否在矩形内部\n   * @param point1\n   * @param point2\n   * @param targetPoint\n   * @return {boolean}\n   */\n\n\n  function checkPointInRect(point1, point2, targetPoint) {\n    return targetPoint.x >= point1.x && targetPoint.x <= point2.x && targetPoint.y >= point1.y && targetPoint.y <= point2.y;\n  }\n  /**\n   * 根据两点获取一条射线\n   * @param point1\n   * @param point2\n   * @param xyMax\n   * @return {(*|{x: *, y: *})[]|*[]}\n   */\n\n\n  function getRayLine(point1, point2, xyMax) {\n    if (point1 && point2) {\n      var point;\n\n      if (point1.x === point2.x && point1.y !== point2.y) {\n        if (point1.y < point2.y) {\n          point = {\n            x: point1.x,\n            y: xyMax.y\n          };\n        } else {\n          point = {\n            x: point1.x,\n            y: 0\n          };\n        }\n      } else if (point1.x > point2.x) {\n        point = {\n          x: 0,\n          y: getLinearYFromPoints(point1, point2, {\n            x: 0,\n            y: point1.y\n          })\n        };\n      } else {\n        point = {\n          x: xyMax.x,\n          y: getLinearYFromPoints(point1, point2, {\n            x: xyMax.x,\n            y: point1.y\n          })\n        };\n      }\n\n      return [point1, point];\n    }\n\n    return [];\n  }\n  /**\n   * 获取平行线\n   * @param points\n   * @param xyMax\n   * @param extendParallelLineCount\n   * @returns {Array}\n   */\n\n\n  function getParallelLines(points, xyMax) {\n    var extendParallelLineCount = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var lines = [];\n\n    if (points.length > 1) {\n      if (points[0].x === points[1].x) {\n        var startY = 0;\n        var endY = xyMax.y;\n        lines.push([{\n          x: points[0].x,\n          y: startY\n        }, {\n          x: points[0].x,\n          y: endY\n        }]);\n\n        if (points.length > 2) {\n          lines.push([{\n            x: points[2].x,\n            y: startY\n          }, {\n            x: points[2].x,\n            y: endY\n          }]);\n          var distance = points[0].x - points[2].x;\n\n          for (var i = 0; i < extendParallelLineCount; i++) {\n            var d = distance * (i + 1);\n            lines.push([{\n              x: points[0].x + d,\n              y: startY\n            }, {\n              x: points[0].x + d,\n              y: endY\n            }]);\n          }\n        }\n      } else {\n        var startX = 0;\n        var endX = xyMax.x;\n        var kb = getLinearSlopeIntercept(points[0], points[1]);\n        var k = kb.k;\n        var b = kb.b;\n        lines.push([{\n          x: startX,\n          y: startX * k + b\n        }, {\n          x: endX,\n          y: endX * k + b\n        }]);\n\n        if (points.length > 2) {\n          var b1 = points[2].y - k * points[2].x;\n          lines.push([{\n            x: startX,\n            y: startX * k + b1\n          }, {\n            x: endX,\n            y: endX * k + b1\n          }]);\n\n          var _distance = b - b1;\n\n          for (var _i = 0; _i < extendParallelLineCount; _i++) {\n            var b2 = b + _distance * (_i + 1);\n            lines.push([{\n              x: startX,\n              y: startX * k + b2\n            }, {\n              x: endX,\n              y: endX * k + b2\n            }]);\n          }\n        }\n      }\n    }\n\n    return lines;\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 绘制水平直线\n   * @param ctx\n   * @param y\n   * @param left\n   * @param right\n   */\n\n\n  function renderHorizontalLine(ctx, y, left, right) {\n    ctx.beginPath();\n    var correction = ctx.lineWidth % 2 ? 0.5 : 0;\n    ctx.moveTo(left, y + correction);\n    ctx.lineTo(right, y + correction);\n    ctx.stroke();\n    ctx.closePath();\n  }\n  /**\n   * 绘制垂直直线\n   * @param ctx\n   * @param x\n   * @param top\n   * @param bottom\n   */\n\n\n  function renderVerticalLine(ctx, x, top, bottom) {\n    ctx.beginPath();\n    var correction = ctx.lineWidth % 2 ? 0.5 : 0;\n    ctx.moveTo(x + correction, top);\n    ctx.lineTo(x + correction, bottom);\n    ctx.stroke();\n    ctx.closePath();\n  }\n  /**\n   * 绘制线\n   * @param ctx\n   * @param renderFuc\n   */\n\n\n  function renderLine(ctx, renderFuc) {\n    ctx.save();\n\n    if (ctx.lineWidth % 2) {\n      ctx.translate(0.5, 0.5);\n    }\n\n    renderFuc();\n    ctx.restore();\n  }\n\n  var GRAPHIC_MARK_DRAW_STEP_START = 1; // 标记图形绘制步骤结束\n\n  var GRAPHIC_MARK_DRAW_STEP_FINISHED = -1;\n  /**\n   * 图形标记鼠标操作元素类型\n   * @type {{OTHER: string, POINT: string, NONE: string}}\n   */\n\n  var GraphicMarkMouseOperateElement = {\n    OTHER: 'other',\n    POINT: 'point',\n    NONE: 'none'\n  };\n  /**\n   * 绘制类型\n   * @type {{ARC: string, POLYGON: string, LINE: string, CONTINUOUS_LINE: string, TEXT: string}}\n   */\n\n  var GraphicMarkDrawType = {\n    LINE: 'line',\n    TEXT: 'text',\n    CONTINUOUS_LINE: 'continuous_line',\n    POLYGON: 'polygon',\n    ARC: 'arc'\n  };\n  /**\n   * 绘制风格\n   * @type {{STROKE: string, FILL: string, SOLID: string, DASH: string}}\n   */\n\n  var GraphicMarkDrawStyle = {\n    STROKE: 'stroke',\n    FILL: 'fill',\n    SOLID: 'solid',\n    DASH: 'dash'\n  };\n  /**\n   * 线类型\n   * @type {{VERTICAL: number, COMMON: number, HORIZONTAL: number}}\n   */\n\n  var LineType = {\n    COMMON: 0,\n    HORIZONTAL: 1,\n    VERTICAL: 2\n  };\n  /**\n   * 获取绘制线类型\n   * @param point1\n   * @param point2\n   * @private\n   */\n\n  function getLineType(point1, point2) {\n    if (point1.x === point2.x) {\n      return LineType.VERTICAL;\n    }\n\n    if (point1.y === point2.y) {\n      return LineType.HORIZONTAL;\n    }\n\n    return LineType.COMMON;\n  }\n  /**\n   * 标记图形\n   */\n\n\n  var GraphicMark = /*#__PURE__*/function (_Overlay) {\n    _inherits(GraphicMark, _Overlay);\n\n    var _super = _createSuper(GraphicMark);\n\n    function GraphicMark(_ref) {\n      var _this;\n\n      var id = _ref.id,\n          name = _ref.name,\n          totalStep = _ref.totalStep,\n          chartData = _ref.chartData,\n          xAxis = _ref.xAxis,\n          yAxis = _ref.yAxis,\n          points = _ref.points,\n          styles = _ref.styles,\n          lock = _ref.lock;\n\n      _classCallCheck(this, GraphicMark);\n\n      _this = _super.call(this, {\n        id: id,\n        chartData: chartData,\n        xAxis: xAxis,\n        yAxis: yAxis\n      });\n      _this._name = name;\n      _this._totalStep = totalStep;\n      _this._lock = lock;\n      _this._drawStep = GRAPHIC_MARK_DRAW_STEP_START;\n      _this._points = [];\n\n      _this.setPoints(points);\n\n      _this.setStyles(styles, chartData.styleOptions().graphicMark);\n\n      return _this;\n    }\n    /**\n     * 加载点\n     * @param points\n     */\n\n\n    _createClass(GraphicMark, [{\n      key: \"setPoints\",\n      value: function setPoints(points) {\n        if (isArray(points) && points.length > 0) {\n          var repeatTotalStep;\n\n          if (points.length >= this._totalStep - 1) {\n            this._drawStep = GRAPHIC_MARK_DRAW_STEP_FINISHED;\n            this._points = points.slice(0, this._totalStep - 1);\n            repeatTotalStep = this._totalStep - 1;\n          } else {\n            this._drawStep = points.length + 1;\n            this._points = clone(points);\n            repeatTotalStep = points.length;\n          } // 重新演练绘制一遍，防止因为点不对而绘制出错误的图形\n\n\n          for (var i = 0; i < repeatTotalStep; i++) {\n            this.performMouseMoveForDrawing(i + 2, this.points, this._points[i], this._xAxis, this._yAxis);\n          }\n\n          if (this._drawStep === GRAPHIC_MARK_DRAW_STEP_FINISHED) {\n            this.performMousePressedMove(this._points, this._points.length - 1, this._points[this._points.length - 1], this._xAxis, this._yAxis);\n          }\n        }\n      }\n      /**\n       * 时间戳转换成x轴上点的位置\n       * @param point\n       * @return {*|number}\n       * @private\n       */\n\n    }, {\n      key: \"_timestampOrDataIndexToPointX\",\n      value: function _timestampOrDataIndexToPointX(_ref2) {\n        var timestamp = _ref2.timestamp,\n            dataIndex = _ref2.dataIndex;\n        return timestamp ? this._xAxis.convertToPixel(this._chartData.timestampToDataIndex(timestamp)) : this._xAxis.convertToPixel(dataIndex);\n      }\n      /**\n       * 绘制线\n       * @param ctx\n       * @param lines\n       * @param style\n       * @param markOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawLines\",\n      value: function _drawLines(ctx, lines, style, markOptions) {\n        ctx.save();\n        ctx.strokeStyle = markOptions.line.color;\n        ctx.lineWidth = markOptions.line.size;\n\n        if (style === GraphicMarkDrawStyle.DASH) {\n          ctx.setLineDash(markOptions.line.dashValue);\n        }\n\n        lines.forEach(function (points) {\n          if (points.length > 1) {\n            var lineType = getLineType(points[0], points[1]);\n\n            switch (lineType) {\n              case LineType.COMMON:\n                {\n                  renderLine(ctx, function () {\n                    ctx.beginPath();\n                    ctx.moveTo(points[0].x, points[0].y);\n                    ctx.lineTo(points[1].x, points[1].y);\n                    ctx.stroke();\n                    ctx.closePath();\n                  });\n                  break;\n                }\n\n              case LineType.HORIZONTAL:\n                {\n                  renderHorizontalLine(ctx, points[0].y, points[0].x, points[1].x);\n                  break;\n                }\n\n              case LineType.VERTICAL:\n                {\n                  renderVerticalLine(ctx, points[0].x, points[0].y, points[1].y);\n                  break;\n                }\n            }\n          }\n        });\n        ctx.restore();\n      }\n      /**\n       * 绘制连续线\n       * @param ctx\n       * @param continuousLines\n       * @param style\n       * @param markOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawContinuousLines\",\n      value: function _drawContinuousLines(ctx, continuousLines, style, markOptions) {\n        ctx.save();\n        ctx.strokeStyle = markOptions.line.color;\n        ctx.lineWidth = markOptions.line.size;\n\n        if (style === GraphicMarkDrawStyle.DASH) {\n          ctx.setLineDash(markOptions.line.dashValue);\n        }\n\n        continuousLines.forEach(function (points) {\n          if (points.length > 0) {\n            renderLine(ctx, function () {\n              ctx.beginPath();\n              ctx.moveTo(points[0].x, points[0].y);\n\n              for (var i = 1; i < points.length; i++) {\n                ctx.lineTo(points[i].x, points[i].y);\n              }\n\n              ctx.stroke();\n              ctx.closePath();\n            });\n          }\n        });\n        ctx.restore();\n      }\n      /**\n       * 绘制多边形\n       * @param ctx\n       * @param polygons\n       * @param style\n       * @param markOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawPolygons\",\n      value: function _drawPolygons(ctx, polygons, style, markOptions) {\n        ctx.save();\n        var fillStroke;\n\n        if (style === GraphicMarkDrawStyle.FILL) {\n          ctx.fillStyle = markOptions.polygon.fill.color;\n          fillStroke = ctx.fill;\n        } else {\n          ctx.lineWidth = markOptions.polygon.stroke.size;\n          ctx.strokeStyle = markOptions.polygon.stroke.color;\n          fillStroke = ctx.stroke;\n        }\n\n        polygons.forEach(function (points) {\n          if (points.length > 0) {\n            renderLine(ctx, function () {\n              ctx.beginPath();\n              ctx.moveTo(points[0].x, points[0].y);\n\n              for (var i = 1; i < points.length; i++) {\n                ctx.lineTo(points[i].x, points[i].y);\n              }\n\n              ctx.closePath();\n              fillStroke.call(ctx);\n            });\n          }\n        });\n        ctx.restore();\n      }\n      /**\n       * 画圆弧\n       * @param ctx\n       * @param arcs\n       * @param style\n       * @param markOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawArcs\",\n      value: function _drawArcs(ctx, arcs, style, markOptions) {\n        ctx.save();\n\n        if (style === GraphicMarkDrawStyle.FILL) {\n          ctx.fillStyle = markOptions.arc.fill.color;\n        } else {\n          ctx.lineWidth = markOptions.arc.stroke.size;\n          ctx.strokeStyle = markOptions.arc.stroke.color;\n        }\n\n        arcs.forEach(function (_ref3) {\n          var x = _ref3.x,\n              y = _ref3.y,\n              radius = _ref3.radius,\n              startAngle = _ref3.startAngle,\n              endAngle = _ref3.endAngle;\n          ctx.beginPath();\n          ctx.arc(x, y, radius, startAngle, endAngle);\n\n          if (style === GraphicMarkDrawStyle.FILL) {\n            ctx.closePath();\n            ctx.fill();\n          } else {\n            ctx.stroke();\n            ctx.closePath();\n          }\n        });\n        ctx.restore();\n      }\n      /**\n       * 绘制文字\n       * @param ctx\n       * @param texts\n       * @param style\n       * @param markOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawText\",\n      value: function _drawText(ctx, texts, style, markOptions) {\n        ctx.save();\n        var fillStroke;\n\n        if (style === GraphicMarkDrawStyle.STROKE) {\n          ctx.strokeStyle = markOptions.text.color;\n          fillStroke = ctx.strokeText;\n        } else {\n          ctx.fillStyle = markOptions.text.color;\n          fillStroke = ctx.fillText;\n        }\n\n        ctx.font = \"\".concat(markOptions.text.weight, \" \").concat(markOptions.text.size, \"px \").concat(markOptions.text.family);\n        texts.forEach(function (_ref4) {\n          var x = _ref4.x,\n              y = _ref4.y,\n              text = _ref4.text;\n          fillStroke.call(ctx, text, x + markOptions.text.marginLeft, y - markOptions.text.marginBottom);\n        });\n        ctx.restore();\n      }\n      /**\n       * 绘制\n       * @param ctx\n       */\n\n    }, {\n      key: \"draw\",\n      value: function draw(ctx) {\n        var _this2 = this;\n\n        var coordinates = this._points.map(function (_ref5) {\n          var timestamp = _ref5.timestamp,\n              price = _ref5.price,\n              dataIndex = _ref5.dataIndex;\n          return {\n            x: _this2._timestampOrDataIndexToPointX({\n              timestamp: timestamp,\n              dataIndex: dataIndex\n            }),\n            y: _this2._yAxis.convertToPixel(price)\n          };\n        });\n\n        var markOptions = this._styles || this._chartData.styleOptions().graphicMark;\n\n        if (this._drawStep !== GRAPHIC_MARK_DRAW_STEP_START && coordinates.length > 0) {\n          var viewport = {\n            width: this._xAxis.width(),\n            height: this._yAxis.height()\n          };\n          var precision = {\n            price: this._chartData.pricePrecision(),\n            volume: this._chartData.volumePrecision()\n          };\n          var graphicDataSources = this.createGraphicDataSource(this._drawStep, this._points, coordinates, viewport, precision, this._xAxis, this._yAxis) || [];\n          graphicDataSources.forEach(function (_ref6) {\n            var type = _ref6.type,\n                isDraw = _ref6.isDraw,\n                style = _ref6.style,\n                _ref6$dataSource = _ref6.dataSource,\n                dataSource = _ref6$dataSource === void 0 ? [] : _ref6$dataSource;\n\n            if (!isValid(isDraw) || isDraw) {\n              switch (type) {\n                case GraphicMarkDrawType.LINE:\n                  {\n                    _this2._drawLines(ctx, dataSource, style, markOptions);\n\n                    break;\n                  }\n\n                case GraphicMarkDrawType.CONTINUOUS_LINE:\n                  {\n                    _this2._drawContinuousLines(ctx, dataSource, style, markOptions);\n\n                    break;\n                  }\n\n                case GraphicMarkDrawType.POLYGON:\n                  {\n                    _this2._drawPolygons(ctx, dataSource, style, markOptions);\n\n                    break;\n                  }\n\n                case GraphicMarkDrawType.ARC:\n                  {\n                    _this2._drawArcs(ctx, dataSource, style, markOptions);\n\n                    break;\n                  }\n\n                case GraphicMarkDrawType.TEXT:\n                  {\n                    _this2._drawText(ctx, dataSource, style, markOptions);\n\n                    break;\n                  }\n              }\n            }\n          });\n\n          if (this.drawExtend) {\n            ctx.save();\n            this.drawExtend(ctx, graphicDataSources, markOptions, viewport, precision, this._xAxis, this._yAxis);\n            ctx.restore();\n          }\n        }\n\n        var graphicMarkMouseOperate = this._chartData.graphicMarkMouseOperate();\n\n        if (graphicMarkMouseOperate.hover.id === this._id && graphicMarkMouseOperate.hover.element !== GraphicMarkMouseOperateElement.NONE || graphicMarkMouseOperate.click.id === this._id && graphicMarkMouseOperate.click.element !== GraphicMarkMouseOperateElement.NONE) {\n          coordinates.forEach(function (_ref7, index) {\n            var x = _ref7.x,\n                y = _ref7.y;\n            var radius = markOptions.point.radius;\n            var color = markOptions.point.backgroundColor;\n            var borderColor = markOptions.point.borderColor;\n            var borderSize = markOptions.point.borderSize;\n\n            if (graphicMarkMouseOperate.hover.id === _this2._id && graphicMarkMouseOperate.hover.element === GraphicMarkMouseOperateElement.POINT && index === graphicMarkMouseOperate.hover.elementIndex) {\n              radius = markOptions.point.activeRadius;\n              color = markOptions.point.activeBackgroundColor;\n              borderColor = markOptions.point.activeBorderColor;\n              borderSize = markOptions.point.activeBorderSize;\n            }\n\n            renderFillCircle(ctx, borderColor, {\n              x: x,\n              y: y\n            }, radius + borderSize);\n            renderFillCircle(ctx, color, {\n              x: x,\n              y: y\n            }, radius);\n          });\n        }\n      }\n      /**\n       * 设置是否锁定\n       * @param lock\n       */\n\n    }, {\n      key: \"setLock\",\n      value: function setLock(lock) {\n        this._lock = lock;\n      }\n      /**\n       * 获取名字\n       * @return {*}\n       */\n\n    }, {\n      key: \"name\",\n      value: function name() {\n        return this._name;\n      }\n      /**\n       * 是否锁定\n       * @return {*}\n       */\n\n    }, {\n      key: \"lock\",\n      value: function lock() {\n        return this._lock;\n      }\n      /**\n       * 总步骤数\n       * @return {*}\n       */\n\n    }, {\n      key: \"totalStep\",\n      value: function totalStep() {\n        return this._totalStep;\n      }\n      /**\n       * 获取点\n       * @return {[]}\n       */\n\n    }, {\n      key: \"points\",\n      value: function points() {\n        return this._points;\n      }\n      /**\n       * 是否在绘制中\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"isDrawing\",\n      value: function isDrawing() {\n        return this._drawStep !== GRAPHIC_MARK_DRAW_STEP_FINISHED;\n      }\n      /**\n       * 检查鼠标点是否在图形上\n       * @param mouseCoordinate\n       * @return {{id: *, elementIndex: number, element: string}}\n       */\n\n    }, {\n      key: \"checkMousePointOnGraphic\",\n      value: function checkMousePointOnGraphic(mouseCoordinate) {\n        var markOptions = this._styles || this._chartData.styleOptions().graphicMark;\n\n        var coordinates = []; // 检查鼠标点是否在图形的点上\n\n        for (var i = 0; i < this._points.length; i++) {\n          var _this$_points$i = this._points[i],\n              timestamp = _this$_points$i.timestamp,\n              price = _this$_points$i.price,\n              dataIndex = _this$_points$i.dataIndex;\n          var coordinate = {\n            x: this._timestampOrDataIndexToPointX({\n              timestamp: timestamp,\n              dataIndex: dataIndex\n            }),\n            y: this._yAxis.convertToPixel(price)\n          };\n          coordinates.push(coordinate);\n\n          if (checkPointInCircle(coordinate, markOptions.point.radius, mouseCoordinate)) {\n            return {\n              id: this._id,\n              element: GraphicMarkMouseOperateElement.POINT,\n              elementIndex: i,\n              instance: this\n            };\n          }\n        } // 检查鼠标点是否在点构成的其它图形上\n\n\n        var graphicDataSources = this.createGraphicDataSource(this._drawStep, this._points, coordinates, {\n          width: this._xAxis.width(),\n          height: this._yAxis.height()\n        }, {\n          price: this._chartData.pricePrecision(),\n          volume: this._chartData.volumePrecision()\n        }, this._xAxis, this._yAxis) || [];\n\n        var _iterator = _createForOfIteratorHelper(graphicDataSources),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var _step$value = _step.value,\n                key = _step$value.key,\n                type = _step$value.type,\n                isCheck = _step$value.isCheck,\n                _step$value$dataSourc = _step$value.dataSource,\n                dataSource = _step$value$dataSourc === void 0 ? [] : _step$value$dataSourc;\n\n            if (isCheck) {\n              for (var _i = 0; _i < dataSource.length; _i++) {\n                var sources = dataSource[_i];\n\n                if (this.checkMousePointOn(key, type, sources, mouseCoordinate)) {\n                  return {\n                    id: this._id,\n                    element: GraphicMarkMouseOperateElement.OTHER,\n                    elementIndex: _i,\n                    instance: this\n                  };\n                }\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n      /**\n       * 绘制过程中鼠标移动事件\n       * @param point\n       */\n\n    }, {\n      key: \"mouseMoveForDrawing\",\n      value: function mouseMoveForDrawing(point) {\n        var dataIndex = this._xAxis.convertFromPixel(point.x);\n\n        var timestamp = this._chartData.dataIndexToTimestamp(dataIndex);\n\n        var price = this._yAxis.convertFromPixel(point.y);\n\n        this._points[this._drawStep - 1] = {\n          timestamp: timestamp,\n          price: price,\n          dataIndex: dataIndex\n        };\n        this.performMouseMoveForDrawing(this._drawStep, this._points, {\n          timestamp: timestamp,\n          price: price,\n          dataIndex: dataIndex\n        }, this._xAxis, this._yAxis);\n        this.onDrawing({\n          id: this._id,\n          step: this._drawStep,\n          points: this._points\n        });\n      }\n      /**\n       * 鼠标左边按钮点击事件\n       */\n\n    }, {\n      key: \"mouseLeftButtonDownForDrawing\",\n      value: function mouseLeftButtonDownForDrawing() {\n        if (this._drawStep === this._totalStep - 1) {\n          this._drawStep = GRAPHIC_MARK_DRAW_STEP_FINISHED;\n          this.onDrawEnd({\n            id: this._id,\n            points: this._points\n          });\n        } else {\n          this._drawStep++;\n        }\n      }\n      /**\n       * 鼠标按住移动方法\n       * @param point\n       * @param event\n       */\n\n    }, {\n      key: \"mousePressedMove\",\n      value: function mousePressedMove(point, event) {\n        var graphicMarkMouseOperate = this._chartData.graphicMarkMouseOperate();\n\n        var elementIndex = graphicMarkMouseOperate.click.elementIndex;\n\n        if (!this._lock && graphicMarkMouseOperate.click.id === this._id && graphicMarkMouseOperate.click.element === GraphicMarkMouseOperateElement.POINT && elementIndex !== -1) {\n          var dataIndex = this._xAxis.convertFromPixel(point.x);\n\n          var timestamp = this._chartData.dataIndexToTimestamp(dataIndex);\n\n          var price = this._yAxis.convertFromPixel(point.y);\n\n          this._points[elementIndex].timestamp = timestamp;\n          this._points[elementIndex].dataIndex = dataIndex;\n          this._points[elementIndex].price = price;\n          this.performMousePressedMove(this._points, elementIndex, {\n            dataIndex: dataIndex,\n            timestamp: timestamp,\n            price: price\n          }, this._xAxis, this._yAxis);\n          this.onPressedMove({\n            id: graphicMarkMouseOperate.click.id,\n            points: this._points,\n            event: event\n          });\n        }\n      } // -------------------- 事件开始 -------------------\n\n      /**\n       * 开始绘制事件回调\n       * @param id\n       */\n\n    }, {\n      key: \"onDrawStart\",\n      value: function onDrawStart(_ref8) {\n        _ref8.id;\n      }\n      /**\n       * 绘制过程中事件回调\n       * @param id\n       * @param step\n       * @param points\n       */\n\n    }, {\n      key: \"onDrawing\",\n      value: function onDrawing(_ref9) {\n        _ref9.id;\n        _ref9.step;\n        _ref9.points;\n      }\n      /**\n       * 绘制结束事件回调\n       * @param id\n       * @param points\n       */\n\n    }, {\n      key: \"onDrawEnd\",\n      value: function onDrawEnd(_ref10) {\n        _ref10.id;\n        _ref10.points;\n      }\n      /**\n       * 按住移动事件\n       * @param id\n       * @param points\n       * @param event\n       */\n\n    }, {\n      key: \"onPressedMove\",\n      value: function onPressedMove(_ref11) {\n        _ref11.id;\n        _ref11.points;\n        _ref11.event;\n      }\n      /**\n       * 移除事件回调\n       * @param id\n       */\n\n    }, {\n      key: \"onRemove\",\n      value: function onRemove(_ref12) {\n        _ref12.id;\n      } // -------------------- 事件结束 -------------------\n      // --------------------- 自定义时需要实现的一些方法开始 ----------------------\n\n      /**\n       * 检查鼠标点在其它图形上\n       * @param key\n       * @param type\n       * @param points\n       * @param mousePoint\n       */\n\n    }, {\n      key: \"checkMousePointOn\",\n      value: function checkMousePointOn(key, type, points, mousePoint) {}\n      /**\n       * 创建图形配置\n       * @param step\n       * @param points\n       * @param coordinates\n       * @param viewport\n       * @param precision\n       * @param xAxis\n       * @param yAxis\n       */\n\n    }, {\n      key: \"createGraphicDataSource\",\n      value: function createGraphicDataSource(step, points, coordinates, viewport, precision, xAxis, yAxis) {}\n      /**\n       * 处理绘制过程中鼠标移动\n       * @param step\n       * @param points\n       * @param point\n       * @param xAxis\n       * @param yAxis\n       */\n\n    }, {\n      key: \"performMouseMoveForDrawing\",\n      value: function performMouseMoveForDrawing(step, points, point, xAxis, yAxis) {}\n      /**\n       * 处理鼠标按住移动\n       * @param points\n       * @param pressedPointIndex\n       * @param point\n       * @param xAxis\n       * @param yAxis\n       */\n\n    }, {\n      key: \"performMousePressedMove\",\n      value: function performMousePressedMove(points, pressedPointIndex, point, xAxis, yAxis) {} // --------------------- 自定义时需要实现的一些方法结束 ----------------------\n\n    }]);\n\n    return GraphicMark;\n  }(Overlay);\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n\n  var Delegate = /*#__PURE__*/function () {\n    function Delegate() {\n      _classCallCheck(this, Delegate);\n\n      this._observers = [];\n    }\n\n    _createClass(Delegate, [{\n      key: \"subscribe\",\n      value: function subscribe(observer) {\n        if (this._observers.indexOf(observer) < 0) {\n          this._observers.push(observer);\n        }\n      }\n    }, {\n      key: \"unsubscribe\",\n      value: function unsubscribe(observer) {\n        var index = this._observers.indexOf(observer);\n\n        if (index > -1) {\n          this._observers.splice(index, 1);\n        } else {\n          this._observers = [];\n        }\n      }\n    }, {\n      key: \"execute\",\n      value: function execute(data) {\n        this._observers.forEach(function (observer) {\n          observer(data);\n        });\n      }\n    }, {\n      key: \"hasObservers\",\n      value: function hasObservers() {\n        return this._observers.length > 0;\n      }\n    }]);\n\n    return Delegate;\n  }();\n  /**\n   * 创建图形标记映射\n   * @return {{}}\n   */\n\n\n  function createGraphicMarkMapping() {\n    var mapping = {};\n    var graphicMarkExtensions = extension.graphicMarkExtensions;\n\n    for (var name in graphicMarkExtensions) {\n      var graphicMarkClass = createGraphicMarkClass(graphicMarkExtensions[name]);\n\n      if (graphicMarkClass) {\n        mapping[name] = graphicMarkClass;\n      }\n    }\n\n    return mapping;\n  }\n  /**\n   * 创建图形标记类\n   * @param name\n   * @param series\n   * @param checkMousePointOn\n   * @param createGraphicDataSource\n   * @param performMousePressedMove\n   * @param performMouseMoveForDrawing\n   * @param drawExtend\n   * @return {Mark|null}\n   */\n\n\n  function createGraphicMarkClass(_ref) {\n    var name = _ref.name,\n        totalStep = _ref.totalStep,\n        checkMousePointOn = _ref.checkMousePointOn,\n        createGraphicDataSource = _ref.createGraphicDataSource,\n        performMousePressedMove = _ref.performMousePressedMove,\n        performMouseMoveForDrawing = _ref.performMouseMoveForDrawing,\n        drawExtend = _ref.drawExtend;\n\n    if (!name || !isNumber(totalStep) || !isFunction(checkMousePointOn) || !isFunction(createGraphicDataSource)) {\n      logWarn('', '', 'Required attribute \"name\" and \"totalStep\", method \"checkMousePointOn\" and \"createGraphicDataSource\", new graphic mark cannot be generated!!!');\n      return null;\n    }\n\n    var Mark = /*#__PURE__*/function (_GraphicMark) {\n      _inherits(Mark, _GraphicMark);\n\n      var _super = _createSuper(Mark);\n\n      function Mark(_ref2) {\n        var id = _ref2.id,\n            chartData = _ref2.chartData,\n            xAxis = _ref2.xAxis,\n            yAxis = _ref2.yAxis,\n            points = _ref2.points,\n            styles = _ref2.styles,\n            lock = _ref2.lock;\n\n        _classCallCheck(this, Mark);\n\n        return _super.call(this, {\n          id: id,\n          name: name,\n          totalStep: totalStep,\n          chartData: chartData,\n          xAxis: xAxis,\n          yAxis: yAxis,\n          points: points,\n          styles: styles,\n          lock: lock\n        });\n      }\n\n      return Mark;\n    }(GraphicMark);\n\n    Mark.prototype.checkMousePointOn = checkMousePointOn;\n    Mark.prototype.createGraphicDataSource = createGraphicDataSource;\n\n    if (isFunction(performMousePressedMove)) {\n      Mark.prototype.performMousePressedMove = performMousePressedMove;\n    }\n\n    if (isFunction(performMouseMoveForDrawing)) {\n      Mark.prototype.performMouseMoveForDrawing = performMouseMoveForDrawing;\n    }\n\n    if (isFunction(drawExtend)) {\n      Mark.prototype.drawExtend = drawExtend;\n    }\n\n    return Mark;\n  }\n  /**\n   * 获取图形标记信息\n   * @param graphicMark\n   * @return {{name, lock: *, styles, id, points: (*|*[])}}\n   */\n\n\n  function getGraphicMarkInfo(graphicMark) {\n    return {\n      name: graphicMark.name(),\n      id: graphicMark.id(),\n      totalStep: graphicMark.totalStep(),\n      lock: graphicMark.lock(),\n      points: graphicMark.tpPoints(),\n      styles: graphicMark.styles()\n    };\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n  // 默认技术指标窗口高度\n\n\n  var DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT = 100; // 技术指标窗口id前缀\n\n  var TECHNICAL_INDICATOR_PANE_ID_PREFIX = 'technical_indicator_pane_'; // 图形标记id前缀\n\n  var GRAPHIC_MARK_ID_PREFIX = 'graphic_mark_'; // 蜡烛图窗口id\n\n  var CANDLE_PANE_ID = 'candle_pane'; // 最小单条数据宽度\n\n  var MIN_DATA_SPACE = 1; // 最大单条数据宽度\n\n  var MAX_DATA_SPACE = 50;\n  /**\n   * 刷新层级\n   * @type {{OVERLAY: number, MAIN: number, NONE: number, FULL: number}}\n   */\n\n  var InvalidateLevel = {\n    NONE: 0,\n    OVERLAY: 1,\n    MAIN: 2,\n    FULL: 3\n  };\n  /**\n   * 图表动作\n   * @type {{DRAW_CANDLE: string, SCROLL: string, PANE_DRAG: string, ZOOM: string, CROSSHAIR: string, DRAW_TECHNICAL_INDICATOR: string}}\n   */\n\n  var ActionType = {\n    DRAW_CANDLE: 'drawCandle',\n    DRAW_TECHNICAL_INDICATOR: 'drawTechnicalIndicator',\n    ZOOM: 'zoom',\n    SCROLL: 'scroll',\n    CROSSHAIR: 'crosshair',\n    PANE_DRAG: 'pane_drag'\n  };\n\n  var ChartData = /*#__PURE__*/function () {\n    function ChartData(styleOptions, handler) {\n      _classCallCheck(this, ChartData); // 持有者\n\n\n      this._handler = handler; // 样式配置\n\n      this._styleOptions = clone(defaultStyleOptions);\n      merge(this._styleOptions, styleOptions); // 所有技术指标映射\n\n      this._technicalIndicatorMapping = createTechnicalIndicatorMapping(); // 是否可以缩放\n\n      this._zoomEnabled = true; // 是否可以拖拽滑动\n\n      this._scrollEnabled = true; // 价格精度\n\n      this._pricePrecision = 2; // 数量精度\n\n      this._volumePrecision = 0;\n      this._dateTimeFormat = new Intl.DateTimeFormat('en', {\n        hour12: false,\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      }); // 数据源\n\n      this._dataList = []; // 可见的数据(需要绘制的数据)\n\n      this._visibleDataList = []; // 是否在加载中\n\n      this._loading = true; // 加载更多回调\n\n      this._loadMoreCallback = null; // 还有更多\n\n      this._more = true; // 可见区域数据占用的空间\n\n      this._totalDataSpace = 0; // 每一条数据的空间\n\n      this._dataSpace = 6; // bar的空间\n\n      this._barSpace = this._calcBarSpace(); // 向右偏移的空间\n\n      this._offsetRightSpace = 50; // 向右偏移的数量\n\n      this._offsetRightBarCount = this._offsetRightSpace / this._dataSpace; // 左边最小可见bar的个数\n\n      this._leftMinVisibleBarCount = 2; // 右边最小可见bar的个数\n\n      this._rightMinVisibleBarCount = 2; // 开始绘制的索引\n\n      this._from = 0; // 结束的索引\n\n      this._to = 0; // 十字光标信息\n\n      this._crosshair = {}; // 用来记录开始拖拽时向右偏移的数量\n\n      this._preOffsetRightBarCount = 0; // 拖拽标记图形标记\n\n      this._dragGraphicMarkFlag = false; // 图形标记映射\n\n      this._graphicMarkMapping = createGraphicMarkMapping(); // 图形标记鼠标操作信息\n\n      this._graphicMarkMouseOperate = {\n        click: {\n          id: '',\n          element: GraphicMarkMouseOperateElement.NONE,\n          elementIndex: -1\n        },\n        hover: {\n          id: '',\n          element: GraphicMarkMouseOperateElement.NONE,\n          elementIndex: -1\n        }\n      }; // 绘图标记数据\n\n      this._graphicMarks = []; // 注解标记\n\n      this._annotations = new Map(); // 可见的注解标记\n\n      this._visibleAnnotations = []; // 注解鼠标操作信息\n\n      this._annotationMouseOperate = {\n        id: ''\n      }; // 标签\n\n      this._tags = new Map(); // 调整pane标记\n\n      this._dragPaneFlag = false; // 事件代理\n\n      this._actionDelegate = new Map();\n    }\n    /**\n     * 计算一条柱子的空间\n     * @returns {number}\n     * @private\n     */\n\n\n    _createClass(ChartData, [{\n      key: \"_calcBarSpace\",\n      value: function _calcBarSpace() {\n        var rateBarSpace = Math.floor(this._dataSpace * 0.8);\n        var floorBarSpace = Math.floor(this._dataSpace);\n        var optimalBarSpace = Math.min(rateBarSpace, floorBarSpace - 1);\n        return Math.max(1, optimalBarSpace);\n      }\n      /**\n       * 调整可见数据\n       * @private\n       */\n\n    }, {\n      key: \"_adjustVisibleDataList\",\n      value: function _adjustVisibleDataList() {\n        // 处理需要绘制的数据\n        var dataSize = this._dataList.length;\n        this._visibleDataList = [];\n        this._visibleAnnotations = [];\n\n        for (var i = this._from; i < this._to; i++) {\n          var kLineData = this._dataList[i];\n          var deltaFromRight = dataSize + this._offsetRightBarCount - i;\n          var x = this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace;\n\n          this._visibleDataList.push({\n            index: i,\n            x: x,\n            data: kLineData\n          });\n\n          var annotation = this._annotations.get(kLineData.timestamp) || [];\n\n          if (annotation.length > 0) {\n            var _iterator = _createForOfIteratorHelper(annotation),\n                _step;\n\n            try {\n              for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                var an = _step.value;\n                an.createSymbolCoordinate(x);\n\n                this._visibleAnnotations.push(an);\n              }\n            } catch (err) {\n              _iterator.e(err);\n            } finally {\n              _iterator.f();\n            }\n          }\n        }\n      }\n      /**\n       * 调整绘制起点终点位置\n       * @private\n       */\n\n    }, {\n      key: \"_adjustFromTo\",\n      value: function _adjustFromTo() {\n        var dataSize = this._dataList.length;\n        var barLength = this._totalDataSpace / this._dataSpace;\n        var maxRightOffsetBarCount = barLength - Math.min(this._leftMinVisibleBarCount, dataSize);\n\n        if (this._offsetRightBarCount > maxRightOffsetBarCount) {\n          this._offsetRightBarCount = maxRightOffsetBarCount;\n        }\n\n        var minRightOffsetBarCount = -dataSize + Math.min(this._rightMinVisibleBarCount, dataSize);\n\n        if (this._offsetRightBarCount < minRightOffsetBarCount) {\n          this._offsetRightBarCount = minRightOffsetBarCount;\n        }\n\n        this._to = Math.round(this._offsetRightBarCount + dataSize + 0.5);\n        this._from = Math.round(this._to - barLength) - 1;\n\n        if (this._to > dataSize) {\n          this._to = dataSize;\n        }\n\n        if (this._from < 0) {\n          this._from = 0;\n        }\n\n        this._adjustVisibleDataList(); // 处理加载更多，有更多并且没有在加载则去加载更多\n\n\n        if (this._from === 0 && this._more && !this._loading && this._loadMoreCallback && isFunction(this._loadMoreCallback)) {\n          this._loading = true;\n\n          this._loadMoreCallback(formatValue(this._dataList[0], 'timestamp'));\n        }\n      }\n      /**\n       * 获取样式配置\n       * @return {{}}\n       */\n\n    }, {\n      key: \"styleOptions\",\n      value: function styleOptions() {\n        return this._styleOptions;\n      }\n      /**\n       * 设置样式配置\n       * @param options\n       */\n\n    }, {\n      key: \"applyStyleOptions\",\n      value: function applyStyleOptions(options) {\n        merge(this._styleOptions, options);\n      }\n      /**\n       * 获取技术指标信息\n       * @param name\n       * @return {{}|{series: *, calcParams: *, precision: *, name: *}}\n       */\n\n    }, {\n      key: \"getTechnicalIndicatorInfo\",\n      value: function getTechnicalIndicatorInfo(name) {\n        if (isValid(name)) {\n          var tech = this.getTechnicalIndicatorInstance(name);\n\n          if (tech) {\n            return createTechnicalIndicatorInfo(tech);\n          }\n        } else {\n          var techs = {};\n\n          for (var _name in this._technicalIndicatorMapping) {\n            var instance = this._technicalIndicatorMapping[_name];\n            techs[_name] = createTechnicalIndicatorInfo(instance);\n          }\n\n          return techs;\n        }\n\n        return {};\n      }\n      /**\n       * 根据指标类型获取指标类\n       * @param name\n       * @return {*}\n       */\n\n    }, {\n      key: \"getTechnicalIndicatorInstance\",\n      value: function getTechnicalIndicatorInstance(name) {\n        return this._technicalIndicatorMapping[name];\n      }\n      /**\n       * 价格精度\n       * @returns {number}\n       */\n\n    }, {\n      key: \"pricePrecision\",\n      value: function pricePrecision() {\n        return this._pricePrecision;\n      }\n      /**\n       * 数量精度\n       * @returns {number}\n       */\n\n    }, {\n      key: \"volumePrecision\",\n      value: function volumePrecision() {\n        return this._volumePrecision;\n      }\n      /**\n       * 获取时间格式化\n       * @returns {Intl.DateTimeFormat | Intl.DateTimeFormat}\n       */\n\n    }, {\n      key: \"dateTimeFormat\",\n      value: function dateTimeFormat() {\n        return this._dateTimeFormat;\n      }\n      /**\n       * 设置时区\n       * @param timezone\n       */\n\n    }, {\n      key: \"setTimezone\",\n      value: function setTimezone(timezone) {\n        var dateTimeFormat;\n\n        try {\n          dateTimeFormat = new Intl.DateTimeFormat('en', {\n            hour12: false,\n            timeZone: timezone,\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit',\n            hour: '2-digit',\n            minute: '2-digit'\n          });\n        } catch (e) {\n          logWarn('', '', 'Timezone is error!!!');\n        }\n\n        if (dateTimeFormat) {\n          this._dateTimeFormat = dateTimeFormat;\n        }\n      }\n      /**\n       * 获取时区\n       * @returns {null}\n       */\n\n    }, {\n      key: \"timezone\",\n      value: function timezone() {\n        return this._dateTimeFormat.resolvedOptions().timeZone;\n      }\n      /**\n       * 设置价格和数量精度\n       * @param pricePrecision\n       * @param volumePrecision\n       */\n\n    }, {\n      key: \"setPriceVolumePrecision\",\n      value: function setPriceVolumePrecision(pricePrecision, volumePrecision) {\n        this._pricePrecision = pricePrecision;\n        this._volumePrecision = volumePrecision;\n\n        for (var name in this._technicalIndicatorMapping) {\n          var series = this._technicalIndicatorMapping[name].series;\n\n          switch (series) {\n            case TechnicalIndicatorSeries.PRICE:\n              {\n                this._technicalIndicatorMapping[name].setPrecision(pricePrecision);\n\n                break;\n              }\n\n            case TechnicalIndicatorSeries.VOLUME:\n              {\n                this._technicalIndicatorMapping[name].setPrecision(volumePrecision);\n\n                break;\n              }\n          }\n        }\n      }\n      /**\n       * 获取数据源\n       * @returns {[]|*[]}\n       */\n\n    }, {\n      key: \"dataList\",\n      value: function dataList() {\n        return this._dataList;\n      }\n      /**\n       * 获取可见数据源\n       * @returns {[]|*[]}\n       */\n\n    }, {\n      key: \"visibleDataList\",\n      value: function visibleDataList() {\n        return this._visibleDataList;\n      }\n      /**\n       * 清空数据源\n       */\n\n    }, {\n      key: \"clearDataList\",\n      value: function clearDataList() {\n        this._more = true;\n        this._loading = true;\n        this._dataList = [];\n        this._visibleDataList = [];\n        this._from = 0;\n        this._to = 0;\n      }\n      /**\n       * 添加数据\n       * @param data\n       * @param pos\n       * @param more\n       */\n\n    }, {\n      key: \"addData\",\n      value: function addData(data, pos, more) {\n        if (isObject(data)) {\n          if (isArray(data)) {\n            this._loading = false;\n            this._more = isBoolean(more) ? more : true;\n            var isFirstAdd = this._dataList.length === 0;\n            this._dataList = data.concat(this._dataList);\n\n            if (isFirstAdd) {\n              this.setOffsetRightSpace(this._offsetRightSpace);\n            }\n\n            this._adjustFromTo();\n          } else {\n            var dataSize = this._dataList.length;\n\n            if (pos >= dataSize) {\n              this._dataList.push(data);\n\n              if (this._offsetRightBarCount < 0) {\n                this._offsetRightBarCount -= 1;\n              }\n\n              this._adjustFromTo();\n            } else {\n              this._dataList[pos] = data;\n\n              this._adjustVisibleDataList();\n            }\n          }\n\n          this.setCrosshair(this._crosshair, true);\n        }\n      }\n      /**\n       * 获取一条数据的空间\n       * @returns {number}\n       */\n\n    }, {\n      key: \"dataSpace\",\n      value: function dataSpace() {\n        return this._dataSpace;\n      }\n      /**\n       * 获取绘制一条数据的空间（不包括bar之间的间隙）\n       * @returns {*}\n       */\n\n    }, {\n      key: \"barSpace\",\n      value: function barSpace() {\n        return this._barSpace;\n      }\n      /**\n       * 设置一条数据的空间\n       * @param dataSpace\n       * @param adjustBeforeFuc\n       */\n\n    }, {\n      key: \"setDataSpace\",\n      value: function setDataSpace(dataSpace, adjustBeforeFuc) {\n        if (dataSpace < MIN_DATA_SPACE || dataSpace > MAX_DATA_SPACE || this._dataSpace === dataSpace) {\n          return;\n        }\n\n        this._dataSpace = dataSpace;\n        this._barSpace = this._calcBarSpace();\n        adjustBeforeFuc && adjustBeforeFuc();\n\n        this._adjustFromTo();\n\n        this.setCrosshair(this._crosshair, true);\n        this.invalidate();\n      }\n      /**\n       * 设置可见区域数据占用的总空间\n       * @param totalSpace\n       */\n\n    }, {\n      key: \"setTotalDataSpace\",\n      value: function setTotalDataSpace(totalSpace) {\n        if (this._totalDataSpace === totalSpace) {\n          return;\n        }\n\n        this._totalDataSpace = totalSpace;\n\n        this._adjustFromTo();\n\n        this.setCrosshair(this._crosshair, true);\n      }\n      /**\n       * 设置右边可以偏移的空间\n       * @param space\n       * @param invalidate\n       */\n\n    }, {\n      key: \"setOffsetRightSpace\",\n      value: function setOffsetRightSpace(space, invalidate) {\n        this._offsetRightSpace = space;\n        this._offsetRightBarCount = space / this._dataSpace;\n\n        if (invalidate) {\n          this._adjustFromTo();\n\n          this.setCrosshair(this._crosshair, true);\n          this.invalidate();\n        }\n      }\n      /**\n       * 右偏移距离\n       * @return {number}\n       */\n\n    }, {\n      key: \"offsetRightSpace\",\n      value: function offsetRightSpace() {\n        return this._offsetRightSpace;\n      }\n      /**\n       * 右偏移bar数量\n       * @return {*|number}\n       */\n\n    }, {\n      key: \"offsetRightBarCount\",\n      value: function offsetRightBarCount() {\n        return this._offsetRightBarCount;\n      }\n      /**\n       * 设置左边可见的最小bar数量\n       * @param barCount\n       */\n\n    }, {\n      key: \"setLeftMinVisibleBarCount\",\n      value: function setLeftMinVisibleBarCount(barCount) {\n        this._leftMinVisibleBarCount = barCount;\n      }\n      /**\n       * 设置右边可见的最小bar数量\n       * @param barCount\n       */\n\n    }, {\n      key: \"setRightMinVisibleBarCount\",\n      value: function setRightMinVisibleBarCount(barCount) {\n        this._rightMinVisibleBarCount = barCount;\n      }\n      /**\n       * 获取数据绘制起点\n       * @returns {number}\n       */\n\n    }, {\n      key: \"from\",\n      value: function from() {\n        return this._from;\n      }\n      /**\n       * 获取数据绘制终点\n       * @returns {number}\n       */\n\n    }, {\n      key: \"to\",\n      value: function to() {\n        return this._to;\n      }\n      /**\n       * 获取十字光标信息\n       * @returns {{}}\n       */\n\n    }, {\n      key: \"crosshair\",\n      value: function crosshair() {\n        return this._crosshair;\n      }\n      /**\n       * 设置十字光标点信息\n       * @param crosshair\n       * @param notInvalidate\n       */\n\n    }, {\n      key: \"setCrosshair\",\n      value: function setCrosshair(crosshair, notInvalidate) {\n        var cr = crosshair || {};\n        var realDataIndex;\n        var dataIndex;\n\n        if (isValid(cr.x)) {\n          realDataIndex = this.coordinateToDataIndex(cr.x);\n\n          if (realDataIndex < 0) {\n            dataIndex = 0;\n          } else if (realDataIndex > this._dataList.length - 1) {\n            dataIndex = this._dataList.length - 1;\n          } else {\n            dataIndex = realDataIndex;\n          }\n        } else {\n          realDataIndex = this._dataList.length - 1;\n          dataIndex = realDataIndex;\n        }\n\n        var kLineData = this._dataList[dataIndex];\n        var realX = this.dataIndexToCoordinate(realDataIndex);\n        var prevCrosshair = {\n          x: this._crosshair.x,\n          y: this._crosshair.y,\n          paneId: this._crosshair.paneId\n        };\n        this._crosshair = _objectSpread2(_objectSpread2({}, cr), {}, {\n          realX: realX,\n          kLineData: kLineData,\n          realDataIndex: realDataIndex,\n          dataIndex: dataIndex\n        });\n\n        if (cr.paneId && kLineData) {\n          this._handler.crosshair({\n            realDataIndex: realDataIndex,\n            dataIndex: dataIndex,\n            kLineData: kLineData,\n            x: cr.x,\n            y: cr.y\n          });\n        }\n\n        if ((prevCrosshair.x !== cr.x || prevCrosshair.y !== cr.y || prevCrosshair.paneId !== cr.paneId) && !notInvalidate) {\n          this.invalidate(InvalidateLevel.OVERLAY);\n        }\n      }\n      /**\n       * 开始滚动\n       */\n\n    }, {\n      key: \"startScroll\",\n      value: function startScroll() {\n        this._preOffsetRightBarCount = this._offsetRightBarCount;\n      }\n      /**\n       * 滚动\n       * @param distance\n       * @param crosshair\n       */\n\n    }, {\n      key: \"scroll\",\n      value: function scroll(distance, crosshair) {\n        if (!this._scrollEnabled) {\n          return;\n        }\n\n        var distanceBarCount = distance / this._dataSpace;\n        this.actionExecute(ActionType.SCROLL, {\n          barCount: distanceBarCount,\n          distance: distance\n        });\n        this._offsetRightBarCount = this._preOffsetRightBarCount - distanceBarCount;\n\n        this._adjustFromTo();\n\n        var cross = crosshair || this._crosshair;\n        this.setCrosshair(cross, true);\n        this.invalidate();\n      }\n      /**\n       * x转换成浮点数的位置\n       * @param x\n       * @returns {number}\n       */\n\n    }, {\n      key: \"coordinateToFloatIndex\",\n      value: function coordinateToFloatIndex(x) {\n        var dataSize = this._dataList.length;\n        var deltaFromRight = (this._totalDataSpace - x) / this._dataSpace;\n        var index = dataSize + this._offsetRightBarCount - deltaFromRight;\n        return Math.round(index * 1000000) / 1000000;\n      }\n      /**\n       * 数据索引转换成时间戳\n       * @param dataIndex\n       * @return {*}\n       */\n\n    }, {\n      key: \"dataIndexToTimestamp\",\n      value: function dataIndexToTimestamp(dataIndex) {\n        var data = this._dataList[dataIndex];\n\n        if (data) {\n          return data.timestamp;\n        }\n      }\n      /**\n       * 将时间戳转换成数据索引位置\n       * @param timestamp\n       * @return {number}\n       */\n\n    }, {\n      key: \"timestampToDataIndex\",\n      value: function timestampToDataIndex(timestamp) {\n        if (this._dataList.length === 0) {\n          return 0;\n        }\n\n        return binarySearchNearest(this._dataList, 'timestamp', timestamp);\n      }\n      /**\n       * 数据索引转换成坐标\n       * @param dataIndex\n       */\n\n    }, {\n      key: \"dataIndexToCoordinate\",\n      value: function dataIndexToCoordinate(dataIndex) {\n        var dataSize = this._dataList.length;\n        var deltaFromRight = dataSize + this._offsetRightBarCount - dataIndex; // return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace + this._barSpace / 2\n\n        return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace;\n      }\n      /**\n       * 坐标换成数据索引转\n       * @param pixel\n       */\n\n    }, {\n      key: \"coordinateToDataIndex\",\n      value: function coordinateToDataIndex(pixel) {\n        return Math.ceil(this.coordinateToFloatIndex(pixel)) - 1;\n      }\n      /**\n       * 缩放\n       * @param scale\n       * @param point\n       */\n\n    }, {\n      key: \"zoom\",\n      value: function zoom(scale, point) {\n        var _this = this;\n\n        if (!this._zoomEnabled) {\n          return;\n        }\n\n        if (!point || !isValid(point.x)) {\n          point = {\n            x: isValid(this._crosshair.x) ? this._crosshair.x : this._totalDataSpace / 2\n          };\n        }\n\n        this.actionExecute(ActionType.ZOOM, {\n          point: point,\n          scale: scale\n        });\n        var floatIndex = this.coordinateToFloatIndex(point.x);\n        var dataSpace = this._dataSpace + scale * (this._dataSpace / 10);\n        this.setDataSpace(dataSpace, function () {\n          _this._offsetRightBarCount += floatIndex - _this.coordinateToFloatIndex(point.x);\n        });\n      }\n      /**\n       * 刷新\n       * @param invalidateLevel\n       */\n\n    }, {\n      key: \"invalidate\",\n      value: function invalidate(invalidateLevel) {\n        this._handler.invalidate(invalidateLevel);\n      }\n      /**\n       * 设置是否可以缩放\n       * @param enabled\n       */\n\n    }, {\n      key: \"setZoomEnabled\",\n      value: function setZoomEnabled(enabled) {\n        this._zoomEnabled = enabled;\n      }\n      /**\n       * 获取是否可以缩放\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"zoomEnabled\",\n      value: function zoomEnabled() {\n        return this._zoomEnabled;\n      }\n      /**\n       * 设置是否可以拖拽滚动\n       * @param enabled\n       */\n\n    }, {\n      key: \"setScrollEnabled\",\n      value: function setScrollEnabled(enabled) {\n        this._scrollEnabled = enabled;\n      }\n      /**\n       * 获取是否可以拖拽滚动\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"scrollEnabled\",\n      value: function scrollEnabled() {\n        return this._scrollEnabled;\n      }\n      /**\n       * 设置加载更多\n       * @param callback\n       */\n\n    }, {\n      key: \"setLoadMoreCallback\",\n      value: function setLoadMoreCallback(callback) {\n        this._loadMoreCallback = callback;\n      }\n      /**\n       * 添加标记实例\n       * @param graphicMark\n       */\n\n    }, {\n      key: \"addGraphicMarkInstance\",\n      value: function addGraphicMarkInstance(graphicMark) {\n        if (this._graphicMarks.find(function (gm) {\n          return gm.id() === graphicMark.id();\n        })) {\n          return false;\n        }\n\n        var lastGraphicMark = this._graphicMarks[this._graphicMarks.length - 1];\n\n        if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n          this._graphicMarks[this._graphicMarks.length - 1] = graphicMark;\n        } else {\n          this._graphicMarks.push(graphicMark);\n        }\n\n        this.invalidate(InvalidateLevel.OVERLAY);\n        return true;\n      }\n      /**\n       * 添加自定义标记图形\n       * @param graphicMarks\n       */\n\n    }, {\n      key: \"addCustomGraphicMark\",\n      value: function addCustomGraphicMark(graphicMarks) {\n        var _this2 = this;\n\n        graphicMarks.forEach(function (mark) {\n          var GraphicMarkClass = createGraphicMarkClass(mark);\n\n          if (GraphicMarkClass) {\n            _this2._graphicMarkMapping[mark.name] = GraphicMarkClass;\n          }\n        });\n      }\n      /**\n       * 设置图形标记配置\n       * @param id\n       * @param options\n       */\n\n    }, {\n      key: \"setGraphicMarkOptions\",\n      value: function setGraphicMarkOptions(id) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var styles = options.styles,\n            lock = options.lock;\n\n        var graphicMark = this._graphicMarks.find(function (gm) {\n          return gm.id() === id;\n        });\n\n        if (graphicMark) {\n          graphicMark.setLock(lock);\n\n          if (graphicMark.setStyles(styles, this._styleOptions.graphicMark)) {\n            this.invalidate(InvalidateLevel.OVERLAY);\n          }\n        }\n      }\n      /**\n       * 获取图形标记信息\n       * @param id\n       * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n       */\n\n    }, {\n      key: \"getGraphicMark\",\n      value: function getGraphicMark(id) {\n        if (id) {\n          var graphicMark = this._graphicMarks.find(function (gm) {\n            return gm.id() === id;\n          });\n\n          if (graphicMark) {\n            return getGraphicMarkInfo(graphicMark);\n          }\n        } else {\n          return this._graphicMarks.map(function (graphicMark) {\n            return getGraphicMarkInfo(graphicMark);\n          });\n        }\n\n        return null;\n      }\n      /**\n       * 移除图形实例\n       * @param id 参数\n       */\n\n    }, {\n      key: \"removeGraphicMarkInstance\",\n      value: function removeGraphicMarkInstance(id) {\n        var graphicMarks = this._graphicMarks;\n\n        if (isValid(id)) {\n          var removeIndex = graphicMarks.findIndex(function (gm) {\n            return gm.id() === id;\n          });\n\n          if (removeIndex > -1) {\n            graphicMarks[removeIndex].onRemove({\n              id: graphicMarks[removeIndex].id()\n            });\n            graphicMarks.splice(removeIndex, 1);\n            this.invalidate(InvalidateLevel.OVERLAY);\n          }\n        } else {\n          if (graphicMarks.length > 0) {\n            graphicMarks.forEach(function (gm) {\n              gm.onRemove({\n                id: gm.id()\n              });\n            });\n            this._graphicMarks = [];\n            this.invalidate(InvalidateLevel.OVERLAY);\n          }\n        }\n      }\n      /**\n       * 获取图形标记拖拽标记\n       * @returns {boolean}\n       */\n\n    }, {\n      key: \"dragGraphicMarkFlag\",\n      value: function dragGraphicMarkFlag() {\n        return this._dragGraphicMarkFlag;\n      }\n      /**\n       * 设置图形标记拖拽标记\n       * @param flag\n       */\n\n    }, {\n      key: \"setDragGraphicMarkFlag\",\n      value: function setDragGraphicMarkFlag(flag) {\n        this._dragGraphicMarkFlag = flag;\n      }\n      /**\n       * 获取图形标记鼠标操作信息\n       * @return {{hover: {id: string, elementIndex: number, element: string}, click: {id: string, elementIndex: number, element: string}}}\n       */\n\n    }, {\n      key: \"graphicMarkMouseOperate\",\n      value: function graphicMarkMouseOperate() {\n        return this._graphicMarkMouseOperate;\n      }\n      /**\n       * 获取拖拽Pane标记\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"dragPaneFlag\",\n      value: function dragPaneFlag() {\n        return this._dragPaneFlag;\n      }\n      /**\n       * 设置拖拽Pane标记\n       * @param flag\n       */\n\n    }, {\n      key: \"setDragPaneFlag\",\n      value: function setDragPaneFlag(flag) {\n        this._dragPaneFlag = flag;\n      }\n      /**\n       * 获取图形标记映射\n       * @returns {{}}\n       */\n\n    }, {\n      key: \"graphicMarkMapping\",\n      value: function graphicMarkMapping() {\n        return this._graphicMarkMapping;\n      }\n      /**\n       * 获取图形标记的数据\n       * @returns {{}}\n       */\n\n    }, {\n      key: \"graphicMarks\",\n      value: function graphicMarks() {\n        return this._graphicMarks;\n      }\n      /**\n       * 获取可见的注解\n       * @return {[]}\n       */\n\n    }, {\n      key: \"visibleAnnotations\",\n      value: function visibleAnnotations() {\n        return this._visibleAnnotations;\n      }\n      /**\n       * 获取注解鼠标操作信息\n       * @return {null}\n       */\n\n    }, {\n      key: \"annotationMouseOperate\",\n      value: function annotationMouseOperate() {\n        return this._annotationMouseOperate;\n      }\n      /**\n       * 创建注解\n       * @param annotations\n       */\n\n    }, {\n      key: \"addAnnotations\",\n      value: function addAnnotations(annotations) {\n        var _this3 = this;\n\n        annotations.forEach(function (annotation) {\n          if (_this3._annotations.has(annotation.id())) {\n            _this3._annotations.get(annotation.id()).push(annotation);\n          } else {\n            _this3._annotations.set(annotation.id(), [annotation]);\n          }\n        });\n\n        this._adjustVisibleDataList();\n\n        this.invalidate(InvalidateLevel.OVERLAY);\n      }\n      /**\n       * 移除注解\n       * @param points\n       */\n\n    }, {\n      key: \"removeAnnotation\",\n      value: function removeAnnotation(points) {\n        var _this4 = this;\n\n        var shouldAdjust = false;\n\n        if (isValid(points)) {\n          [].concat(points).forEach(function (_ref) {\n            var timestamp = _ref.timestamp;\n\n            if (_this4._annotations.has(timestamp)) {\n              shouldAdjust = true;\n\n              _this4._annotations.delete(timestamp);\n            }\n          });\n\n          if (shouldAdjust) {\n            this._adjustVisibleDataList();\n          }\n        } else {\n          shouldAdjust = true;\n\n          this._annotations.clear();\n\n          this._visibleAnnotations = [];\n        }\n\n        if (shouldAdjust) {\n          this.invalidate(InvalidateLevel.OVERLAY);\n        }\n      }\n      /**\n       * 获取标签\n       * @return {Map<any, any>}\n       */\n\n    }, {\n      key: \"tags\",\n      value: function tags() {\n        return this._tags;\n      }\n      /**\n       * 根据id获取标签实例\n       * @param id\n       * @return\n       */\n\n    }, {\n      key: \"getTag\",\n      value: function getTag(id) {\n        return this._tags.get(id);\n      }\n      /**\n       * 添加标签\n       * @param tags\n       */\n\n    }, {\n      key: \"addTags\",\n      value: function addTags(tags) {\n        var _this5 = this;\n\n        tags.forEach(function (tag) {\n          _this5._tags.set(tag.id(), tag);\n        });\n        this.invalidate(InvalidateLevel.OVERLAY);\n      }\n      /**\n       * 移除标签\n       * @param id\n       */\n\n    }, {\n      key: \"removeTag\",\n      value: function removeTag(id) {\n        var _this6 = this;\n\n        var shouldInvalidate = false;\n\n        if (isValid(id)) {\n          var ids = [].concat(id);\n          ids.forEach(function (id) {\n            if (_this6._tags.has(id)) {\n              shouldInvalidate = true;\n\n              _this6._tags.delete(id);\n            }\n          });\n        } else {\n          shouldInvalidate = true;\n\n          this._tags.clear();\n        }\n\n        if (shouldInvalidate) {\n          this.invalidate(InvalidateLevel.OVERLAY);\n        }\n      }\n      /**\n       * 设置覆盖物鼠标操作信息\n       * @param graphicMarkOperate\n       * @param annotationOperate\n       */\n\n    }, {\n      key: \"setOverlayMouseOperate\",\n      value: function setOverlayMouseOperate(graphicMarkOperate, annotationOperate) {\n        var _this$_graphicMarkMou = this._graphicMarkMouseOperate,\n            hover = _this$_graphicMarkMou.hover,\n            click = _this$_graphicMarkMou.click;\n        var id = this._annotationMouseOperate.id;\n        var lastGraphicMark = this._graphicMarks[this._graphicMarks.length - 1];\n        var shouldInvalidate = false;\n\n        if (graphicMarkOperate.hover && (hover.id !== graphicMarkOperate.hover.id || hover.element !== graphicMarkOperate.hover.element || hover.elementIndex !== graphicMarkOperate.hover.elementIndex)) {\n          this._graphicMarkMouseOperate.hover = _objectSpread2({}, graphicMarkOperate.hover);\n          shouldInvalidate = true;\n        }\n\n        if (graphicMarkOperate.click && (click.id !== graphicMarkOperate.click.id || click.element !== graphicMarkOperate.click.element || click.elementIndex !== graphicMarkOperate.click.elementIndex)) {\n          this._graphicMarkMouseOperate.click = _objectSpread2({}, graphicMarkOperate.click);\n          shouldInvalidate = true;\n        }\n\n        if (annotationOperate && id !== annotationOperate.id) {\n          this._annotationMouseOperate = _objectSpread2({}, annotationOperate);\n          shouldInvalidate = true;\n        }\n\n        if (shouldInvalidate || lastGraphicMark && lastGraphicMark.isDrawing()) {\n          this.invalidate(InvalidateLevel.OVERLAY);\n        }\n      }\n      /**\n       * 添加一个自定义指标\n       * @param techs\n       */\n\n    }, {\n      key: \"addCustomTechnicalIndicator\",\n      value: function addCustomTechnicalIndicator(techs) {\n        var _this7 = this;\n\n        techs.forEach(function (tech) {\n          var instance = createTechnicalIndicatorInstance(tech || {});\n\n          if (instance) {\n            // 将生成的新的指标类放入集合\n            _this7._technicalIndicatorMapping[instance.name] = instance;\n          }\n        });\n      }\n      /**\n       * 事件执行\n       * @param type\n       * @param data\n       * @param executeBeforeFun\n       * @param executeAfterFun\n       */\n\n    }, {\n      key: \"actionExecute\",\n      value: function actionExecute(type, data, executeBeforeFun, executeAfterFun) {\n        if (this.hasAction(type)) {\n          executeBeforeFun && executeBeforeFun();\n\n          this._actionDelegate.get(type).execute(data);\n\n          executeAfterFun && executeAfterFun();\n        }\n      }\n      /**\n       * 是否有事件监听\n       * @param type\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"hasAction\",\n      value: function hasAction(type) {\n        return this._actionDelegate.has(type) && this._actionDelegate.get(type).hasObservers();\n      }\n      /**\n       * 订阅事件\n       * @param type\n       * @param callback\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"subscribeAction\",\n      value: function subscribeAction(type, callback) {\n        if (Object.values(ActionType).indexOf(type) < 0) {\n          return false;\n        }\n\n        if (!this._actionDelegate.has(type)) {\n          this._actionDelegate.set(type, new Delegate());\n        }\n\n        this._actionDelegate.get(type).subscribe(callback);\n\n        return true;\n      }\n      /**\n       * 取消事件订阅\n       * @param type\n       * @param callback\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"unsubscribeAction\",\n      value: function unsubscribeAction(type, callback) {\n        if (Object.values(ActionType).indexOf(type) < 0) {\n          return false;\n        }\n\n        if (this._actionDelegate.has(type)) {\n          var delegate = this._actionDelegate.get(type);\n\n          delegate.unsubscribe(callback);\n\n          if (!delegate.hasObservers()) {\n            this._actionDelegate.delete(type);\n          }\n\n          return true;\n        }\n\n        return false;\n      }\n    }]);\n\n    return ChartData;\n  }();\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 获取屏幕比\n   * @param canvas\n   * @returns {number}\n   */\n\n\n  function getPixelRatio(canvas) {\n    return canvas.ownerDocument && canvas.ownerDocument.defaultView && canvas.ownerDocument.defaultView.devicePixelRatio || 2;\n  }\n  /**\n   * 测量文字的宽度\n   * @param ctx\n   * @param text\n   * @returns {number}\n   */\n\n\n  function calcTextWidth(ctx, text) {\n    return Math.round(ctx.measureText(text).width);\n  }\n  /**\n   * 创建字体\n   * @param fontSize\n   * @param fontFamily\n   * @param fontWeight\n   * @returns {string}\n   */\n\n\n  function createFont() {\n    var fontSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 12;\n    var fontWeight = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'normal';\n    var fontFamily = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'Helvetica Neue';\n    return \"\".concat(fontWeight, \" \").concat(fontSize, \"px \").concat(fontFamily);\n  }\n\n  var Pane = /*#__PURE__*/function () {\n    function Pane(props) {\n      _classCallCheck(this, Pane);\n\n      this._height = -1;\n      this._container = props.container;\n      this._chartData = props.chartData;\n\n      this._initBefore(props);\n\n      this._initElement();\n\n      this._mainWidget = this._createMainWidget(this._element, props);\n      this._yAxisWidget = this._createYAxisWidget(this._element, props);\n    }\n\n    _createClass(Pane, [{\n      key: \"_initBefore\",\n      value: function _initBefore(props) {}\n    }, {\n      key: \"_initElement\",\n      value: function _initElement() {\n        this._element = document.createElement('div');\n        this._element.style.margin = '0';\n        this._element.style.padding = '0';\n        this._element.style.position = 'relative';\n        this._element.style.overflow = 'hidden';\n        this._element.style.width = '100%';\n        var lastElement = this._container.lastChild;\n\n        if (lastElement) {\n          this._container.insertBefore(this._element, lastElement);\n        } else {\n          this._container.appendChild(this._element);\n        }\n      }\n      /**\n       * 创建主组件\n       * @param container\n       * @param props\n       * @private\n       */\n\n    }, {\n      key: \"_createMainWidget\",\n      value: function _createMainWidget(container, props) {}\n      /**\n       * 创建y轴组件\n       * @param container\n       * @param props\n       * @private\n       */\n\n    }, {\n      key: \"_createYAxisWidget\",\n      value: function _createYAxisWidget(container, props) {}\n      /**\n       * 获取宽度\n       * @returns {number}\n       */\n\n    }, {\n      key: \"width\",\n      value: function width() {\n        return this._element.offsetWidth;\n      }\n    }, {\n      key: \"setWidth\",\n      value: function setWidth(mainWidgetWidth, yAxisWidgetWidth) {\n        this._mainWidget.setWidth(mainWidgetWidth);\n\n        this._yAxisWidget && this._yAxisWidget.setWidth(yAxisWidgetWidth);\n      }\n      /**\n       * 获取高度\n       */\n\n    }, {\n      key: \"height\",\n      value: function height() {\n        return this._height;\n      }\n      /**\n       * 设置临时高度\n       * @param height\n       */\n\n    }, {\n      key: \"setHeight\",\n      value: function setHeight(height) {\n        this._height = height;\n\n        this._mainWidget.setHeight(height);\n\n        this._yAxisWidget && this._yAxisWidget.setHeight(height);\n      }\n    }, {\n      key: \"setOffsetLeft\",\n      value: function setOffsetLeft(mainWidgetOffsetLeft, yAxisWidgetOffsetLeft) {\n        this._mainWidget.setOffsetLeft(mainWidgetOffsetLeft);\n\n        this._yAxisWidget && this._yAxisWidget.setOffsetLeft(yAxisWidgetOffsetLeft);\n      }\n    }, {\n      key: \"layout\",\n      value: function layout() {\n        if (this._element.offsetHeight !== this._height) {\n          this._element.style.height = \"\".concat(this._height, \"px\");\n        }\n\n        this._mainWidget.layout();\n\n        this._yAxisWidget && this._yAxisWidget.layout();\n      }\n      /**\n       * 刷新\n       * @param level\n       */\n\n    }, {\n      key: \"invalidate\",\n      value: function invalidate(level) {\n        this._yAxisWidget && this._yAxisWidget.invalidate(level);\n\n        this._mainWidget.invalidate(level);\n      }\n      /**\n       * 将canvas转换成图片\n       * @param includeOverlay\n       * @return {HTMLCanvasElement}\n       */\n\n    }, {\n      key: \"getImage\",\n      value: function getImage(includeOverlay) {\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var pixelRatio = getPixelRatio(canvas);\n        var width = this._element.offsetWidth;\n        var height = this._element.offsetHeight;\n        canvas.style.width = \"\".concat(width, \"px\");\n        canvas.style.height = \"\".concat(height, \"px\");\n        canvas.width = width * pixelRatio;\n        canvas.height = height * pixelRatio;\n        ctx.scale(pixelRatio, pixelRatio);\n\n        var mainWidgetElement = this._mainWidget.getElement();\n\n        var mainWidgetWidth = mainWidgetElement.offsetWidth;\n        var mainWidgetHeight = mainWidgetElement.offsetHeight;\n        var mainWidgetOffsetLeft = parseInt(mainWidgetElement.style.left, 10);\n        ctx.drawImage(this._mainWidget.getImage(includeOverlay), mainWidgetOffsetLeft, 0, mainWidgetWidth, mainWidgetHeight);\n\n        if (this._yAxisWidget) {\n          var yAxisWidgetElement = this._yAxisWidget.getElement();\n\n          var yAxisWidgetWidth = yAxisWidgetElement.offsetWidth;\n          var yAxisWidgetHeight = yAxisWidgetElement.offsetHeight;\n          var yAxisWidgetOffsetLeft = parseInt(yAxisWidgetElement.style.left, 10);\n          ctx.drawImage(this._yAxisWidget.getImage(includeOverlay), yAxisWidgetOffsetLeft, 0, yAxisWidgetWidth, yAxisWidgetHeight);\n        }\n\n        return canvas;\n      }\n      /**\n       * 销毁\n       */\n\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this._container.removeChild(this._element);\n      }\n    }]);\n\n    return Pane;\n  }();\n\n  var Widget = /*#__PURE__*/function () {\n    function Widget(props) {\n      _classCallCheck(this, Widget);\n\n      this._width = 0;\n      this._height = 0;\n\n      this._initElement(props.container);\n\n      this._mainView = this._createMainView(this._element, props);\n      this._overlayView = this._createOverlayView(this._element, props);\n    }\n    /**\n     * 初始化element\n     * @param container\n     * @private\n     */\n\n\n    _createClass(Widget, [{\n      key: \"_initElement\",\n      value: function _initElement(container) {\n        this._element = document.createElement('div');\n        this._element.style.top = '0';\n        this._element.style.margin = '0';\n        this._element.style.padding = '0';\n        this._element.style.position = 'absolute';\n        this._element.style.overflow = 'hidden';\n        container.appendChild(this._element);\n      }\n      /**\n       * 创建主view\n       * @param container\n       * @param props\n       * @private\n       */\n\n    }, {\n      key: \"_createMainView\",\n      value: function _createMainView(container, props) {}\n      /**\n       * 创建浮层view\n       * @param container\n       * @param props\n       * @private\n       */\n\n    }, {\n      key: \"_createOverlayView\",\n      value: function _createOverlayView(container, props) {}\n    }, {\n      key: \"getElement\",\n      value: function getElement() {\n        return this._element;\n      }\n    }, {\n      key: \"setWidth\",\n      value: function setWidth(width) {\n        this._width = width;\n\n        this._mainView.setWidth(width);\n\n        this._overlayView.setWidth(width);\n      }\n    }, {\n      key: \"setHeight\",\n      value: function setHeight(height) {\n        this._height = height;\n\n        this._mainView.setHeight(height);\n\n        this._overlayView.setHeight(height);\n      }\n    }, {\n      key: \"setOffsetLeft\",\n      value: function setOffsetLeft(offsetLeft) {\n        this._element.style.left = \"\".concat(offsetLeft, \"px\");\n      }\n    }, {\n      key: \"layout\",\n      value: function layout() {\n        if (this._element.offsetWidth !== this._width) {\n          this._element.style.width = \"\".concat(this._width, \"px\");\n        }\n\n        if (this._element.offsetHeight !== this._height) {\n          this._element.style.height = \"\".concat(this._height, \"px\");\n        }\n\n        this._mainView.layout();\n\n        this._overlayView.layout();\n      }\n      /**\n       * 更新\n       * @param level\n       */\n\n    }, {\n      key: \"invalidate\",\n      value: function invalidate(level) {\n        switch (level) {\n          case InvalidateLevel.OVERLAY:\n            {\n              this._overlayView.flush();\n\n              break;\n            }\n\n          case InvalidateLevel.MAIN:\n          case InvalidateLevel.FULL:\n            {\n              this._mainView.flush();\n\n              this._overlayView.flush();\n\n              break;\n            }\n        }\n      }\n      /**\n       * 将widget转换成图片\n       * @param includeOverlay\n       * @returns {HTMLCanvasElement}\n       */\n\n    }, {\n      key: \"getImage\",\n      value: function getImage(includeOverlay) {\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var pixelRatio = getPixelRatio(canvas);\n        canvas.style.width = \"\".concat(this._width, \"px\");\n        canvas.style.height = \"\".concat(this._height, \"px\");\n        canvas.width = this._width * pixelRatio;\n        canvas.height = this._height * pixelRatio;\n        ctx.scale(pixelRatio, pixelRatio);\n        ctx.drawImage(this._mainView.getImage(), 0, 0, this._width, this._height);\n\n        if (includeOverlay && this._overlayView) {\n          ctx.drawImage(this._overlayView.getImage(), 0, 0, this._width, this._height);\n        }\n\n        return canvas;\n      }\n    }]);\n\n    return Widget;\n  }();\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * requestAnimationFrame兼容\n   * @param fn\n   */\n\n\n  function requestAnimationFrame(fn) {\n    if (!window.requestAnimationFrame) {\n      return window.setTimeout(fn, 20);\n    }\n\n    return window.requestAnimationFrame(fn);\n  }\n  /**\n   * cancelAnimationFrame兼容\n   * @param id\n   */\n\n\n  function cancelAnimationFrame(id) {\n    if (!window.cancelAnimationFrame) {\n      clearTimeout(id);\n    }\n\n    window.cancelAnimationFrame(id);\n  }\n\n  var View = /*#__PURE__*/function () {\n    function View(container, chartData) {\n      _classCallCheck(this, View);\n\n      this._chartData = chartData;\n\n      this._initCanvas(container);\n    }\n    /**\n     * 初始化画布\n     * @param container\n     * @private\n     */\n\n\n    _createClass(View, [{\n      key: \"_initCanvas\",\n      value: function _initCanvas(container) {\n        this._canvas = document.createElement('canvas');\n        this._canvas.style.position = 'absolute';\n        this._canvas.style.top = '0';\n        this._canvas.style.left = '0';\n        this._canvas.style.zIndex = '2';\n        this._ctx = this._canvas.getContext('2d');\n        container.appendChild(this._canvas);\n      }\n      /**\n       * 重新绘制\n       * @param extendFun\n       * @private\n       */\n\n    }, {\n      key: \"_redraw\",\n      value: function _redraw(extendFun) {\n        this._ctx.clearRect(0, 0, this._canvas.offsetWidth, this._canvas.offsetHeight);\n\n        extendFun && extendFun();\n\n        this._draw();\n      }\n      /**\n       * 绘制\n       */\n\n    }, {\n      key: \"_draw\",\n      value: function _draw() {}\n    }, {\n      key: \"setWidth\",\n      value: function setWidth(width) {\n        this._width = width;\n      }\n    }, {\n      key: \"setHeight\",\n      value: function setHeight(height) {\n        this._height = height;\n      }\n    }, {\n      key: \"layout\",\n      value: function layout() {\n        var _this = this;\n\n        if (this._height !== this._canvas.offsetHeight || this._width !== this._canvas.offsetWidth) {\n          this._redraw(function () {\n            var pixelRatio = getPixelRatio(_this._canvas);\n            _this._canvas.style.width = \"\".concat(_this._width, \"px\");\n            _this._canvas.style.height = \"\".concat(_this._height, \"px\");\n            _this._canvas.width = Math.floor(_this._width * pixelRatio);\n            _this._canvas.height = Math.floor(_this._height * pixelRatio);\n\n            _this._ctx.scale(pixelRatio, pixelRatio);\n          });\n        } else {\n          this.flush();\n        }\n      }\n      /**\n       * 刷新\n       */\n\n    }, {\n      key: \"flush\",\n      value: function flush() {\n        var _this2 = this;\n\n        if (this.requestAnimationId) {\n          cancelAnimationFrame(this.requestAnimationId);\n          this.requestAnimationId = null;\n        }\n\n        this.requestAnimationId = requestAnimationFrame(function () {\n          _this2._redraw();\n        });\n      }\n      /**\n       * 获取图片\n       * @returns {HTMLCanvasElement}\n       */\n\n    }, {\n      key: \"getImage\",\n      value: function getImage() {\n        return this._canvas;\n      }\n    }]);\n\n    return View;\n  }();\n\n  var TechnicalIndicatorView = /*#__PURE__*/function (_View) {\n    _inherits(TechnicalIndicatorView, _View);\n\n    var _super = _createSuper(TechnicalIndicatorView);\n\n    function TechnicalIndicatorView(container, chartData, xAxis, yAxis, additionalDataProvider) {\n      var _this;\n\n      _classCallCheck(this, TechnicalIndicatorView);\n\n      _this = _super.call(this, container, chartData);\n      _this._xAxis = xAxis;\n      _this._yAxis = yAxis;\n      _this._additionalDataProvider = additionalDataProvider;\n      return _this;\n    }\n\n    _createClass(TechnicalIndicatorView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        this._drawGrid();\n\n        this._drawTechnicalIndicators();\n      }\n      /**\n       * 绘制网格\n       * @private\n       */\n\n    }, {\n      key: \"_drawGrid\",\n      value: function _drawGrid() {\n        var _this2 = this;\n\n        var gridOptions = this._chartData.styleOptions().grid;\n\n        if (!gridOptions.show) {\n          return;\n        }\n\n        var gridHorizontalOptions = gridOptions.horizontal;\n\n        this._ctx.save();\n\n        if (gridHorizontalOptions.show) {\n          this._ctx.strokeStyle = gridHorizontalOptions.color;\n          this._ctx.lineWidth = gridHorizontalOptions.size;\n\n          if (gridHorizontalOptions.style === LineStyle.DASH) {\n            this._ctx.setLineDash(gridHorizontalOptions.dashValue);\n          } else {\n            this._ctx.setLineDash([]);\n          }\n\n          this._yAxis.ticks().forEach(function (tick) {\n            renderHorizontalLine(_this2._ctx, tick.y, 0, _this2._width);\n          });\n        }\n\n        var gridVerticalOptions = gridOptions.vertical;\n\n        if (gridVerticalOptions.show) {\n          this._ctx.strokeStyle = gridVerticalOptions.color;\n          this._ctx.lineWidth = gridVerticalOptions.size;\n\n          if (gridVerticalOptions.style === LineStyle.DASH) {\n            this._ctx.setLineDash(gridVerticalOptions.dashValue);\n          } else {\n            this._ctx.setLineDash([]);\n          }\n\n          this._xAxis.ticks().forEach(function (tick) {\n            renderVerticalLine(_this2._ctx, tick.x, 0, _this2._height);\n          });\n        }\n\n        this._ctx.restore();\n      }\n      /**\n       * 绘制指标\n       * @private\n       */\n\n    }, {\n      key: \"_drawTechnicalIndicators\",\n      value: function _drawTechnicalIndicators() {\n        var _this3 = this;\n\n        var technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator;\n\n        var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n        technicalIndicators.forEach(function (technicalIndicator) {\n          var plots = technicalIndicator.plots;\n          var lines = [];\n\n          var dataList = _this3._chartData.dataList();\n\n          var technicalIndicatorResult = technicalIndicator.result;\n          var styles = technicalIndicator.styles || technicalIndicatorOptions; // 技术指标自定义绘制\n\n          if (technicalIndicator.render) {\n            _this3._ctx.save();\n\n            technicalIndicator.render(_this3._ctx, {\n              from: _this3._chartData.from(),\n              to: _this3._chartData.to(),\n              kLineDataList: _this3._chartData.dataList(),\n              technicalIndicatorDataList: technicalIndicatorResult\n            }, {\n              width: _this3._width,\n              height: _this3._height,\n              dataSpace: _this3._chartData.dataSpace(),\n              barSpace: _this3._chartData.barSpace()\n            }, styles, {\n              convertFromPixel: _this3._xAxis.convertFromPixel.bind(_this3._xAxis),\n              convertToPixel: _this3._xAxis.convertToPixel.bind(_this3._xAxis)\n            }, {\n              convertFromPixel: _this3._yAxis.convertFromPixel.bind(_this3._yAxis),\n              convertToPixel: _this3._yAxis.convertToPixel.bind(_this3._yAxis)\n            }, _this3._yAxis.isCandleYAxis());\n\n            _this3._ctx.restore();\n          }\n\n          var baseValue = technicalIndicator.baseValue;\n\n          if (!isValid(baseValue)) {\n            baseValue = _this3._yAxis.min();\n          }\n\n          var baseValueY = _this3._yAxis.convertToPixel(baseValue);\n\n          var isCandleYAxis = _this3._yAxis.isCandleYAxis();\n\n          _this3._ctx.lineWidth = 1;\n\n          _this3._drawGraphics(function (x, i, kLineData, halfBarSpace, barSpace) {\n            var technicalIndicatorData = technicalIndicatorResult[i] || {};\n            var lineValueIndex = 0;\n\n            if (technicalIndicator.shouldOhlc && !isCandleYAxis) {\n              _this3._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, styles.bar, CandleType.OHLC);\n            }\n\n            var coordinateY = {};\n            plots.forEach(function (plot) {\n              var value = technicalIndicatorData[plot.key];\n\n              var valueY = _this3._yAxis.convertToPixel(value);\n\n              coordinateY[plot.key] = valueY;\n\n              switch (plot.type) {\n                case TechnicalIndicatorPlotType.CIRCLE:\n                  {\n                    if (isValid(value)) {\n                      var cbData = {\n                        preData: {\n                          kLineData: dataList[i - 1],\n                          technicalIndicatorData: technicalIndicatorResult[i - 1]\n                        },\n                        currentData: {\n                          kLineData: kLineData,\n                          technicalIndicatorData: technicalIndicatorData\n                        },\n                        nextData: {\n                          kLineData: dataList[i + 1],\n                          technicalIndicatorData: technicalIndicatorResult[i + 1]\n                        }\n                      };\n                      var circle = {\n                        x: x,\n                        y: valueY,\n                        radius: halfBarSpace,\n                        color: plot.color && plot.color(cbData, styles) || styles.circle.noChangeColor,\n                        isStroke: plot.isStroke ? plot.isStroke(cbData) : true\n                      };\n\n                      _this3._drawCircle(circle);\n                    }\n\n                    break;\n                  }\n\n                case TechnicalIndicatorPlotType.BAR:\n                  {\n                    if (isValid(value)) {\n                      var _cbData = {\n                        preData: {\n                          kLineData: dataList[i - 1],\n                          technicalIndicatorData: technicalIndicatorResult[i - 1]\n                        },\n                        currentData: {\n                          kLineData: kLineData,\n                          technicalIndicatorData: technicalIndicatorData\n                        },\n                        nextData: {\n                          kLineData: dataList[i + 1],\n                          technicalIndicatorData: technicalIndicatorResult[i + 1]\n                        }\n                      };\n                      var height = Math.abs(baseValueY - valueY);\n                      var bar = {\n                        x: x - halfBarSpace,\n                        width: halfBarSpace * 2,\n                        height: Math.max(1, height)\n                      };\n\n                      if (valueY > baseValueY) {\n                        bar.y = baseValueY;\n                      } else {\n                        bar.y = height < 1 ? baseValueY - 1 : valueY;\n                      }\n\n                      bar.color = plot.color && plot.color(_cbData, styles) || styles.bar.noChangeColor;\n                      bar.isStroke = plot.isStroke ? plot.isStroke(_cbData) : false;\n\n                      _this3._drawBar(bar);\n                    }\n\n                    break;\n                  }\n\n                case TechnicalIndicatorPlotType.LINE:\n                  {\n                    var line = null;\n\n                    if (isValid(value)) {\n                      line = {\n                        x: x,\n                        y: valueY\n                      };\n                    }\n\n                    if (lines[lineValueIndex]) {\n                      lines[lineValueIndex].push(line);\n                    } else {\n                      lines[lineValueIndex] = [line];\n                    }\n\n                    lineValueIndex++;\n                    break;\n                  }\n              }\n\n              _this3._drawActionExecute(ActionType.DRAW_TECHNICAL_INDICATOR, {\n                ctx: _this3._ctx,\n                kLineData: kLineData,\n                dataIndex: i,\n                technicalIndicatorData: technicalIndicatorData,\n                technicalIndicatorName: technicalIndicator.name,\n                coordinate: _objectSpread2({\n                  x: x\n                }, coordinateY),\n                viewport: {\n                  width: _this3._width,\n                  height: _this3._height\n                },\n                barSpace: barSpace,\n                halfBarSpace: halfBarSpace,\n                isCandle: isCandleYAxis\n              });\n            });\n          }, function () {\n            _this3._drawLines(lines, styles);\n          });\n        });\n      }\n      /**\n       * 绘制图形\n       * @param onDrawing\n       * @param onDrawEnd\n       * @private\n       */\n\n    }, {\n      key: \"_drawGraphics\",\n      value: function _drawGraphics(onDrawing, onDrawEnd) {\n        var visibleDataList = this._chartData.visibleDataList();\n\n        var barSpace = this._chartData.barSpace();\n\n        var halfBarSpace = barSpace / 2;\n        visibleDataList.forEach(function (_ref, n) {\n          var x = _ref.x,\n              index = _ref.index,\n              data = _ref.data;\n          onDrawing(x, index, data, halfBarSpace, barSpace, n);\n        });\n        onDrawEnd && onDrawEnd();\n      }\n      /**\n       * 绘制线\n       * @param lines\n       * @param technicalIndicatorOptions\n       */\n\n    }, {\n      key: \"_drawLines\",\n      value: function _drawLines(lines, technicalIndicatorOptions) {\n        var _this4 = this;\n\n        var colors = technicalIndicatorOptions.line.colors || [];\n        var colorSize = colors.length;\n        this._ctx.lineWidth = technicalIndicatorOptions.line.size;\n        renderLine(this._ctx, function () {\n          lines.forEach(function (lineItem, i) {\n            _this4._ctx.strokeStyle = colors[i % colorSize];\n\n            _this4._ctx.beginPath();\n\n            var isStart = true;\n            lineItem.forEach(function (line) {\n              if (isValid(line)) {\n                if (isStart) {\n                  _this4._ctx.moveTo(line.x, line.y);\n\n                  isStart = false;\n                } else {\n                  _this4._ctx.lineTo(line.x, line.y);\n                }\n              }\n            });\n\n            _this4._ctx.stroke();\n\n            _this4._ctx.closePath();\n          });\n        });\n      }\n      /**\n       * 绘制柱\n       */\n\n    }, {\n      key: \"_drawBar\",\n      value: function _drawBar(bar) {\n        if (bar.isStroke) {\n          this._ctx.strokeStyle = bar.color;\n\n          this._ctx.strokeRect(bar.x + 0.5, bar.y, bar.width - 1, bar.height);\n        } else {\n          this._ctx.fillStyle = bar.color;\n\n          this._ctx.fillRect(bar.x, bar.y, bar.width, bar.height);\n        }\n      }\n      /**\n       * 绘制圆点\n       * @param circle\n       * @private\n       */\n\n    }, {\n      key: \"_drawCircle\",\n      value: function _drawCircle(circle) {\n        this._ctx.strokeStyle = circle.color;\n        this._ctx.fillStyle = circle.color;\n\n        this._ctx.beginPath();\n\n        this._ctx.arc(circle.x, circle.y, circle.radius, Math.PI * 2, 0, true);\n\n        if (circle.isStroke) {\n          this._ctx.stroke();\n        } else {\n          this._ctx.fill();\n        }\n\n        this._ctx.closePath();\n      }\n      /**\n       * 绘制蜡烛柱\n       * @param x\n       * @param halfBarSpace\n       * @param barSpace\n       * @param dataIndex\n       * @param kLineData\n       * @param barOptions\n       * @param barStyle\n       * @private\n       */\n\n    }, {\n      key: \"_drawCandleBar\",\n      value: function _drawCandleBar(x, halfBarSpace, barSpace, dataIndex, kLineData, barOptions, barStyle) {\n        var open = kLineData.open,\n            close = kLineData.close,\n            high = kLineData.high,\n            low = kLineData.low;\n\n        if (close > open) {\n          this._ctx.strokeStyle = barOptions.upColor;\n          this._ctx.fillStyle = barOptions.upColor;\n        } else if (close < open) {\n          this._ctx.strokeStyle = barOptions.downColor;\n          this._ctx.fillStyle = barOptions.downColor;\n        } else {\n          this._ctx.strokeStyle = barOptions.noChangeColor;\n          this._ctx.fillStyle = barOptions.noChangeColor;\n        }\n\n        var openY = this._yAxis.convertToPixel(open);\n\n        var closeY = this._yAxis.convertToPixel(close);\n\n        var highY = this._yAxis.convertToPixel(high);\n\n        var lowY = this._yAxis.convertToPixel(low);\n\n        var highEndY = Math.min(openY, closeY);\n        var lowStartY = Math.max(openY, closeY);\n\n        this._ctx.fillRect(x - 0.5, highY, 1, highEndY - highY);\n\n        this._ctx.fillRect(x - 0.5, lowStartY, 1, lowY - lowStartY);\n\n        var barHeight = Math.max(1, lowStartY - highEndY);\n\n        switch (barStyle) {\n          case CandleType.CANDLE_SOLID:\n            {\n              this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight);\n\n              break;\n            }\n\n          case CandleType.CANDLE_STROKE:\n            {\n              this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight);\n\n              break;\n            }\n\n          case CandleType.CANDLE_UP_STROKE:\n            {\n              if (close > open) {\n                this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight);\n              } else {\n                this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight);\n              }\n\n              break;\n            }\n\n          case CandleType.CANDLE_DOWN_STROKE:\n            {\n              if (close > open) {\n                this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight);\n              } else {\n                this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight);\n              }\n\n              break;\n            }\n\n          default:\n            {\n              this._ctx.fillRect(x - 0.5, highY, 1, lowY - highY);\n\n              this._ctx.fillRect(x - halfBarSpace, openY - 0.5, halfBarSpace, 1);\n\n              this._ctx.fillRect(x, closeY - 0.5, halfBarSpace, 1);\n\n              break;\n            }\n        }\n\n        this._drawActionExecute(ActionType.DRAW_CANDLE, {\n          ctx: this._ctx,\n          dataIndex: dataIndex,\n          kLineData: kLineData,\n          coordinate: {\n            x: x,\n            open: openY,\n            close: closeY,\n            high: highY,\n            low: lowY\n          },\n          viewport: {\n            width: this._width,\n            height: this._height\n          },\n          barSpace: barSpace,\n          halfBarSpace: halfBarSpace,\n          isCandle: this._yAxis.isCandleYAxis()\n        });\n      }\n      /**\n       * 执行绘制事件监听\n       * @param type\n       * @param data\n       * @private\n       */\n\n    }, {\n      key: \"_drawActionExecute\",\n      value: function _drawActionExecute(type, data) {\n        var _this5 = this;\n\n        this._chartData.actionExecute(type, data, function () {\n          _this5._ctx.save();\n        }, function () {\n          _this5._ctx.restore();\n        });\n      }\n    }]);\n\n    return TechnicalIndicatorView;\n  }(View);\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 绘制文字\n   * @param ctx\n   * @param color\n   * @param x\n   * @param y\n   * @param text\n   */\n\n\n  function renderText(ctx, color, x, y, text) {\n    ctx.fillStyle = color;\n    ctx.fillText(text, x, y);\n  }\n\n  var TechnicalIndicatorOverlayView = /*#__PURE__*/function (_View) {\n    _inherits(TechnicalIndicatorOverlayView, _View);\n\n    var _super = _createSuper(TechnicalIndicatorOverlayView);\n\n    function TechnicalIndicatorOverlayView(container, chartData, xAxis, yAxis, additionalDataProvider) {\n      var _this;\n\n      _classCallCheck(this, TechnicalIndicatorOverlayView);\n\n      _this = _super.call(this, container, chartData);\n      _this._xAxis = xAxis;\n      _this._yAxis = yAxis;\n      _this._additionalDataProvider = additionalDataProvider;\n      return _this;\n    }\n\n    _createClass(TechnicalIndicatorOverlayView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        this._drawCover();\n\n        var crosshair = this._chartData.crosshair();\n\n        if (crosshair.kLineData) {\n          var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n          var styleOptions = this._chartData.styleOptions();\n\n          var crosshairOptions = styleOptions.crosshair;\n\n          if (crosshair.paneId === this._additionalDataProvider.id()) {\n            // 绘制十字光标水平线\n            this._drawCrosshairLine(crosshairOptions, 'horizontal', crosshair.y, 0, this._width, renderHorizontalLine);\n          }\n\n          if (crosshair.paneId) {\n            // 绘制十字光标垂直线\n            this._drawCrosshairLine(crosshairOptions, 'vertical', crosshair.realX, 0, this._height, renderVerticalLine);\n          }\n\n          this._drawTooltip(crosshair, technicalIndicators);\n        }\n      }\n      /**\n       * 绘制覆盖物\n       * @private\n       */\n\n    }, {\n      key: \"_drawCover\",\n      value: function _drawCover() {}\n      /**\n       * 绘制图例\n       * @param crosshair\n       * @param technicalIndicators\n       * @private\n       */\n\n    }, {\n      key: \"_drawTooltip\",\n      value: function _drawTooltip(crosshair, technicalIndicators) {\n        var technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator;\n\n        this._drawBatchTechnicalIndicatorToolTip(crosshair, technicalIndicators, technicalIndicatorOptions, 0, this._shouldDrawTooltip(crosshair, technicalIndicatorOptions.tooltip));\n      }\n      /**\n       * 绘制十字光标线\n       * @param crosshairOptions\n       * @param optionsKey\n       * @param fixedCoordinate\n       * @param startCoordinate\n       * @param endCoordinate\n       * @param drawLine\n       * @private\n       */\n\n    }, {\n      key: \"_drawCrosshairLine\",\n      value: function _drawCrosshairLine(crosshairOptions, optionsKey, fixedCoordinate, startCoordinate, endCoordinate, drawLine) {\n        var crosshairDirectionOptions = crosshairOptions[optionsKey];\n        var crosshairLineOptions = crosshairDirectionOptions.line;\n\n        if (!crosshairOptions.show || !crosshairDirectionOptions.show || !crosshairLineOptions.show) {\n          return;\n        }\n\n        this._ctx.save();\n\n        this._ctx.lineWidth = crosshairLineOptions.size;\n        this._ctx.strokeStyle = crosshairLineOptions.color;\n\n        if (crosshairLineOptions.style === LineStyle.DASH) {\n          this._ctx.setLineDash(crosshairLineOptions.dashValue);\n        }\n\n        drawLine(this._ctx, fixedCoordinate, startCoordinate, endCoordinate);\n\n        this._ctx.restore();\n      }\n      /**\n       * 批量绘制技术指标提示\n       * @param crosshair\n       * @param technicalIndicators\n       * @param technicalIndicatorOptions\n       * @param offsetTop\n       * @param isDrawTechnicalIndicatorTooltip\n       * @private\n       */\n\n    }, {\n      key: \"_drawBatchTechnicalIndicatorToolTip\",\n      value: function _drawBatchTechnicalIndicatorToolTip(crosshair, technicalIndicators, technicalIndicatorOptions) {\n        var _this2 = this;\n\n        var offsetTop = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var isDrawTechnicalIndicatorTooltip = arguments.length > 4 ? arguments[4] : undefined;\n\n        if (!isDrawTechnicalIndicatorTooltip) {\n          return;\n        }\n\n        var technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip;\n        var top = offsetTop;\n        technicalIndicators.forEach(function (technicalIndicator) {\n          _this2._drawTechnicalIndicatorTooltip(crosshair, technicalIndicator, technicalIndicatorOptions, top);\n\n          top += technicalIndicatorTooltipOptions.text.marginTop + technicalIndicatorTooltipOptions.text.size + technicalIndicatorTooltipOptions.text.marginBottom;\n        });\n      }\n      /**\n       * 绘制指标图例\n       * @param crosshair\n       * @param technicalIndicator\n       * @param technicalIndicatorOptions\n       * @param offsetTop\n       * @private\n       */\n\n    }, {\n      key: \"_drawTechnicalIndicatorTooltip\",\n      value: function _drawTechnicalIndicatorTooltip(crosshair, technicalIndicator, technicalIndicatorOptions) {\n        var _this3 = this;\n\n        var offsetTop = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip;\n        var styles = technicalIndicator.styles || technicalIndicatorOptions;\n        var technicalIndicatorResult = technicalIndicator.result;\n        var technicalIndicatorData = technicalIndicatorResult[crosshair.dataIndex];\n        var tooltipData = getTechnicalIndicatorTooltipData(technicalIndicatorData, technicalIndicator);\n        var colors = styles.line.colors;\n\n        var dataList = this._chartData.dataList();\n\n        var cbData = {\n          preData: {\n            kLineData: dataList[crosshair.dataIndex - 1],\n            technicalIndicatorData: technicalIndicatorResult[crosshair.dataIndex - 1]\n          },\n          currentData: {\n            kLineData: dataList[crosshair.dataIndex],\n            technicalIndicatorData: technicalIndicatorData\n          },\n          nextData: {\n            kLineData: dataList[crosshair.dataIndex + 1],\n            technicalIndicatorData: technicalIndicatorResult[crosshair.dataIndex + 1]\n          }\n        };\n        var plots = technicalIndicator.plots;\n        var technicalIndicatorTooltipTextOptions = technicalIndicatorTooltipOptions.text;\n        var values = tooltipData.values;\n        var textMarginLeft = technicalIndicatorTooltipTextOptions.marginLeft;\n        var textMarginRight = technicalIndicatorTooltipTextOptions.marginRight;\n        var labelX = 0;\n        var labelY = technicalIndicatorTooltipTextOptions.marginTop + offsetTop;\n        var textSize = technicalIndicatorTooltipTextOptions.size;\n        var textColor = technicalIndicatorTooltipTextOptions.color;\n        var colorSize = colors.length;\n        this._ctx.textBaseline = 'top';\n        this._ctx.font = createFont(textSize, technicalIndicatorTooltipTextOptions.weight, technicalIndicatorTooltipTextOptions.family);\n\n        if (technicalIndicatorTooltipOptions.showName) {\n          var nameText = tooltipData.name;\n          var nameTextWidth = calcTextWidth(this._ctx, nameText);\n          labelX += textMarginLeft;\n          renderText(this._ctx, textColor, labelX, labelY, nameText);\n          labelX += nameTextWidth;\n\n          if (!technicalIndicatorTooltipOptions.showParams) {\n            labelX += textMarginRight;\n          }\n        }\n\n        if (technicalIndicatorTooltipOptions.showParams) {\n          var calcParamText = tooltipData.calcParamText;\n          var calcParamTextWidth = calcTextWidth(this._ctx, calcParamText);\n\n          if (!technicalIndicatorTooltipOptions.showName) {\n            labelX += textMarginLeft;\n          }\n\n          renderText(this._ctx, textColor, labelX, labelY, calcParamText);\n          labelX += calcParamTextWidth + textMarginRight;\n        }\n\n        var lineCount = 0;\n        var valueColor;\n        plots.forEach(function (plot, i) {\n          switch (plot.type) {\n            case TechnicalIndicatorPlotType.CIRCLE:\n              {\n                valueColor = plot.color && plot.color(cbData, styles) || styles.circle.noChangeColor;\n                break;\n              }\n\n            case TechnicalIndicatorPlotType.BAR:\n              {\n                valueColor = plot.color && plot.color(cbData, styles) || styles.bar.noChangeColor;\n                break;\n              }\n\n            case TechnicalIndicatorPlotType.LINE:\n              {\n                valueColor = colors[lineCount % colorSize] || textColor;\n                lineCount++;\n                break;\n              }\n          }\n\n          var title = values[i].title;\n\n          if (isValid(title)) {\n            labelX += textMarginLeft;\n            var text = \"\".concat(title).concat(values[i].value || technicalIndicatorTooltipOptions.defaultValue);\n            var textWidth = calcTextWidth(_this3._ctx, text);\n            renderText(_this3._ctx, valueColor, labelX, labelY, text);\n            labelX += textWidth + textMarginRight;\n          }\n        });\n      }\n      /**\n       * 是否需要绘制图例\n       * @param crosshair\n       * @param tooltipOptions\n       * @return {boolean|boolean|*}\n       * @private\n       */\n\n    }, {\n      key: \"_shouldDrawTooltip\",\n      value: function _shouldDrawTooltip(crosshair, tooltipOptions) {\n        var showRule = tooltipOptions.showRule;\n        return showRule === TooltipShowRule.ALWAYS || showRule === TooltipShowRule.FOLLOW_CROSS && !!crosshair.paneId;\n      }\n    }]);\n\n    return TechnicalIndicatorOverlayView;\n  }(View);\n\n  var TechnicalIndicatorWidget = /*#__PURE__*/function (_Widget) {\n    _inherits(TechnicalIndicatorWidget, _Widget);\n\n    var _super = _createSuper(TechnicalIndicatorWidget);\n\n    function TechnicalIndicatorWidget() {\n      _classCallCheck(this, TechnicalIndicatorWidget);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(TechnicalIndicatorWidget, [{\n      key: \"_createMainView\",\n      value: function _createMainView(container, props) {\n        return new TechnicalIndicatorView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider);\n      }\n    }, {\n      key: \"_createOverlayView\",\n      value: function _createOverlayView(container, props) {\n        return new TechnicalIndicatorOverlayView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider);\n      }\n    }]);\n\n    return TechnicalIndicatorWidget;\n  }(Widget);\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 绘制带边框的圆角填充矩形\n   * @param ctx\n   * @param fillColor\n   * @param borderColor\n   * @param borderSize\n   * @param x\n   * @param y\n   * @param width\n   * @param height\n   * @param borderRadius\n   */\n\n\n  function renderStrokeFillRoundRect(ctx, fillColor, borderColor, borderSize, x, y, width, height, borderRadius) {\n    renderFillRoundRect(ctx, fillColor, x, y, width, height, borderRadius);\n    renderStrokeRoundRect(ctx, borderColor, borderSize, x, y, width, height, borderRadius);\n  }\n  /**\n   * 绘制填充的矩形\n   * @param ctx\n   * @param color\n   * @param x\n   * @param y\n   * @param width\n   * @param height\n   */\n\n\n  function renderFillRect(ctx, color, x, y, width, height) {\n    ctx.fillStyle = color;\n    ctx.fillRect(x, y, width, height);\n  }\n  /**\n   * 绘制圆角空心矩形\n   * @param ctx\n   * @param borderColor\n   * @param borderSize\n   * @param x\n   * @param y\n   * @param w\n   * @param h\n   * @param r\n   */\n\n\n  function renderStrokeRoundRect(ctx, borderColor, borderSize, x, y, w, h, r) {\n    ctx.lineWidth = borderSize;\n    ctx.strokeStyle = borderColor;\n    renderRoundRect(ctx, x, y, w, h, r);\n    ctx.stroke();\n  }\n  /**\n   * 绘制填充圆角矩形\n   * @param ctx\n   * @param color\n   * @param x\n   * @param y\n   * @param w\n   * @param h\n   * @param r\n   */\n\n\n  function renderFillRoundRect(ctx, color, x, y, w, h, r) {\n    ctx.fillStyle = color;\n    renderRoundRect(ctx, x, y, w, h, r);\n    ctx.fill();\n  }\n  /**\n   * 绘制圆角矩形\n   * @param ctx\n   * @param x\n   * @param y\n   * @param w\n   * @param h\n   * @param r\n   */\n\n\n  function renderRoundRect(ctx, x, y, w, h, r) {\n    ctx.beginPath();\n    ctx.moveTo(x + r, y);\n    ctx.arcTo(x + w, y, x + w, y + h, r);\n    ctx.arcTo(x + w, y + h, x, y + h, r);\n    ctx.arcTo(x, y + h, x, y, r);\n    ctx.arcTo(x, y, x + w, y, r);\n    ctx.closePath();\n  }\n\n  var YAxisView = /*#__PURE__*/function (_View) {\n    _inherits(YAxisView, _View);\n\n    var _super = _createSuper(YAxisView);\n\n    function YAxisView(container, chartData, yAxis, additionalDataProvider) {\n      var _this;\n\n      _classCallCheck(this, YAxisView);\n\n      _this = _super.call(this, container, chartData);\n      _this._yAxis = yAxis;\n      _this._additionalDataProvider = additionalDataProvider;\n      return _this;\n    }\n\n    _createClass(YAxisView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        var yAxisOptions = this._chartData.styleOptions().yAxis;\n\n        if (yAxisOptions.show) {\n          this._drawAxisLine(yAxisOptions);\n\n          this._drawTickLines(yAxisOptions);\n\n          this._drawTickLabels(yAxisOptions);\n\n          this._drawTechnicalIndicatorLastValue(yAxisOptions);\n\n          this._drawLastPriceLabel(yAxisOptions);\n        }\n      }\n    }, {\n      key: \"_drawAxisLine\",\n      value: function _drawAxisLine(yAxisOptions) {\n        var axisLine = yAxisOptions.axisLine;\n\n        if (!axisLine.show) {\n          return;\n        }\n\n        this._ctx.strokeStyle = axisLine.color;\n        this._ctx.lineWidth = axisLine.size;\n        var x;\n\n        if (this._yAxis.isFromYAxisZero()) {\n          x = 0;\n        } else {\n          x = this._width - 1;\n        }\n\n        renderVerticalLine(this._ctx, x, 0, this._height);\n      }\n    }, {\n      key: \"_drawTickLines\",\n      value: function _drawTickLines(yAxisOptions) {\n        var _this2 = this;\n\n        var tickLine = yAxisOptions.tickLine;\n\n        if (!tickLine.show) {\n          return;\n        }\n\n        this._ctx.lineWidth = tickLine.size;\n        this._ctx.strokeStyle = tickLine.color;\n        var tickLineLength = tickLine.length;\n        var startX;\n        var endX;\n\n        if (this._yAxis.isFromYAxisZero()) {\n          startX = 0;\n\n          if (yAxisOptions.axisLine.show) {\n            startX += yAxisOptions.axisLine.size;\n          }\n\n          endX = startX + tickLineLength;\n        } else {\n          startX = this._width;\n\n          if (yAxisOptions.axisLine.show) {\n            startX -= yAxisOptions.axisLine.size;\n          }\n\n          endX = startX - tickLineLength;\n        }\n\n        this._yAxis.ticks().forEach(function (tick) {\n          renderHorizontalLine(_this2._ctx, tick.y, startX, endX);\n        });\n      }\n    }, {\n      key: \"_drawTickLabels\",\n      value: function _drawTickLabels(yAxisOptions) {\n        var _this3 = this;\n\n        var tickText = yAxisOptions.tickText;\n\n        if (!tickText.show) {\n          return;\n        }\n\n        var tickLine = yAxisOptions.tickLine;\n        var tickLineShow = tickLine.show;\n        var tickLineLength = tickLine.length;\n        var labelX;\n\n        if (this._yAxis.isFromYAxisZero()) {\n          labelX = tickText.paddingLeft;\n\n          if (yAxisOptions.axisLine.show) {\n            labelX += yAxisOptions.axisLine.size;\n          }\n\n          if (tickLineShow) {\n            labelX += tickLineLength;\n          }\n\n          this._ctx.textAlign = 'left';\n        } else {\n          labelX = this._width - tickText.paddingRight;\n\n          if (yAxisOptions.axisLine.show) {\n            labelX -= yAxisOptions.axisLine.size;\n          }\n\n          if (tickLineShow) {\n            labelX -= tickLineLength;\n          }\n\n          this._ctx.textAlign = 'right';\n        }\n\n        this._ctx.textBaseline = 'middle';\n        this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family);\n        this._ctx.fillStyle = tickText.color;\n\n        this._yAxis.ticks().forEach(function (tick) {\n          _this3._ctx.fillText(tick.v, labelX, tick.y);\n        });\n\n        this._ctx.textAlign = 'left';\n      }\n      /**\n       * 绘制技术指标最后值\n       * @param yAxisOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawTechnicalIndicatorLastValue\",\n      value: function _drawTechnicalIndicatorLastValue(yAxisOptions) {\n        var _this4 = this;\n\n        var technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator;\n\n        var lastValueMarkOptions = technicalIndicatorOptions.lastValueMark;\n\n        var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n        if (!lastValueMarkOptions.show || !lastValueMarkOptions.text.show) {\n          return;\n        }\n\n        var dataList = this._chartData.dataList();\n\n        technicalIndicators.forEach(function (technicalIndicator) {\n          var technicalIndicatorResult = technicalIndicator.result || [];\n          var dataSize = technicalIndicatorResult.length;\n          var technicalIndicatorData = technicalIndicatorResult[dataSize - 1] || {};\n          var plots = technicalIndicator.plots;\n          var cbData = {\n            preData: {\n              kLineData: dataList[dataSize - 2],\n              technicalIndicatorData: technicalIndicatorResult[dataSize - 2]\n            },\n            currentData: {\n              kLineData: dataList[dataSize - 1],\n              technicalIndicatorData: technicalIndicatorData\n            },\n            nextData: {\n              kLineData: null,\n              technicalIndicatorData: null\n            }\n          };\n          var precision = technicalIndicator.precision;\n          var styles = technicalIndicator.styles || technicalIndicatorOptions;\n          var colors = styles.line.colors || [];\n          var colorSize = colors.length;\n          var lineCount = 0;\n          plots.forEach(function (plot) {\n            var value = technicalIndicatorData[plot.key];\n            var backgroundColor;\n\n            switch (plot.type) {\n              case TechnicalIndicatorPlotType.CIRCLE:\n                {\n                  backgroundColor = plot.color && plot.color(cbData, styles) || styles.circle.noChangeColor;\n                  break;\n                }\n\n              case TechnicalIndicatorPlotType.BAR:\n                {\n                  backgroundColor = plot.color && plot.color(cbData, styles) || styles.bar.noChangeColor;\n                  break;\n                }\n\n              case TechnicalIndicatorPlotType.LINE:\n                {\n                  backgroundColor = colors[lineCount % colorSize];\n                  lineCount++;\n                  break;\n                }\n            }\n\n            if (isValid(value)) {\n              _this4._drawMarkLabel(yAxisOptions, value, precision, technicalIndicator.shouldFormatBigNumber, _objectSpread2(_objectSpread2({}, lastValueMarkOptions.text), {}, {\n                backgroundColor: backgroundColor\n              }));\n            }\n          });\n        });\n      }\n      /**\n       * 绘制最新价文字\n       * @private\n       */\n\n    }, {\n      key: \"_drawLastPriceLabel\",\n      value: function _drawLastPriceLabel(yAxisOptions) {\n        if (!this._yAxis.isCandleYAxis()) {\n          return;\n        }\n\n        var priceMarkOptions = this._chartData.styleOptions().candle.priceMark;\n\n        var lastPriceMarkOptions = priceMarkOptions.last;\n\n        if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.text.show) {\n          return;\n        }\n\n        var dataList = this._chartData.dataList();\n\n        var kLineData = dataList[dataList.length - 1];\n\n        if (!kLineData) {\n          return;\n        }\n\n        var close = kLineData.close;\n        var open = kLineData.open;\n        var backgroundColor;\n\n        if (close > open) {\n          backgroundColor = lastPriceMarkOptions.upColor;\n        } else if (close < open) {\n          backgroundColor = lastPriceMarkOptions.downColor;\n        } else {\n          backgroundColor = lastPriceMarkOptions.noChangeColor;\n        }\n\n        this._drawMarkLabel(yAxisOptions, close, this._chartData.pricePrecision(), false, _objectSpread2(_objectSpread2({}, lastPriceMarkOptions.text), {}, {\n          backgroundColor: backgroundColor\n        }));\n      }\n      /**\n       * 绘制标记label\n       * @param yAxisOptions\n       * @param value\n       * @param precision\n       * @param shouldFormatBigNumber\n       * @param size\n       * @param weight\n       * @param family\n       * @param color\n       * @param backgroundColor\n       * @param borderRadius\n       * @param paddingLeft\n       * @param paddingTop\n       * @param paddingRight\n       * @param paddingBottom\n       * @private\n       */\n\n    }, {\n      key: \"_drawMarkLabel\",\n      value: function _drawMarkLabel(yAxisOptions, value, precision, shouldFormatBigNumber, _ref) {\n        var size = _ref.size,\n            weight = _ref.weight,\n            family = _ref.family,\n            color = _ref.color,\n            backgroundColor = _ref.backgroundColor,\n            borderRadius = _ref.borderRadius,\n            paddingLeft = _ref.paddingLeft,\n            paddingTop = _ref.paddingTop,\n            paddingRight = _ref.paddingRight,\n            paddingBottom = _ref.paddingBottom;\n\n        var valueY = this._yAxis.convertToNicePixel(value);\n\n        var text;\n\n        if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n          var fromData = (this._chartData.visibleDataList()[0] || {}).data || {};\n          var fromClose = fromData.close;\n          text = \"\".concat(((value - fromClose) / fromClose * 100).toFixed(2), \"%\");\n        } else {\n          text = formatPrecision(value, precision);\n\n          if (shouldFormatBigNumber) {\n            text = formatBigNumber(text);\n          }\n        }\n\n        this._ctx.font = createFont(size, weight, family);\n        var rectWidth = calcTextWidth(this._ctx, text) + paddingLeft + paddingRight;\n        var rectHeight = paddingTop + size + paddingBottom;\n        var rectStartX;\n\n        if (this._yAxis.isFromYAxisZero()) {\n          rectStartX = 0;\n        } else {\n          rectStartX = this._width - rectWidth;\n        }\n\n        renderFillRoundRect(this._ctx, backgroundColor, rectStartX, valueY - paddingTop - size / 2, rectWidth, rectHeight, borderRadius);\n        this._ctx.textBaseline = 'middle';\n        renderText(this._ctx, color, rectStartX + paddingLeft, valueY, text);\n      }\n    }]);\n\n    return YAxisView;\n  }(View);\n\n  var YAxisOverlayView = /*#__PURE__*/function (_View) {\n    _inherits(YAxisOverlayView, _View);\n\n    var _super = _createSuper(YAxisOverlayView);\n\n    function YAxisOverlayView(container, chartData, yAxis, additionalDataProvider) {\n      var _this;\n\n      _classCallCheck(this, YAxisOverlayView);\n\n      _this = _super.call(this, container, chartData);\n      _this._yAxis = yAxis;\n      _this._additionalDataProvider = additionalDataProvider;\n      return _this;\n    }\n\n    _createClass(YAxisOverlayView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        var _this2 = this;\n\n        this._ctx.textBaseline = 'middle';\n\n        if (this._yAxis.isCandleYAxis()) {\n          // 绘制标签\n          var tags = this._chartData.tags();\n\n          tags.forEach(function (tag) {\n            tag.drawText(_this2._ctx);\n          });\n        }\n\n        this._drawCrossHairLabel();\n      }\n    }, {\n      key: \"_drawCrossHairLabel\",\n      value: function _drawCrossHairLabel() {\n        var crosshair = this._chartData.crosshair();\n\n        if (crosshair.paneId !== this._additionalDataProvider.id() || this._chartData.dataList().length === 0) {\n          return;\n        }\n\n        var styleOptions = this._chartData.styleOptions();\n\n        var crosshairOptions = styleOptions.crosshair;\n        var crosshairHorizontalOptions = crosshairOptions.horizontal;\n        var crosshairHorizontalTextOptions = crosshairHorizontalOptions.text;\n\n        if (!crosshairOptions.show || !crosshairHorizontalOptions.show || !crosshairHorizontalTextOptions.show) {\n          return;\n        }\n\n        var value = this._yAxis.convertFromPixel(crosshair.y);\n\n        var text;\n\n        if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n          var fromData = (this._chartData.visibleDataList()[0] || {}).data || {};\n          text = \"\".concat(((value - fromData.close) / fromData.close * 100).toFixed(2), \"%\");\n        } else {\n          var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n          var precision = 0;\n          var shouldFormatBigNumber = false;\n\n          if (this._yAxis.isCandleYAxis()) {\n            precision = this._chartData.pricePrecision();\n          } else {\n            technicalIndicators.forEach(function (technicalIndicator) {\n              precision = Math.max(technicalIndicator.precision, precision);\n\n              if (!shouldFormatBigNumber) {\n                shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber;\n              }\n            });\n          }\n\n          text = formatPrecision(value, precision);\n\n          if (shouldFormatBigNumber) {\n            text = formatBigNumber(text);\n          }\n        }\n\n        var textSize = crosshairHorizontalTextOptions.size;\n        this._ctx.font = createFont(textSize, crosshairHorizontalTextOptions.weight, crosshairHorizontalTextOptions.family);\n        var yAxisDataLabelWidth = calcTextWidth(this._ctx, text);\n        var rectStartX;\n        var paddingLeft = crosshairHorizontalTextOptions.paddingLeft;\n        var paddingRight = crosshairHorizontalTextOptions.paddingRight;\n        var paddingTop = crosshairHorizontalTextOptions.paddingTop;\n        var paddingBottom = crosshairHorizontalTextOptions.paddingBottom;\n        var borderSize = crosshairHorizontalTextOptions.borderSize;\n        var rectWidth = yAxisDataLabelWidth + borderSize * 2 + paddingLeft + paddingRight;\n        var rectHeight = textSize + borderSize * 2 + paddingTop + paddingBottom;\n\n        if (this._yAxis.isFromYAxisZero()) {\n          rectStartX = 0;\n        } else {\n          rectStartX = this._width - rectWidth;\n        }\n\n        var rectY = crosshair.y - borderSize - paddingTop - textSize / 2; // 绘制y轴文字外的边框\n\n        renderStrokeFillRoundRect(this._ctx, crosshairHorizontalTextOptions.backgroundColor, crosshairHorizontalTextOptions.borderColor, borderSize, rectStartX, rectY, rectWidth, rectHeight, crosshairHorizontalTextOptions.borderRadius);\n        renderText(this._ctx, crosshairHorizontalTextOptions.color, rectStartX + borderSize + paddingLeft, crosshair.y, text);\n      }\n    }]);\n\n    return YAxisOverlayView;\n  }(View);\n\n  var YAxisWidget = /*#__PURE__*/function (_Widget) {\n    _inherits(YAxisWidget, _Widget);\n\n    var _super = _createSuper(YAxisWidget);\n\n    function YAxisWidget() {\n      _classCallCheck(this, YAxisWidget);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(YAxisWidget, [{\n      key: \"_createMainView\",\n      value: function _createMainView(container, props) {\n        return new YAxisView(container, props.chartData, props.yAxis, props.additionalDataProvider);\n      }\n    }, {\n      key: \"_createOverlayView\",\n      value: function _createOverlayView(container, props) {\n        return new YAxisOverlayView(container, props.chartData, props.yAxis, props.additionalDataProvider);\n      }\n    }]);\n\n    return YAxisWidget;\n  }(Widget);\n\n  var Axis = /*#__PURE__*/function () {\n    function Axis(chartData) {\n      _classCallCheck(this, Axis);\n\n      this._chartData = chartData;\n      this._width = 0;\n      this._height = 0;\n      this._cacheMinValue = 0;\n      this._cacheMaxValue = 0;\n      this._minValue = 0;\n      this._maxValue = 0;\n      this._range = 0;\n      this._ticks = [];\n\n      this._initMeasureCanvas();\n    }\n\n    _createClass(Axis, [{\n      key: \"_initMeasureCanvas\",\n      value: function _initMeasureCanvas() {\n        var measureCanvas = document.createElement('canvas');\n        var pixelRatio = getPixelRatio(measureCanvas);\n        this._measureCtx = measureCanvas.getContext('2d');\n\n        this._measureCtx.scale(pixelRatio, pixelRatio);\n      }\n    }, {\n      key: \"min\",\n      value: function min() {\n        return this._minValue;\n      }\n    }, {\n      key: \"max\",\n      value: function max() {\n        return this._maxValue;\n      }\n    }, {\n      key: \"width\",\n      value: function width() {\n        return this._width;\n      }\n    }, {\n      key: \"height\",\n      value: function height() {\n        return this._height;\n      }\n    }, {\n      key: \"setWidth\",\n      value: function setWidth(width) {\n        this._width = width;\n      }\n    }, {\n      key: \"setHeight\",\n      value: function setHeight(height) {\n        this._height = height;\n      }\n      /**\n       * 获取ticks\n       * @returns {[]|*[]}\n       */\n\n    }, {\n      key: \"ticks\",\n      value: function ticks() {\n        return this._ticks;\n      }\n      /**\n       * 计算轴\n       * @param forceCompute\n       */\n\n    }, {\n      key: \"computeAxis\",\n      value: function computeAxis(forceCompute) {\n        var minMax = this._optimalMinMax(this._computeMinMax());\n\n        this._minValue = minMax.min;\n        this._maxValue = minMax.max;\n        this._range = minMax.range;\n\n        if (this._cacheMinValue !== minMax.min || this._cacheMaxValue !== minMax.max || forceCompute) {\n          this._cacheMinValue = minMax.min;\n          this._cacheMaxValue = minMax.max;\n          this._ticks = this._optimalTicks(this._computeTicks());\n          return true;\n        }\n\n        return false;\n      }\n      /**\n       * 计算最大最小值\n       * @private\n       */\n\n    }, {\n      key: \"_computeMinMax\",\n      value: function _computeMinMax() {}\n      /**\n       * 优化最大最小值\n       * @param min\n       * @param max\n       * @param precision\n       * @private\n       */\n\n    }, {\n      key: \"_optimalMinMax\",\n      value: function _optimalMinMax(_ref) {\n        _ref.min;\n        _ref.max;\n        _ref.precision;\n      }\n      /**\n       * 计算轴上的tick值\n       */\n\n    }, {\n      key: \"_computeTicks\",\n      value: function _computeTicks() {\n        var ticks = [];\n\n        if (this._range >= 0) {\n          var intervalPrecision = this._computeInterval(this._range);\n\n          var interval = intervalPrecision.interval;\n          var precision = intervalPrecision.precision;\n          var first = round(Math.ceil(this._minValue / interval) * interval, precision);\n          var last = round(Math.floor(this._maxValue / interval) * interval, precision);\n          var n = 0;\n          var f = first;\n\n          if (interval !== 0) {\n            while (f <= last) {\n              ticks[n] = {\n                v: f.toFixed(precision)\n              };\n              ++n;\n              f += interval;\n            }\n          }\n        }\n\n        return ticks;\n      }\n      /**\n       * 计算最佳的tick\n       * @param ticks\n       */\n\n    }, {\n      key: \"_optimalTicks\",\n      value: function _optimalTicks(ticks) {}\n      /**\n       * 计算间隔\n       * @private\n       */\n\n    }, {\n      key: \"_computeInterval\",\n      value: function _computeInterval(range) {\n        var interval = nice(range / 8.0);\n        var precision = getPrecision(interval);\n        return {\n          interval: interval,\n          precision: precision\n        };\n      }\n    }]);\n\n    return Axis;\n  }();\n\n  var YAxis = /*#__PURE__*/function (_Axis) {\n    _inherits(YAxis, _Axis);\n\n    var _super = _createSuper(YAxis);\n\n    function YAxis(chartData, isCandleYAxis, additionalDataProvider) {\n      var _this;\n\n      _classCallCheck(this, YAxis);\n\n      _this = _super.call(this, chartData);\n      _this._realRange = 0;\n      _this._isCandleYAxis = isCandleYAxis;\n      _this._additionalDataProvider = additionalDataProvider;\n      return _this;\n    }\n\n    _createClass(YAxis, [{\n      key: \"_computeMinMax\",\n      value: function _computeMinMax() {\n        var _this2 = this;\n\n        var minMaxArray = [Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER];\n        var plotsResult = [];\n        var shouldOhlc = false;\n        var minValue = Number.MAX_SAFE_INTEGER;\n        var maxValue = Number.MIN_SAFE_INTEGER;\n        var technicalIndicatorPrecision = Number.MAX_SAFE_INTEGER;\n\n        var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n        technicalIndicators.forEach(function (tech) {\n          if (!shouldOhlc) {\n            shouldOhlc = tech.shouldOhlc;\n          }\n\n          technicalIndicatorPrecision = Math.min(technicalIndicatorPrecision, tech.precision);\n\n          if (isNumber(tech.minValue)) {\n            minValue = Math.min(minValue, tech.minValue);\n          }\n\n          if (isNumber(tech.maxValue)) {\n            maxValue = Math.max(maxValue, tech.maxValue);\n          }\n\n          plotsResult.push({\n            plots: tech.plots,\n            result: tech.result\n          });\n        });\n        var precision = 4;\n\n        if (this._isCandleYAxis) {\n          var pricePrecision = this._chartData.pricePrecision();\n\n          if (technicalIndicatorPrecision !== Number.MAX_SAFE_INTEGER) {\n            precision = Math.min(technicalIndicatorPrecision, pricePrecision);\n          } else {\n            precision = pricePrecision;\n          }\n        } else {\n          if (technicalIndicatorPrecision !== Number.MAX_SAFE_INTEGER) {\n            precision = technicalIndicatorPrecision;\n          }\n        }\n\n        var visibleDataList = this._chartData.visibleDataList();\n\n        var candleOptions = this._chartData.styleOptions().candle;\n\n        var isArea = candleOptions.type === CandleType.AREA;\n        var areaValueKey = candleOptions.area.value;\n        var shouldCompareHighLow = this._isCandleYAxis && !isArea || !this._isCandleYAxis && shouldOhlc;\n        visibleDataList.forEach(function (_ref) {\n          var index = _ref.index,\n              data = _ref.data;\n\n          if (shouldCompareHighLow) {\n            minMaxArray[0] = Math.min(minMaxArray[0], data.low);\n            minMaxArray[1] = Math.max(minMaxArray[1], data.high);\n          }\n\n          if (_this2._isCandleYAxis && isArea) {\n            minMaxArray[0] = Math.min(minMaxArray[0], data[areaValueKey]);\n            minMaxArray[1] = Math.max(minMaxArray[1], data[areaValueKey]);\n          }\n\n          plotsResult.forEach(function (_ref2) {\n            var plots = _ref2.plots,\n                result = _ref2.result;\n            var technicalIndicatorData = result[index] || {};\n            plots.forEach(function (plot) {\n              var value = technicalIndicatorData[plot.key];\n\n              if (isValid(value)) {\n                minMaxArray[0] = Math.min(minMaxArray[0], value);\n                minMaxArray[1] = Math.max(minMaxArray[1], value);\n              }\n            });\n          });\n        });\n\n        if (minMaxArray[0] !== Number.MAX_SAFE_INTEGER && minMaxArray[1] !== Number.MIN_SAFE_INTEGER) {\n          minMaxArray[0] = Math.min(minValue, minMaxArray[0]);\n          minMaxArray[1] = Math.max(maxValue, minMaxArray[1]);\n        } else {\n          minMaxArray[0] = 0;\n          minMaxArray[1] = 10;\n        }\n\n        return {\n          min: minMaxArray[0],\n          max: minMaxArray[1],\n          precision: precision,\n          specifyMin: minValue,\n          specifyMax: maxValue\n        };\n      }\n    }, {\n      key: \"_optimalMinMax\",\n      value: function _optimalMinMax(_ref3) {\n        var min = _ref3.min,\n            max = _ref3.max,\n            precision = _ref3.precision,\n            specifyMin = _ref3.specifyMin,\n            specifyMax = _ref3.specifyMax;\n        var minValue = min;\n        var maxValue = max;\n        var yAxisType = this.yAxisType();\n        var dif;\n\n        switch (yAxisType) {\n          case YAxisType.PERCENTAGE:\n            {\n              var fromData = (this._chartData.visibleDataList()[0] || {}).data || {};\n\n              if (isNumber(fromData.close)) {\n                minValue = (minValue - fromData.close) / fromData.close * 100;\n                maxValue = (maxValue - fromData.close) / fromData.close * 100;\n              }\n\n              dif = Math.pow(10, -2);\n              break;\n            }\n\n          case YAxisType.LOG:\n            {\n              minValue = log10(minValue);\n              maxValue = log10(maxValue);\n              dif = 0.05 * index10(-precision);\n              break;\n            }\n\n          default:\n            {\n              dif = index10(-precision);\n            }\n        }\n\n        if (minValue === maxValue || Math.abs(minValue - maxValue) < dif) {\n          var minCheck = specifyMin === minValue;\n          var maxCheck = specifyMax === maxValue;\n          minValue = minCheck ? minValue : maxCheck ? minValue - 8 * dif : minValue - 4 * dif;\n          maxValue = maxCheck ? maxValue : minCheck ? maxValue + 8 * dif : maxValue + 4 * dif;\n        }\n\n        var marginOptions;\n\n        if (this._isCandleYAxis) {\n          marginOptions = this._chartData.styleOptions().candle.margin;\n        } else {\n          marginOptions = this._chartData.styleOptions().technicalIndicator.margin;\n        }\n\n        var topRate;\n        var bottomRate;\n\n        if (marginOptions.top > 1) {\n          topRate = marginOptions.top / this._height;\n        } else {\n          topRate = isNumber(marginOptions.top) ? marginOptions.top : 0.2;\n        }\n\n        if (marginOptions.bottom > 1) {\n          bottomRate = marginOptions.bottom / this._height;\n        } else {\n          bottomRate = isNumber(marginOptions.bottom) ? marginOptions.bottom : 0.1;\n        }\n\n        var range = Math.abs(maxValue - minValue); // 保证每次图形绘制上下都留间隙\n\n        minValue = minValue - range * bottomRate;\n        maxValue = maxValue + range * topRate;\n        range = Math.abs(maxValue - minValue);\n\n        if (yAxisType === YAxisType.LOG) {\n          this._realRange = Math.abs(index10(maxValue) - index10(minValue));\n        } else {\n          this._realRange = range;\n        }\n\n        return {\n          min: minValue,\n          max: maxValue,\n          range: range\n        };\n      }\n    }, {\n      key: \"_optimalTicks\",\n      value: function _optimalTicks(ticks) {\n        var _this3 = this;\n\n        var optimalTicks = [];\n        var yAxisType = this.yAxisType();\n\n        var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n        var precision = 0;\n        var shouldFormatBigNumber = false;\n\n        if (this._isCandleYAxis) {\n          precision = this._chartData.pricePrecision();\n        } else {\n          technicalIndicators.forEach(function (technicalIndicator) {\n            precision = Math.max(precision, technicalIndicator.precision);\n\n            if (!shouldFormatBigNumber) {\n              shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber;\n            }\n          });\n        }\n\n        var textHeight = this._chartData.styleOptions().xAxis.tickText.size;\n\n        var intervalPrecision;\n\n        if (yAxisType === YAxisType.LOG) {\n          intervalPrecision = this._computeInterval(this._realRange);\n        }\n\n        var validY;\n        ticks.forEach(function (_ref4) {\n          var v = _ref4.v;\n          var value;\n\n          var y = _this3._innerConvertToPixel(+v);\n\n          switch (yAxisType) {\n            case YAxisType.PERCENTAGE:\n              {\n                value = \"\".concat(formatPrecision(v, 2), \"%\");\n                break;\n              }\n\n            case YAxisType.LOG:\n              {\n                value = round(index10(v), intervalPrecision.precision);\n                y = _this3._innerConvertToPixel(log10(value));\n                value = formatPrecision(value, precision);\n                break;\n              }\n\n            default:\n              {\n                value = formatPrecision(v, precision);\n\n                if (shouldFormatBigNumber) {\n                  value = formatBigNumber(value);\n                }\n\n                break;\n              }\n          }\n\n          if (y > textHeight && y < _this3._height - textHeight && (validY && validY - y > textHeight * 2 || !validY)) {\n            optimalTicks.push({\n              v: value,\n              y: y\n            });\n            validY = y;\n          }\n        });\n        return optimalTicks;\n      }\n      /**\n       * 内部值转换成坐标\n       * @param value\n       * @return {number}\n       * @private\n       */\n\n    }, {\n      key: \"_innerConvertToPixel\",\n      value: function _innerConvertToPixel(value) {\n        return Math.round((1.0 - (value - this._minValue) / this._range) * this._height);\n      }\n      /**\n       * 是否是蜡烛图轴\n       * @return {*}\n       */\n\n    }, {\n      key: \"isCandleYAxis\",\n      value: function isCandleYAxis() {\n        return this._isCandleYAxis;\n      }\n      /**\n       * y轴类型\n       * @return {string|*}\n       */\n\n    }, {\n      key: \"yAxisType\",\n      value: function yAxisType() {\n        if (this._isCandleYAxis) {\n          return this._chartData.styleOptions().yAxis.type;\n        }\n\n        return YAxisType.NORMAL;\n      }\n      /**\n       * 是否从y轴0开始\n       * @return {boolean|*|boolean}\n       */\n\n    }, {\n      key: \"isFromYAxisZero\",\n      value: function isFromYAxisZero() {\n        var yAxisOptions = this._chartData.styleOptions().yAxis;\n\n        return yAxisOptions.position === YAxisPosition.LEFT && yAxisOptions.inside || yAxisOptions.position === YAxisPosition.RIGHT && !yAxisOptions.inside;\n      }\n      /**\n       * 获取自身宽度\n       * @return {number}\n       */\n\n    }, {\n      key: \"getSelfWidth\",\n      value: function getSelfWidth() {\n        var _this4 = this;\n\n        var styleOptions = this._chartData.styleOptions();\n\n        var yAxisOptions = styleOptions.yAxis;\n        var width = yAxisOptions.width;\n\n        if (isNumber(width)) {\n          return width;\n        }\n\n        var yAxisWidth = 0;\n\n        if (yAxisOptions.show) {\n          if (yAxisOptions.axisLine.show) {\n            yAxisWidth += yAxisOptions.axisLine.size;\n          }\n\n          if (yAxisOptions.tickLine.show) {\n            yAxisWidth += yAxisOptions.tickLine.length;\n          }\n\n          if (yAxisOptions.tickText.show) {\n            var textWidth = 0;\n            this._measureCtx.font = createFont(yAxisOptions.tickText.size, yAxisOptions.tickText.weight, yAxisOptions.tickText.family);\n\n            this._ticks.forEach(function (tick) {\n              textWidth = Math.max(textWidth, calcTextWidth(_this4._measureCtx, tick.v));\n            });\n\n            yAxisWidth += yAxisOptions.tickText.paddingLeft + yAxisOptions.tickText.paddingRight + textWidth;\n          }\n        }\n\n        var crosshairOptions = styleOptions.crosshair;\n        var crosshairVerticalTextWidth = 0;\n\n        if (crosshairOptions.show && crosshairOptions.horizontal.show && crosshairOptions.horizontal.text.show) {\n          var technicalIndicators = this._additionalDataProvider.technicalIndicators();\n\n          var technicalIndicatorPrecision = 0;\n          var shouldFormatBigNumber = false;\n          technicalIndicators.forEach(function (technicalIndicator) {\n            technicalIndicatorPrecision = Math.max(technicalIndicator.precision, technicalIndicatorPrecision);\n\n            if (!shouldFormatBigNumber) {\n              shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber;\n            }\n          });\n          this._measureCtx.font = createFont(crosshairOptions.horizontal.text.size, crosshairOptions.horizontal.text.weight, crosshairOptions.horizontal.text.family);\n          var precision = 2;\n\n          if (this.yAxisType() !== YAxisType.PERCENTAGE) {\n            if (this._isCandleYAxis) {\n              var pricePrecision = this._chartData.pricePrecision();\n\n              var lastValueMarkOptions = styleOptions.technicalIndicator.lastValueMark;\n\n              if (lastValueMarkOptions.show && lastValueMarkOptions.text.show) {\n                precision = Math.max(technicalIndicatorPrecision, pricePrecision);\n              } else {\n                precision = pricePrecision;\n              }\n            } else {\n              precision = technicalIndicatorPrecision;\n            }\n          }\n\n          var valueText = formatPrecision(this._maxValue, precision);\n\n          if (shouldFormatBigNumber) {\n            valueText = formatBigNumber(valueText);\n          }\n\n          crosshairVerticalTextWidth += crosshairOptions.horizontal.text.paddingLeft + crosshairOptions.horizontal.text.paddingRight + crosshairOptions.horizontal.text.borderSize * 2 + calcTextWidth(this._measureCtx, valueText);\n        }\n\n        return Math.max(yAxisWidth, crosshairVerticalTextWidth);\n      }\n    }, {\n      key: \"convertFromPixel\",\n      value: function convertFromPixel(pixel) {\n        var value = (1.0 - pixel / this._height) * this._range + this._minValue;\n\n        switch (this.yAxisType()) {\n          case YAxisType.PERCENTAGE:\n            {\n              var fromData = (this._chartData.visibleDataList()[0] || {}).data || {};\n\n              if (isNumber(fromData.close)) {\n                return fromData.close * value / 100 + fromData.close;\n              }\n\n              break;\n            }\n\n          case YAxisType.LOG:\n            {\n              return index10(value);\n            }\n\n          default:\n            {\n              return value;\n            }\n        }\n      }\n    }, {\n      key: \"convertToPixel\",\n      value: function convertToPixel(value) {\n        var v;\n\n        switch (this.yAxisType()) {\n          case YAxisType.PERCENTAGE:\n            {\n              var fromData = (this._chartData.visibleDataList()[0] || {}).data || {};\n\n              if (isNumber(fromData.close)) {\n                v = (value - fromData.close) / fromData.close * 100;\n              }\n\n              break;\n            }\n\n          case YAxisType.LOG:\n            {\n              v = log10(value);\n              break;\n            }\n\n          default:\n            {\n              v = value;\n            }\n        }\n\n        return this._innerConvertToPixel(v);\n      }\n      /**\n       * 将值转换成坐标，即使坐标不在范围内，也会显示在顶部或者底部\n       * @param value\n       * @return {number}\n       */\n\n    }, {\n      key: \"convertToNicePixel\",\n      value: function convertToNicePixel(value) {\n        var y = this.convertToPixel(value);\n        return Math.round(Math.max(this._height * 0.05, Math.min(y, this._height * 0.98)));\n      }\n    }]);\n\n    return YAxis;\n  }(Axis);\n\n  var TechnicalIndicatorPane = /*#__PURE__*/function (_Pane) {\n    _inherits(TechnicalIndicatorPane, _Pane);\n\n    var _super = _createSuper(TechnicalIndicatorPane);\n\n    function TechnicalIndicatorPane(props) {\n      var _this;\n\n      _classCallCheck(this, TechnicalIndicatorPane);\n\n      _this = _super.call(this, props);\n      _this._techs = new Map();\n\n      if ('height' in props) {\n        _this.setHeight(props.height);\n      }\n\n      _this.setTechnicalIndicator(_this._chartData.getTechnicalIndicatorInstance(props.name));\n\n      return _this;\n    }\n\n    _createClass(TechnicalIndicatorPane, [{\n      key: \"_initBefore\",\n      value: function _initBefore(props) {\n        this._id = props.id;\n        this._yAxis = this._createYAxis(props);\n      }\n    }, {\n      key: \"_createYAxis\",\n      value: function _createYAxis(props) {\n        return new YAxis(props.chartData, false, {\n          technicalIndicators: this.technicalIndicators.bind(this)\n        });\n      }\n    }, {\n      key: \"_createMainWidget\",\n      value: function _createMainWidget(container, props) {\n        return new TechnicalIndicatorWidget({\n          container: container,\n          chartData: props.chartData,\n          xAxis: props.xAxis,\n          yAxis: this._yAxis,\n          additionalDataProvider: {\n            technicalIndicators: this.technicalIndicators.bind(this),\n            id: this.id.bind(this)\n          }\n        });\n      }\n    }, {\n      key: \"_createYAxisWidget\",\n      value: function _createYAxisWidget(container, props) {\n        return new YAxisWidget({\n          container: container,\n          chartData: props.chartData,\n          yAxis: this._yAxis,\n          additionalDataProvider: {\n            technicalIndicators: this.technicalIndicators.bind(this),\n            id: this.id.bind(this)\n          }\n        });\n      }\n    }, {\n      key: \"setHeight\",\n      value: function setHeight(height) {\n        _get(_getPrototypeOf(TechnicalIndicatorPane.prototype), \"setHeight\", this).call(this, height);\n\n        this._yAxis.setHeight(height);\n      }\n    }, {\n      key: \"setWidth\",\n      value: function setWidth(mainWidgetWidth, yAxisWidgetWidth) {\n        _get(_getPrototypeOf(TechnicalIndicatorPane.prototype), \"setWidth\", this).call(this, mainWidgetWidth, yAxisWidgetWidth);\n\n        this._yAxis.setWidth(yAxisWidgetWidth);\n      }\n      /**\n       * 获取id\n       * @returns {string}\n       */\n\n    }, {\n      key: \"id\",\n      value: function id() {\n        return this._id;\n      }\n    }, {\n      key: \"yAxis\",\n      value: function yAxis() {\n        return this._yAxis;\n      }\n      /**\n       * 获取技术指标\n       * @return {Map<any, any>}\n       */\n\n    }, {\n      key: \"technicalIndicators\",\n      value: function technicalIndicators() {\n        return this._techs;\n      }\n      /**\n       * 是否无指标\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"isEmptyTechnicalIndicator\",\n      value: function isEmptyTechnicalIndicator() {\n        return this._techs.size === 0;\n      }\n      /**\n       * 移除技术指标\n       * @param name\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"removeTechnicalIndicator\",\n      value: function removeTechnicalIndicator(name) {\n        if (name) {\n          if (this._techs.has(name)) {\n            this._techs.delete(name);\n\n            return true;\n          }\n        } else {\n          this._techs.clear();\n\n          return true;\n        }\n\n        return false;\n      }\n      /**\n       * 设置技术指标类型\n       * @param technicalIndicator\n       * @param isStack\n       */\n\n    }, {\n      key: \"setTechnicalIndicator\",\n      value: function setTechnicalIndicator(technicalIndicator, isStack) {\n        if (technicalIndicator) {\n          if (this._techs.has(technicalIndicator.name)) {\n            return false;\n          }\n\n          var cloneInstance = Object.create(technicalIndicator);\n\n          if (isStack) {\n            this._techs.set(cloneInstance.name, cloneInstance);\n          } else {\n            this._techs = new Map([[cloneInstance.name, cloneInstance]]);\n          }\n\n          this.calcTechnicalIndicator(cloneInstance);\n          return true;\n        }\n\n        return false;\n      }\n      /**\n       * 计算单个技术指标\n       * @param technicalIndicator\n       */\n\n    }, {\n      key: \"calcTechnicalIndicator\",\n      value: function calcTechnicalIndicator(technicalIndicator) {\n        technicalIndicator.result = technicalIndicator.calcTechnicalIndicator(this._chartData.dataList(), technicalIndicator.calcParams, technicalIndicator.plots) || [];\n      }\n      /**\n       * 计算所有技术指标\n       */\n\n    }, {\n      key: \"calcAllTechnicalIndicator\",\n      value: function calcAllTechnicalIndicator() {\n        var _this2 = this;\n\n        this._techs.forEach(function (technicalIndicator) {\n          _this2.calcTechnicalIndicator(technicalIndicator);\n        });\n\n        return this._yAxis.computeAxis();\n      }\n    }]);\n\n    return TechnicalIndicatorPane;\n  }(Pane);\n\n  var CandleView = /*#__PURE__*/function (_TechnicalIndicatorVi) {\n    _inherits(CandleView, _TechnicalIndicatorVi);\n\n    var _super = _createSuper(CandleView);\n\n    function CandleView() {\n      _classCallCheck(this, CandleView);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(CandleView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        this._drawGrid();\n\n        var candleOptions = this._chartData.styleOptions().candle;\n\n        if (candleOptions.type === CandleType.AREA) {\n          this._drawArea(candleOptions);\n        } else {\n          this._drawCandle(candleOptions);\n\n          this._drawLowHighPrice(candleOptions.priceMark, 'high', 'high', Number.MIN_SAFE_INTEGER, [-2, -5], function (price, comparePrice) {\n            if (price > comparePrice) {\n              return price;\n            }\n          });\n\n          this._drawLowHighPrice(candleOptions.priceMark, 'low', 'low', Number.MAX_SAFE_INTEGER, [2, 5], function (price, comparePrice) {\n            if (price < comparePrice) {\n              return price;\n            }\n          });\n        }\n\n        this._drawTechnicalIndicators();\n\n        this._drawLastPriceLine(candleOptions.priceMark);\n      }\n      /**\n       * 绘制面积图\n       * @param candleOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawArea\",\n      value: function _drawArea(candleOptions) {\n        var _this = this;\n\n        var linePoints = [];\n        var areaPoints = [];\n        var minY = Number.MAX_SAFE_INTEGER;\n        var areaOptions = candleOptions.area;\n\n        var onDrawing = function onDrawing(x, i, kLineData, halfBarSpace, barSpace, n) {\n          var value = kLineData[areaOptions.value];\n\n          if (isNumber(value)) {\n            var y = _this._yAxis.convertToPixel(value);\n\n            if (n === 0) {\n              var startX = x - halfBarSpace;\n              areaPoints.push({\n                x: startX,\n                y: _this._height\n              });\n              areaPoints.push({\n                x: startX,\n                y: y\n              });\n              linePoints.push({\n                x: startX,\n                y: y\n              });\n            }\n\n            linePoints.push({\n              x: x,\n              y: y\n            });\n            areaPoints.push({\n              x: x,\n              y: y\n            });\n            minY = Math.min(minY, y);\n          }\n        };\n\n        var onDrawEnd = function onDrawEnd() {\n          var areaPointLength = areaPoints.length;\n\n          if (areaPointLength > 0) {\n            var lastPoint = areaPoints[areaPointLength - 1];\n            var halfBarSpace = _this._chartData.barSpace() / 2;\n            var endX = lastPoint.x + halfBarSpace;\n            linePoints.push({\n              x: endX,\n              y: lastPoint.y\n            });\n            areaPoints.push({\n              x: endX,\n              y: lastPoint.y\n            });\n            areaPoints.push({\n              x: endX,\n              y: _this._height\n            });\n          }\n\n          if (linePoints.length > 0) {\n            // 绘制分时线\n            _this._ctx.lineWidth = areaOptions.lineSize;\n            _this._ctx.strokeStyle = areaOptions.lineColor;\n            renderLine(_this._ctx, function () {\n              _this._ctx.beginPath();\n\n              _this._ctx.moveTo(linePoints[0].x, linePoints[0].y);\n\n              for (var i = 1; i < linePoints.length; i++) {\n                _this._ctx.lineTo(linePoints[i].x, linePoints[i].y);\n              }\n\n              _this._ctx.stroke();\n\n              _this._ctx.closePath();\n            });\n          }\n\n          if (areaPoints.length > 0) {\n            // 绘制分时线填充区域\n            var fillColor = areaOptions.fillColor;\n\n            if (isArray(fillColor)) {\n              var gradient = _this._ctx.createLinearGradient(0, _this._height, 0, minY);\n\n              try {\n                fillColor.forEach(function (_ref) {\n                  var offset = _ref.offset,\n                      color = _ref.color;\n                  gradient.addColorStop(offset, color);\n                });\n              } catch (e) {}\n\n              _this._ctx.fillStyle = gradient;\n            } else {\n              _this._ctx.fillStyle = fillColor;\n            }\n\n            _this._ctx.beginPath();\n\n            _this._ctx.moveTo(areaPoints[0].x, areaPoints[0].y);\n\n            for (var i = 1; i < areaPoints.length; i++) {\n              _this._ctx.lineTo(areaPoints[i].x, areaPoints[i].y);\n            }\n\n            _this._ctx.closePath();\n\n            _this._ctx.fill();\n          }\n        };\n\n        this._drawGraphics(onDrawing, onDrawEnd);\n      }\n      /**\n       * 绘制蜡烛\n       * @param candleOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawCandle\",\n      value: function _drawCandle(candleOptions) {\n        var _this2 = this;\n\n        this._drawGraphics(function (x, i, kLineData, halfBarSpace, barSpace) {\n          _this2._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, candleOptions.bar, candleOptions.type);\n        });\n      }\n      /**\n       * 渲染最高最低价格\n       * @param priceMarkOptions\n       * @param optionKey\n       * @param priceKey\n       * @param initPriceValue\n       * @param offsets\n       * @param compare\n       * @private\n       */\n\n    }, {\n      key: \"_drawLowHighPrice\",\n      value: function _drawLowHighPrice(priceMarkOptions, optionKey, priceKey, initPriceValue, offsets, compare) {\n        var _this3 = this;\n\n        var lowHighPriceMarkOptions = priceMarkOptions[optionKey];\n\n        if (!priceMarkOptions.show || !lowHighPriceMarkOptions.show) {\n          return;\n        }\n\n        var visibleDataList = this._chartData.visibleDataList();\n\n        var price = initPriceValue;\n        var pos = -1;\n        visibleDataList.forEach(function (_ref2) {\n          var index = _ref2.index,\n              data = _ref2.data;\n          var comparePrice = compare(formatValue(data, priceKey, initPriceValue), price);\n\n          if (comparePrice) {\n            price = comparePrice;\n            pos = index;\n          }\n        });\n\n        var pricePrecision = this._chartData.pricePrecision();\n\n        var priceY = this._yAxis.convertToPixel(price);\n\n        var startX = this._xAxis.convertToPixel(pos);\n\n        var startY = priceY + offsets[0];\n        this._ctx.textAlign = 'left';\n        this._ctx.lineWidth = 1;\n        this._ctx.strokeStyle = lowHighPriceMarkOptions.color;\n        this._ctx.fillStyle = lowHighPriceMarkOptions.color;\n        renderLine(this._ctx, function () {\n          _this3._ctx.beginPath();\n\n          _this3._ctx.moveTo(startX - 2, startY + offsets[0]);\n\n          _this3._ctx.lineTo(startX, startY);\n\n          _this3._ctx.lineTo(startX + 2, startY + offsets[0]);\n\n          _this3._ctx.stroke();\n\n          _this3._ctx.closePath();\n        }); // 绘制竖线\n\n        var y = startY + offsets[1];\n        renderLine(this._ctx, function () {\n          _this3._ctx.beginPath();\n\n          _this3._ctx.moveTo(startX, startY);\n\n          _this3._ctx.lineTo(startX, y);\n\n          _this3._ctx.lineTo(startX + 5, y);\n\n          _this3._ctx.stroke();\n\n          _this3._ctx.closePath();\n        });\n        this._ctx.font = createFont(lowHighPriceMarkOptions.textSize, lowHighPriceMarkOptions.textWeight, lowHighPriceMarkOptions.textFamily);\n        var text = formatPrecision(price, pricePrecision);\n        this._ctx.textBaseline = 'middle';\n\n        this._ctx.fillText(text, startX + 5 + lowHighPriceMarkOptions.textMargin, y);\n      }\n      /**\n       * 绘制最新价线\n       * @param priceMarkOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawLastPriceLine\",\n      value: function _drawLastPriceLine(priceMarkOptions) {\n        var lastPriceMarkOptions = priceMarkOptions.last;\n\n        if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.line.show) {\n          return;\n        }\n\n        var dataList = this._chartData.dataList();\n\n        var kLineData = dataList[dataList.length - 1];\n\n        if (!kLineData) {\n          return;\n        }\n\n        var close = kLineData.close;\n        var open = kLineData.open;\n\n        var priceY = this._yAxis.convertToNicePixel(close);\n\n        var color;\n\n        if (close > open) {\n          color = lastPriceMarkOptions.upColor;\n        } else if (close < open) {\n          color = lastPriceMarkOptions.downColor;\n        } else {\n          color = lastPriceMarkOptions.noChangeColor;\n        }\n\n        this._ctx.save();\n\n        this._ctx.strokeStyle = color;\n        this._ctx.lineWidth = lastPriceMarkOptions.line.size;\n\n        if (lastPriceMarkOptions.line.style === LineStyle.DASH) {\n          this._ctx.setLineDash(lastPriceMarkOptions.line.dashValue);\n        }\n\n        renderHorizontalLine(this._ctx, priceY, 0, this._width);\n\n        this._ctx.restore();\n      }\n    }]);\n\n    return CandleView;\n  }(TechnicalIndicatorView);\n\n  var CandleOverlayView = /*#__PURE__*/function (_TechnicalIndicatorOv) {\n    _inherits(CandleOverlayView, _TechnicalIndicatorOv);\n\n    var _super = _createSuper(CandleOverlayView);\n\n    function CandleOverlayView() {\n      _classCallCheck(this, CandleOverlayView);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(CandleOverlayView, [{\n      key: \"_drawCover\",\n      value: function _drawCover() {\n        var _this = this;\n\n        this._ctx.textBaseline = 'alphabetic'; // 绘制标签\n\n        var tags = this._chartData.tags();\n\n        tags.forEach(function (tag) {\n          tag.drawMarkLine(_this._ctx);\n        }); // 绘制图形标记\n\n        var graphicMarks = this._chartData.graphicMarks();\n\n        graphicMarks.forEach(function (graphicMark) {\n          graphicMark.draw(_this._ctx);\n        }); // 绘制注解\n\n        var annotations = this._chartData.visibleAnnotations();\n\n        annotations.forEach(function (annotation) {\n          annotation.draw(_this._ctx);\n        });\n      }\n    }, {\n      key: \"_drawTooltip\",\n      value: function _drawTooltip(crosshair, technicalIndicators) {\n        var styleOptions = this._chartData.styleOptions();\n\n        var candleOptions = styleOptions.candle;\n        var candleTooltipOptions = candleOptions.tooltip;\n        var technicalIndicatorOptions = styleOptions.technicalIndicator;\n        var technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip;\n\n        var isDrawCandleTooltip = this._shouldDrawTooltip(crosshair, candleTooltipOptions);\n\n        var isDrawTechnicalIndicatorTooltip = this._shouldDrawTooltip(crosshair, technicalIndicatorTooltipOptions);\n\n        if (candleTooltipOptions.showType === TooltipShowType.RECT && technicalIndicatorTooltipOptions.showType === TooltipShowType.RECT) {\n          this._drawCandleTooltipWithRect(crosshair, technicalIndicators, candleOptions, isDrawCandleTooltip, technicalIndicatorOptions, isDrawTechnicalIndicatorTooltip);\n        } else {\n          if (candleTooltipOptions.showType === TooltipShowType.STANDARD) {\n            this._drawCandleTooltipWithStandard(crosshair.kLineData, candleOptions, isDrawCandleTooltip);\n\n            if (technicalIndicatorTooltipOptions.showType === TooltipShowType.STANDARD) {\n              var offsetTop = isDrawCandleTooltip ? candleTooltipOptions.text.size + candleTooltipOptions.text.marginTop : 0;\n\n              this._drawBatchTechnicalIndicatorToolTip(crosshair, technicalIndicators, technicalIndicatorOptions, offsetTop, isDrawTechnicalIndicatorTooltip);\n            } else {\n              this._drawCandleTooltipWithRect(crosshair, technicalIndicators, candleOptions, false, technicalIndicatorOptions, isDrawTechnicalIndicatorTooltip);\n            }\n          } else {\n            this._drawCandleTooltipWithRect(crosshair, technicalIndicators, candleOptions, isDrawCandleTooltip, technicalIndicatorOptions, false);\n\n            this._drawBatchTechnicalIndicatorToolTip(crosshair, technicalIndicators, technicalIndicatorOptions, 0, isDrawTechnicalIndicatorTooltip);\n          }\n        }\n      }\n      /**\n       * 绘制蜡烛默认的图例\n       * @param kLineData\n       * @param candleOptions\n       * @param isDrawCandleTooltip\n       * @private\n       */\n\n    }, {\n      key: \"_drawCandleTooltipWithStandard\",\n      value: function _drawCandleTooltipWithStandard(kLineData, candleOptions, isDrawCandleTooltip) {\n        var _this2 = this;\n\n        if (!isDrawCandleTooltip) {\n          return;\n        }\n\n        var values = this._getCandleTooltipData(kLineData, candleOptions);\n\n        var candleTooltipOptions = candleOptions.tooltip;\n        var textMarginLeft = candleTooltipOptions.text.marginLeft;\n        var textMarginRight = candleTooltipOptions.text.marginRight;\n        var textSize = candleTooltipOptions.text.size;\n        var textColor = candleTooltipOptions.text.color;\n        var labels = candleTooltipOptions.labels;\n        this._ctx.textBaseline = 'top';\n        this._ctx.font = createFont(textSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family);\n        var labelX = textMarginLeft;\n        var labelY = candleTooltipOptions.text.marginTop;\n        labels.forEach(function (label, i) {\n          var labelWidth = calcTextWidth(_this2._ctx, label);\n          renderText(_this2._ctx, textColor, labelX, labelY, label);\n          labelX += labelWidth;\n          var value = values[i] || candleTooltipOptions.defaultValue;\n          var valueText;\n          var valueColor;\n\n          if (isObject(value)) {\n            valueText = value.value || candleTooltipOptions.defaultValue;\n            valueColor = value.color || textColor;\n          } else {\n            valueColor = textColor;\n            valueText = value;\n          }\n\n          var textWidth = calcTextWidth(_this2._ctx, valueText);\n          renderText(_this2._ctx, valueColor, labelX, labelY, valueText);\n          labelX += textWidth + textMarginLeft + textMarginRight;\n        });\n      }\n      /**\n       * 绘制蜡烛图矩形类型图例\n       * @param crosshair\n       * @param technicalIndicators\n       * @param candleOptions\n       * @param isDrawCandleTooltip\n       * @param technicalIndicatorOptions\n       * @param isDrawTechnicalIndicatorTooltip\n       * @private\n       */\n\n    }, {\n      key: \"_drawCandleTooltipWithRect\",\n      value: function _drawCandleTooltipWithRect(crosshair, technicalIndicators, candleOptions, isDrawCandleTooltip, technicalIndicatorOptions, isDrawTechnicalIndicatorTooltip) {\n        var _this3 = this;\n\n        if (!isDrawCandleTooltip && !isDrawTechnicalIndicatorTooltip) {\n          return;\n        }\n\n        var candleTooltipOptions = candleOptions.tooltip;\n        var baseLabels = candleTooltipOptions.labels;\n\n        var baseValues = this._getCandleTooltipData(crosshair.kLineData, candleOptions);\n\n        var baseTextMarginLeft = candleTooltipOptions.text.marginLeft;\n        var baseTextMarginRight = candleTooltipOptions.text.marginRight;\n        var baseTextMarginTop = candleTooltipOptions.text.marginTop;\n        var baseTextMarginBottom = candleTooltipOptions.text.marginBottom;\n        var baseTextSize = candleTooltipOptions.text.size;\n        var baseTextColor = candleTooltipOptions.text.color;\n        var rectOptions = candleTooltipOptions.rect;\n        var rectBorderSize = rectOptions.borderSize;\n        var rectPaddingLeft = rectOptions.paddingLeft;\n        var rectPaddingRight = rectOptions.paddingRight;\n        var rectPaddingTop = rectOptions.paddingTop;\n        var rectPaddingBottom = rectOptions.paddingBottom;\n        var rectLeft = rectOptions.offsetLeft;\n        var rectRight = rectOptions.offsetRight;\n        var maxLabelWidth = 0;\n        var rectWidth = 0;\n        var rectHeight = 0;\n\n        this._ctx.save();\n\n        this._ctx.textBaseline = 'top';\n\n        if (isDrawCandleTooltip) {\n          this._ctx.font = createFont(baseTextSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family);\n          baseLabels.forEach(function (label, i) {\n            var value = baseValues[i];\n            var v;\n\n            if (isObject(value)) {\n              v = value.value || candleTooltipOptions.defaultValue;\n            } else {\n              v = value;\n            }\n\n            var text = \"\".concat(label).concat(v);\n            var labelWidth = calcTextWidth(_this3._ctx, text) + baseTextMarginLeft + baseTextMarginRight;\n            maxLabelWidth = Math.max(maxLabelWidth, labelWidth);\n          });\n          rectHeight += (baseTextMarginBottom + baseTextMarginTop + baseTextSize) * baseLabels.length;\n        }\n\n        var technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip;\n        var indicatorTextMarginLeft = technicalIndicatorTooltipOptions.text.marginLeft;\n        var indicatorTextMarginRight = technicalIndicatorTooltipOptions.text.marginRight;\n        var indicatorTextMarginTop = technicalIndicatorTooltipOptions.text.marginTop;\n        var indicatorTextMarginBottom = technicalIndicatorTooltipOptions.text.marginBottom;\n        var indicatorTextSize = technicalIndicatorTooltipOptions.text.size;\n        var indicatorTooltipDataList = [];\n\n        var dataList = this._chartData.dataList();\n\n        technicalIndicators.forEach(function (tech) {\n          var result = tech.result;\n          indicatorTooltipDataList.push({\n            name: tech.name,\n            tooltipData: getTechnicalIndicatorTooltipData(result[crosshair.dataIndex], tech),\n            cbData: {\n              preData: {\n                kLineData: dataList[crosshair.dataIndex - 1],\n                technicalIndicatorData: result[crosshair.dataIndex - 1]\n              },\n              currentData: {\n                kLineData: dataList[crosshair.dataIndex],\n                technicalIndicatorData: result[crosshair.dataIndex]\n              },\n              nextData: {\n                kLineData: dataList[crosshair.dataIndex + 1],\n                technicalIndicatorData: result[crosshair.dataIndex + 1]\n              }\n            }\n          });\n        });\n\n        if (isDrawTechnicalIndicatorTooltip) {\n          this._ctx.font = createFont(indicatorTextSize, technicalIndicatorTooltipOptions.text.weight, technicalIndicatorTooltipOptions.text.family);\n          indicatorTooltipDataList.forEach(function (_ref) {\n            var tooltipData = _ref.tooltipData;\n            tooltipData.values.forEach(function (_ref2) {\n              var title = _ref2.title,\n                  value = _ref2.value;\n\n              if (isValid(title)) {\n                var v = value || technicalIndicatorTooltipOptions.defaultValue;\n                var text = \"\".concat(title).concat(v);\n                var labelWidth = calcTextWidth(_this3._ctx, text) + indicatorTextMarginLeft + indicatorTextMarginRight;\n                maxLabelWidth = Math.max(maxLabelWidth, labelWidth);\n                rectHeight += indicatorTextMarginTop + indicatorTextMarginBottom + indicatorTextSize;\n              }\n            });\n          });\n        }\n\n        rectWidth += maxLabelWidth;\n\n        if (rectWidth === 0 || rectHeight === 0) {\n          return;\n        }\n\n        rectWidth += rectBorderSize * 2 + rectPaddingLeft + rectPaddingRight;\n        rectHeight += rectBorderSize * 2 + rectPaddingTop + rectPaddingBottom;\n        var centerX = this._width / 2;\n        var rectX;\n\n        if (crosshair.realX < centerX) {\n          rectX = this._width - rectRight - rectWidth;\n        } else {\n          rectX = rectLeft;\n        }\n\n        var rectY = rectOptions.offsetTop;\n        var radius = rectOptions.borderRadius;\n        renderFillRoundRect(this._ctx, rectOptions.fillColor, rectX, rectY, rectWidth, rectHeight, radius);\n        renderStrokeRoundRect(this._ctx, rectOptions.borderColor, rectBorderSize, rectX, rectY, rectWidth, rectHeight, radius);\n        var baseLabelX = rectX + rectBorderSize + rectPaddingLeft + baseTextMarginLeft;\n        var labelY = rectY + rectBorderSize + rectPaddingTop;\n\n        if (isDrawCandleTooltip) {\n          // 开始渲染基础数据文字\n          this._ctx.font = createFont(baseTextSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family);\n          baseLabels.forEach(function (label, i) {\n            labelY += baseTextMarginTop;\n            _this3._ctx.textAlign = 'left';\n            renderText(_this3._ctx, baseTextColor, baseLabelX, labelY, label);\n            var value = baseValues[i];\n            var text;\n            var color;\n\n            if (isObject(value)) {\n              color = value.color || baseTextColor;\n              text = value.value || candleTooltipOptions.defaultValue;\n            } else {\n              color = baseTextColor;\n              text = value || candleTooltipOptions.defaultValue;\n            }\n\n            _this3._ctx.textAlign = 'right';\n            renderText(_this3._ctx, color, rectX + rectWidth - rectBorderSize - baseTextMarginRight - rectPaddingRight, labelY, text);\n            labelY += baseTextSize + baseTextMarginBottom;\n          });\n        }\n\n        if (isDrawTechnicalIndicatorTooltip) {\n          // 开始渲染指标数据文字\n          var _technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator;\n\n          var indicatorLabelX = rectX + rectBorderSize + rectPaddingLeft + indicatorTextMarginLeft;\n          this._ctx.font = createFont(indicatorTextSize, technicalIndicatorTooltipOptions.text.weight, technicalIndicatorTooltipOptions.text.family);\n          indicatorTooltipDataList.forEach(function (_ref3) {\n            var name = _ref3.name,\n                tooltipData = _ref3.tooltipData,\n                cbData = _ref3.cbData;\n            var tech = technicalIndicators.get(name);\n            var styles = tech.styles || _technicalIndicatorOptions;\n            var colors = styles.line.colors;\n            var colorSize = colors.length;\n            var plots = tech.plots;\n            var lineCount = 0;\n            var valueColor;\n            plots.forEach(function (plot, i) {\n              switch (plot.type) {\n                case TechnicalIndicatorPlotType.CIRCLE:\n                  {\n                    valueColor = plot.color && plot.color(cbData, styles) || styles.circle.noChangeColor;\n                    break;\n                  }\n\n                case TechnicalIndicatorPlotType.BAR:\n                  {\n                    valueColor = plot.color && plot.color(cbData, styles) || styles.bar.noChangeColor;\n                    break;\n                  }\n\n                case TechnicalIndicatorPlotType.LINE:\n                  {\n                    valueColor = colors[lineCount % colorSize] || styles.text.color;\n                    lineCount++;\n                    break;\n                  }\n              }\n\n              var value = tooltipData.values[i];\n\n              if (isValid(value.title)) {\n                labelY += indicatorTextMarginTop;\n                _this3._ctx.textAlign = 'left';\n                _this3._ctx.fillStyle = valueColor;\n\n                _this3._ctx.fillText(\"\".concat(value.title), indicatorLabelX, labelY);\n\n                _this3._ctx.textAlign = 'right';\n\n                _this3._ctx.fillText(value.value || technicalIndicatorTooltipOptions.defaultValue, rectX + rectWidth - rectBorderSize - indicatorTextMarginRight - rectPaddingRight, labelY);\n\n                labelY += indicatorTextSize + indicatorTextMarginBottom;\n              }\n            });\n          });\n        }\n\n        this._ctx.restore();\n      }\n      /**\n       * 获取蜡烛提示数据\n       * @param kLineData\n       * @param candleOptions\n       * @returns {*}\n       * @private\n       */\n\n    }, {\n      key: \"_getCandleTooltipData\",\n      value: function _getCandleTooltipData(kLineData, candleOptions) {\n        var _this4 = this;\n\n        var baseValues = candleOptions.tooltip.values;\n        var values = [];\n\n        if (baseValues) {\n          if (isFunction(baseValues)) {\n            values = baseValues(kLineData, candleOptions) || [];\n          } else if (isArray(baseValues)) {\n            values = baseValues;\n          }\n        } else {\n          var pricePrecision = this._chartData.pricePrecision();\n\n          var volumePrecision = this._chartData.volumePrecision();\n\n          values = [formatValue(kLineData, 'timestamp'), formatValue(kLineData, 'open'), formatValue(kLineData, 'close'), formatValue(kLineData, 'high'), formatValue(kLineData, 'low'), formatValue(kLineData, 'volume')];\n          values.forEach(function (value, index) {\n            switch (index) {\n              case 0:\n                {\n                  values[index] = formatDate(_this4._chartData.dateTimeFormat(), value, 'YYYY-MM-DD hh:mm');\n                  break;\n                }\n\n              case values.length - 1:\n                {\n                  values[index] = formatBigNumber(formatPrecision(value, volumePrecision));\n                  break;\n                }\n\n              default:\n                {\n                  values[index] = formatPrecision(value, pricePrecision);\n                  break;\n                }\n            }\n          });\n        }\n\n        return values;\n      }\n    }]);\n\n    return CandleOverlayView;\n  }(TechnicalIndicatorOverlayView);\n\n  var CandleWidget = /*#__PURE__*/function (_TechnicalIndicatorWi) {\n    _inherits(CandleWidget, _TechnicalIndicatorWi);\n\n    var _super = _createSuper(CandleWidget);\n\n    function CandleWidget() {\n      _classCallCheck(this, CandleWidget);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(CandleWidget, [{\n      key: \"_createMainView\",\n      value: function _createMainView(container, props) {\n        return new CandleView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider);\n      }\n    }, {\n      key: \"_createOverlayView\",\n      value: function _createOverlayView(container, props) {\n        return new CandleOverlayView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider);\n      }\n    }]);\n\n    return CandleWidget;\n  }(TechnicalIndicatorWidget);\n\n  var CandlePane = /*#__PURE__*/function (_TechnicalIndicatorPa) {\n    _inherits(CandlePane, _TechnicalIndicatorPa);\n\n    var _super = _createSuper(CandlePane);\n\n    function CandlePane() {\n      _classCallCheck(this, CandlePane);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(CandlePane, [{\n      key: \"_createYAxis\",\n      value: function _createYAxis(props) {\n        return new YAxis(props.chartData, true, {\n          technicalIndicators: this.technicalIndicators.bind(this)\n        });\n      }\n    }, {\n      key: \"_createMainWidget\",\n      value: function _createMainWidget(container, props) {\n        return new CandleWidget({\n          container: container,\n          chartData: props.chartData,\n          xAxis: props.xAxis,\n          yAxis: this._yAxis,\n          additionalDataProvider: {\n            technicalIndicators: this.technicalIndicators.bind(this),\n            id: this.id.bind(this)\n          }\n        });\n      }\n    }]);\n\n    return CandlePane;\n  }(TechnicalIndicatorPane);\n\n  var XAxisView = /*#__PURE__*/function (_View) {\n    _inherits(XAxisView, _View);\n\n    var _super = _createSuper(XAxisView);\n\n    function XAxisView(container, chartData, xAxis) {\n      var _this;\n\n      _classCallCheck(this, XAxisView);\n\n      _this = _super.call(this, container, chartData);\n      _this._xAxis = xAxis;\n      return _this;\n    }\n\n    _createClass(XAxisView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        var xAxisOptions = this._chartData.styleOptions().xAxis;\n\n        if (xAxisOptions.show) {\n          this._drawAxisLine(xAxisOptions);\n\n          this._drawTickLines(xAxisOptions);\n\n          this._drawTickLabels(xAxisOptions);\n        }\n      }\n    }, {\n      key: \"_drawAxisLine\",\n      value: function _drawAxisLine(xAxisOptions) {\n        var xAxisLine = xAxisOptions.axisLine;\n\n        if (!xAxisLine.show) {\n          return;\n        }\n\n        this._ctx.strokeStyle = xAxisLine.color;\n        this._ctx.lineWidth = xAxisLine.size;\n        renderHorizontalLine(this._ctx, 0, 0, this._width);\n      }\n    }, {\n      key: \"_drawTickLines\",\n      value: function _drawTickLines(xAxisOptions) {\n        var _this2 = this;\n\n        var tickLine = xAxisOptions.tickLine;\n\n        if (!tickLine.show) {\n          return;\n        }\n\n        this._ctx.lineWidth = tickLine.size;\n        this._ctx.strokeStyle = tickLine.color;\n        var startY = xAxisOptions.axisLine.show ? xAxisOptions.axisLine.size : 0;\n        var endY = startY + tickLine.length;\n\n        this._xAxis.ticks().forEach(function (tick) {\n          renderVerticalLine(_this2._ctx, tick.x, startY, endY);\n        });\n      }\n    }, {\n      key: \"_drawTickLabels\",\n      value: function _drawTickLabels(xAxisOptions) {\n        var tickText = xAxisOptions.tickText;\n\n        if (!tickText.show) {\n          return;\n        }\n\n        var tickLine = xAxisOptions.tickLine;\n        this._ctx.textBaseline = 'top';\n        this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family);\n        this._ctx.textAlign = 'center';\n        this._ctx.fillStyle = tickText.color;\n        var labelY = tickText.paddingTop;\n\n        if (xAxisOptions.axisLine.show) {\n          labelY += xAxisOptions.axisLine.size;\n        }\n\n        if (tickLine.show) {\n          labelY += tickLine.length;\n        }\n\n        var ticks = this._xAxis.ticks();\n\n        var tickLength = ticks.length;\n\n        for (var i = 0; i < tickLength; i++) {\n          this._ctx.fillText(ticks[i].v, ticks[i].x, labelY);\n        }\n      }\n    }]);\n\n    return XAxisView;\n  }(View);\n\n  var XAxisOverlayView = /*#__PURE__*/function (_View) {\n    _inherits(XAxisOverlayView, _View);\n\n    var _super = _createSuper(XAxisOverlayView);\n\n    function XAxisOverlayView(container, chartData, xAxis) {\n      var _this;\n\n      _classCallCheck(this, XAxisOverlayView);\n\n      _this = _super.call(this, container, chartData);\n      _this._xAxis = xAxis;\n      return _this;\n    }\n\n    _createClass(XAxisOverlayView, [{\n      key: \"_draw\",\n      value: function _draw() {\n        this._drawCrosshairLabel();\n      }\n    }, {\n      key: \"_drawCrosshairLabel\",\n      value: function _drawCrosshairLabel() {\n        var crosshair = this._chartData.crosshair();\n\n        if (!crosshair.paneId) {\n          return;\n        }\n\n        var crosshairOptions = this._chartData.styleOptions().crosshair;\n\n        var crosshairVerticalOptions = crosshairOptions.vertical;\n        var crosshairVerticalTextOptions = crosshairVerticalOptions.text;\n\n        if (!crosshairOptions.show || !crosshairVerticalOptions.show || !crosshairVerticalTextOptions.show || crosshair.dataIndex !== crosshair.realDataIndex) {\n          return;\n        }\n\n        var x = crosshair.realX;\n        var timestamp = crosshair.kLineData.timestamp;\n        var text = formatDate(this._chartData.dateTimeFormat(), timestamp, 'YYYY-MM-DD hh:mm');\n        var textSize = crosshairVerticalTextOptions.size;\n        this._ctx.font = createFont(textSize, crosshairVerticalTextOptions.weight, crosshairVerticalTextOptions.family);\n        var labelWidth = calcTextWidth(this._ctx, text);\n        var labelX = x - labelWidth / 2;\n        var paddingLeft = crosshairVerticalTextOptions.paddingLeft;\n        var paddingRight = crosshairVerticalTextOptions.paddingRight;\n        var paddingTop = crosshairVerticalTextOptions.paddingTop;\n        var paddingBottom = crosshairVerticalTextOptions.paddingBottom;\n        var borderSize = crosshairVerticalTextOptions.borderSize; // 保证整个x轴上的提示文字总是完全显示\n\n        if (labelX < paddingLeft + borderSize) {\n          labelX = paddingLeft + borderSize;\n        } else if (labelX > this._width - labelWidth - borderSize - paddingRight) {\n          labelX = this._width - labelWidth - borderSize - paddingRight;\n        }\n\n        var rectX = labelX - borderSize - paddingLeft;\n        var rectWidth = labelWidth + borderSize * 2 + paddingRight + paddingLeft;\n        var rectHeight = textSize + borderSize * 2 + paddingTop + paddingBottom;\n        renderStrokeFillRoundRect(this._ctx, crosshairVerticalTextOptions.backgroundColor, crosshairVerticalTextOptions.borderColor, borderSize, rectX, 0, rectWidth, rectHeight, crosshairVerticalTextOptions.borderRadius); // 绘制轴上的提示文字\n\n        this._ctx.textBaseline = 'top';\n        renderText(this._ctx, crosshairVerticalTextOptions.color, labelX, borderSize + paddingTop, text);\n      }\n    }]);\n\n    return XAxisOverlayView;\n  }(View);\n\n  var XAxisWidget = /*#__PURE__*/function (_Widget) {\n    _inherits(XAxisWidget, _Widget);\n\n    var _super = _createSuper(XAxisWidget);\n\n    function XAxisWidget() {\n      _classCallCheck(this, XAxisWidget);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(XAxisWidget, [{\n      key: \"_createMainView\",\n      value: function _createMainView(container, props) {\n        return new XAxisView(container, props.chartData, props.xAxis);\n      }\n    }, {\n      key: \"_createOverlayView\",\n      value: function _createOverlayView(container, props) {\n        return new XAxisOverlayView(container, props.chartData, props.xAxis);\n      }\n    }]);\n\n    return XAxisWidget;\n  }(Widget);\n\n  var XAxis = /*#__PURE__*/function (_Axis) {\n    _inherits(XAxis, _Axis);\n\n    var _super = _createSuper(XAxis);\n\n    function XAxis() {\n      _classCallCheck(this, XAxis);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(XAxis, [{\n      key: \"_computeMinMax\",\n      value: function _computeMinMax() {\n        return {\n          min: this._chartData.from(),\n          max: this._chartData.to() - 1\n        };\n      }\n    }, {\n      key: \"_optimalMinMax\",\n      value: function _optimalMinMax(_ref) {\n        var min = _ref.min,\n            max = _ref.max;\n        return {\n          min: min,\n          max: max,\n          range: max - min + 1\n        };\n      }\n    }, {\n      key: \"_optimalTicks\",\n      value: function _optimalTicks(ticks) {\n        var optimalTicks = [];\n        var tickLength = ticks.length;\n\n        var dataList = this._chartData.dataList();\n\n        if (tickLength > 0) {\n          var dateTimeFormat = this._chartData.dateTimeFormat();\n\n          var tickText = this._chartData.styleOptions().xAxis.tickText;\n\n          this._measureCtx.font = createFont(tickText.size, tickText.weight, tickText.family);\n          var defaultLabelWidth = calcTextWidth(this._measureCtx, '00-00 00:00');\n          var pos = parseInt(ticks[0].v, 10);\n          var x = this.convertToPixel(pos);\n          var tickCountDif = 1;\n\n          if (tickLength > 1) {\n            var nextPos = parseInt(ticks[1].v, 10);\n            var nextX = this.convertToPixel(nextPos);\n            var xDif = Math.abs(nextX - x);\n\n            if (xDif < defaultLabelWidth) {\n              tickCountDif = Math.ceil(defaultLabelWidth / xDif);\n            }\n          }\n\n          for (var i = 0; i < tickLength; i += tickCountDif) {\n            var _pos = parseInt(ticks[i].v, 10);\n\n            var kLineData = dataList[_pos];\n            var timestamp = kLineData.timestamp;\n            var label = formatDate(dateTimeFormat, timestamp, 'hh:mm');\n\n            if (i !== 0) {\n              var prePos = parseInt(ticks[i - tickCountDif].v, 10);\n              var preKLineData = dataList[prePos];\n              var preTimestamp = preKLineData.timestamp;\n              label = this._optimalTickLabel(dateTimeFormat, timestamp, preTimestamp) || label;\n            }\n\n            var _x = this.convertToPixel(_pos);\n\n            optimalTicks.push({\n              v: label,\n              x: _x,\n              oV: timestamp\n            });\n          }\n\n          var optimalTickLength = optimalTicks.length;\n\n          if (optimalTickLength === 1) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, optimalTicks[0].oV, 'YYYY-MM-DD hh:mm');\n          } else {\n            var firstTimestamp = optimalTicks[0].oV;\n            var secondTimestamp = optimalTicks[1].oV;\n\n            if (optimalTicks[2]) {\n              var thirdV = optimalTicks[2].v;\n\n              if (/^[0-9]{2}-[0-9]{2}$/.test(thirdV)) {\n                optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'MM-DD');\n              } else if (/^[0-9]{4}-[0-9]{2}$/.test(thirdV)) {\n                optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY-MM');\n              } else if (/^[0-9]{4}$/.test(thirdV)) {\n                optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY');\n              }\n            } else {\n              optimalTicks[0].v = this._optimalTickLabel(dateTimeFormat, firstTimestamp, secondTimestamp) || optimalTicks[0].v;\n            }\n          }\n        }\n\n        return optimalTicks;\n      }\n    }, {\n      key: \"_optimalTickLabel\",\n      value: function _optimalTickLabel(dateTimeFormat, timestamp, comparedTimestamp) {\n        var year = formatDate(dateTimeFormat, timestamp, 'YYYY');\n        var month = formatDate(dateTimeFormat, timestamp, 'YYYY-MM');\n        var day = formatDate(dateTimeFormat, timestamp, 'MM-DD');\n\n        if (year !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY')) {\n          return year;\n        } else if (month !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY-MM')) {\n          return month;\n        } else if (day !== formatDate(dateTimeFormat, comparedTimestamp, 'MM-DD')) {\n          return day;\n        }\n\n        return null;\n      }\n      /**\n       * 获取自身高度\n       */\n\n    }, {\n      key: \"getSelfHeight\",\n      value: function getSelfHeight() {\n        var stylOptions = this._chartData.styleOptions();\n\n        var xAxisOptions = stylOptions.xAxis;\n        var height = xAxisOptions.height;\n\n        if (isNumber(height)) {\n          return height;\n        }\n\n        var crosshairOptions = stylOptions.crosshair;\n        var xAxisHeight = 0;\n\n        if (xAxisOptions.show) {\n          if (xAxisOptions.axisLine.show) {\n            xAxisHeight += xAxisOptions.axisLine.size;\n          }\n\n          if (xAxisOptions.tickLine.show) {\n            xAxisHeight += xAxisOptions.tickLine.length;\n          }\n\n          if (xAxisOptions.tickText.show) {\n            xAxisHeight += xAxisOptions.tickText.paddingTop + xAxisOptions.tickText.paddingBottom + xAxisOptions.tickText.size;\n          }\n        }\n\n        var crosshairVerticalTextHeight = 0;\n\n        if (crosshairOptions.show && crosshairOptions.vertical.show && crosshairOptions.vertical.text.show) {\n          crosshairVerticalTextHeight += crosshairOptions.vertical.text.paddingTop + crosshairOptions.vertical.text.paddingBottom + crosshairOptions.vertical.text.borderSize * 2 + crosshairOptions.vertical.text.size;\n        }\n\n        return Math.max(xAxisHeight, crosshairVerticalTextHeight);\n      }\n    }, {\n      key: \"convertFromPixel\",\n      value: function convertFromPixel(pixel) {\n        return this._chartData.coordinateToDataIndex(pixel);\n      }\n    }, {\n      key: \"convertToPixel\",\n      value: function convertToPixel(value) {\n        return this._chartData.dataIndexToCoordinate(value);\n      }\n    }]);\n\n    return XAxis;\n  }(Axis);\n\n  var XAxisPane = /*#__PURE__*/function (_Pane) {\n    _inherits(XAxisPane, _Pane);\n\n    var _super = _createSuper(XAxisPane);\n\n    function XAxisPane() {\n      _classCallCheck(this, XAxisPane);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(XAxisPane, [{\n      key: \"_initBefore\",\n      value: function _initBefore() {\n        this._xAxis = new XAxis(this._chartData);\n      }\n    }, {\n      key: \"_createMainWidget\",\n      value: function _createMainWidget(container, props) {\n        return new XAxisWidget({\n          container: container,\n          chartData: props.chartData,\n          xAxis: this._xAxis\n        });\n      }\n    }, {\n      key: \"xAxis\",\n      value: function xAxis() {\n        return this._xAxis;\n      }\n    }, {\n      key: \"setWidth\",\n      value: function setWidth(mainWidgetWidth, yAxisWidgetWidth) {\n        _get(_getPrototypeOf(XAxisPane.prototype), \"setWidth\", this).call(this, mainWidgetWidth, yAxisWidgetWidth);\n\n        this._xAxis.setWidth(mainWidgetWidth);\n      }\n    }, {\n      key: \"setHeight\",\n      value: function setHeight(height) {\n        _get(_getPrototypeOf(XAxisPane.prototype), \"setHeight\", this).call(this, height);\n\n        this._xAxis.setHeight(height);\n      }\n    }]);\n\n    return XAxisPane;\n  }(Pane);\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * The file comes from tradingview/lightweight-charts\n   * https://www.tradingview.com/\n   * Convert files from typescript to javascript.\n   * Modified the class name.\n   * The use of the source code of this file is also subject to the terms\n   * and consitions of the license of \"lightweight-charts\" (Apache License V2, see\n   * </licenses/LICENSE-lightweight-charts>).\n   */\n\n\n  var MouseEventButton = {\n    LEFT: 0,\n    RIGHT: 2\n  };\n  var DELAY_RESET_CLICK = 500;\n  var DELAY_LONG_TAG = 600;\n\n  function getBoundingClientRect(element) {\n    return element.getBoundingClientRect() || {\n      left: 0,\n      top: 0\n    };\n  }\n\n  function isTouchEvent(event) {\n    return Boolean(event.touches);\n  }\n\n  function preventDefault(event) {\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n  }\n\n  function checkTouchEvents() {\n    if ('ontouchstart' in window) {\n      return true;\n    }\n\n    return Boolean(window.DocumentTouch && document instanceof window.DocumentTouch);\n  }\n\n  var touch = !!navigator.maxTouchPoints || !!navigator.msMaxTouchPoints || checkTouchEvents();\n  var mobileTouch = 'onorientationchange' in window && touch;\n\n  function getDistance(p1, p2) {\n    var xDiff = p1.clientX - p2.clientX;\n    var yDiff = p1.clientY - p2.clientY;\n    return Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n  }\n\n  var EventType = {\n    MOUSE: 'mouse',\n    TOUCH: 'touch'\n  };\n\n  var EventBase = /*#__PURE__*/function () {\n    function EventBase(target, eventHandler, options) {\n      _classCallCheck(this, EventBase);\n\n      this._target = target;\n      this._handler = eventHandler;\n      this._options = options;\n      this._clickCount = 0;\n      this._clickTimeoutId = null;\n      this._longTapTimeoutId = null;\n      this._longTapActive = false;\n      this._mouseMoveStartPosition = null;\n      this._moveExceededManhattanDistance = false;\n      this._cancelClick = false;\n      this._unsubscribeOutsideEvents = null;\n      this._unsubscribeMousemove = null;\n      this._unsubscribeRoot = null;\n      this._startPinchMiddlePoint = null;\n      this._startPinchDistance = 0;\n      this._pinchPrevented = false;\n      this._preventDragProcess = false;\n      this._mousePressed = false;\n\n      this._init();\n    }\n\n    _createClass(EventBase, [{\n      key: \"destroy\",\n      value: function destroy() {\n        if (this._unsubscribeOutsideEvents !== null) {\n          this._unsubscribeOutsideEvents();\n\n          this._unsubscribeOutsideEvents = null;\n        }\n\n        if (this._unsubscribeMousemove !== null) {\n          this._unsubscribeMousemove();\n\n          this._unsubscribeMousemove = null;\n        }\n\n        if (this._unsubscribeRoot !== null) {\n          this._unsubscribeRoot();\n\n          this._unsubscribeRoot = null;\n        }\n\n        this._clearLongTapTimeout();\n\n        this._resetClickTimeout();\n      }\n    }, {\n      key: \"_mouseEnterHandler\",\n      value: function _mouseEnterHandler(enterEvent) {\n        var _this = this;\n\n        if (this._unsubscribeMousemove) {\n          this._unsubscribeMousemove();\n        }\n\n        {\n          var boundMouseMoveHandler = this._mouseMoveHandler.bind(this);\n\n          var boundMouseWheelHandler = this._mouseWheelHandler.bind(this);\n\n          this._unsubscribeMousemove = function () {\n            _this._target.removeEventListener('mousemove', boundMouseMoveHandler);\n\n            _this._target.removeEventListener('wheel', boundMouseWheelHandler);\n          };\n\n          this._target.addEventListener('mousemove', boundMouseMoveHandler);\n\n          this._target.addEventListener('wheel', boundMouseWheelHandler, {\n            passive: false\n          });\n        }\n\n        if (isTouchEvent(enterEvent)) {\n          this._mouseMoveHandler(enterEvent);\n        }\n\n        var compatEvent = this._makeCompatEvent(enterEvent);\n\n        this._processEvent(compatEvent, this._handler.mouseEnterEvent);\n      }\n    }, {\n      key: \"_resetClickTimeout\",\n      value: function _resetClickTimeout() {\n        if (this._clickTimeoutId !== null) {\n          clearTimeout(this._clickTimeoutId);\n        }\n\n        this._clickCount = 0;\n        this._clickTimeoutId = null;\n      }\n    }, {\n      key: \"_mouseMoveHandler\",\n      value: function _mouseMoveHandler(moveEvent) {\n        if (this._mousePressed && !isTouchEvent(moveEvent)) {\n          return;\n        }\n\n        var compatEvent = this._makeCompatEvent(moveEvent);\n\n        this._processEvent(compatEvent, this._handler.mouseMoveEvent);\n      }\n    }, {\n      key: \"_mouseWheelHandler\",\n      value: function _mouseWheelHandler(wheelEvent) {\n        var compatEvent = this._makeCompatEvent(wheelEvent);\n\n        wheelEvent.localX = compatEvent.localX;\n        wheelEvent.localY = compatEvent.localY;\n\n        this._processEvent(wheelEvent, this._handler.mouseWheelEvent);\n      }\n    }, {\n      key: \"_mouseMoveWithDownHandler\",\n      value: function _mouseMoveWithDownHandler(moveEvent) {\n        if ('button' in moveEvent && moveEvent.button !== MouseEventButton.LEFT) {\n          return;\n        }\n\n        if (this._startPinchMiddlePoint !== null) {\n          return;\n        }\n\n        var isTouch = isTouchEvent(moveEvent);\n\n        if (this._preventDragProcess && isTouch) {\n          return;\n        }\n\n        this._pinchPrevented = true;\n\n        var compatEvent = this._makeCompatEvent(moveEvent);\n\n        var startMouseMovePos = this._mouseMoveStartPosition;\n        var xOffset = Math.abs(startMouseMovePos.x - compatEvent.pageX);\n        var yOffset = Math.abs(startMouseMovePos.y - compatEvent.pageY);\n        var moveExceededManhattanDistance = xOffset + yOffset > 5;\n\n        if (!moveExceededManhattanDistance && isTouch) {\n          return;\n        }\n\n        if (moveExceededManhattanDistance && !this._moveExceededManhattanDistance && isTouch) {\n          // vertical drag is more important than horizontal drag\n          // because we scroll the page vertically often than horizontally\n          var correctedXOffset = xOffset * 0.5; // a drag can be only if touch page scroll isn't allowed\n\n          var isVertDrag = yOffset >= correctedXOffset && !this._options.treatVertTouchDragAsPageScroll;\n          var isHorzDrag = correctedXOffset > yOffset && !this._options.treatHorzTouchDragAsPageScroll; // if drag event happened then we should revert preventDefault state to original one\n          // and try to process the drag event\n          // else we shouldn't prevent default of the event and ignore processing the drag event\n\n          if (!isVertDrag && !isHorzDrag) {\n            this._preventDragProcess = true;\n          }\n        }\n\n        if (moveExceededManhattanDistance) {\n          this._moveExceededManhattanDistance = true; // if manhattan distance is more that 5 - we should cancel click event\n\n          this._cancelClick = true;\n\n          if (isTouch) {\n            this._clearLongTapTimeout();\n          }\n        }\n\n        if (!this._preventDragProcess) {\n          this._processEvent(compatEvent, this._handler.pressedMouseMoveEvent); // we should prevent default in case of touch only\n          // to prevent scroll of the page\n\n\n          if (isTouch) {\n            preventDefault(moveEvent);\n          }\n        }\n      }\n    }, {\n      key: \"_mouseUpHandler\",\n      value: function _mouseUpHandler(mouseUpEvent) {\n        if ('button' in mouseUpEvent && mouseUpEvent.button !== MouseEventButton.LEFT) {\n          return;\n        }\n\n        var compatEvent = this._makeCompatEvent(mouseUpEvent);\n\n        this._clearLongTapTimeout();\n\n        this._mouseMoveStartPosition = null;\n        this._mousePressed = false;\n\n        if (this._unsubscribeRoot) {\n          this._unsubscribeRoot();\n\n          this._unsubscribeRoot = null;\n        }\n\n        if (isTouchEvent(mouseUpEvent)) {\n          this._mouseLeaveHandler(mouseUpEvent);\n        }\n\n        this._processEvent(compatEvent, this._handler.mouseUpEvent);\n\n        ++this._clickCount;\n\n        if (this._clickTimeoutId && this._clickCount > 1) {\n          this._processEvent(compatEvent, this._handler.mouseDoubleClickEvent);\n\n          this._resetClickTimeout();\n        } else {\n          if (!this._cancelClick) {\n            this._processEvent(compatEvent, this._handler.mouseClickEvent);\n          }\n        } // prevent safari's dblclick-to-zoom\n        // we handle mouseDoubleClickEvent here ourself\n\n\n        if (isTouchEvent(mouseUpEvent)) {\n          preventDefault(mouseUpEvent);\n\n          this._mouseLeaveHandler(mouseUpEvent);\n\n          if (mouseUpEvent.touches.length === 0) {\n            this._longTapActive = false;\n          }\n        }\n      }\n    }, {\n      key: \"_clearLongTapTimeout\",\n      value: function _clearLongTapTimeout() {\n        if (this._longTapTimeoutId === null) {\n          return;\n        }\n\n        clearTimeout(this._longTapTimeoutId);\n        this._longTapTimeoutId = null;\n      }\n    }, {\n      key: \"_mouseDownHandler\",\n      value: function _mouseDownHandler(downEvent) {\n        if ('button' in downEvent && downEvent.button !== MouseEventButton.LEFT && downEvent.button !== MouseEventButton.RIGHT) {\n          return;\n        }\n\n        var compatEvent = this._makeCompatEvent(downEvent);\n\n        if ('button' in downEvent && downEvent.button === MouseEventButton.RIGHT) {\n          this._processEvent(compatEvent, this._handler.mouseRightDownEvent);\n\n          return;\n        }\n\n        this._cancelClick = false;\n        this._moveExceededManhattanDistance = false;\n        this._preventDragProcess = false;\n\n        if (isTouchEvent(downEvent)) {\n          this._mouseEnterHandler(downEvent);\n        }\n\n        this._mouseMoveStartPosition = {\n          x: compatEvent.pageX,\n          y: compatEvent.pageY\n        };\n\n        if (this._unsubscribeRoot) {\n          this._unsubscribeRoot();\n\n          this._unsubscribeRoot = null;\n        }\n\n        {\n          var boundMouseMoveWithDownHandler = this._mouseMoveWithDownHandler.bind(this);\n\n          var boundMouseUpHandler = this._mouseUpHandler.bind(this);\n\n          var rootElement = this._target.ownerDocument.documentElement;\n\n          this._unsubscribeRoot = function () {\n            rootElement.removeEventListener('touchmove', boundMouseMoveWithDownHandler);\n            rootElement.removeEventListener('touchend', boundMouseUpHandler);\n            rootElement.removeEventListener('mousemove', boundMouseMoveWithDownHandler);\n            rootElement.removeEventListener('mouseup', boundMouseUpHandler);\n          };\n\n          rootElement.addEventListener('touchmove', boundMouseMoveWithDownHandler, {\n            passive: false\n          });\n          rootElement.addEventListener('touchend', boundMouseUpHandler, {\n            passive: false\n          });\n\n          this._clearLongTapTimeout();\n\n          if (isTouchEvent(downEvent) && downEvent.touches.length === 1) {\n            this._longTapTimeoutId = setTimeout(this._longTapHandler.bind(this, downEvent), DELAY_LONG_TAG);\n          } else {\n            rootElement.addEventListener('mousemove', boundMouseMoveWithDownHandler);\n            rootElement.addEventListener('mouseup', boundMouseUpHandler);\n          }\n        }\n        this._mousePressed = true;\n\n        this._processEvent(compatEvent, this._handler.mouseDownEvent);\n\n        if (!this._clickTimeoutId) {\n          this._clickCount = 0;\n          this._clickTimeoutId = setTimeout(this._resetClickTimeout.bind(this), DELAY_RESET_CLICK);\n        }\n      }\n    }, {\n      key: \"_init\",\n      value: function _init() {\n        var _this2 = this;\n\n        this._target.addEventListener('mouseenter', this._mouseEnterHandler.bind(this));\n\n        this._target.addEventListener('touchcancel', this._clearLongTapTimeout.bind(this));\n\n        {\n          var doc = this._target.ownerDocument;\n\n          var outsideHandler = function outsideHandler(event) {\n            if (!_this2._handler.mouseDownOutsideEvent) {\n              return;\n            }\n\n            if (event.target && _this2._target.contains(event.target)) {\n              return;\n            }\n\n            _this2._handler.mouseDownOutsideEvent();\n          };\n\n          this._unsubscribeOutsideEvents = function () {\n            doc.removeEventListener('mousedown', outsideHandler);\n            doc.removeEventListener('touchstart', outsideHandler);\n          };\n\n          doc.addEventListener('mousedown', outsideHandler);\n          doc.addEventListener('touchstart', outsideHandler, {\n            passive: true\n          });\n        }\n\n        this._target.addEventListener('mouseleave', this._mouseLeaveHandler.bind(this));\n\n        this._target.addEventListener('touchstart', this._mouseDownHandler.bind(this), {\n          passive: true\n        });\n\n        if (!mobileTouch) {\n          this._target.addEventListener('mousedown', this._mouseDownHandler.bind(this));\n        }\n\n        this._initPinch(); // Hey mobile Safari, what's up?\n        // If mobile Safari doesn't have any touchmove handler with passive=false\n        // it treats a touchstart and the following touchmove events as cancelable=false,\n        // so we can't prevent them (as soon we subscribe on touchmove inside handler of touchstart).\n        // And we'll get scroll of the page along with chart's one instead of only chart's scroll.\n\n\n        this._target.addEventListener('touchmove', function () {}, {\n          passive: false\n        });\n      }\n    }, {\n      key: \"_initPinch\",\n      value: function _initPinch() {\n        var _this3 = this;\n\n        if (this._handler.pinchStartEvent === undefined && this._handler.pinchEvent === undefined && this._handler.pinchEndEvent === undefined) {\n          return;\n        }\n\n        this._target.addEventListener('touchstart', function (event) {\n          return _this3._checkPinchState(event.touches);\n        }, {\n          passive: true\n        });\n\n        this._target.addEventListener('touchmove', function (event) {\n          if (event.touches.length !== 2 || _this3._startPinchMiddlePoint === null) {\n            return;\n          }\n\n          if (_this3._handler.pinchEvent !== undefined) {\n            var currentDistance = getDistance(event.touches[0], event.touches[1]);\n            var scale = currentDistance / _this3._startPinchDistance;\n\n            _this3._handler.pinchEvent(_this3._startPinchMiddlePoint, scale);\n\n            preventDefault(event);\n          }\n        }, {\n          passive: false\n        });\n\n        this._target.addEventListener('touchend', function (event) {\n          _this3._checkPinchState(event.touches);\n        });\n      }\n    }, {\n      key: \"_checkPinchState\",\n      value: function _checkPinchState(touches) {\n        if (touches.length === 1) {\n          this._pinchPrevented = false;\n        }\n\n        if (touches.length !== 2 || this._pinchPrevented || this._longTapActive) {\n          this._stopPinch();\n        } else {\n          this._startPinch(touches);\n        }\n      }\n    }, {\n      key: \"_startPinch\",\n      value: function _startPinch(touches) {\n        var box = getBoundingClientRect(this._target);\n        this._startPinchMiddlePoint = {\n          x: (touches[0].clientX - box.left + (touches[1].clientX - box.left)) / 2,\n          y: (touches[0].clientY - box.top + (touches[1].clientY - box.top)) / 2\n        };\n        this._startPinchDistance = getDistance(touches[0], touches[1]);\n\n        if (this._handler.pinchStartEvent !== undefined) {\n          this._handler.pinchStartEvent();\n        }\n\n        this._clearLongTapTimeout();\n      }\n    }, {\n      key: \"_stopPinch\",\n      value: function _stopPinch() {\n        if (this._startPinchMiddlePoint === null) {\n          return;\n        }\n\n        this._startPinchMiddlePoint = null;\n\n        if (this._handler.pinchEndEvent !== undefined) {\n          this._handler.pinchEndEvent();\n        }\n      }\n    }, {\n      key: \"_mouseLeaveHandler\",\n      value: function _mouseLeaveHandler(event) {\n        if (this._unsubscribeMousemove) {\n          this._unsubscribeMousemove();\n        }\n\n        var compatEvent = this._makeCompatEvent(event);\n\n        this._processEvent(compatEvent, this._handler.mouseLeaveEvent);\n      }\n    }, {\n      key: \"_longTapHandler\",\n      value: function _longTapHandler(event) {\n        var compatEvent = this._makeCompatEvent(event);\n\n        this._processEvent(compatEvent, this._handler.longTapEvent);\n\n        this._cancelClick = true; // long tap is active untill touchend event with 0 touches occured\n\n        this._longTapActive = true;\n      }\n    }, {\n      key: \"_processEvent\",\n      value: function _processEvent(event, callback) {\n        if (!callback) {\n          return;\n        }\n\n        callback.call(this._handler, event);\n      }\n    }, {\n      key: \"_makeCompatEvent\",\n      value: function _makeCompatEvent(event) {\n        // TouchEvent has no clientX/Y coordinates:\n        // We have to use the last Touch instead\n        var eventLike;\n\n        if ('touches' in event && event.touches.length) {\n          eventLike = event.touches[0];\n        } else if ('changedTouches' in event && event.changedTouches.length) {\n          eventLike = event.changedTouches[0];\n        } else {\n          eventLike = event;\n        }\n\n        var box = getBoundingClientRect(this._target);\n        return {\n          clientX: eventLike.clientX,\n          clientY: eventLike.clientY,\n          pageX: eventLike.pageX,\n          pageY: eventLike.pageY,\n          screenX: eventLike.screenX,\n          screenY: eventLike.screenY,\n          localX: eventLike.clientX - box.left,\n          localY: eventLike.clientY - box.top,\n          ctrlKey: event.ctrlKey,\n          altKey: event.altKey,\n          shiftKey: event.shiftKey,\n          metaKey: event.metaKey,\n          type: event.type.startsWith('mouse') ? EventType.MOUSE : EventType.TOUCH,\n          target: eventLike.target,\n          view: event.view\n        };\n      }\n    }]);\n\n    return EventBase;\n  }();\n\n  var SeparatorPane = /*#__PURE__*/function () {\n    function SeparatorPane(container, chartData, topPaneId, bottomPaneId, dragEnabled, dragEventHandler) {\n      _classCallCheck(this, SeparatorPane);\n\n      this._chartData = chartData;\n      this._topPaneId = topPaneId;\n      this._bottomPaneId = bottomPaneId;\n      this._dragEnabled = dragEnabled;\n      this._width = 0;\n      this._offsetLeft = 0;\n      this._dragEventHandler = dragEventHandler;\n      this._dragFlag = false;\n\n      this._initElement(container);\n\n      this._initEvent(dragEnabled);\n    }\n    /**\n     * 初始化dom元素\n     * @param container\n     * @private\n     */\n\n\n    _createClass(SeparatorPane, [{\n      key: \"_initElement\",\n      value: function _initElement(container) {\n        this._container = container;\n        this._wrapper = this._createElement();\n        this._wrapper.style.position = 'relative';\n        this._element = this._createElement();\n        this._element.style.width = '100%';\n        this._element.style.position = 'absolute';\n        this._element.style.zIndex = '20';\n        this._element.style.top = '-3px';\n        this._element.style.height = '7px';\n\n        this._wrapper.appendChild(this._element);\n\n        var lastElement = container.lastChild;\n\n        if (lastElement) {\n          container.insertBefore(this._wrapper, lastElement);\n        } else {\n          container.appendChild(this._wrapper);\n        }\n      }\n      /**\n       * 初始化事件\n       * @param dragEnabled\n       * @private\n       */\n\n    }, {\n      key: \"_initEvent\",\n      value: function _initEvent(dragEnabled) {\n        if (dragEnabled) {\n          this._element.style.cursor = 'ns-resize';\n          this._dragEvent = new EventBase(this._element, {\n            mouseDownEvent: this._mouseDownEvent.bind(this),\n            mouseUpEvent: this._mouseUpEvent.bind(this),\n            pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n            mouseEnterEvent: this._mouseEnterEvent.bind(this),\n            mouseLeaveEvent: this._mouseLeaveEvent.bind(this)\n          }, {\n            treatVertTouchDragAsPageScroll: false,\n            treatHorzTouchDragAsPageScroll: true\n          });\n        }\n      }\n      /**\n       * 创建div节点\n       * @return {HTMLDivElement}\n       * @private\n       */\n\n    }, {\n      key: \"_createElement\",\n      value: function _createElement() {\n        var element = document.createElement('div');\n        element.style.margin = '0';\n        element.style.padding = '0';\n        return element;\n      }\n    }, {\n      key: \"_mouseDownEvent\",\n      value: function _mouseDownEvent(event) {\n        this._dragFlag = true;\n        this._startY = event.pageY;\n\n        this._dragEventHandler.startDrag(this._topPaneId, this._bottomPaneId);\n      }\n    }, {\n      key: \"_mouseUpEvent\",\n      value: function _mouseUpEvent() {\n        this._dragFlag = false;\n\n        this._chartData.setDragPaneFlag(false);\n      }\n    }, {\n      key: \"_pressedMouseMoveEvent\",\n      value: function _pressedMouseMoveEvent(event) {\n        var dragDistance = event.pageY - this._startY;\n\n        this._dragEventHandler.drag(dragDistance, this._topPaneId, this._bottomPaneId);\n\n        this._chartData.setDragPaneFlag(true);\n\n        this._chartData.setCrosshair();\n      }\n    }, {\n      key: \"_mouseEnterEvent\",\n      value: function _mouseEnterEvent() {\n        var separatorOptions = this._chartData.styleOptions().separator;\n\n        this._element.style.background = separatorOptions.activeBackgroundColor;\n\n        this._chartData.setDragPaneFlag(true);\n\n        this._chartData.setCrosshair();\n      }\n    }, {\n      key: \"_mouseLeaveEvent\",\n      value: function _mouseLeaveEvent() {\n        if (!this._dragFlag) {\n          this._element.style.background = null;\n\n          this._chartData.setDragPaneFlag(false);\n        }\n      }\n      /**\n       * 获取高度\n       * @returns {number}\n       */\n\n    }, {\n      key: \"height\",\n      value: function height() {\n        return this._wrapper.offsetHeight;\n      }\n      /**\n       * 设置尺寸\n       * 用于fill属性\n       * @param offsetLeft\n       * @param width\n       */\n\n    }, {\n      key: \"setSize\",\n      value: function setSize(offsetLeft, width) {\n        this._offsetLeft = offsetLeft;\n        this._width = width;\n        this.invalidate();\n      }\n      /**\n       * 设置是否可以拖拽\n       * @param dragEnabled\n       */\n\n    }, {\n      key: \"setDragEnabled\",\n      value: function setDragEnabled(dragEnabled) {\n        if (dragEnabled !== this._dragEnabled) {\n          this._dragEnabled = dragEnabled;\n\n          if (dragEnabled) {\n            !this._dragEvent && this._initEvent(dragEnabled);\n          } else {\n            this._element.style.cursor = 'default';\n            this._dragEvent && this._dragEvent.destroy();\n            this._dragEvent = null;\n          }\n        }\n      }\n      /**\n       * 顶部paneId\n       * @return {*}\n       */\n\n    }, {\n      key: \"topPaneId\",\n      value: function topPaneId() {\n        return this._topPaneId;\n      }\n      /**\n       * 底部paneId\n       * @return {*}\n       */\n\n    }, {\n      key: \"bottomPaneId\",\n      value: function bottomPaneId() {\n        return this._bottomPaneId;\n      }\n      /**\n       * 更新上下两个图表的索引\n       * @param topPaneId\n       * @param bottomPaneId\n       */\n\n    }, {\n      key: \"updatePaneId\",\n      value: function updatePaneId(topPaneId, bottomPaneId) {\n        if (isValid(topPaneId)) {\n          this._topPaneId = topPaneId;\n        }\n\n        if (isValid(bottomPaneId)) {\n          this._bottomPaneId = bottomPaneId;\n        }\n      }\n      /**\n       * 刷新\n       */\n\n    }, {\n      key: \"invalidate\",\n      value: function invalidate() {\n        var separatorOptions = this._chartData.styleOptions().separator;\n\n        this._element.style.top = \"\".concat(-Math.floor((7 - separatorOptions.size) / 2), \"px\");\n        this._wrapper.style.backgroundColor = separatorOptions.color;\n        this._wrapper.style.height = \"\".concat(separatorOptions.size, \"px\");\n        this._wrapper.style.marginLeft = \"\".concat(separatorOptions.fill ? 0 : this._offsetLeft, \"px\");\n        this._wrapper.style.width = separatorOptions.fill ? '100%' : \"\".concat(this._width, \"px\");\n      }\n      /**\n       * 将图形转换成图片\n       * @returns {HTMLCanvasElement}\n       */\n\n    }, {\n      key: \"getImage\",\n      value: function getImage() {\n        var separatorOptions = this._chartData.styleOptions().separator;\n\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var pixelRatio = getPixelRatio(canvas);\n        var width = this._wrapper.offsetWidth;\n        var height = separatorOptions.size;\n        canvas.style.width = \"\".concat(width, \"px\");\n        canvas.style.height = \"\".concat(height, \"px\");\n        canvas.width = width * pixelRatio;\n        canvas.height = height * pixelRatio;\n        ctx.scale(pixelRatio, pixelRatio);\n        ctx.fillStyle = separatorOptions.color;\n        ctx.fillRect(this._offsetLeft, 0, width, height);\n        return canvas;\n      }\n      /**\n       * 销毁\n       */\n\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        if (this._dragEvent) {\n          this._dragEvent.destroy();\n        }\n\n        this._container.removeChild(this._wrapper);\n      }\n    }]);\n\n    return SeparatorPane;\n  }();\n\n  function isTouch(event) {\n    return event.type === EventType.TOUCH;\n  }\n\n  function isMouse(event) {\n    return event.type === EventType.MOUSE;\n  }\n\n  var EventHandler = /*#__PURE__*/function () {\n    function EventHandler(chartData) {\n      _classCallCheck(this, EventHandler);\n\n      this._chartData = chartData;\n      this._chartContentSize = {};\n      this._paneContentSize = {};\n    }\n\n    _createClass(EventHandler, [{\n      key: \"_checkEventPointX\",\n      value: function _checkEventPointX(x) {\n        return x > 0 && x < this._chartContentSize.contentRight - this._chartContentSize.contentLeft;\n      }\n    }, {\n      key: \"setChartContentSize\",\n      value: function setChartContentSize(chartContentSize) {\n        this._chartContentSize = chartContentSize;\n      }\n    }, {\n      key: \"setPaneContentSize\",\n      value: function setPaneContentSize(paneContentSize) {\n        this._paneContentSize = paneContentSize;\n      }\n    }]);\n\n    return EventHandler;\n  }();\n\n  var TOUCH_MIN_RADIUS = 10;\n\n  var ZoomScrollEventHandler = /*#__PURE__*/function (_EventHandler) {\n    _inherits(ZoomScrollEventHandler, _EventHandler);\n\n    var _super = _createSuper(ZoomScrollEventHandler);\n\n    function ZoomScrollEventHandler(chartData) {\n      var _this;\n\n      _classCallCheck(this, ZoomScrollEventHandler);\n\n      _this = _super.call(this, chartData); // 开始滚动时坐标点\n\n      _this._startScrollPoint = {}; // 开始触摸时坐标\n\n      _this._touchPoint = null; // 是否是取消了十字光标\n\n      _this._touchCancelCrossHair = false; // 是否缩放过\n\n      _this._touchZoomed = false; // 用来记录捏合缩放的尺寸\n\n      _this._pinchScale = 1;\n      return _this;\n    }\n\n    _createClass(ZoomScrollEventHandler, [{\n      key: \"pinchStartEvent\",\n      value: function pinchStartEvent() {\n        this._pinchScale = 1;\n        this._touchZoomed = true;\n      }\n    }, {\n      key: \"pinchEvent\",\n      value: function pinchEvent(middlePoint, scale) {\n        var zoomScale = (scale - this._pinchScale) * 5;\n        this._pinchScale = scale;\n\n        this._chartData.zoom(zoomScale, middlePoint);\n      }\n    }, {\n      key: \"mouseLeaveEvent\",\n      value: function mouseLeaveEvent(event) {\n        if (isMouse(event)) {\n          this._chartData.setCrosshair();\n        }\n      }\n    }, {\n      key: \"mouseMoveEvent\",\n      value: function mouseMoveEvent(event) {\n        var _this2 = this;\n\n        if (!isMouse(event)) {\n          return;\n        }\n\n        this._performCross(event, false, function (cross) {\n          _this2._chartData.setCrosshair({\n            x: event.localX,\n            y: cross.y,\n            paneId: cross.paneId\n          });\n        }, function () {\n          _this2._chartData.setCrosshair();\n        });\n      }\n    }, {\n      key: \"mouseWheelEvent\",\n      value: function mouseWheelEvent(event) {\n        if (!this._checkEventPointX(event.localX)) {\n          return;\n        }\n\n        if (Math.abs(event.deltaX) > Math.abs(event.deltaY)) {\n          if (event.cancelable) {\n            event.preventDefault();\n          }\n\n          if (Math.abs(event.deltaX) === 0) {\n            return;\n          }\n\n          this._chartData.startScroll();\n\n          this._chartData.scroll(-event.deltaX);\n        } else {\n          var deltaY = -(event.deltaY / 100);\n\n          if (deltaY === 0) {\n            return;\n          }\n\n          if (event.cancelable) {\n            event.preventDefault();\n          }\n\n          switch (event.deltaMode) {\n            case event.DOM_DELTA_PAGE:\n              deltaY *= 120;\n              break;\n\n            case event.DOM_DELTA_LINE:\n              deltaY *= 32;\n              break;\n          }\n\n          if (deltaY !== 0) {\n            var scale = Math.sign(deltaY) * Math.min(1, Math.abs(deltaY));\n\n            this._chartData.zoom(scale, {\n              x: event.localX,\n              y: event.localY\n            });\n          }\n        }\n      }\n    }, {\n      key: \"mouseClickEvent\",\n      value: function mouseClickEvent(event) {\n        var _this3 = this;\n\n        this._performCross(event, true, function (cross) {\n          if (!_this3._touchPoint && !_this3._touchCancelCrossHair && !_this3._touchZoomed) {\n            _this3._touchPoint = {\n              x: event.localX,\n              y: event.localY\n            };\n\n            _this3._chartData.setCrosshair({\n              x: event.localX,\n              y: cross.y,\n              paneId: cross.paneId\n            });\n          }\n        });\n      }\n    }, {\n      key: \"mouseDownEvent\",\n      value: function mouseDownEvent(event) {\n        var _this4 = this;\n\n        this._startScrollPoint = {\n          x: event.localX,\n          y: event.localY\n        };\n\n        this._chartData.startScroll();\n\n        this._performCross(event, true, function (cross) {\n          _this4._touchZoomed = false;\n\n          if (_this4._touchPoint) {\n            var xDif = event.localX - _this4._touchPoint.x;\n            var yDif = event.localY - _this4._touchPoint.y;\n            var radius = Math.sqrt(xDif * xDif + yDif * yDif);\n\n            if (radius < TOUCH_MIN_RADIUS) {\n              _this4._touchPoint = {\n                x: event.localX,\n                y: event.localY\n              };\n\n              _this4._chartData.setCrosshair({\n                x: event.localX,\n                y: cross.y,\n                paneId: cross.paneId\n              });\n            } else {\n              _this4._touchCancelCrossHair = true;\n              _this4._touchPoint = null;\n\n              _this4._chartData.setCrosshair();\n            }\n          } else {\n            _this4._touchCancelCrossHair = false;\n          }\n        });\n      }\n    }, {\n      key: \"pressedMouseMoveEvent\",\n      value: function pressedMouseMoveEvent(event) {\n        var _this5 = this;\n\n        this._performCross(event, false, function (cross) {\n          var crosshair = {\n            x: event.localX,\n            y: cross.y,\n            paneId: cross.paneId\n          };\n\n          if (isTouch(event)) {\n            if (_this5._touchPoint) {\n              _this5._touchPoint = {\n                x: event.localX,\n                y: event.localY\n              };\n\n              _this5._chartData.setCrosshair(crosshair);\n\n              return;\n            } else {\n              crosshair = null;\n            }\n          }\n\n          var distance = event.localX - _this5._startScrollPoint.x;\n\n          _this5._chartData.scroll(distance, crosshair);\n        });\n      }\n    }, {\n      key: \"longTapEvent\",\n      value: function longTapEvent(event) {\n        var _this6 = this;\n\n        this._performCross(event, true, function (cross) {\n          _this6._touchPoint = {\n            x: event.localX,\n            y: event.localY\n          };\n\n          _this6._chartData.setCrosshair({\n            x: event.localX,\n            y: cross.y,\n            paneId: cross.paneId\n          });\n        });\n      }\n      /**\n       * 处理十字光标\n       * @param event\n       * @param checkTouchEvent\n       * @param performFuc\n       * @param extendFun\n       * @private\n       */\n\n    }, {\n      key: \"_performCross\",\n      value: function _performCross(event, checkTouchEvent, performFuc, extendFun) {\n        if (checkTouchEvent && !isTouch(event)) {\n          return;\n        }\n\n        if (!this._checkEventPointX(event.localX)) {\n          if (extendFun) {\n            extendFun();\n          }\n\n          return;\n        }\n\n        var isPerform = false;\n\n        for (var paneId in this._paneContentSize) {\n          var size = this._paneContentSize[paneId];\n\n          if (event.localY > size.contentTop && event.localY < size.contentBottom) {\n            isPerform = true;\n\n            if (performFuc) {\n              performFuc({\n                paneId: paneId,\n                y: event.localY - size.contentTop\n              });\n            }\n\n            break;\n          }\n        }\n\n        if (!isPerform && extendFun) {\n          extendFun();\n        }\n      }\n    }]);\n\n    return ZoomScrollEventHandler;\n  }(EventHandler);\n\n  var OverlayEventHandler = /*#__PURE__*/function (_EventHandler) {\n    _inherits(OverlayEventHandler, _EventHandler);\n\n    var _super = _createSuper(OverlayEventHandler);\n\n    function OverlayEventHandler(chartData) {\n      var _this;\n\n      _classCallCheck(this, OverlayEventHandler);\n\n      _this = _super.call(this, chartData);\n      _this._pressedGraphicMark = null;\n      return _this;\n    }\n    /**\n     * 处理覆盖物鼠标hover事件\n     * @param overlays\n     * @param preHoverOperate\n     * @param coordinate\n     * @param event\n     * @return {*}\n     * @private\n     */\n\n\n    _createClass(OverlayEventHandler, [{\n      key: \"_performOverlayMouseHover\",\n      value: function _performOverlayMouseHover(overlays, preHoverOperate, coordinate, event) {\n        var hoverOperate;\n\n        var _iterator = _createForOfIteratorHelper(overlays),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var overlay = _step.value;\n            hoverOperate = overlay.checkMousePointOnGraphic(coordinate);\n\n            if (hoverOperate) {\n              break;\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        if (!hoverOperate || preHoverOperate.id !== hoverOperate.id) {\n          if (preHoverOperate.id && preHoverOperate.instance && isMouse(event)) {\n            preHoverOperate.instance.onMouseLeave({\n              id: preHoverOperate.id,\n              points: preHoverOperate.instance.points(),\n              event: event\n            });\n          }\n\n          if (hoverOperate && hoverOperate.id !== preHoverOperate.id && hoverOperate.instance && isMouse(event)) {\n            hoverOperate.instance.onMouseEnter({\n              id: hoverOperate.id,\n              points: hoverOperate.instance.points(),\n              event: event\n            });\n          }\n        }\n\n        return hoverOperate;\n      }\n      /**\n       * 鼠标抬起事件\n       * @param event\n       */\n\n    }, {\n      key: \"mouseUpEvent\",\n      value: function mouseUpEvent(event) {\n        if (this._pressedGraphicMark) {\n          this._pressedGraphicMark = null;\n\n          this._chartData.setDragGraphicMarkFlag(false);\n        }\n      }\n    }, {\n      key: \"mouseMoveEvent\",\n      value: function mouseMoveEvent(event) {\n        if (!this._checkEventPointX(event.localX) || !this._checkEventPointY(event.localY) || this._waitingForMouseMoveAnimationFrame) {\n          return;\n        }\n\n        this._waitingForMouseMoveAnimationFrame = true;\n        var coordinate = {\n          x: event.localX,\n          y: event.localY\n        };\n\n        var graphicMarks = this._chartData.graphicMarks();\n\n        var visibleAnnotations = this._chartData.visibleAnnotations();\n\n        var lastGraphicMark = graphicMarks[graphicMarks.length - 1];\n\n        var preGraphicMarkHoverOperate = this._chartData.graphicMarkMouseOperate().hover;\n\n        var preAnnotationHoverOperate = this._chartData.annotationMouseOperate();\n\n        var graphicMarkHoverOperate;\n        var graphicMarkClickOperate;\n        var annotationHoverOperate;\n\n        if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n          lastGraphicMark.mouseMoveForDrawing(coordinate);\n          graphicMarkHoverOperate = lastGraphicMark.checkMousePointOnGraphic(coordinate);\n          graphicMarkClickOperate = {\n            id: '',\n            element: GraphicMarkMouseOperateElement.NONE,\n            elementIndex: -1\n          };\n        } else {\n          graphicMarkHoverOperate = this._performOverlayMouseHover(graphicMarks, preGraphicMarkHoverOperate, coordinate, event);\n          annotationHoverOperate = this._performOverlayMouseHover(visibleAnnotations, preAnnotationHoverOperate, coordinate, event);\n        }\n\n        this._chartData.setOverlayMouseOperate({\n          hover: graphicMarkHoverOperate || {\n            id: '',\n            element: GraphicMarkMouseOperateElement.NONE,\n            elementIndex: -1\n          },\n          click: graphicMarkClickOperate\n        }, annotationHoverOperate || {\n          id: ''\n        });\n\n        this._waitingForMouseMoveAnimationFrame = false;\n      }\n      /**\n       * 鼠标按下事件\n       * @param event\n       */\n\n    }, {\n      key: \"mouseDownEvent\",\n      value: function mouseDownEvent(event) {\n        if (!this._checkEventPointX(event.localX) || !this._checkEventPointY(event.localY)) {\n          return;\n        }\n\n        var coordinate = {\n          x: event.localX,\n          y: event.localY\n        };\n\n        var graphicMarks = this._chartData.graphicMarks();\n\n        var lastGraphicMark = graphicMarks[graphicMarks.length - 1];\n        var graphicMarkHoverOperate = {\n          id: '',\n          element: GraphicMarkMouseOperateElement.NONE,\n          elementIndex: -1\n        };\n        var graphicMarkClickOperate;\n\n        if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n          lastGraphicMark.mouseLeftButtonDownForDrawing(coordinate);\n          graphicMarkClickOperate = lastGraphicMark.checkMousePointOnGraphic(coordinate);\n        } else {\n          var _iterator2 = _createForOfIteratorHelper(graphicMarks),\n              _step2;\n\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var graphicMark = _step2.value;\n              graphicMarkClickOperate = graphicMark.checkMousePointOnGraphic(coordinate);\n\n              if (graphicMarkClickOperate) {\n                if (graphicMarkClickOperate.element === GraphicMarkMouseOperateElement.POINT) {\n                  this._pressedGraphicMark = graphicMark;\n\n                  this._chartData.setDragGraphicMarkFlag(true);\n\n                  graphicMarkHoverOperate = _objectSpread2({}, graphicMarkClickOperate);\n                }\n\n                graphicMark.onClick({\n                  id: graphicMarkClickOperate.id,\n                  points: graphicMark.points(),\n                  event: event\n                });\n                break;\n              }\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n\n          var visibleAnnotations = this._chartData.visibleAnnotations();\n\n          var _iterator3 = _createForOfIteratorHelper(visibleAnnotations),\n              _step3;\n\n          try {\n            for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n              var annotation = _step3.value;\n              var annotationOperate = annotation.checkMousePointOnGraphic(coordinate);\n\n              if (annotationOperate) {\n                annotation.onClick({\n                  id: annotationOperate.id,\n                  points: annotation.points(),\n                  event: event\n                });\n                break;\n              }\n            }\n          } catch (err) {\n            _iterator3.e(err);\n          } finally {\n            _iterator3.f();\n          }\n        }\n\n        this._chartData.setOverlayMouseOperate({\n          hover: graphicMarkHoverOperate,\n          click: graphicMarkClickOperate || {\n            id: '',\n            element: GraphicMarkMouseOperateElement.NONE,\n            elementIndex: -1\n          }\n        });\n      }\n    }, {\n      key: \"mouseRightDownEvent\",\n      value: function mouseRightDownEvent(event) {\n        var graphicMark = this._chartData.graphicMarks().find(function (gm) {\n          return gm.checkMousePointOnGraphic({\n            x: event.localX,\n            y: event.localY\n          });\n        });\n\n        if (graphicMark && !graphicMark.onRightClick({\n          id: graphicMark.id(),\n          points: graphicMark.points(),\n          event: event\n        })) {\n          this._chartData.removeGraphicMarkInstance(graphicMark.id());\n        }\n\n        var annotation = this._chartData.visibleAnnotations().find(function (an) {\n          return an.checkMousePointOnGraphic({\n            x: event.localX,\n            y: event.localY\n          });\n        });\n\n        if (annotation) {\n          annotation.onRightClick({\n            id: annotation.id(),\n            points: annotation.points(),\n            event: event\n          });\n        }\n      }\n    }, {\n      key: \"pressedMouseMoveEvent\",\n      value: function pressedMouseMoveEvent(event) {\n        var graphicMarks = this._chartData.graphicMarks();\n\n        var lastGraphicMark = graphicMarks[graphicMarks.length - 1];\n\n        if ((!lastGraphicMark || !lastGraphicMark.isDrawing()) && this._pressedGraphicMark) {\n          this._pressedGraphicMark.mousePressedMove({\n            x: event.localX,\n            y: event.localY\n          }, event);\n\n          this._chartData.invalidate(InvalidateLevel.OVERLAY);\n        }\n      }\n    }, {\n      key: \"_checkEventPointY\",\n      value: function _checkEventPointY(y) {\n        var size = this._paneContentSize[CANDLE_PANE_ID];\n        return y > size.contentTop && y < size.contentBottom;\n      }\n    }]);\n\n    return OverlayEventHandler;\n  }(EventHandler);\n\n  var KeyBoardCode = {\n    EQUAL: 'Equal',\n    MINUS: 'Minus',\n    ARROW_LEFT: 'ArrowLeft',\n    ARROW_RIGHT: 'ArrowRight'\n  };\n\n  var KeyBoardEventHandler = /*#__PURE__*/function (_EventHandler) {\n    _inherits(KeyBoardEventHandler, _EventHandler);\n\n    var _super = _createSuper(KeyBoardEventHandler);\n\n    function KeyBoardEventHandler() {\n      _classCallCheck(this, KeyBoardEventHandler);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(KeyBoardEventHandler, [{\n      key: \"keyBoardDownEvent\",\n      value:\n      /**\n       * 键盘事件\n       * @param event\n       */\n      function keyBoardDownEvent(event) {\n        if (event.shiftKey) {\n          switch (event.code) {\n            case KeyBoardCode.EQUAL:\n              {\n                this._chartData.zoom(0.5);\n\n                break;\n              }\n\n            case KeyBoardCode.MINUS:\n              {\n                this._chartData.zoom(-0.5);\n\n                break;\n              }\n\n            case KeyBoardCode.ARROW_LEFT:\n              {\n                this._chartData.startScroll();\n\n                this._chartData.scroll(-3 * this._chartData.dataSpace());\n\n                break;\n              }\n\n            case KeyBoardCode.ARROW_RIGHT:\n              {\n                this._chartData.startScroll();\n\n                this._chartData.scroll(3 * this._chartData.dataSpace());\n\n                break;\n              }\n          }\n        }\n      }\n    }]);\n\n    return KeyBoardEventHandler;\n  }(EventHandler);\n\n  var ChartEvent = /*#__PURE__*/function () {\n    function ChartEvent(target, chartData) {\n      _classCallCheck(this, ChartEvent);\n\n      this._target = target;\n      this._chartData = chartData;\n      this._chartContentSize = {};\n      this._event = new EventBase(this._target, {\n        pinchStartEvent: this._pinchStartEvent.bind(this),\n        pinchEvent: this._pinchEvent.bind(this),\n        mouseUpEvent: this._mouseUpEvent.bind(this),\n        mouseClickEvent: this._mouseClickEvent.bind(this),\n        mouseDownEvent: this._mouseDownEvent.bind(this),\n        mouseRightDownEvent: this._mouseRightDownEvent.bind(this),\n        mouseLeaveEvent: this._mouseLeaveEvent.bind(this),\n        mouseMoveEvent: this._mouseMoveEvent.bind(this),\n        mouseWheelEvent: this._mouseWheelEvent.bind(this),\n        pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n        longTapEvent: this._longTapEvent.bind(this)\n      }, {\n        treatVertTouchDragAsPageScroll: false,\n        treatHorzTouchDragAsPageScroll: false\n      });\n      this._boundKeyBoardDownEvent = this._keyBoardDownEvent.bind(this);\n\n      this._target.addEventListener('keydown', this._boundKeyBoardDownEvent);\n\n      this._boundContextMenuEvent = function (e) {\n        e.preventDefault();\n      };\n\n      this._target.addEventListener('contextmenu', this._boundContextMenuEvent, false);\n\n      this._zoomScrollEventHandler = new ZoomScrollEventHandler(chartData);\n      this._overlayEventHandler = new OverlayEventHandler(chartData);\n      this._keyBoardEventHandler = new KeyBoardEventHandler(chartData);\n    }\n\n    _createClass(ChartEvent, [{\n      key: \"_keyBoardDownEvent\",\n      value: function _keyBoardDownEvent(event) {\n        this._keyBoardEventHandler.keyBoardDownEvent(event);\n      }\n    }, {\n      key: \"_pinchStartEvent\",\n      value: function _pinchStartEvent() {\n        this._zoomScrollEventHandler.pinchStartEvent();\n      }\n    }, {\n      key: \"_pinchEvent\",\n      value: function _pinchEvent(middlePoint, scale) {\n        this._zoomScrollEventHandler.pinchEvent(middlePoint, scale);\n      }\n    }, {\n      key: \"_mouseUpEvent\",\n      value: function _mouseUpEvent(event) {\n        this._target.style.cursor = 'crosshair';\n\n        if (this._shouldPerformOverlayEvent()) {\n          event.localX -= this._chartContentSize.contentLeft;\n\n          this._overlayEventHandler.mouseUpEvent(event);\n        }\n      }\n    }, {\n      key: \"_mouseLeaveEvent\",\n      value: function _mouseLeaveEvent(event) {\n        if (this._checkZoomScroll()) {\n          event.localX -= this._chartContentSize.contentLeft;\n\n          this._zoomScrollEventHandler.mouseLeaveEvent(event);\n        }\n      }\n    }, {\n      key: \"_mouseMoveEvent\",\n      value: function _mouseMoveEvent(event) {\n        event.localX -= this._chartContentSize.contentLeft;\n\n        if (this._shouldPerformOverlayEvent()) {\n          this._overlayEventHandler.mouseMoveEvent(event);\n        }\n\n        if (this._checkZoomScroll()) {\n          this._zoomScrollEventHandler.mouseMoveEvent(event);\n        }\n      }\n    }, {\n      key: \"_mouseWheelEvent\",\n      value: function _mouseWheelEvent(event) {\n        if (this._checkZoomScroll()) {\n          this._zoomScrollEventHandler.mouseWheelEvent(event);\n        }\n      }\n    }, {\n      key: \"_mouseClickEvent\",\n      value: function _mouseClickEvent(event) {\n        if (this._checkZoomScroll()) {\n          event.localX -= this._chartContentSize.contentLeft;\n\n          this._zoomScrollEventHandler.mouseClickEvent(event);\n        }\n      }\n    }, {\n      key: \"_mouseDownEvent\",\n      value: function _mouseDownEvent(event) {\n        this._target.style.cursor = 'pointer';\n        event.localX -= this._chartContentSize.contentLeft;\n\n        if (this._shouldPerformOverlayEvent()) {\n          this._overlayEventHandler.mouseDownEvent(event);\n        }\n\n        if (this._checkZoomScroll()) {\n          this._zoomScrollEventHandler.mouseDownEvent(event);\n        }\n      }\n    }, {\n      key: \"_mouseRightDownEvent\",\n      value: function _mouseRightDownEvent(event) {\n        if (this._shouldPerformOverlayEvent()) {\n          event.localX -= this._chartContentSize.contentLeft;\n\n          this._overlayEventHandler.mouseRightDownEvent(event);\n        }\n      }\n    }, {\n      key: \"_pressedMouseMoveEvent\",\n      value: function _pressedMouseMoveEvent(event) {\n        event.localX -= this._chartContentSize.contentLeft;\n\n        if (this._chartData.dragGraphicMarkFlag()) {\n          this._overlayEventHandler.pressedMouseMoveEvent(event); // 这里判断一下，如果是在拖拽图形标记，让十字光标不显示\n\n\n          if (this._chartData.crosshair().paneId) {\n            this._chartData.setCrosshair();\n          }\n        }\n\n        if (this._checkZoomScroll()) {\n          this._zoomScrollEventHandler.pressedMouseMoveEvent(event);\n        }\n      }\n    }, {\n      key: \"_longTapEvent\",\n      value: function _longTapEvent(event) {\n        if (this._checkZoomScroll()) {\n          event.localX -= this._chartContentSize.contentLeft;\n\n          this._zoomScrollEventHandler.longTapEvent(event);\n        }\n      }\n    }, {\n      key: \"_checkZoomScroll\",\n      value: function _checkZoomScroll() {\n        var graphicMarks = this._chartData.graphicMarks();\n\n        var graphicMarkCount = graphicMarks.length;\n        return !this._chartData.dragPaneFlag() && !this._chartData.dragGraphicMarkFlag() && (graphicMarkCount === 0 || !graphicMarks[graphicMarkCount - 1].isDrawing());\n      }\n      /**\n       * 是否需要处理图形标记事件\n       * @return {boolean}\n       * @private\n       */\n\n    }, {\n      key: \"_shouldPerformOverlayEvent\",\n      value: function _shouldPerformOverlayEvent() {\n        return this._chartData.graphicMarks().length > 0 || this._chartData.visibleAnnotations().length > 0;\n      }\n    }, {\n      key: \"setChartContentSize\",\n      value: function setChartContentSize(chartContentSize) {\n        this._chartContentSize = chartContentSize;\n\n        this._zoomScrollEventHandler.setChartContentSize(chartContentSize);\n\n        this._overlayEventHandler.setChartContentSize(chartContentSize);\n      }\n    }, {\n      key: \"setPaneContentSize\",\n      value: function setPaneContentSize(paneContentSize) {\n        this._zoomScrollEventHandler.setPaneContentSize(paneContentSize);\n\n        this._overlayEventHandler.setPaneContentSize(paneContentSize);\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this._event.destroy();\n\n        this._target.removeEventListener('keydown', this._boundKeyBoardDownEvent);\n\n        this._target.removeEventListener('contextmenu', this._boundContextMenuEvent);\n      }\n    }]);\n\n    return ChartEvent;\n  }();\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n\n  function throttle(func) {\n    var wait = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 20;\n    var previous = 0;\n    return function () {\n      var now = Date.now();\n      var context = this;\n      var args = arguments;\n\n      if (now - previous > wait) {\n        func.apply(context, args);\n        previous = now;\n      }\n    };\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 渲染填充菱形\n   * @param ctx\n   * @param color\n   * @param centerPoint\n   * @param width\n   * @param height\n   */\n\n\n  function renderFillDiamond(ctx, color, centerPoint, width, height) {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.moveTo(centerPoint.x - width / 2, centerPoint.y);\n    ctx.lineTo(centerPoint.x, centerPoint.y - height / 2);\n    ctx.lineTo(centerPoint.x + width / 2, centerPoint.y);\n    ctx.lineTo(centerPoint.x, centerPoint.y + height / 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * 渲染填充菱形\n   * @param ctx\n   * @param color\n   * @param centerPoint\n   * @param width\n   * @param height\n   */\n\n\n  function renderFillTriangle(ctx, color, centerPoint, width, height) {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.moveTo(centerPoint.x - width / 2, centerPoint.y + height / 2);\n    ctx.lineTo(centerPoint.x, centerPoint.y - height / 2);\n    ctx.lineTo(centerPoint.x + width / 2, centerPoint.y + height / 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n  /**\n   * 注解\n   */\n\n\n  var Annotation = /*#__PURE__*/function (_Overlay) {\n    _inherits(Annotation, _Overlay);\n\n    var _super = _createSuper(Annotation);\n\n    function Annotation(_ref) {\n      var _this;\n\n      var id = _ref.id,\n          point = _ref.point,\n          chartData = _ref.chartData,\n          xAxis = _ref.xAxis,\n          yAxis = _ref.yAxis,\n          styles = _ref.styles;\n\n      _classCallCheck(this, Annotation);\n\n      _this = _super.call(this, {\n        id: id,\n        chartData: chartData,\n        xAxis: xAxis,\n        yAxis: yAxis\n      });\n      _this._point = point;\n      _this._symbolCoordinate = {};\n\n      _this.setStyles(styles, chartData.styleOptions().annotation);\n\n      return _this;\n    }\n    /**\n     * 绘制标识\n     * @param ctx\n     * @param isActive\n     * @param styles\n     * @private\n     */\n\n\n    _createClass(Annotation, [{\n      key: \"_drawSymbol\",\n      value: function _drawSymbol(ctx, isActive, styles) {\n        var barSpace = this._chartData.barSpace();\n\n        var symbolOptions = styles.symbol;\n        var styleSize = symbolOptions.size;\n        var styleActiveSize = symbolOptions.activeSize;\n        var size = isActive ? isNumber(styleActiveSize) ? styleActiveSize : barSpace : isNumber(styleSize) ? styleSize : barSpace;\n        var color = isActive ? symbolOptions.activeColor : symbolOptions.color;\n\n        switch (symbolOptions.type) {\n          case AnnotationSymbolType.CIRCLE:\n            {\n              renderFillCircle(ctx, color, this._symbolCoordinate, size / 2);\n              break;\n            }\n\n          case AnnotationSymbolType.RECT:\n            {\n              renderFillRect(ctx, color, this._symbolCoordinate.x - size / 2, this._symbolCoordinate.y - size / 2, size, size);\n              break;\n            }\n\n          case AnnotationSymbolType.DIAMOND:\n            {\n              renderFillDiamond(ctx, color, this._symbolCoordinate, size, size);\n              break;\n            }\n\n          case AnnotationSymbolType.TRIANGLE:\n            {\n              renderFillTriangle(ctx, color, this._symbolCoordinate, size, size);\n              break;\n            }\n\n          case AnnotationSymbolType.CUSTOM:\n            {\n              this.drawCustomSymbol({\n                ctx: ctx,\n                point: this._point,\n                coordinate: this._symbolCoordinate,\n                viewport: {\n                  width: this._xAxis.width(),\n                  height: this._yAxis.height(),\n                  barSpace: barSpace\n                },\n                styles: symbolOptions,\n                isActive: isActive\n              });\n              break;\n            }\n        }\n      }\n    }, {\n      key: \"draw\",\n      value: function draw(ctx) {\n        var styles = this._styles || this._chartData.styleOptions().annotation;\n\n        var symbolOptions = styles.symbol;\n        var offset = symbolOptions.offset || [];\n        var y = 0;\n\n        switch (symbolOptions.position) {\n          case OverlayPosition.POINT:\n            {\n              y = this._yAxis.convertToPixel(this._point.price);\n              break;\n            }\n\n          case OverlayPosition.TOP:\n            {\n              y = 0;\n              break;\n            }\n\n          case OverlayPosition.BOTTOM:\n            {\n              y = this._yAxis.height();\n              break;\n            }\n        }\n\n        this._symbolCoordinate.y = y + (offset[1] || 0);\n\n        var isActive = this._id === this._chartData.annotationMouseOperate().id;\n\n        this._drawSymbol(ctx, isActive, styles);\n\n        if (this.drawExtend) {\n          ctx.save();\n          this.drawExtend({\n            ctx: ctx,\n            point: this._point,\n            coordinate: this._symbolCoordinate,\n            viewport: {\n              width: this._xAxis.width(),\n              height: this._yAxis.height()\n            },\n            styles: styles,\n            isActive: isActive\n          });\n          ctx.restore();\n        }\n      }\n    }, {\n      key: \"checkMousePointOnGraphic\",\n      value: function checkMousePointOnGraphic(mouseCoordinate) {\n        var barSpace = this._chartData.barSpace();\n\n        var styles = this._styles || this._chartData.styleOptions().annotation;\n\n        var symbolOptions = styles.symbol;\n        var size = isNumber(symbolOptions.size) ? symbolOptions.size : barSpace;\n        var isOn;\n\n        switch (symbolOptions.type) {\n          case AnnotationSymbolType.CIRCLE:\n            {\n              isOn = checkPointInCircle(this._symbolCoordinate, size / 2, mouseCoordinate);\n              break;\n            }\n\n          case AnnotationSymbolType.RECT:\n            {\n              var coordinate1 = {\n                x: this._symbolCoordinate.x - size / 2,\n                y: this._symbolCoordinate.y - size / 2\n              };\n              var coordinate2 = {\n                x: this._symbolCoordinate.x + size / 2,\n                y: this._symbolCoordinate.y + size / 2\n              };\n              isOn = checkPointInRect(coordinate1, coordinate2, mouseCoordinate);\n              break;\n            }\n\n          case AnnotationSymbolType.DIAMOND:\n            {\n              isOn = checkPointInDiamond(this._symbolCoordinate, size, size, mouseCoordinate);\n              break;\n            }\n\n          case AnnotationSymbolType.TRIANGLE:\n            {\n              isOn = checkPointInTriangle([{\n                x: this._symbolCoordinate.x - size / 2,\n                y: this._symbolCoordinate.y + size / 2\n              }, {\n                x: this._symbolCoordinate.x,\n                y: this._symbolCoordinate.y - size / 2\n              }, {\n                x: this._symbolCoordinate.x + size / 2,\n                y: this._symbolCoordinate.y + size / 2\n              }], mouseCoordinate);\n              break;\n            }\n\n          case AnnotationSymbolType.CUSTOM:\n            {\n              isOn = this.checkPointInCustomSymbol({\n                mouseCoordinate: mouseCoordinate,\n                coordinate: this._symbolCoordinate,\n                size: size\n              });\n              break;\n            }\n        }\n\n        if (isOn) {\n          return {\n            id: this._id,\n            instance: this\n          };\n        }\n      }\n      /**\n       * 生成标识坐标\n       * @param x\n       */\n\n    }, {\n      key: \"createSymbolCoordinate\",\n      value: function createSymbolCoordinate(x) {\n        var styles = this._styles || this._chartData.styleOptions().annotation;\n\n        var symbolOptions = styles.symbol;\n        var offset = symbolOptions.offset || [];\n        this._symbolCoordinate = {\n          x: x + (offset[0] || 0)\n        };\n      }\n      /**\n       * 获取点\n       * @return {*}\n       */\n\n    }, {\n      key: \"points\",\n      value: function points() {\n        return this._point;\n      }\n      /**\n       * 检查鼠标点是否在自定义标识内\n       * @param mouseCoordinate\n       * @param coordinate\n       * @param size\n       */\n\n    }, {\n      key: \"checkPointInCustomSymbol\",\n      value: function checkPointInCustomSymbol(_ref2) {\n        _ref2.mouseCoordinate;\n        _ref2.coordinate;\n        _ref2.size;\n      }\n      /**\n       * 绘制自定义标识\n       * @param ctx\n       * @param point\n       * @param coordinate\n       * @param viewport\n       * @param styles\n       * @param isActive\n       */\n\n    }, {\n      key: \"drawCustomSymbol\",\n      value: function drawCustomSymbol(_ref3) {\n        _ref3.ctx;\n        _ref3.point;\n        _ref3.coordinate;\n        _ref3.viewport;\n        _ref3.styles;\n        _ref3.isActive;\n      }\n    }]);\n\n    return Annotation;\n  }(Overlay);\n\n  var Tag = /*#__PURE__*/function (_Overlay) {\n    _inherits(Tag, _Overlay);\n\n    var _super = _createSuper(Tag);\n\n    function Tag(_ref) {\n      var _this;\n\n      var id = _ref.id,\n          point = _ref.point,\n          text = _ref.text,\n          mark = _ref.mark,\n          chartData = _ref.chartData,\n          xAxis = _ref.xAxis,\n          yAxis = _ref.yAxis,\n          styles = _ref.styles;\n\n      _classCallCheck(this, Tag);\n\n      _this = _super.call(this, {\n        id: id,\n        chartData: chartData,\n        xAxis: xAxis,\n        yAxis: yAxis\n      });\n      _this._point = point || {};\n      _this._text = text;\n      _this._mark = mark;\n\n      _this.setStyles(styles, chartData.styleOptions().tag);\n\n      return _this;\n    }\n    /**\n     * 更新\n     * @param point\n     * @param text\n     * @param mark\n     * @param styles\n     * @return {boolean}\n     */\n\n\n    _createClass(Tag, [{\n      key: \"update\",\n      value: function update(_ref2) {\n        var point = _ref2.point,\n            text = _ref2.text,\n            mark = _ref2.mark,\n            styles = _ref2.styles;\n        var success = false;\n\n        if (isObject(point)) {\n          this._point = point;\n          success = true;\n        }\n\n        if (isValid(text)) {\n          this._text = text;\n          success = true;\n        }\n\n        if (isValid(mark)) {\n          this._mark = mark;\n          success = true;\n        }\n\n        if (this.setStyles(styles, this._chartData.styleOptions().tag)) {\n          success = true;\n        }\n\n        return success;\n      }\n      /**\n       * 绘制标记和线\n       * @param ctx\n       */\n\n    }, {\n      key: \"drawMarkLine\",\n      value: function drawMarkLine(ctx) {\n        var options = this._chartData.styleOptions();\n\n        var yAxisOptions = options.yAxis;\n        var tagOptions = this._styles || options.tag;\n\n        var y = this._getY(tagOptions);\n\n        ctx.save();\n\n        this._drawLine(ctx, y, tagOptions.line);\n\n        this._drawMark(ctx, y, tagOptions, yAxisOptions);\n\n        ctx.restore();\n      }\n      /**\n       * 绘制值\n       */\n\n    }, {\n      key: \"drawText\",\n      value: function drawText(ctx) {\n        if (!isValid(this._text)) {\n          return;\n        }\n\n        var options = this._chartData.styleOptions();\n\n        var tagOptions = this._styles || options.tag;\n        var tagTextOptions = tagOptions.text;\n        ctx.font = createFont(tagTextOptions.size, tagTextOptions.weight, tagTextOptions.family);\n\n        var rectWidth = this._getTextRectWidth(ctx, tagTextOptions);\n\n        var rectHeight = tagTextOptions.paddingTop + tagTextOptions.paddingBottom + tagTextOptions.size;\n        var x;\n\n        if (this._yAxis.isFromYAxisZero()) {\n          x = 0;\n        } else {\n          x = this._yAxis.width() - rectWidth;\n        }\n\n        var y = this._getY(tagOptions);\n\n        renderFillRoundRect(ctx, tagTextOptions.backgroundColor, x, y - rectHeight / 2, rectWidth, rectHeight, tagTextOptions.borderRadius);\n        renderText(ctx, tagTextOptions.color, x + tagTextOptions.paddingLeft, y, this._text);\n      }\n      /**\n       * 绘制线\n       * @param ctx\n       * @param y\n       * @param tagLineOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawLine\",\n      value: function _drawLine(ctx, y, tagLineOptions) {\n        if (!tagLineOptions.show) {\n          return;\n        }\n\n        ctx.strokeStyle = tagLineOptions.color;\n        ctx.lineWidth = tagLineOptions.size;\n\n        if (tagLineOptions.style === LineStyle.DASH) {\n          ctx.setLineDash(tagLineOptions.dashValue);\n        }\n\n        renderHorizontalLine(ctx, y, 0, this._xAxis.width());\n      }\n      /**\n       * 绘制标记\n       * @param ctx\n       * @param y\n       * @param tagOptions\n       * @param yAxisOptions\n       * @private\n       */\n\n    }, {\n      key: \"_drawMark\",\n      value: function _drawMark(ctx, y, tagOptions, yAxisOptions) {\n        if (!isValid(this._mark)) {\n          return;\n        }\n\n        var tagMarkOptions = tagOptions.mark;\n        ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family);\n        var rectWidth = tagMarkOptions.paddingLeft + tagMarkOptions.paddingRight + calcTextWidth(ctx, this._mark);\n        var rectHeight = tagMarkOptions.paddingTop + tagMarkOptions.paddingBottom + tagMarkOptions.size;\n        var x;\n\n        if (yAxisOptions.inside) {\n          var valueRectWidth = 0;\n\n          if (isValid(this._text)) {\n            valueRectWidth = this._getTextRectWidth(ctx, tagOptions.text);\n          }\n\n          if (yAxisOptions.position === YAxisPosition.LEFT) {\n            x = valueRectWidth;\n          } else {\n            x = this._xAxis.width() - valueRectWidth - rectWidth;\n          }\n        } else {\n          if (yAxisOptions.position === YAxisPosition.LEFT) {\n            x = 0;\n          } else {\n            x = this._xAxis.width() - rectWidth;\n          }\n        }\n\n        renderFillRoundRect(ctx, tagMarkOptions.backgroundColor, x, y - rectHeight / 2, rectWidth, rectHeight, tagMarkOptions.borderRadius);\n        ctx.textBaseline = 'middle';\n        ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family);\n        renderText(ctx, tagMarkOptions.color, x + tagMarkOptions.paddingLeft, y, this._mark);\n      }\n      /**\n       * 获取坐标y值\n       * @param tagOptions\n       * @return {*}\n       * @private\n       */\n\n    }, {\n      key: \"_getY\",\n      value: function _getY(tagOptions) {\n        var offset = tagOptions.offset;\n\n        switch (tagOptions.position) {\n          case OverlayPosition.TOP:\n            {\n              return offset;\n            }\n\n          case OverlayPosition.BOTTOM:\n            {\n              return this._yAxis.height() + offset;\n            }\n\n          default:\n            {\n              return this._yAxis.convertToNicePixel(this._point.price) + offset;\n            }\n        }\n      }\n      /**\n       * 获取值的矩形宽度\n       * @param ctx\n       * @param textOptions\n       * @return {*}\n       * @private\n       */\n\n    }, {\n      key: \"_getTextRectWidth\",\n      value: function _getTextRectWidth(ctx, textOptions) {\n        ctx.font = createFont(textOptions.size, textOptions.weight, textOptions.family);\n        return textOptions.paddingLeft + textOptions.paddingRight + calcTextWidth(ctx, this._text);\n      }\n    }]);\n\n    return Tag;\n  }(Overlay);\n\n  var ChartPane = /*#__PURE__*/function () {\n    function ChartPane(container, styleOptions) {\n      _classCallCheck(this, ChartPane);\n\n      this._initChartContainer(container);\n\n      this._graphicMarkBaseId = 0;\n      this._paneBaseId = 0;\n      this._separatorDragStartTopPaneHeight = 0;\n      this._separatorDragStartBottomPaneHeight = 0;\n      this._chartData = new ChartData(styleOptions, {\n        invalidate: this._invalidatePane.bind(this),\n        crosshair: this._crosshairObserver.bind(this)\n      });\n      this._xAxisPane = new XAxisPane({\n        container: this._chartContainer,\n        chartData: this._chartData\n      });\n      this._panes = new Map([[CANDLE_PANE_ID, new CandlePane({\n        container: this._chartContainer,\n        chartData: this._chartData,\n        xAxis: this._xAxisPane.xAxis(),\n        id: CANDLE_PANE_ID\n      })]]);\n      this._separators = new Map();\n      this._chartWidth = {};\n      this._chartHeight = {};\n      this._chartEvent = new ChartEvent(this._chartContainer, this._chartData);\n      this.adjustPaneViewport(true, true, true);\n    }\n    /**\n     * 初始化图表容器\n     * @param container\n     * @private\n     */\n\n\n    _createClass(ChartPane, [{\n      key: \"_initChartContainer\",\n      value: function _initChartContainer(container) {\n        this._container = container;\n        this._chartContainer = document.createElement('div');\n        this._chartContainer.style.userSelect = 'none';\n        this._chartContainer.style.webkitUserSelect = 'none';\n        this._chartContainer.style.msUserSelect = 'none';\n        this._chartContainer.style.MozUserSelect = 'none';\n        this._chartContainer.style.webkitTapHighlightColor = 'transparent';\n        this._chartContainer.style.position = 'relative';\n        this._chartContainer.style.outline = 'none';\n        this._chartContainer.style.borderStyle = 'none';\n        this._chartContainer.style.width = '100%';\n        this._chartContainer.style.cursor = 'crosshair';\n        this._chartContainer.tabIndex = 1;\n        container.appendChild(this._chartContainer);\n      }\n      /**\n       * 十字光标观察者\n       * @private\n       */\n\n    }, {\n      key: \"_crosshairObserver\",\n      value: function _crosshairObserver(_ref) {\n        var dataIndex = _ref.dataIndex,\n            kLineData = _ref.kLineData,\n            x = _ref.x,\n            y = _ref.y;\n\n        if (this.chartData().hasAction(ActionType.CROSSHAIR)) {\n          var technicalIndicatorData = {};\n\n          this._panes.forEach(function (pane, id) {\n            var data = {};\n            pane.technicalIndicators().forEach(function (tech) {\n              var result = tech.result;\n              data[tech.name] = result[dataIndex];\n            });\n            technicalIndicatorData[id] = data;\n          });\n\n          this._chartData.actionExecute(ActionType.CROSSHAIR, {\n            coordinate: {\n              x: x,\n              y: y\n            },\n            dataIndex: dataIndex,\n            kLineData: kLineData,\n            technicalIndicatorData: technicalIndicatorData\n          });\n        }\n      }\n      /**\n       * 分割线拖拽开始\n       * @param topPaneId\n       * @param bottomPaneId\n       * @private\n       */\n\n    }, {\n      key: \"_separatorStartDrag\",\n      value: function _separatorStartDrag(topPaneId, bottomPaneId) {\n        this._separatorDragStartTopPaneHeight = this._panes.get(topPaneId).height();\n        this._separatorDragStartBottomPaneHeight = this._panes.get(bottomPaneId).height();\n      }\n      /**\n       * 分割线拖拽\n       * @param dragDistance\n       * @param topPaneId\n       * @param bottomPaneId\n       * @private\n       */\n\n    }, {\n      key: \"_separatorDrag\",\n      value: function _separatorDrag(dragDistance, topPaneId, bottomPaneId) {\n        var topPaneHeight = this._separatorDragStartTopPaneHeight + dragDistance;\n        var bottomPaneHeight = this._separatorDragStartBottomPaneHeight - dragDistance;\n\n        if (topPaneHeight > this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight) {\n          topPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight;\n          bottomPaneHeight = 0;\n        }\n\n        if (topPaneHeight < 0) {\n          topPaneHeight = 0;\n          bottomPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight;\n        }\n\n        this._panes.get(topPaneId).setHeight(topPaneHeight);\n\n        this._panes.get(bottomPaneId).setHeight(bottomPaneHeight);\n\n        this._chartData.actionExecute(ActionType.PANE_DRAG, {\n          topPaneId: topPaneId,\n          bottomPaneId: bottomPaneId,\n          topPaneHeight: topPaneHeight,\n          bottomPaneHeight: bottomPaneHeight\n        });\n\n        this.adjustPaneViewport(true, true, true, true, true);\n      }\n      /**\n       * 更新所有pane\n       * @private\n       */\n\n    }, {\n      key: \"_invalidatePane\",\n      value: function _invalidatePane() {\n        var invalidateLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : InvalidateLevel.FULL;\n\n        if (invalidateLevel === InvalidateLevel.OVERLAY) {\n          this._xAxisPane.invalidate(invalidateLevel);\n\n          this._panes.forEach(function (pane) {\n            pane.invalidate(invalidateLevel);\n          });\n        } else {\n          var shouldMeasureWidth = false;\n\n          this._panes.forEach(function (pane) {\n            var should = pane.yAxis().computeAxis();\n\n            if (should) {\n              shouldMeasureWidth = should;\n            }\n          });\n\n          this.adjustPaneViewport(false, shouldMeasureWidth, true);\n        }\n      }\n      /**\n       * 计算所有pane的指标\n       * @private\n       */\n\n    }, {\n      key: \"_calcAllPaneTechnicalIndicator\",\n      value: function _calcAllPaneTechnicalIndicator() {\n        var _this = this;\n\n        var tasks = [];\n\n        this._panes.forEach(function (pane) {\n          tasks.push(Promise.resolve(pane.calcAllTechnicalIndicator()));\n        });\n\n        Promise.all(tasks).then(function (result) {\n          var shouldMeasureWidth = result.indexOf(true) > -1;\n\n          _this.adjustPaneViewport(false, shouldMeasureWidth, true);\n        });\n      }\n      /**\n       * 测量pane高度\n       * @private\n       */\n\n    }, {\n      key: \"_measurePaneHeight\",\n      value: function _measurePaneHeight() {\n        var _this2 = this;\n\n        var styleOptions = this._chartData.styleOptions();\n\n        var paneHeight = this._container.offsetHeight;\n        var separatorSize = styleOptions.separator.size;\n        var separatorTotalHeight = separatorSize * this._separators.size;\n\n        var xAxisHeight = this._xAxisPane.xAxis().getSelfHeight();\n\n        var paneExcludeXAxisSeparatorHeight = paneHeight - xAxisHeight - separatorTotalHeight;\n        var techPaneTotalHeight = 0;\n\n        this._panes.forEach(function (pane) {\n          if (pane.id() !== CANDLE_PANE_ID) {\n            var _paneHeight = pane.height();\n\n            if (techPaneTotalHeight + _paneHeight > paneExcludeXAxisSeparatorHeight) {\n              pane.setHeight(paneExcludeXAxisSeparatorHeight - techPaneTotalHeight);\n              techPaneTotalHeight = paneExcludeXAxisSeparatorHeight;\n            } else {\n              techPaneTotalHeight += _paneHeight;\n            }\n          }\n        });\n\n        var candlePaneHeight = paneExcludeXAxisSeparatorHeight - techPaneTotalHeight;\n        var paneContentSize = {};\n        paneContentSize[CANDLE_PANE_ID] = {\n          contentTop: 0,\n          contentBottom: candlePaneHeight\n        };\n        var contentTop = candlePaneHeight;\n        var contentBottom = candlePaneHeight;\n\n        this._panes.get(CANDLE_PANE_ID).setHeight(candlePaneHeight);\n\n        this._chartHeight[CANDLE_PANE_ID] = candlePaneHeight;\n\n        this._panes.forEach(function (pane) {\n          if (pane.id() !== CANDLE_PANE_ID) {\n            var _paneHeight2 = pane.height();\n\n            contentBottom += _paneHeight2 + separatorSize;\n            paneContentSize[pane.id()] = {\n              contentTop: contentTop,\n              contentBottom: contentBottom\n            };\n            _this2._chartHeight[pane.id()] = _paneHeight2;\n            contentTop = contentBottom;\n          }\n        });\n\n        this._xAxisPane.setHeight(xAxisHeight);\n\n        this._chartHeight.xAxis = xAxisHeight;\n        this._chartHeight.total = paneHeight;\n\n        this._chartEvent.setPaneContentSize(paneContentSize);\n      }\n      /**\n       * 测量pan宽度\n       * @private\n       */\n\n    }, {\n      key: \"_measurePaneWidth\",\n      value: function _measurePaneWidth() {\n        var _this3 = this;\n\n        var styleOptions = this._chartData.styleOptions();\n\n        var yAxisOptions = styleOptions.yAxis;\n        var isYAxisLeft = yAxisOptions.position === YAxisPosition.LEFT;\n        var isOutside = !yAxisOptions.inside;\n        var paneWidth = this._container.offsetWidth;\n        var mainWidth;\n        var yAxisWidth = Number.MIN_SAFE_INTEGER;\n        var yAxisOffsetLeft;\n        var mainOffsetLeft;\n\n        if (isOutside) {\n          this._panes.forEach(function (pane) {\n            yAxisWidth = Math.max(yAxisWidth, pane.yAxis().getSelfWidth());\n          });\n\n          mainWidth = paneWidth - yAxisWidth;\n\n          if (isYAxisLeft) {\n            yAxisOffsetLeft = 0;\n            mainOffsetLeft = yAxisWidth;\n          } else {\n            mainOffsetLeft = 0;\n            yAxisOffsetLeft = paneWidth - yAxisWidth;\n          }\n        } else {\n          mainWidth = paneWidth;\n          yAxisWidth = paneWidth;\n          yAxisOffsetLeft = 0;\n          mainOffsetLeft = 0;\n        }\n\n        this._chartData.setTotalDataSpace(mainWidth);\n\n        this._panes.forEach(function (pane, paneId) {\n          pane.setWidth(mainWidth, yAxisWidth);\n          pane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft);\n\n          var separator = _this3._separators.get(paneId);\n\n          separator && separator.setSize(mainOffsetLeft, mainWidth);\n        });\n\n        this._chartWidth = {\n          content: mainWidth,\n          yAxis: yAxisWidth,\n          total: paneWidth\n        };\n\n        this._xAxisPane.setWidth(mainWidth, yAxisWidth);\n\n        this._xAxisPane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft);\n\n        this._chartEvent.setChartContentSize({\n          contentLeft: mainOffsetLeft,\n          contentRight: mainOffsetLeft + mainWidth\n        });\n      }\n      /**\n       * 调整窗口尺寸\n       * @param shouldMeasureHeight\n       * @param shouldMeasureWidth\n       * @param shouldLayout\n       * @param shouldComputeAxis\n       * @param shouldForceComputeAxis\n       */\n\n    }, {\n      key: \"adjustPaneViewport\",\n      value: function adjustPaneViewport(shouldMeasureHeight, shouldMeasureWidth, shouldLayout, shouldComputeAxis, shouldForceComputeAxis) {\n        if (shouldMeasureHeight) {\n          this._measurePaneHeight();\n        }\n\n        var isAdjust = false;\n\n        if (shouldComputeAxis) {\n          this._panes.forEach(function (pane) {\n            var adjust = pane.yAxis().computeAxis(shouldForceComputeAxis);\n\n            if (!isAdjust) {\n              isAdjust = adjust;\n            }\n          });\n        }\n\n        if (!shouldComputeAxis && shouldMeasureWidth || shouldComputeAxis && isAdjust) {\n          this._measurePaneWidth();\n        }\n\n        if (shouldLayout) {\n          this._xAxisPane.xAxis().computeAxis(true);\n\n          this._xAxisPane.layout();\n\n          this._panes.forEach(function (pane) {\n            pane.layout();\n          });\n        }\n      }\n      /**\n       * 获取图表上的数据\n       * @returns {ChartData}\n       */\n\n    }, {\n      key: \"chartData\",\n      value: function chartData() {\n        return this._chartData;\n      }\n      /**\n       * 覆盖技术指标\n       * @param techInstance\n       * @param name\n       * @param calcParams\n       * @param calcParamsAllowDecimal\n       * @param precision\n       * @param styles\n       */\n\n    }, {\n      key: \"overrideTechnicalIndicator\",\n      value: function overrideTechnicalIndicator(techInstance, _ref2) {\n        var _this4 = this;\n\n        var name = _ref2.name,\n            calcParams = _ref2.calcParams,\n            calcParamsAllowDecimal = _ref2.calcParamsAllowDecimal,\n            precision = _ref2.precision,\n            styles = _ref2.styles;\n        techInstance.setCalcParamsAllowDecimal(calcParamsAllowDecimal);\n        var calcParamsSuccess = techInstance.setCalcParams(calcParams);\n        var precisionSuccess = techInstance.setPrecision(precision);\n\n        var defaultTechnicalStyleOptions = this._chartData.styleOptions().technicalIndicator;\n\n        var styleSuccess = techInstance.setStyles(styles, defaultTechnicalStyleOptions);\n\n        if (calcParamsSuccess || precisionSuccess || styleSuccess) {\n          var shouldAdjust = false;\n          var tasks = [];\n\n          this._panes.forEach(function (pane) {\n            var techs = pane.technicalIndicators();\n\n            if (techs.has(name)) {\n              shouldAdjust = true;\n              var tech = techs.get(name);\n\n              if (calcParamsSuccess) {\n                tasks.push(Promise.resolve(pane.calcTechnicalIndicator(tech)));\n              }\n            }\n          });\n\n          if (shouldAdjust) {\n            Promise.all(tasks).then(function (_) {\n              _this4.adjustPaneViewport(false, true, true, true);\n            });\n          }\n        }\n      }\n      /**\n       * 处理数组数据\n       * @param dataList\n       * @param more\n       * @param extendFun\n       * @private\n       */\n\n    }, {\n      key: \"_applyDataList\",\n      value: function _applyDataList(dataList, more, extendFun) {\n        if (isArray(dataList)) {\n          if (isFunction(extendFun)) {\n            extendFun();\n          }\n\n          this._chartData.addData(dataList, 0, more);\n\n          this._calcAllPaneTechnicalIndicator();\n        }\n      }\n      /**\n       * 添加新数据\n       * @param dataList\n       * @param more\n       */\n\n    }, {\n      key: \"applyNewData\",\n      value: function applyNewData(dataList, more) {\n        var _this5 = this;\n\n        this._applyDataList(dataList, more, function () {\n          _this5._chartData.clearDataList();\n        });\n      }\n      /**\n       * 添加更多数据\n       * @param dataList\n       * @param more\n       */\n\n    }, {\n      key: \"applyMoreData\",\n      value: function applyMoreData(dataList, more) {\n        this._applyDataList(dataList, more);\n      }\n      /**\n       * 更新数据\n       * @param data\n       */\n\n    }, {\n      key: \"updateData\",\n      value: function updateData(data) {\n        var dataList = this._chartData.dataList();\n\n        var dataSize = dataList.length; // 这里判断单个数据应该添加到哪个位置\n\n        var timestamp = formatValue(data, 'timestamp', 0);\n        var lastDataTimestamp = formatValue(dataList[dataSize - 1], 'timestamp', 0);\n\n        if (timestamp >= lastDataTimestamp) {\n          var pos = dataSize;\n\n          if (timestamp === lastDataTimestamp) {\n            pos = dataSize - 1;\n          }\n\n          this._chartData.addData(data, pos);\n\n          this._calcAllPaneTechnicalIndicator();\n        }\n      }\n      /**\n       * 移除指标\n       * @param paneId\n       * @param name\n       */\n\n    }, {\n      key: \"removeTechnicalIndicator\",\n      value: function removeTechnicalIndicator(paneId, name) {\n        var _this6 = this;\n\n        if (this._panes.has(paneId)) {\n          if (paneId === CANDLE_PANE_ID) {\n            if (this._panes.get(CANDLE_PANE_ID).removeTechnicalIndicator(name)) {\n              this.adjustPaneViewport(false, true, true, true);\n            }\n          } else {\n            var pane = this._panes.get(paneId);\n\n            var removed = pane.removeTechnicalIndicator(name);\n\n            if (pane.isEmptyTechnicalIndicator()) {\n              pane.destroy();\n\n              var deleteSeparatorTopPaneId = this._separators.get(paneId).topPaneId();\n\n              this._separators.get(paneId).destroy();\n\n              this._panes.delete(paneId);\n\n              this._separators.delete(paneId);\n\n              this._separators.forEach(function (separator) {\n                var topPaneId = separator.topPaneId();\n\n                if (!_this6._separators.has(topPaneId)) {\n                  separator.updatePaneId(deleteSeparatorTopPaneId);\n                }\n              });\n\n              this.adjustPaneViewport(true, true, true, true, true);\n            } else {\n              if (removed) {\n                this.adjustPaneViewport(false, true, true, true);\n              }\n            }\n          }\n        }\n      }\n      /**\n       * 设置指标类型\n       * @param tech 技术指标实例\n       * @param isStack 是否覆盖\n       * @param options 配置\n       */\n\n    }, {\n      key: \"createTechnicalIndicator\",\n      value: function createTechnicalIndicator(tech, isStack) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n        if (this._panes.has(options.id)) {\n          this.setPaneOptions(options, this._panes.get(options.id).setTechnicalIndicator(tech, isStack));\n          return options.id;\n        }\n\n        var id = options.id || \"\".concat(TECHNICAL_INDICATOR_PANE_ID_PREFIX).concat(++this._paneBaseId);\n        var dragEnabled = isBoolean(options.dragEnabled) ? options.dragEnabled : true;\n\n        this._separators.set(id, new SeparatorPane(this._chartContainer, this._chartData, Array.from(this._panes.keys()).pop(), id, dragEnabled, {\n          startDrag: this._separatorStartDrag.bind(this),\n          drag: throttle(this._separatorDrag.bind(this), 50)\n        }));\n\n        this._panes.set(id, new TechnicalIndicatorPane({\n          container: this._chartContainer,\n          chartData: this._chartData,\n          xAxis: this._xAxisPane.xAxis(),\n          name: tech.name,\n          id: id,\n          height: options.height || DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT\n        }));\n\n        this.adjustPaneViewport(true, true, true, true, true);\n        return id;\n      }\n      /**\n       * 获取窗口技术指标\n       * @param paneId\n       * @return {{}}\n       */\n\n    }, {\n      key: \"getPaneTechnicalIndicator\",\n      value: function getPaneTechnicalIndicator(paneId) {\n        var technicalIndicatorInfo = function technicalIndicatorInfo(pane) {\n          var paneTechs = {};\n          pane.technicalIndicators().forEach(function (tech) {\n            paneTechs[tech.name] = createTechnicalIndicatorInfo(tech);\n          });\n          return paneTechs;\n        };\n\n        if (isValid(paneId)) {\n          if (this._panes.has(paneId)) {\n            return technicalIndicatorInfo(this._panes.get(paneId));\n          }\n        } else {\n          var techs = {};\n\n          this._panes.forEach(function (pane) {\n            techs[pane.id()] = technicalIndicatorInfo(pane);\n          });\n\n          return techs;\n        }\n\n        return {};\n      }\n      /**\n       * 创建图形标记\n       * @param GraphicMark\n       * @param options\n       */\n\n    }, {\n      key: \"createGraphicMark\",\n      value: function createGraphicMark(GraphicMark) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var id = options.id,\n            points = options.points,\n            styles = options.styles,\n            lock = options.lock,\n            onDrawStart = options.onDrawStart,\n            onDrawing = options.onDrawing,\n            onDrawEnd = options.onDrawEnd,\n            onClick = options.onClick,\n            onRightClick = options.onRightClick,\n            onPressedMove = options.onPressedMove,\n            onMouseEnter = options.onMouseEnter,\n            onMouseLeave = options.onMouseLeave,\n            onRemove = options.onRemove;\n        var graphicMarkId = id || \"\".concat(GRAPHIC_MARK_ID_PREFIX).concat(++this._graphicMarkBaseId);\n        var graphicMarkInstance = new GraphicMark({\n          id: graphicMarkId,\n          chartData: this._chartData,\n          xAxis: this._xAxisPane.xAxis(),\n          yAxis: this._panes.get(CANDLE_PANE_ID).yAxis(),\n          points: points,\n          styles: styles,\n          lock: lock\n        });\n\n        if (isFunction(onDrawStart)) {\n          graphicMarkInstance.onDrawStart = onDrawStart;\n          graphicMarkInstance.onDrawStart({\n            id: graphicMarkId\n          });\n        }\n\n        if (isFunction(onDrawing)) {\n          graphicMarkInstance.onDrawing = onDrawing;\n        }\n\n        if (isFunction(onDrawEnd)) {\n          graphicMarkInstance.onDrawEnd = onDrawEnd;\n        }\n\n        if (isFunction(onClick)) {\n          graphicMarkInstance.onClick = onClick;\n        }\n\n        if (isFunction(onRightClick)) {\n          graphicMarkInstance.onRightClick = onRightClick;\n        }\n\n        if (isFunction(onPressedMove)) {\n          graphicMarkInstance.onPressedMove = onPressedMove;\n        }\n\n        if (isFunction(onMouseEnter)) {\n          graphicMarkInstance.onMouseEnter = onMouseEnter;\n        }\n\n        if (isFunction(onMouseLeave)) {\n          graphicMarkInstance.onMouseLeave = onMouseLeave;\n        }\n\n        if (isFunction(onRemove)) {\n          graphicMarkInstance.onRemove = onRemove;\n        }\n\n        if (this._chartData.addGraphicMarkInstance(graphicMarkInstance)) {\n          return graphicMarkId;\n        }\n      }\n      /**\n       * 创建注解\n       * @param annotations\n       */\n\n    }, {\n      key: \"createAnnotation\",\n      value: function createAnnotation(annotations) {\n        var _this7 = this;\n\n        var instances = [];\n        annotations.forEach(function (_ref3) {\n          var point = _ref3.point,\n              styles = _ref3.styles,\n              checkPointInCustomSymbol = _ref3.checkPointInCustomSymbol,\n              drawCustomSymbol = _ref3.drawCustomSymbol,\n              drawExtend = _ref3.drawExtend,\n              onClick = _ref3.onClick,\n              onRightClick = _ref3.onRightClick,\n              onMouseEnter = _ref3.onMouseEnter,\n              onMouseLeave = _ref3.onMouseLeave;\n\n          if (point && point.timestamp) {\n            var annotationInstance = new Annotation({\n              id: point.timestamp,\n              chartData: _this7._chartData,\n              point: point,\n              xAxis: _this7._xAxisPane.xAxis(),\n              yAxis: _this7._panes.get(CANDLE_PANE_ID).yAxis(),\n              styles: styles\n            });\n\n            if (isFunction(drawExtend)) {\n              annotationInstance.drawExtend = drawExtend;\n            }\n\n            if (isFunction(checkPointInCustomSymbol)) {\n              annotationInstance.checkPointInCustomSymbol = checkPointInCustomSymbol;\n            }\n\n            if (isFunction(drawCustomSymbol)) {\n              annotationInstance.drawCustomSymbol = drawCustomSymbol;\n            }\n\n            if (isFunction(onClick)) {\n              annotationInstance.onClick = onClick;\n            }\n\n            if (isFunction(onRightClick)) {\n              annotationInstance.onRightClick = onRightClick;\n            }\n\n            if (isFunction(onMouseEnter)) {\n              annotationInstance.onMouseEnter = onMouseEnter;\n            }\n\n            if (isFunction(onMouseLeave)) {\n              annotationInstance.onMouseLeave = onMouseLeave;\n            }\n\n            instances.push(annotationInstance);\n          }\n        });\n\n        if (instances.length > 0) {\n          this._chartData.addAnnotations(instances);\n        }\n      }\n      /**\n       * 创建标签\n       * @param tags\n       */\n\n    }, {\n      key: \"createTag\",\n      value: function createTag(tags) {\n        var _this8 = this;\n\n        var instances = [];\n        var shouldUpdate = false;\n        var shouldAdd = false;\n        tags.forEach(function (_ref4) {\n          var id = _ref4.id,\n              point = _ref4.point,\n              text = _ref4.text,\n              mark = _ref4.mark,\n              styles = _ref4.styles;\n\n          if (isValid(id)) {\n            var tag = _this8._chartData.getTag(id);\n\n            if (tag) {\n              var updateSuccess = tag.update({\n                point: point,\n                text: text,\n                mark: mark,\n                styles: styles\n              });\n\n              if (!shouldUpdate) {\n                shouldUpdate = updateSuccess;\n              }\n            } else {\n              shouldAdd = true;\n              instances.push(new Tag({\n                id: id,\n                point: point,\n                text: text,\n                mark: mark,\n                styles: styles,\n                chartData: _this8._chartData,\n                xAxis: _this8._xAxisPane.xAxis(),\n                yAxis: _this8._panes.get(CANDLE_PANE_ID).yAxis()\n              }));\n            }\n          }\n        });\n\n        if (shouldAdd) {\n          this._chartData.addTags(instances);\n        } else {\n          if (shouldUpdate) {\n            this._invalidatePane(InvalidateLevel.OVERLAY);\n          }\n        }\n      }\n      /**\n       * 设置窗体参数\n       * @param options\n       * @param forceShouldAdjust\n       */\n\n    }, {\n      key: \"setPaneOptions\",\n      value: function setPaneOptions(options, forceShouldAdjust) {\n        var shouldAdjust = forceShouldAdjust;\n        var shouldMeasureHeight = false;\n\n        if (options.id !== CANDLE_PANE_ID) {\n          var pane = this._panes.get(options.id);\n\n          if (pane) {\n            if (isNumber(options.height) && options.height > 0 && pane.height() !== options.height) {\n              shouldAdjust = true;\n              pane.setHeight(options.height);\n              shouldMeasureHeight = true;\n            }\n\n            if (isBoolean(options.dragEnabled)) {\n              this._separators.get(options.id).setDragEnabled(options.dragEnabled);\n            }\n          }\n        }\n\n        if (shouldAdjust) {\n          this.adjustPaneViewport(shouldMeasureHeight, true, true, true);\n        }\n      }\n      /**\n       * 设置时区\n       * @param timezone\n       */\n\n    }, {\n      key: \"setTimezone\",\n      value: function setTimezone(timezone) {\n        this._chartData.setTimezone(timezone);\n\n        this._xAxisPane.xAxis().computeAxis(true);\n\n        this._xAxisPane.invalidate(InvalidateLevel.FULL);\n      }\n      /**\n       * 将值装换成像素\n       * @param timestamp\n       * @param value\n       * @param paneId\n       * @param dataIndexXAxis\n       * @param absoluteYAxis\n       */\n\n    }, {\n      key: \"convertToPixel\",\n      value: function convertToPixel(value, _ref5) {\n        var _this9 = this;\n\n        var _ref5$paneId = _ref5.paneId,\n            paneId = _ref5$paneId === void 0 ? CANDLE_PANE_ID : _ref5$paneId,\n            dataIndexXAxis = _ref5.dataIndexXAxis,\n            absoluteYAxis = _ref5.absoluteYAxis;\n        var values = [].concat(value);\n        var coordinates = [];\n\n        var separatorSize = this._chartData.styleOptions().separator.size;\n\n        var absoluteTop = 0;\n\n        var panes = this._panes.values();\n\n        var _iterator = _createForOfIteratorHelper(panes),\n            _step;\n\n        try {\n          var _loop = function _loop() {\n            var pane = _step.value;\n\n            if (pane.id() === paneId) {\n              coordinates = values.map(function (_ref6) {\n                var xAxisValue = _ref6.xAxisValue,\n                    yAxisValue = _ref6.yAxisValue;\n                var coordinate = {};\n\n                if (isValid(xAxisValue)) {\n                  var dataIndex = dataIndexXAxis ? xAxisValue : _this9._chartData.timestampToDataIndex(xAxisValue);\n                  coordinate.x = _this9._xAxisPane.xAxis().convertToPixel(dataIndex);\n                }\n\n                if (isValid(yAxisValue)) {\n                  var y = pane.yAxis().convertToPixel(yAxisValue);\n                  coordinate.y = absoluteYAxis ? absoluteTop + y : y;\n                }\n\n                return coordinate;\n              });\n              return \"break\";\n            }\n\n            absoluteTop += pane.height() + separatorSize;\n          };\n\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var _ret = _loop();\n\n            if (_ret === \"break\") break;\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        return isArray(value) ? coordinates : coordinates[0] || {};\n      }\n      /**\n       * 将像素转换成值\n       * @param coordinate\n       * @param paneId\n       * @param dataIndexXAxis\n       * @param absoluteYAxis\n       * @return {{}[]|*[]}\n       */\n\n    }, {\n      key: \"convertFromPixel\",\n      value: function convertFromPixel(coordinate, _ref7) {\n        var _this10 = this;\n\n        var _ref7$paneId = _ref7.paneId,\n            paneId = _ref7$paneId === void 0 ? CANDLE_PANE_ID : _ref7$paneId,\n            dataIndexXAxis = _ref7.dataIndexXAxis,\n            absoluteYAxis = _ref7.absoluteYAxis;\n        var coordinates = [].concat(coordinate);\n        var values = [];\n\n        var separatorSize = this._chartData.styleOptions().separator.size;\n\n        var absoluteTop = 0;\n\n        var panes = this._panes.values();\n\n        var _iterator2 = _createForOfIteratorHelper(panes),\n            _step2;\n\n        try {\n          var _loop2 = function _loop2() {\n            var pane = _step2.value;\n\n            if (pane.id() === paneId) {\n              values = coordinates.map(function (_ref8) {\n                var x = _ref8.x,\n                    y = _ref8.y;\n                var value = {};\n\n                if (isValid(x)) {\n                  var v = _this10._xAxisPane.xAxis().convertFromPixel(x);\n\n                  value.xAxisValue = dataIndexXAxis ? v : _this10._chartData.dataIndexToTimestamp(v);\n                }\n\n                if (isValid(y)) {\n                  var ry = absoluteYAxis ? y - absoluteTop : y;\n                  value.yAxisValue = pane.yAxis().convertFromPixel(ry);\n                }\n\n                return value;\n              });\n              return \"break\";\n            }\n\n            absoluteTop += pane.height() + separatorSize;\n          };\n\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _ret2 = _loop2();\n\n            if (_ret2 === \"break\") break;\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        return isArray(coordinate) ? values : values[0] || {};\n      }\n      /**\n       * 图表宽度\n       * @return {*|{}}\n       */\n\n    }, {\n      key: \"chartWidth\",\n      value: function chartWidth() {\n        return this._chartWidth;\n      }\n      /**\n       * 图表高度\n       * @return {*|{}}\n       */\n\n    }, {\n      key: \"chartHeight\",\n      value: function chartHeight() {\n        return this._chartHeight;\n      }\n      /**\n       * 获取图表转换为图片后url\n       * @param includeOverlay,\n       * @param type\n       * @param backgroundColor\n       */\n\n    }, {\n      key: \"getConvertPictureUrl\",\n      value: function getConvertPictureUrl(includeOverlay, type, backgroundColor) {\n        var _this11 = this;\n\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var pixelRatio = getPixelRatio(canvas);\n        var width = this._chartContainer.offsetWidth;\n        var height = this._chartContainer.offsetHeight;\n        canvas.style.width = \"\".concat(width, \"px\");\n        canvas.style.height = \"\".concat(height, \"px\");\n        canvas.width = width * pixelRatio;\n        canvas.height = height * pixelRatio;\n        ctx.scale(pixelRatio, pixelRatio);\n        ctx.fillStyle = backgroundColor;\n        ctx.fillRect(0, 0, width, height);\n        var offsetTop = 0;\n\n        this._panes.forEach(function (pane, paneId) {\n          if (paneId !== CANDLE_PANE_ID) {\n            var separator = _this11._separators.get(paneId);\n\n            ctx.drawImage(separator.getImage(), 0, offsetTop, width, separator.height());\n            offsetTop += separator.height();\n          }\n\n          ctx.drawImage(pane.getImage(includeOverlay), 0, offsetTop, width, pane.height());\n          offsetTop += pane.height();\n        });\n\n        ctx.drawImage(this._xAxisPane.getImage(includeOverlay), 0, offsetTop, width, this._xAxisPane.height());\n        return canvas.toDataURL(\"image/\".concat(type));\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this._panes.forEach(function (pane) {\n          pane.destroy();\n        });\n\n        this._separators.forEach(function (pane) {\n          pane.destroy();\n        });\n\n        this._panes.clear();\n\n        this._separators.clear();\n\n        this._xAxisPane.destroy();\n\n        this._container.removeChild(this._chartContainer);\n\n        this._chartEvent.destroy();\n      }\n    }]);\n\n    return ChartPane;\n  }();\n\n  var Chart = /*#__PURE__*/function () {\n    function Chart(container, styleOptions) {\n      _classCallCheck(this, Chart);\n\n      this._chartPane = new ChartPane(container, styleOptions);\n    }\n    /**\n     * 获取宽尺寸\n     * @return {*|{}}\n     */\n\n\n    _createClass(Chart, [{\n      key: \"getWidth\",\n      value: function getWidth() {\n        return this._chartPane.chartWidth();\n      }\n      /**\n       * 获取高度尺寸\n       * @return {*|{}}\n       */\n\n    }, {\n      key: \"getHeight\",\n      value: function getHeight() {\n        return this._chartPane.chartHeight();\n      }\n      /**\n       * 设置样式配置\n       * @param options\n       */\n\n    }, {\n      key: \"setStyleOptions\",\n      value: function setStyleOptions(options) {\n        if (!isObject(options)) {\n          logWarn('setStyleOptions', 'options');\n          return;\n        }\n\n        this._chartPane.chartData().applyStyleOptions(options);\n\n        this._chartPane.adjustPaneViewport(true, true, true, true, true);\n      }\n      /**\n       * 获取样式配置\n       * @returns {[]|*[]}\n       */\n\n    }, {\n      key: \"getStyleOptions\",\n      value: function getStyleOptions() {\n        return clone(this._chartPane.chartData().styleOptions());\n      }\n      /**\n       * 覆盖技术指标\n       * @param override\n       */\n\n    }, {\n      key: \"overrideTechnicalIndicator\",\n      value: function overrideTechnicalIndicator(override) {\n        if (!isObject(override)) {\n          logWarn('overrideTechnicalIndicator', 'override', 'override must be an object!!!');\n          return;\n        }\n\n        var tech = this._chartPane.chartData().getTechnicalIndicatorInstance(override.name);\n\n        if (!tech) {\n          logWarn('overrideTechnicalIndicator', 'override.name', 'can not find the corresponding technical indicator!!!');\n          return;\n        }\n\n        this._chartPane.overrideTechnicalIndicator(tech, override);\n      }\n      /**\n       * 获取技术指标名字获取技术指标\n       * @param name\n       * @return {{}|{series: *, calcParams: *, precision: *, name: *}}\n       */\n\n    }, {\n      key: \"getTechnicalIndicatorByName\",\n      value: function getTechnicalIndicatorByName(name) {\n        return this._chartPane.chartData().getTechnicalIndicatorInfo(name);\n      }\n      /**\n       * 获取窗口上的技术指标\n       * @param paneId\n       * @return {{}}\n       */\n\n    }, {\n      key: \"getTechnicalIndicatorByPaneId\",\n      value: function getTechnicalIndicatorByPaneId(paneId) {\n        return this._chartPane.getPaneTechnicalIndicator(paneId);\n      }\n      /**\n       * 设置价格数量精度\n       * @param pricePrecision\n       * @param volumePrecision\n       */\n\n    }, {\n      key: \"setPriceVolumePrecision\",\n      value: function setPriceVolumePrecision(pricePrecision, volumePrecision) {\n        if (!isNumber(pricePrecision) || pricePrecision < 0) {\n          logWarn('setPriceVolumePrecision', 'pricePrecision', 'pricePrecision must be a number and greater than zero!!!');\n          return;\n        }\n\n        if (!isNumber(volumePrecision) || volumePrecision < 0) {\n          logWarn('setPriceVolumePrecision', 'volumePrecision', 'volumePrecision must be a number and greater than zero!!!');\n          return;\n        }\n\n        this._chartPane.chartData().setPriceVolumePrecision(pricePrecision, volumePrecision);\n      }\n      /**\n       * 设置时区\n       * @param timezone\n       */\n\n    }, {\n      key: \"setTimezone\",\n      value: function setTimezone(timezone) {\n        this._chartPane.setTimezone(timezone);\n      }\n      /**\n       * 获取当前时区\n       */\n\n    }, {\n      key: \"getTimezone\",\n      value: function getTimezone() {\n        return this._chartPane.chartData().timezone();\n      }\n      /**\n       * 重置尺寸，总是会填充父容器\n       */\n\n    }, {\n      key: \"resize\",\n      value: function resize() {\n        this._chartPane.adjustPaneViewport(true, true, true, true, true);\n      }\n      /**\n       * 设置右边间距\n       * @param space\n       */\n\n    }, {\n      key: \"setOffsetRightSpace\",\n      value: function setOffsetRightSpace(space) {\n        if (!isNumber(space)) {\n          logWarn('setOffsetRightSpace', 'space', 'space must be a number!!!');\n          return;\n        }\n\n        this._chartPane.chartData().setOffsetRightSpace(space, true);\n      }\n      /**\n       * 设置左边可见的最小bar数量\n       * @param barCount\n       */\n\n    }, {\n      key: \"setLeftMinVisibleBarCount\",\n      value: function setLeftMinVisibleBarCount(barCount) {\n        if (!isNumber(barCount) || barCount <= 0) {\n          logWarn('setLeftMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!');\n          return;\n        }\n\n        this._chartPane.chartData().setLeftMinVisibleBarCount(Math.ceil(barCount));\n      }\n      /**\n       * 设置右边可见的最小bar数量\n       * @param barCount\n       */\n\n    }, {\n      key: \"setRightMinVisibleBarCount\",\n      value: function setRightMinVisibleBarCount(barCount) {\n        if (!isNumber(barCount) || barCount <= 0) {\n          logWarn('setRightMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!');\n          return;\n        }\n\n        this._chartPane.chartData().setRightMinVisibleBarCount(Math.ceil(barCount));\n      }\n      /**\n       * 设置一条数据的空间\n       * @param space\n       */\n\n    }, {\n      key: \"setDataSpace\",\n      value: function setDataSpace(space) {\n        if (!isNumber(space)) {\n          logWarn('setDataSpace', 'space', 'space must be a number!!!');\n          return;\n        }\n\n        this._chartPane.chartData().setDataSpace(space);\n      }\n      /**\n       * 清空数据\n       */\n\n    }, {\n      key: \"clearData\",\n      value: function clearData() {\n        this._chartPane.chartData().clearDataList();\n      }\n      /**\n       * 获取数据源\n       */\n\n    }, {\n      key: \"getDataList\",\n      value: function getDataList() {\n        return this._chartPane.chartData().dataList();\n      }\n      /**\n       * 添加新数据\n       * @param dataList\n       * @param more\n       */\n\n    }, {\n      key: \"applyNewData\",\n      value: function applyNewData(dataList, more) {\n        if (!isArray(dataList)) {\n          logWarn('applyNewData', 'dataList', 'dataList must be an array!!!');\n          return;\n        }\n\n        this._chartPane.applyNewData(dataList, more);\n      }\n      /**\n       * 添加历史更多数据\n       * @param dataList\n       * @param more\n       */\n\n    }, {\n      key: \"applyMoreData\",\n      value: function applyMoreData(dataList, more) {\n        if (!isArray(dataList)) {\n          logWarn('applyMoreData', 'dataList', 'dataList must be an array!!!');\n          return;\n        }\n\n        this._chartPane.applyMoreData(dataList, more);\n      }\n      /**\n       * 更新数据\n       * @param data\n       */\n\n    }, {\n      key: \"updateData\",\n      value: function updateData(data) {\n        if (!isObject(data) || isArray(data)) {\n          logWarn('updateData', 'data');\n          return;\n        }\n\n        this._chartPane.updateData(data);\n      }\n      /**\n       * 设置加载更多回调\n       * @param cb\n       */\n\n    }, {\n      key: \"loadMore\",\n      value: function loadMore(cb) {\n        if (!isFunction(cb)) {\n          logWarn('loadMore', 'cb', 'cb must be a method!!!');\n          return;\n        }\n\n        this._chartPane.chartData().setLoadMoreCallback(cb);\n      }\n      /**\n       * 创建一个技术指标\n       * @param name 指标名\n       * @param isStack 是否覆盖\n       * @param paneOptions\n       * @returns {string|null}\n       */\n\n    }, {\n      key: \"createTechnicalIndicator\",\n      value: function createTechnicalIndicator(name, isStack, paneOptions) {\n        var tech = this._chartPane.chartData().getTechnicalIndicatorInstance(name);\n\n        if (!tech) {\n          logWarn('createTechnicalIndicator', 'name', 'can not find the corresponding technical indicator!!!');\n          return null;\n        }\n\n        return this._chartPane.createTechnicalIndicator(tech, isStack, paneOptions);\n      }\n      /**\n       * 添加自定义技术指标\n       * @param tech\n       */\n\n    }, {\n      key: \"addCustomTechnicalIndicator\",\n      value: function addCustomTechnicalIndicator(tech) {\n        if (!isObject(tech)) {\n          logWarn('addCustomTechnicalIndicator', 'technicalIndicator', 'technicalIndicator must be an object or array!!!');\n          return;\n        }\n\n        var techs = [].concat(tech);\n\n        this._chartPane.chartData().addCustomTechnicalIndicator(techs);\n      }\n      /**\n       * 移除一个技术指标\n       * @param paneId\n       * @param name\n       */\n\n    }, {\n      key: \"removeTechnicalIndicator\",\n      value: function removeTechnicalIndicator(paneId, name) {\n        this._chartPane.removeTechnicalIndicator(paneId, name);\n      }\n      /**\n       * 创建图形标记\n       * @param name\n       * @param options\n       */\n\n    }, {\n      key: \"createGraphicMark\",\n      value: function createGraphicMark(name, options) {\n        var graphicMarkMapping = this._chartPane.chartData().graphicMarkMapping();\n\n        var GraphicMark = graphicMarkMapping[name];\n\n        if (!GraphicMark) {\n          logWarn('createGraphicMark', 'name', 'can not find the corresponding graphic mark!!!');\n          return null;\n        }\n\n        var id = this._chartPane.createGraphicMark(GraphicMark, options);\n\n        if (!id) {\n          logWarn('createGraphicMark', 'options.id', 'duplicate id!!!');\n        }\n\n        return id;\n      }\n      /**\n       * 获取图形标记\n       * @param id\n       * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n       */\n\n    }, {\n      key: \"getGraphicMark\",\n      value: function getGraphicMark(id) {\n        return this._chartPane.chartData().getGraphicMark(id);\n      }\n      /**\n       * 设置图形标记配置\n       * @param id\n       * @param options\n       */\n\n    }, {\n      key: \"setGraphicMarkOptions\",\n      value: function setGraphicMarkOptions(id, options) {\n        this._chartPane.chartData().setGraphicMarkOptions(id, options);\n      }\n      /**\n       * 添加自定义图形标记\n       * @param graphicMark\n       */\n\n    }, {\n      key: \"addCustomGraphicMark\",\n      value: function addCustomGraphicMark(graphicMark) {\n        if (!isObject(graphicMark)) {\n          logWarn('addCustomGraphicMark', 'graphicMark', 'graphicMark must be an object or array!!!');\n          return;\n        }\n\n        var graphicMarks = [].concat(graphicMark);\n\n        this._chartPane.chartData().addCustomGraphicMark(graphicMarks);\n      }\n      /**\n       * 移除图形标记\n       * @param graphicMarkId\n       */\n\n    }, {\n      key: \"removeGraphicMark\",\n      value: function removeGraphicMark(graphicMarkId) {\n        this._chartPane.chartData().removeGraphicMarkInstance(graphicMarkId);\n      }\n      /**\n       * 创建注解\n       * @param annotation\n       */\n\n    }, {\n      key: \"createAnnotation\",\n      value: function createAnnotation(annotation) {\n        if (!isObject(annotation)) {\n          logWarn('createAnnotation', 'annotation', 'annotation must be an object or array!!!');\n          return;\n        }\n\n        var annotations = [].concat(annotation);\n\n        this._chartPane.createAnnotation(annotations);\n      }\n      /**\n       * 移除注解\n       */\n\n    }, {\n      key: \"removeAnnotation\",\n      value: function removeAnnotation(points) {\n        this._chartPane.chartData().removeAnnotation(points);\n      }\n      /**\n       * 创建标签\n       * @param tag\n       */\n\n    }, {\n      key: \"createTag\",\n      value: function createTag(tag) {\n        if (!isObject(tag)) {\n          logWarn('createTag', 'tag', 'tag must be an object or array!!!');\n          return;\n        }\n\n        var tags = [].concat(tag);\n\n        this._chartPane.createTag(tags);\n      }\n      /**\n       * 移除标签\n       * @param id\n       */\n\n    }, {\n      key: \"removeTag\",\n      value: function removeTag(id) {\n        this._chartPane.chartData().removeTag(id);\n      }\n      /**\n       * 设置窗口属性\n       * @param options\n       */\n\n    }, {\n      key: \"setPaneOptions\",\n      value: function setPaneOptions() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n        this._chartPane.setPaneOptions(options, false);\n      }\n      /**\n       * 设置是否可以缩放\n       * @param enabled\n       */\n\n    }, {\n      key: \"setZoomEnabled\",\n      value: function setZoomEnabled(enabled) {\n        this._chartPane.chartData().setZoomEnabled(enabled);\n      }\n      /**\n       * 是否可以缩放\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"isZoomEnabled\",\n      value: function isZoomEnabled() {\n        return this._chartPane.chartData().zoomEnabled();\n      }\n      /**\n       * 设置是否可以拖拽滚动\n       * @param enabled\n       */\n\n    }, {\n      key: \"setScrollEnabled\",\n      value: function setScrollEnabled(enabled) {\n        this._chartPane.chartData().setScrollEnabled(enabled);\n      }\n      /**\n       * 是否可以拖拽滚动\n       * @return {boolean}\n       */\n\n    }, {\n      key: \"isScrollEnabled\",\n      value: function isScrollEnabled() {\n        return this._chartPane.chartData().scrollEnabled();\n      }\n      /**\n       * 按距离滚动\n       * @param distance\n       * @param animationDuration\n       */\n\n    }, {\n      key: \"scrollByDistance\",\n      value: function scrollByDistance(distance, animationDuration) {\n        var _this = this;\n\n        if (!isNumber(distance)) {\n          logWarn('scrollByDistance', 'distance', 'distance must be a number!!!');\n          return;\n        }\n\n        if (isNumber(animationDuration) && animationDuration > 0) {\n          this._chartPane.chartData().startScroll();\n\n          var startTime = new Date().getTime();\n\n          var animation = function animation() {\n            var progress = (new Date().getTime() - startTime) / animationDuration;\n            var finished = progress >= 1;\n            var dis = finished ? distance : distance * progress;\n\n            _this._chartPane.chartData().scroll(dis);\n\n            if (!finished) {\n              requestAnimationFrame(animation);\n            }\n          };\n\n          animation();\n        } else {\n          this._chartPane.chartData().startScroll();\n\n          this._chartPane.chartData().scroll(distance);\n        }\n      }\n      /**\n       * 滚动到实时位置\n       * @param animationDuration\n       */\n\n    }, {\n      key: \"scrollToRealTime\",\n      value: function scrollToRealTime(animationDuration) {\n        var difBarCount = this._chartPane.chartData().offsetRightBarCount() - this._chartPane.chartData().offsetRightSpace() / this._chartPane.chartData().dataSpace();\n\n        var distance = difBarCount * this._chartPane.chartData().dataSpace();\n\n        this.scrollByDistance(distance, animationDuration);\n      }\n      /**\n       * 滚动到指定位置\n       * @param position\n       * @param animationDuration\n       */\n\n    }, {\n      key: \"scrollToPosition\",\n      value: function scrollToPosition(position, animationDuration) {\n        if (!isNumber(position)) {\n          logWarn('scrollToPosition', 'position', 'position must be a number!!!');\n          return;\n        }\n\n        var distance = (this._chartPane.chartData().dataList().length - 1 - position) * this._chartPane.chartData().dataSpace();\n\n        this.scrollByDistance(distance, animationDuration);\n      }\n      /**\n       * 在某个坐标点缩放\n       * @param scale\n       * @param coordinate\n       * @param animationDuration\n       */\n\n    }, {\n      key: \"zoomAtCoordinate\",\n      value: function zoomAtCoordinate(scale, coordinate, animationDuration) {\n        var _this2 = this;\n\n        if (!isNumber(scale)) {\n          logWarn('zoomAtCoordinate', 'scale', 'scale must be a number!!!');\n          return;\n        }\n\n        if (isNumber(animationDuration) && animationDuration > 0) {\n          var dataSpace = this._chartPane.chartData().dataSpace();\n\n          var scaleDataSpace = dataSpace * scale;\n          var difSpace = scaleDataSpace - dataSpace;\n          var startTime = new Date().getTime();\n\n          var animation = function animation() {\n            var progress = (new Date().getTime() - startTime) / animationDuration;\n            var finished = progress >= 1;\n            var progressDataSpace = finished ? difSpace : difSpace * progress;\n\n            _this2._chartPane.chartData().zoom(progressDataSpace / dataSpace, coordinate);\n\n            if (!finished) {\n              requestAnimationFrame(animation);\n            }\n          };\n\n          animation();\n        } else {\n          this._chartPane.chartData().zoom(scale, coordinate);\n        }\n      }\n      /**\n       * 在某个位置缩放\n       * @param scale\n       * @param position\n       * @param animationDuration\n       */\n\n    }, {\n      key: \"zoomAtPosition\",\n      value: function zoomAtPosition(scale, position, animationDuration) {\n        if (!isNumber(scale)) {\n          logWarn('zoomAtPosition', 'scale', 'scale must be a number!!!');\n          return;\n        }\n\n        if (!isNumber(position)) {\n          logWarn('zoomAtPosition', 'position', 'position must be a number!!!');\n          return;\n        }\n\n        var x = this._chartPane.chartData().dataIndexToCoordinate(position);\n\n        this.zoomAtCoordinate(scale, {\n          x: x\n        }, animationDuration);\n      }\n      /**\n       * 将值装换成像素\n       * @param value\n       * @param finder\n       */\n\n    }, {\n      key: \"convertToPixel\",\n      value: function convertToPixel(value, finder) {\n        return this._chartPane.convertToPixel(value, finder);\n      }\n      /**\n       * 将像素转换成值\n       * @param coordinate\n       * @param finder\n       */\n\n    }, {\n      key: \"convertFromPixel\",\n      value: function convertFromPixel(coordinate, finder) {\n        return this._chartPane.convertFromPixel(coordinate, finder);\n      }\n      /**\n       * 订阅图表动作\n       * @param type\n       * @param callback\n       */\n\n    }, {\n      key: \"subscribeAction\",\n      value: function subscribeAction(type, callback) {\n        if (type === 'drawCandle' || type === 'drawTechnicalIndicator') {\n          logWarn('subscribeAction', '', 'the types drawCandle and drawTechnicalIndicator have been deprecated, please use createAnnotation instead!!!');\n        }\n\n        if (!this._chartPane.chartData().subscribeAction(type, callback)) {\n          logWarn('subscribeAction', 'type', 'type does not exist!!!');\n        }\n      }\n      /**\n       * 取消订阅图表动作\n       * @param type\n       * @param callback\n       */\n\n    }, {\n      key: \"unsubscribeAction\",\n      value: function unsubscribeAction(type, callback) {\n        if (!this._chartPane.chartData().unsubscribeAction(type, callback)) {\n          logWarn('unsubscribeAction', 'type', 'type does not exist!!!');\n        }\n      }\n      /**\n       * 获取将图表装换成图片后的url\n       * @param includeTooltip\n       * @param includeGraphicMark\n       * @param type\n       * @param backgroundColor\n       */\n\n    }, {\n      key: \"getConvertPictureUrl\",\n      value: function getConvertPictureUrl(includeTooltip, includeGraphicMark) {\n        var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'jpeg';\n        var backgroundColor = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '#FFFFFF';\n\n        if (type !== 'png' && type !== 'jpeg' && type !== 'bmp') {\n          logWarn('getConvertPictureUrl', 'type', 'type only supports jpeg, png and bmp!!!');\n          return;\n        }\n\n        return this._chartPane.getConvertPictureUrl(includeTooltip, type, backgroundColor);\n      }\n      /**\n       * 销毁\n       */\n\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this._chartPane.destroy();\n      }\n    }]);\n\n    return Chart;\n  }();\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n\n  var instances = {};\n  var chartBaseId = 1;\n  var CHART_NAME_PREFIX = 'k_line_chart_';\n  /**\n   * 获取版本号\n   * @returns {string}\n   */\n\n  function version() {\n    return '7.5.0';\n  }\n  /**\n   * 初始化\n   * @param ds\n   * @param style\n   * @returns {Chart}\n   */\n\n\n  function init(ds) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    logTag();\n    var errorMessage = 'The chart cannot be initialized correctly. Please check the parameters. The chart container cannot be null and child elements need to be added!!!';\n    var dom;\n\n    if (!ds) {\n      logError('', '', errorMessage);\n      return null;\n    }\n\n    if (isString(ds)) {\n      dom = document.getElementById(ds);\n    } else {\n      dom = ds;\n    }\n\n    if (!isContainerDom(dom)) {\n      logError('', '', errorMessage);\n      return null;\n    }\n\n    var chart = instances[dom.chartId || ''];\n\n    if (chart) {\n      logWarn('', '', 'The chart has been initialized on the dom！！！');\n      return chart;\n    }\n\n    var id = \"\".concat(CHART_NAME_PREFIX).concat(chartBaseId++);\n    chart = new Chart(dom, style);\n    chart.id = id;\n    dom.chartId = id;\n    instances[id] = chart;\n    return chart;\n  }\n  /**\n   * 销毁\n   * @param dcs\n   */\n\n\n  function dispose(dcs) {\n    if (dcs) {\n      var id;\n\n      if (isString(dcs)) {\n        var dom = document.getElementById(dcs);\n        id = dom && dom.chartId;\n      } else if (isContainerDom(dcs)) {\n        id = dcs.chartId;\n      } else if (dcs instanceof Chart) {\n        id = dcs.id;\n      }\n\n      if (id) {\n        instances[id].destroy();\n        delete instances[id];\n      }\n    }\n  }\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n\n  extension.addTechnicalIndicator([averagePrice, bullAndBearIndex, differentOfMovingAverage, directionalMovementIndex, easeOfMovementValue, exponentialMovingAverage, movingAverage, movingAverageConvergenceDivergence, simpleMovingAverage, tripleExponentiallySmoothedAverage, brar, currentRatio, momentum, psychologicalLine, rateOfChange, volumeRatio, awesomeOscillator, bias, commodityChannelIndex, relativeStrengthIndex, stockIndicatorKDJ, williamsR, bollingerBands, stopAndReverse, onBalanceVolume, priceAndVolumeTrend, volume]);\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var horizontalRayLine = {\n    name: 'horizontalRayLine',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      var point = {\n        x: 0,\n        y: coordinates[0].y\n      };\n\n      if (coordinates[1] && coordinates[0].x < coordinates[1].x) {\n        point.x = viewport.width;\n      }\n\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[coordinates[0], point]]\n      }];\n    },\n    performMousePressedMove: function performMousePressedMove(points, pressedPointIndex, _ref) {\n      var price = _ref.price;\n      points[0].price = price;\n      points[1].price = price;\n    },\n    performMouseMoveForDrawing: function performMouseMoveForDrawing(step, points, _ref2) {\n      var price = _ref2.price;\n\n      if (step === 2) {\n        points[0].price = price;\n      }\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var horizontalSegment = {\n    name: 'horizontalSegment',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnSegment(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates) {\n      var lines = [];\n\n      if (coordinates.length === 2) {\n        lines = [coordinates];\n      }\n\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: lines\n      }];\n    },\n    performMousePressedMove: function performMousePressedMove(points, pressedPointIndex, _ref) {\n      var price = _ref.price;\n      points[0].price = price;\n      points[1].price = price;\n    },\n    performMouseMoveForDrawing: function performMouseMoveForDrawing(step, points, _ref2) {\n      var price = _ref2.price;\n\n      if (step === 2) {\n        points[0].price = price;\n      }\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var horizontalStraightLine = {\n    name: 'horizontalStraightLine',\n    totalStep: 2,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[{\n          x: 0,\n          y: coordinates[0].y\n        }, {\n          x: viewport.width,\n          y: coordinates[0].y\n        }]]\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var verticalRayLine = {\n    name: 'verticalRayLine',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      var point = {\n        x: coordinates[0].x,\n        y: 0\n      };\n\n      if (coordinates[1] && coordinates[0].y < coordinates[1].y) {\n        point.y = viewport.height;\n      }\n\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[coordinates[0], point]]\n      }];\n    },\n    performMousePressedMove: function performMousePressedMove(points, pressedPointIndex, _ref) {\n      var dataIndex = _ref.dataIndex,\n          timestamp = _ref.timestamp;\n      points[0].timestamp = timestamp;\n      points[0].dataIndex = dataIndex;\n      points[1].timestamp = timestamp;\n      points[1].dataIndex = dataIndex;\n    },\n    performMouseMoveForDrawing: function performMouseMoveForDrawing(step, points, _ref2) {\n      var timestamp = _ref2.timestamp,\n          dataIndex = _ref2.dataIndex;\n\n      if (step === 2) {\n        points[0].timestamp = timestamp;\n        points[0].dataIndex = dataIndex;\n      }\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var verticalSegment = {\n    name: 'verticalSegment',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnSegment(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates) {\n      var lines = [];\n\n      if (coordinates.length === 2) {\n        lines = [coordinates];\n      }\n\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: lines\n      }];\n    },\n    performMousePressedMove: function performMousePressedMove(points, pressedPointIndex, _ref) {\n      var dataIndex = _ref.dataIndex,\n          timestamp = _ref.timestamp;\n      points[0].timestamp = timestamp;\n      points[0].dataIndex = dataIndex;\n      points[1].timestamp = timestamp;\n      points[1].dataIndex = dataIndex;\n    },\n    performMouseMoveForDrawing: function performMouseMoveForDrawing(step, points, _ref2) {\n      var timestamp = _ref2.timestamp,\n          dataIndex = _ref2.dataIndex;\n\n      if (step === 2) {\n        points[0].timestamp = timestamp;\n        points[0].dataIndex = dataIndex;\n      }\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var verticalStraightLine = {\n    name: 'verticalStraightLine',\n    totalStep: 2,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[{\n          x: coordinates[0].x,\n          y: 0\n        }, {\n          x: coordinates[0].x,\n          y: viewport.height\n        }]]\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var rayLine = {\n    name: 'rayLine',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [getRayLine(coordinates[0], coordinates[1], {\n          x: viewport.width,\n          y: viewport.height\n        })]\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var segment = {\n    name: 'segment',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnSegment(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates) {\n      var lines = [];\n\n      if (coordinates.length === 2) {\n        lines = [coordinates];\n      }\n\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: lines\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var straightLine = {\n    name: 'straightLine',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      if (coordinates.length < 2 || coordinates[0].x === coordinates[1].x) {\n        return [{\n          type: 'line',\n          isDraw: true,\n          isCheck: true,\n          dataSource: [[{\n            x: coordinates[0].x,\n            y: 0\n          }, {\n            x: coordinates[0].x,\n            y: viewport.height\n          }]]\n        }];\n      }\n\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[{\n          x: 0,\n          y: getLinearYFromPoints(coordinates[0], coordinates[1], {\n            x: 0,\n            y: coordinates[0].y\n          })\n        }, {\n          x: viewport.width,\n          y: getLinearYFromPoints(coordinates[0], coordinates[1], {\n            x: viewport.width,\n            y: coordinates[0].y\n          })\n        }]]\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var parallelStraightLine = {\n    name: 'parallelStraightLine',\n    totalStep: 4,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: getParallelLines(coordinates, {\n          x: viewport.width,\n          y: viewport.height\n        })\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var priceChannelLine = {\n    name: 'priceChannelLine',\n    totalStep: 4,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport) {\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: getParallelLines(coordinates, {\n          x: viewport.width,\n          y: viewport.height\n        }, 1)\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var priceLine = {\n    name: 'priceLine',\n    totalStep: 2,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport, precision, xAxis, yAxis) {\n      return [{\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[coordinates[0], {\n          x: viewport.width,\n          y: coordinates[0].y\n        }]]\n      }, {\n        type: 'text',\n        isDraw: true,\n        isCheck: false,\n        dataSource: [{\n          x: coordinates[0].x,\n          y: coordinates[0].y,\n          text: yAxis.convertFromPixel(coordinates[0].y).toFixed(precision.price)\n        }]\n      }];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var fibonacciLine = {\n    name: 'fibonacciLine',\n    totalStep: 3,\n    checkMousePointOn: function checkMousePointOn(key, type, coordinates, mouseCoordinate) {\n      return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate);\n    },\n    createGraphicDataSource: function createGraphicDataSource(step, points, coordinates, viewport, precision) {\n      if (coordinates.length > 0) {\n        var lines = [];\n        var texts = [];\n        var startX = 0;\n        var endX = viewport.width;\n\n        if (coordinates.length > 1) {\n          var percents = [1, 0.786, 0.618, 0.5, 0.382, 0.236, 0];\n          var yDif = coordinates[0].y - coordinates[1].y;\n          var priceDif = points[0].price - points[1].price;\n          percents.forEach(function (percent) {\n            var y = coordinates[1].y + yDif * percent;\n            var price = (points[1].price + priceDif * percent).toFixed(precision.price);\n            lines.push([{\n              x: startX,\n              y: y\n            }, {\n              x: endX,\n              y: y\n            }]);\n            texts.push({\n              x: startX,\n              y: y,\n              text: \"\".concat(price, \" (\").concat((percent * 100).toFixed(1), \"%)\")\n            });\n          });\n        }\n\n        return [{\n          type: 'line',\n          isDraw: true,\n          isCheck: true,\n          dataSource: lines\n        }, {\n          type: 'text',\n          isDraw: true,\n          isCheck: false,\n          dataSource: texts\n        }];\n      }\n\n      return [];\n    }\n  };\n  /**\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n  \n   * http://www.apache.org/licenses/LICENSE-2.0\n  \n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  extension.addGraphicMark([horizontalRayLine, horizontalSegment, horizontalStraightLine, verticalRayLine, verticalSegment, verticalStraightLine, rayLine, segment, straightLine, parallelStraightLine, priceChannelLine, priceLine, fibonacciLine]);\n  exports.dispose = dispose;\n  exports.extension = extension;\n  exports.init = init;\n  exports.version = version;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["../src/extension/technicalindicator/directionalmovement/averagePrice.js","../src/extension/technicalindicator/directionalmovement/bullAndBearIndex.js","../src/extension/technicalindicator/directionalmovement/differentOfMovingAverage.js","../src/extension/technicalindicator/directionalmovement/directionalMovementIndex.js","../src/extension/technicalindicator/directionalmovement/easeOfMovementValue.js","../src/extension/technicalindicator/directionalmovement/exponentialMovingAverage.js","../src/extension/technicalindicator/directionalmovement/movingAverage.js","../src/extension/technicalindicator/directionalmovement/movingAverageConvergenceDivergence.js","../src/extension/technicalindicator/directionalmovement/simpleMovingAverage.js","../src/extension/technicalindicator/directionalmovement/tripleExponentiallySmoothedAverage.js","../src/extension/technicalindicator/momentum/brar.js","../src/extension/technicalindicator/momentum/currentRatio.js","../src/extension/technicalindicator/momentum/momentum.js","../src/extension/technicalindicator/momentum/psychologicalLine.js","../src/extension/technicalindicator/momentum/rateOfChange.js","../src/extension/technicalindicator/momentum/volumeRatio.js","../src/extension/technicalindicator/oscillators/awesomeOscillator.js","../src/extension/technicalindicator/oscillators/bias.js","../src/extension/technicalindicator/oscillators/commodityChannelIndex.js","../src/extension/technicalindicator/oscillators/relativeStrengthIndex.js","../src/extension/technicalindicator/calcHnLn.js","../src/extension/technicalindicator/oscillators/stockIndicatorKDJ.js","../src/extension/technicalindicator/oscillators/williamsR.js","../src/extension/technicalindicator/volatility/bollingerBands.js","../src/extension/technicalindicator/volatility/stopAndReverse.js","../src/extension/technicalindicator/volume/onBalanceVolume.js","../src/extension/technicalindicator/volume/priceAndVolumeTrend.js","../src/extension/technicalindicator/volume/volume.js","../src/data/extension.js","../src/utils/typeChecks.js","../src/data/options/styleOptions.js","../src/utils/format.js","../src/utils/number.js","../src/utils/logger.js","../src/base/technicalindicator/TechnicalIndicator.js","../src/base/technicalindicator/technicalIndicatorControl.js","../src/base/overlay/Overlay.js","../src/renderer/circle.js","../src/extension/mark/graphicHelper.js","../src/renderer/line.js","../src/base/overlay/mark/GraphicMark.js","../src/data/delegate/Delegate.js","../src/base/overlay/mark/graphicMarkControl.js","../src/data/constants.js","../src/data/ChartData.js","../src/utils/canvas.js","../src/pane/Pane.js","../src/widget/Widget.js","../src/utils/compatible.js","../src/view/View.js","../src/view/TechnicalIndicatorView.js","../src/renderer/text.js","../src/view/TechnicalIndicatorOverlayView.js","../src/widget/TechnicalIndicatorWidget.js","../src/renderer/rect.js","../src/view/YAxisView.js","../src/view/YAxisOverlayView.js","../src/widget/YAxisWidget.js","../src/component/Axis.js","../src/component/YAxis.js","../src/pane/TechnicalIndicatorPane.js","../src/view/CandleView.js","../src/view/CandleOverlayView.js","../src/widget/CandleWidget.js","../src/pane/CandlePane.js","../src/view/XAxisView.js","../src/view/XAxisOverlayView.js","../src/widget/XAxisWidget.js","../src/component/XAxis.js","../src/pane/XAxisPane.js","../src/event/EventBase.js","../src/pane/SeparatorPane.js","../src/event/EventHandler.js","../src/event/ZoomScrollEventHandler.js","../src/event/OverlayEventHandler.js","../src/event/KeyBoardEventHandler.js","../src/event/ChartEvent.js","../src/utils/performance.js","../src/renderer/diamond.js","../src/renderer/triangle.js","../src/base/overlay/annotation/Annotation.js","../src/base/overlay/tag/Tag.js","../src/pane/ChartPane.js","../src/Chart.js","../src/core.js","../src/index.blank.js","../src/extension/mark/horizontalRayLine.js","../src/extension/mark/horizontalSegment.js","../src/extension/mark/horizontalStraightLine.js","../src/extension/mark/verticalRayLine.js","../src/extension/mark/verticalSegment.js","../src/extension/mark/verticalStraightLine.js","../src/extension/mark/rayLine.js","../src/extension/mark/segment.js","../src/extension/mark/straightLine.js","../src/extension/mark/parallelStraightLine.js","../src/extension/mark/priceChannelLine.js","../src/extension/mark/priceLine.js","../src/extension/mark/fibonacciLine.js","../src/index.js"],"names":["name","series","precision","plots","key","title","type","calcTechnicalIndicator","totalTurnover","totalVolume","avp","turnover","kLineData","volume","calcParams","shouldCheckParamCount","shouldOhlc","maxParam","Math","closeSums","mas","bbi","close","i","param","kLineDataList","maSum","closeSum1","closeSum2","dmaSum","result","dataList","dma","ma1","ma2","dif","trSum","hSum","lSum","mtr","dmp","dmm","dxSum","adx","dmi","preKLineData","preClose","high","low","hl","hcy","lcy","hhy","lyl","tr","h","l","pdi","mdi","dx","emSum","emvSum","emList","emv","halfHl","preHalfHl","em","regeneratePlots","closeSum","emaValues","ema","ma","baseValue","color","currentData","data","macd","options","isStroke","preData","preMacd","difSum","dea","maxPeriod","emaShort","emaLong","smaValue","sma","ema1Sum","ema2Sum","trixSum","trix","ema1","ema2","trixValue","oldTr","cyl","ho","ol","brar","open","agoKLineData","agoHigh","agoLow","agoOpen","agoPreClose","ma1ForwardPeriod","ma2ForwardPeriod","ma3ForwardPeriod","ma4ForwardPeriod","ma1Sum","ma1List","ma2Sum","ma2List","ma3Sum","ma3List","ma4Sum","ma4List","cr","preMid","highSubPreMid","preMidSubLow","mtmSum","mtm","agoClose","upCount","psySum","upList","psy","upFlag","rocSum","roc","uvs","dvs","pvs","vrSum","vr","halfPvs","agoData","agoPreData","agoVolume","preAo","ao","technicalIndicatorOptions","shortSum","longSum","short","long","middle","bias","mean","p","tpSum","tpList","cci","tp","maTp","sliceTpList","sum","md","agoTp","num","index","sumCloseAs","sumCloseBs","rsi","tmp","agoTmp","hn","Number","ln","kdj","lhn","calcHnLn","hnSubLn","rsv","wr","hln","dataSize","closeMa","b","calcParamsAllowDecimal","boll","getBollMd","technicalIndicatorData","halfHL","startAf","step","maxAf","af","ep","isIncreasing","sar","preSar","lowMin","highMax","obvSum","oldObv","obv","pvt","x","shouldFormatBigNumber","minValue","volSums","vol","technicalIndicatorExtensions","graphicMarkExtensions","addTechnicalIndicator","technicalIndicator","addGraphicMark","graphicMark","isObject","targetProp","target","sourceProp","source","isArray","merge","isValid","copy","v","clone","Object","isNaN","value","dom","LineStyle","DASH","SOLID","YAxisPosition","LEFT","RIGHT","YAxisType","NORMAL","PERCENTAGE","LOG","CandleType","CANDLE_SOLID","CANDLE_STROKE","CANDLE_UP_STROKE","CANDLE_DOWN_STROKE","OHLC","AREA","TooltipShowRule","ALWAYS","FOLLOW_CROSS","NONE","TooltipShowType","RECT","STANDARD","AnnotationSymbolType","CIRCLE","TRIANGLE","DIAMOND","CUSTOM","OverlayPosition","POINT","TOP","BOTTOM","defaultGrid","show","horizontal","size","style","dashValue","vertical","defaultCandle","margin","top","bottom","bar","upColor","downColor","noChangeColor","area","lineSize","lineColor","fillColor","offset","priceMark","textMargin","textSize","textFamily","textWeight","last","line","text","paddingLeft","paddingTop","paddingRight","paddingBottom","family","weight","borderRadius","tooltip","showRule","showType","labels","values","defaultValue","rect","offsetLeft","offsetTop","offsetRight","borderSize","borderColor","marginLeft","marginTop","marginRight","marginBottom","defaultTechnicalIndicator","colors","circle","lastValueMark","showName","showParams","defaultXAxis","height","axisLine","tickText","tickLine","length","defaultYAxis","width","position","inside","defaultCrosshair","backgroundColor","defaultGraphicMark","point","radius","activeBackgroundColor","activeBorderColor","activeBorderSize","activeRadius","polygon","stroke","fill","arc","defaultAnnotation","symbol","activeSize","activeColor","defaultTag","mark","defaultSeparator","defaultStyleOptions","grid","candle","xAxis","yAxis","separator","crosshair","annotation","tag","format","isNumber","dateTimeString","dateTimeFormat","dateTimeStringArray","dateStringArray","date","YYYY","MM","DD","left","right","midIndex","mid","midValue","targetNumber","exponent","log10","exp10","index10","f","nf","str","eIndex","dotIndex","append","console","api","invalidParam","TechnicalIndicatorSeries","PRICE","VOLUME","TechnicalIndicatorPlotType","LINE","BAR","TechnicalIndicator","maxValue","styles","isBoolean","parseInt","params","defaultStyles","mapping","extension","technicalIndicatorInstance","createTechnicalIndicatorInstance","render","isFunction","logWarn","TechnicalIndicatorClass","calcParamText","plot","formatPrecision","formatBigNumber","Overlay","id","chartData","points","event","ctx","circlePoint","DEVIATION","x1","point2","point1","y1","x2","point3","y2","difX","k","kb","getLinearSlopeIntercept","getLinearYFromSlopeIntercept","targetPoint","y","yDif","checkPointOnStraightLine","circleCenterPoint","difY","square","getTriangleSquare","trianglePoints","compareSquare","xDis","centerPoint","yDis","xyMax","getLinearYFromPoints","extendParallelLineCount","lines","startY","endY","distance","d","startX","endX","b1","b2","correction","renderFuc","GRAPHIC_MARK_DRAW_STEP_START","GRAPHIC_MARK_DRAW_STEP_FINISHED","GraphicMarkMouseOperateElement","OTHER","GraphicMarkDrawType","TEXT","CONTINUOUS_LINE","POLYGON","ARC","GraphicMarkDrawStyle","STROKE","FILL","LineType","COMMON","HORIZONTAL","VERTICAL","GraphicMark","totalStep","lock","repeatTotalStep","timestamp","dataIndex","markOptions","lineType","getLineType","renderLine","renderHorizontalLine","renderVerticalLine","continuousLines","fillStroke","polygons","arcs","startAngle","endAngle","texts","coordinates","price","viewport","graphicDataSources","isDraw","dataSource","graphicMarkMouseOperate","renderFillCircle","coordinate","checkPointInCircle","element","elementIndex","instance","isCheck","sources","_points","Delegate","observer","graphicMarkClass","createGraphicMarkClass","checkMousePointOn","createGraphicDataSource","performMousePressedMove","performMouseMoveForDrawing","drawExtend","Mark","DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT","TECHNICAL_INDICATOR_PANE_ID_PREFIX","GRAPHIC_MARK_ID_PREFIX","CANDLE_PANE_ID","MIN_DATA_SPACE","MAX_DATA_SPACE","InvalidateLevel","OVERLAY","MAIN","FULL","ActionType","DRAW_CANDLE","DRAW_TECHNICAL_INDICATOR","ZOOM","SCROLL","CROSSHAIR","PANE_DRAG","ChartData","createTechnicalIndicatorMapping","Intl","hour12","year","month","day","hour","minute","createGraphicMarkMapping","click","hover","rateBarSpace","floorBarSpace","optimalBarSpace","deltaFromRight","an","barLength","maxRightOffsetBarCount","minRightOffsetBarCount","formatValue","tech","createTechnicalIndicatorInfo","techs","timeZone","isFirstAdd","pos","dataSpace","adjustBeforeFuc","space","realDataIndex","realX","prevCrosshair","paneId","distanceBarCount","barCount","cross","binarySearchNearest","scale","floatIndex","gm","lastGraphicMark","graphicMarks","GraphicMarkClass","getGraphicMarkInfo","removeIndex","annotations","shouldAdjust","tags","shouldInvalidate","ids","graphicMarkOperate","annotationOperate","executeBeforeFun","executeAfterFun","delegate","canvas","fontSize","fontWeight","fontFamily","Pane","props","document","lastElement","pixelRatio","getPixelRatio","mainWidgetElement","mainWidgetWidth","mainWidgetHeight","mainWidgetOffsetLeft","yAxisWidgetElement","yAxisWidgetWidth","yAxisWidgetHeight","yAxisWidgetOffsetLeft","Widget","container","includeOverlay","window","clearTimeout","View","extendFun","cancelAnimationFrame","requestAnimationFrame","TechnicalIndicatorView","gridOptions","gridHorizontalOptions","tick","gridVerticalOptions","technicalIndicators","technicalIndicatorResult","from","to","technicalIndicatorDataList","barSpace","convertFromPixel","convertToPixel","baseValueY","isCandleYAxis","lineValueIndex","coordinateY","valueY","cbData","nextData","halfBarSpace","technicalIndicatorName","_height","isCandle","visibleDataList","onDrawing","onDrawEnd","colorSize","isStart","lineItem","barOptions","openY","closeY","highY","lowY","highEndY","lowStartY","barHeight","TechnicalIndicatorOverlayView","styleOptions","crosshairOptions","crosshairDirectionOptions","crosshairLineOptions","drawLine","isDrawTechnicalIndicatorTooltip","technicalIndicatorTooltipOptions","tooltipData","getTechnicalIndicatorTooltipData","technicalIndicatorTooltipTextOptions","textMarginLeft","textMarginRight","labelX","labelY","textColor","createFont","nameText","nameTextWidth","calcTextWidth","renderText","calcParamTextWidth","lineCount","valueColor","textWidth","tooltipOptions","TechnicalIndicatorWidget","renderFillRoundRect","renderStrokeRoundRect","renderRoundRect","YAxisView","yAxisOptions","tickLineLength","tickLineShow","lastValueMarkOptions","priceMarkOptions","lastPriceMarkOptions","fromData","fromClose","rectWidth","rectHeight","rectStartX","YAxisOverlayView","crosshairHorizontalOptions","crosshairHorizontalTextOptions","yAxisDataLabelWidth","rectY","renderStrokeFillRoundRect","YAxisWidget","Axis","measureCanvas","minMax","min","max","ticks","intervalPrecision","interval","first","round","n","nice","range","getPrecision","YAxis","minMaxArray","plotsResult","technicalIndicatorPrecision","pricePrecision","candleOptions","isArea","areaValueKey","shouldCompareHighLow","specifyMin","specifyMax","yAxisType","minCheck","maxCheck","marginOptions","topRate","bottomRate","optimalTicks","textHeight","validY","yAxisWidth","crosshairVerticalTextWidth","valueText","pixel","TechnicalIndicatorPane","additionalDataProvider","cloneInstance","CandleView","linePoints","areaPoints","minY","areaOptions","areaPointLength","lastPoint","gradient","lowHighPriceMarkOptions","comparePrice","compare","priceY","offsets","CandleOverlayView","candleTooltipOptions","isDrawCandleTooltip","labelWidth","baseLabels","baseValues","baseTextMarginLeft","baseTextMarginRight","baseTextMarginTop","baseTextMarginBottom","baseTextSize","baseTextColor","rectOptions","rectBorderSize","rectPaddingLeft","rectPaddingRight","rectPaddingTop","rectPaddingBottom","rectLeft","rectRight","maxLabelWidth","indicatorTextMarginLeft","indicatorTextMarginRight","indicatorTextMarginTop","indicatorTextMarginBottom","indicatorTextSize","indicatorTooltipDataList","centerX","rectX","baseLabelX","indicatorLabelX","volumePrecision","formatDate","CandleWidget","CandlePane","XAxisView","xAxisOptions","xAxisLine","tickLength","XAxisOverlayView","crosshairVerticalOptions","crosshairVerticalTextOptions","XAxisWidget","XAxis","defaultLabelWidth","tickCountDif","nextPos","nextX","xDif","label","prePos","preTimestamp","oV","optimalTickLength","firstTimestamp","secondTimestamp","thirdV","stylOptions","xAxisHeight","crosshairVerticalTextHeight","XAxisPane","_xAxis","MouseEventButton","DELAY_RESET_CLICK","DELAY_LONG_TAG","Boolean","touch","navigator","checkTouchEvents","mobileTouch","xDiff","p1","p2","yDiff","EventType","MOUSE","TOUCH","EventBase","boundMouseMoveHandler","boundMouseWheelHandler","passive","isTouchEvent","compatEvent","wheelEvent","moveEvent","isTouch","startMouseMovePos","xOffset","yOffset","moveExceededManhattanDistance","correctedXOffset","isVertDrag","isHorzDrag","preventDefault","mouseUpEvent","downEvent","pageY","boundMouseMoveWithDownHandler","boundMouseUpHandler","rootElement","setTimeout","doc","outsideHandler","currentDistance","getDistance","touches","box","getBoundingClientRect","callback","eventLike","clientX","clientY","pageX","screenX","screenY","localX","localY","ctrlKey","altKey","shiftKey","metaKey","view","SeparatorPane","mouseDownEvent","pressedMouseMoveEvent","mouseEnterEvent","mouseLeaveEvent","treatVertTouchDragAsPageScroll","treatHorzTouchDragAsPageScroll","dragDistance","separatorOptions","dragEnabled","EventHandler","TOUCH_MIN_RADIUS","ZoomScrollEventHandler","zoomScale","isMouse","deltaY","checkTouchEvent","isPerform","performFuc","contentTop","OverlayEventHandler","overlay","hoverOperate","preHoverOperate","visibleAnnotations","preGraphicMarkHoverOperate","preAnnotationHoverOperate","graphicMarkHoverOperate","graphicMarkClickOperate","annotationHoverOperate","KeyBoardCode","EQUAL","MINUS","ARROW_LEFT","ARROW_RIGHT","KeyBoardEventHandler","ChartEvent","pinchStartEvent","pinchEvent","mouseClickEvent","mouseRightDownEvent","mouseMoveEvent","mouseWheelEvent","longTapEvent","e","graphicMarkCount","wait","previous","now","Date","context","args","func","Annotation","symbolOptions","styleSize","styleActiveSize","isActive","renderFillRect","renderFillDiamond","renderFillTriangle","isOn","coordinate1","coordinate2","checkPointInRect","checkPointInDiamond","checkPointInTriangle","mouseCoordinate","Tag","success","tagOptions","tagTextOptions","tagLineOptions","tagMarkOptions","valueRectWidth","textOptions","ChartPane","invalidate","_chartData","pane","topPaneHeight","bottomPaneHeight","topPaneId","bottomPaneId","invalidateLevel","shouldMeasureWidth","should","tasks","Promise","paneHeight","separatorSize","separatorTotalHeight","paneExcludeXAxisSeparatorHeight","techPaneTotalHeight","candlePaneHeight","paneContentSize","contentBottom","isYAxisLeft","isOutside","paneWidth","mainWidth","yAxisOffsetLeft","mainOffsetLeft","content","total","contentLeft","contentRight","isAdjust","adjust","shouldComputeAxis","techInstance","calcParamsSuccess","precisionSuccess","defaultTechnicalStyleOptions","styleSuccess","lastDataTimestamp","removed","deleteSeparatorTopPaneId","Array","startDrag","drag","throttle","technicalIndicatorInfo","paneTechs","onDrawStart","onClick","onRightClick","onPressedMove","onMouseEnter","onMouseLeave","onRemove","graphicMarkId","graphicMarkInstance","instances","checkPointInCustomSymbol","drawCustomSymbol","annotationInstance","shouldUpdate","shouldAdd","updateSuccess","shouldMeasureHeight","dataIndexXAxis","absoluteYAxis","absoluteTop","panes","xAxisValue","yAxisValue","ry","Chart","override","graphicMarkMapping","animationDuration","startTime","animation","progress","finished","dis","difBarCount","scaleDataSpace","difSpace","progressDataSpace","chartBaseId","CHART_NAME_PREFIX","logTag","errorMessage","logError","isString","isContainerDom","chart","dcs","checkPointOnRayLine","checkPointOnSegment","getRayLine","getParallelLines","percents","priceDif","percent"],"mappings":"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","sourcesContent":["/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 成交均线\n */\nexport default {\n  name: 'AVP',\n  series: 'price',\n  precision: 2,\n  plots: [\n    { key: 'avp', title: 'AVP: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList) => {\n    let totalTurnover = 0\n    let totalVolume = 0\n    return dataList.map(kLineData => {\n      const avp = {}\n      const turnover = kLineData.turnover || 0\n      const volume = kLineData.volume || 0\n      totalTurnover += turnover\n      totalVolume += volume\n      if (totalVolume !== 0) {\n        avp.avp = totalTurnover / totalVolume\n      }\n      return avp\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 多空指标\n * 公式: BBI = (MA(CLOSE, M) + MA(CLOSE, N) + MA(CLOSE, O) + MA(CLOSE, P)) / 4\n *\n */\nexport default {\n  name: 'BBI',\n  series: 'price',\n  precision: 2,\n  calcParams: [3, 6, 12, 24],\n  shouldCheckParamCount: true,\n  shouldOhlc: true,\n  plots: [\n    { key: 'bbi', title: 'BBI: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (kLineDataList, calcParams) => {\n    const maxParam = Math.max.apply(null, calcParams)\n    const closeSums = []\n    const mas = []\n    return kLineDataList.map((kLineData, i) => {\n      const bbi = {}\n      const close = kLineData.close\n      calcParams.forEach((param, index) => {\n        closeSums[index] = (closeSums[index] || 0) + close\n        if (i >= param - 1) {\n          mas[index] = closeSums[index] / param\n          closeSums[index] -= kLineDataList[i - (param - 1)].close\n        }\n      })\n      if (i >= maxParam - 1) {\n        let maSum = 0\n        mas.forEach(ma => {\n          maSum += ma\n        })\n        bbi.bbi = maSum / 4\n      }\n      return bbi\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * DMA\n * 公式：DIF:MA(CLOSE,N1)-MA(CLOSE,N2);DIFMA:MA(DIF,M)\n */\nexport default {\n  name: 'DMA',\n  calcParams: [10, 50, 10],\n  plots: [\n    { key: 'dma', title: 'DMA: ', type: 'line' },\n    { key: 'ama', title: 'AMA: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    const maxParam = Math.max(calcParams[0], calcParams[1])\n    let closeSum1 = 0\n    let closeSum2 = 0\n    let dmaSum = 0\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const dma = {}\n      const close = kLineData.close\n      closeSum1 += close\n      closeSum2 += close\n      let ma1\n      let ma2\n      if (i >= calcParams[0] - 1) {\n        ma1 = closeSum1 / calcParams[0]\n        closeSum1 -= dataList[i - (calcParams[0] - 1)].close\n      }\n      if (i >= calcParams[1] - 1) {\n        ma2 = closeSum2 / calcParams[1]\n        closeSum2 -= dataList[i - (calcParams[1] - 1)].close\n      }\n\n      if (i >= maxParam - 1) {\n        const dif = ma1 - ma2\n        dma.dma = dif\n        dmaSum += dif\n        if (i >= maxParam + calcParams[2] - 2) {\n          dma.ama = dmaSum / calcParams[2]\n          dmaSum -= result[i - (calcParams[2] - 1)].dma\n        }\n      }\n      result.push(dma)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * DMI\n *\n * MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N)\n * HD :=HIGH-REF(HIGH,1);\n * LD :=REF(LOW,1)-LOW;\n * DMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);\n * DMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);\n *\n * PDI: DMP*100/MTR;\n * MDI: DMM*100/MTR;\n * ADX: EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);\n * ADXR:EXPMEMA(ADX,MM);\n * 公式含义：\n * MTR赋值:最高价-最低价和最高价-昨收的绝对值的较大值和昨收-最低价的绝对值的较大值的N日指数平滑移动平均\n * HD赋值:最高价-昨日最高价\n * LD赋值:昨日最低价-最低价\n * DMP赋值:如果HD>0并且HD>LD,返回HD,否则返回0的N日指数平滑移动平均\n * DMM赋值:如果LD>0并且LD>HD,返回LD,否则返回0的N日指数平滑移动平均\n * 输出PDI:DMP*100/MTR\n * 输出MDI:DMM*100/MTR\n * 输出ADX:MDI-PDI的绝对值/(MDI+PDI)*100的MM日指数平滑移动平均\n * 输出ADXR:ADX的MM日指数平滑移动平均\n *\n */\nexport default {\n  name: 'DMI',\n  calcParams: [14, 6],\n  plots: [\n    { key: 'pdi', title: 'PDI: ', type: 'line' },\n    { key: 'mdi', title: 'MDI: ', type: 'line' },\n    { key: 'adx', title: 'ADX: ', type: 'line' },\n    { key: 'adxr', title: 'ADXR: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let trSum = 0\n    let hSum = 0\n    let lSum = 0\n    let mtr = 0\n    let dmp = 0\n    let dmm = 0\n    let dxSum = 0\n    let adx = 0\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const dmi = {}\n      const preKLineData = dataList[i - 1] || kLineData\n      const preClose = preKLineData.close\n      const high = kLineData.high\n      const low = kLineData.low\n      const hl = high - low\n      const hcy = Math.abs(high - preClose)\n      const lcy = Math.abs(preClose - low)\n      const hhy = high - preKLineData.high\n      const lyl = preKLineData.low - low\n      const tr = Math.max(Math.max(hl, hcy), lcy)\n      const h = (hhy > 0 && hhy > lyl) ? hhy : 0\n      const l = (lyl > 0 && lyl > hhy) ? lyl : 0\n      trSum += tr\n      hSum += h\n      lSum += l\n      if (i >= calcParams[0] - 1) {\n        if (i > calcParams[0] - 1) {\n          mtr = mtr - mtr / calcParams[0] + tr\n          dmp = dmp - dmp / calcParams[0] + h\n          dmm = dmm - dmm / calcParams[0] + l\n        } else {\n          mtr = trSum\n          dmp = hSum\n          dmm = lSum\n        }\n        let pdi = 0\n        let mdi = 0\n        if (mtr !== 0) {\n          pdi = dmp * 100 / mtr\n          mdi = dmm * 100 / mtr\n        }\n        dmi.pdi = pdi\n        dmi.mdi = mdi\n        let dx = 0\n        if (mdi + pdi !== 0) {\n          dx = Math.abs((mdi - pdi)) / (mdi + pdi) * 100\n        }\n        dxSum += dx\n        if (i >= calcParams[0] * 2 - 2) {\n          if (i > calcParams[0] * 2 - 2) {\n            adx = (adx * (calcParams[0] - 1) + dx) / calcParams[0]\n          } else {\n            adx = dxSum / calcParams[0]\n          }\n          dmi.adx = adx\n          if (i >= calcParams[0] * 2 + calcParams[1] - 3) {\n            dmi.adxr = (result[i - (calcParams[1] - 1)].adx + adx) / 2\n          }\n        }\n      }\n      result.push(dmi)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n *\n * EMV 简易波动指标\n * 公式：\n * A=（今日最高+今日最低）/2\n * B=（前日最高+前日最低）/2\n * C=今日最高-今日最低\n * EM=（A-B）*C/今日成交额\n * EMV=N日内EM的累和\n * MAEMV=EMV的M日的简单移动平均\n *\n */\nexport default {\n  name: 'EMV',\n  calcParams: [14, 9],\n  plots: [\n    { key: 'emv', title: 'EMV: ', type: 'line' },\n    { key: 'maEmv', title: 'MAEMV: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let emSum = 0\n    let emvSum = 0\n    const emList = []\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const emv = {}\n      const preKLineData = dataList[i - 1] || kLineData\n      const high = kLineData.high\n      const low = kLineData.low\n      const turnover = kLineData.turnover || 0\n      const halfHl = (high + low) / 2\n      const preHalfHl = (preKLineData.high + preKLineData.low) / 2\n      const hl = high - low\n      let em = 0\n      if (turnover !== 0) {\n        em = (halfHl - preHalfHl) * hl / turnover\n      }\n      emList.push(em)\n      emSum += em\n      if (i >= calcParams[0] - 1) {\n        emv.emv = emSum\n        emSum -= emList[i - (calcParams[0] - 1)]\n        emvSum += emv.emv\n        if (i >= calcParams[0] + calcParams[1] - 2) {\n          emv.maEmv = emvSum / calcParams[1]\n          emvSum -= result[i - (calcParams[1] - 1)].emv\n        }\n      }\n      result.push(emv)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * EMA 指数移动平均\n */\nexport default {\n  name: 'EMA',\n  series: 'price',\n  calcParams: [6, 12, 20],\n  precision: 2,\n  shouldCheckParamCount: false,\n  shouldOhlc: true,\n  plots: [\n    { key: 'ema6', title: 'EMA6: ', type: 'line' },\n    { key: 'ema12', title: 'EMA12: ', type: 'line' },\n    { key: 'ema20', title: 'EMA20: ', type: 'line' }\n  ],\n  regeneratePlots: (params) => {\n    return params.map(p => {\n      return { key: `ema${p}`, title: `EMA${p}: `, type: 'line' }\n    })\n  },\n  calcTechnicalIndicator: (dataList, calcParams, plots) => {\n    let closeSum = 0\n    const emaValues = []\n    return dataList.map((kLineData, i) => {\n      const ema = {}\n      const close = kLineData.close\n      closeSum += close\n      calcParams.forEach((param, j) => {\n        if (i >= param - 1) {\n          if (i > param - 1) {\n            emaValues[j] = (2 * close + (param - 1) * emaValues[j]) / (param + 1)\n          } else {\n            emaValues[j] = closeSum / param\n          }\n          ema[plots[j].key] = emaValues[j]\n        }\n      })\n      return ema\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * MA 移动平均\n */\nexport default {\n  name: 'MA',\n  series: 'price',\n  calcParams: [5, 10, 30, 60],\n  precision: 2,\n  shouldCheckParamCount: false,\n  shouldOhlc: true,\n  plots: [\n    { key: 'ma5', title: 'MA5: ', type: 'line' },\n    { key: 'ma10', title: 'MA10: ', type: 'line' },\n    { key: 'ma30', title: 'MA30: ', type: 'line' },\n    { key: 'ma60', title: 'MA60: ', type: 'line' }\n  ],\n  regeneratePlots: (params) => {\n    return params.map(p => {\n      return { key: `ma${p}`, title: `MA${p}: `, type: 'line' }\n    })\n  },\n  calcTechnicalIndicator: (dataList, calcParams, plots) => {\n    const closeSums = []\n    return dataList.map((kLineData, i) => {\n      const ma = {}\n      const close = kLineData.close\n      calcParams.forEach((param, j) => {\n        closeSums[j] = (closeSums[j] || 0) + close\n        if (i >= param - 1) {\n          ma[plots[j].key] = closeSums[j] / param\n          closeSums[j] -= dataList[i - (param - 1)].close\n        }\n      })\n      return ma\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * MACD：参数快线移动平均、慢线移动平均、移动平均，\n * 默认参数值12、26、9。\n * 公式：⒈首先分别计算出收盘价12日指数平滑移动平均线与26日指数平滑移动平均线，分别记为EMA(12）与EMA(26）。\n * ⒉求这两条指数平滑移动平均线的差，即：DIFF=EMA（SHORT）－EMA（LONG）。\n * ⒊再计算DIFF的M日的平均的指数平滑移动平均线，记为DEA。\n * ⒋最后用DIFF减DEA，得MACD。MACD通常绘制成围绕零轴线波动的柱形图。MACD柱状大于0涨颜色，小于0跌颜色。\n */\nexport default {\n  name: 'MACD',\n  calcParams: [12, 26, 9],\n  baseValue: 0,\n  plots: [\n    { key: 'dif', title: 'DIF: ', type: 'line' },\n    { key: 'dea', title: 'DEA: ', type: 'line' },\n    {\n      key: 'macd',\n      title: 'MACD: ',\n      type: 'bar',\n      color: (data, options) => {\n        const { currentData } = data\n        const macd = (currentData.technicalIndicatorData || {}).macd\n        if (macd > 0) {\n          return options.bar.upColor\n        } else if (macd < 0) {\n          return options.bar.downColor\n        } else {\n          return options.bar.noChangeColor\n        }\n      },\n      isStroke: (data) => {\n        const { preData, currentData } = data\n        const macd = (currentData.technicalIndicatorData || {}).macd\n        const preMacd = (preData.technicalIndicatorData || {}).macd\n        return preMacd < macd\n      }\n    }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let closeSum = 0\n    let emaShort\n    let emaLong\n    let dif = 0\n    let difSum = 0\n    let dea = 0\n    const maxPeriod = Math.max(calcParams[0], calcParams[1])\n    return dataList.map((kLineData, i) => {\n      const macd = {}\n      const close = kLineData.close\n      closeSum += close\n      if (i >= calcParams[0] - 1) {\n        if (i > calcParams[0] - 1) {\n          emaShort = (2 * close + (calcParams[0] - 1) * emaShort) / (calcParams[0] + 1)\n        } else {\n          emaShort = closeSum / calcParams[0]\n        }\n      }\n      if (i >= calcParams[1] - 1) {\n        if (i > calcParams[1] - 1) {\n          emaLong = (2 * close + (calcParams[1] - 1) * emaLong) / (calcParams[1] + 1)\n        } else {\n          emaLong = closeSum / calcParams[1]\n        }\n      }\n      if (i >= maxPeriod - 1) {\n        dif = emaShort - emaLong\n        macd.dif = dif\n        difSum += dif\n        if (i >= maxPeriod + calcParams[2] - 2) {\n          if (i > maxPeriod + calcParams[2] - 2) {\n            dea = (dif * 2 + dea * (calcParams[2] - 1)) / (calcParams[2] + 1)\n          } else {\n            dea = difSum / calcParams[2]\n          }\n          macd.macd = (dif - dea) * 2\n          macd.dea = dea\n        }\n      }\n      return macd\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * sma\n */\nexport default {\n  name: 'SMA',\n  calcParams: [12, 2],\n  series: 'price',\n  precision: 2,\n  plots: [\n    { key: 'sma', title: 'SMA: ', type: 'line' }\n  ],\n  shouldCheckParamCount: true,\n  shouldOhlc: true,\n  calcTechnicalIndicator: (kLineDataList, calcParams) => {\n    let closeSum = 0\n    let smaValue = 0\n    return kLineDataList.map((kLineData, i) => {\n      const sma = {}\n      const close = kLineData.close\n      closeSum += close\n      if (i >= calcParams[0] - 1) {\n        if (i > calcParams[0] - 1) {\n          smaValue = (close * calcParams[1] + smaValue * (calcParams[0] - calcParams[1] + 1)) / (calcParams[0] + 1)\n        } else {\n          smaValue = closeSum / calcParams[0]\n        }\n        sma.sma = smaValue\n      }\n      return sma\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http:*www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * trix\n *\n * TR=收盘价的N日指数移动平均的N日指数移动平均的N日指数移动平均；\n * TRIX=(TR-昨日TR)/昨日TR*100；\n * MATRIX=TRIX的M日简单移动平均；\n * 默认参数N设为12，默认参数M设为9；\n * 默认参数12、9\n * 公式：MTR:=EMA(EMA(EMA(CLOSE,N),N),N)\n * TRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\n * TRMA:MA(TRIX,M)\n *\n */\nexport default {\n  name: 'TRIX',\n  calcParams: [12, 9],\n  plots: [\n    { key: 'trix', title: 'TRIX: ', type: 'line' },\n    { key: 'maTrix', title: 'MATRIX: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let closeSum = 0\n    let ema1\n    let ema2\n    let oldTr\n    let ema1Sum = 0\n    let ema2Sum = 0\n    let trixSum = 0\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const trix = {}\n      const close = kLineData.close\n      closeSum += close\n      if (i >= calcParams[0] - 1) {\n        if (i > calcParams[0] - 1) {\n          ema1 = (2 * close + (calcParams[0] - 1) * ema1) / (calcParams[0] + 1)\n        } else {\n          ema1 = closeSum / calcParams[0]\n        }\n        ema1Sum += ema1\n        if (i >= calcParams[0] * 2 - 2) {\n          if (i > calcParams[0] * 2 - 2) {\n            ema2 = (2 * ema1 + (calcParams[0] - 1) * ema2) / (calcParams[0] + 1)\n          } else {\n            ema2 = ema1Sum / calcParams[0]\n          }\n          ema2Sum += ema2\n          if (i >= calcParams[0] * 3 - 3) {\n            let tr\n            let trixValue = 0\n            if (i > calcParams[0] * 3 - 3) {\n              tr = (2 * ema2 + (calcParams[0] - 1) * oldTr) / (calcParams[0] + 1)\n              trixValue = (tr - oldTr) / oldTr * 100\n            } else {\n              tr = ema2Sum / calcParams[0]\n            }\n            oldTr = tr\n            trix.trix = trixValue\n            trixSum += trixValue\n            if (i >= calcParams[0] * 3 + calcParams[1] - 4) {\n              trix.maTrix = trixSum / calcParams[1]\n              trixSum -= result[i - (calcParams[1] - 1)].trix\n            }\n          }\n        }\n      }\n      result.push(trix)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * BRAR\n * 默认参数是26。\n * 公式N日BR=N日内（H－CY）之和除以N日内（CY－L）之和*100，\n * 其中，H为当日最高价，L为当日最低价，CY为前一交易日的收盘价，N为设定的时间参数。\n * N日AR=(N日内（H－O）之和除以N日内（O－L）之和)*100，\n * 其中，H为当日最高价，L为当日最低价，O为当日开盘价，N为设定的时间参数\n *\n */\nexport default {\n  name: 'BRAR',\n  calcParams: [26],\n  plots: [\n    { key: 'br', title: 'BR: ', type: 'line' },\n    { key: 'ar', title: 'AR: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let hcy = 0\n    let cyl = 0\n    let ho = 0\n    let ol = 0\n    return dataList.map((kLineData, i) => {\n      const brar = {}\n      const high = kLineData.high\n      const low = kLineData.low\n      const open = kLineData.open\n      const preClose = (dataList[i - 1] || kLineData).close\n      ho += (high - open)\n      ol += (open - low)\n      hcy += (high - preClose)\n      cyl += (preClose - low)\n      if (i >= calcParams[0] - 1) {\n        if (ol !== 0) {\n          brar.ar = ho / ol * 100\n        } else {\n          brar.ar = 0\n        }\n        if (cyl !== 0) {\n          brar.br = hcy / cyl * 100\n        } else {\n          brar.br = 0\n        }\n        const agoKLineData = dataList[i - (calcParams[0] - 1)]\n        const agoHigh = agoKLineData.high\n        const agoLow = agoKLineData.low\n        const agoOpen = agoKLineData.open\n        const agoPreClose = (dataList[i - calcParams[0]] || dataList[i - (calcParams[0] - 1)]).close\n        hcy -= (agoHigh - agoPreClose)\n        cyl -= (agoPreClose - agoLow)\n        ho -= (agoHigh - agoOpen)\n        ol -= (agoOpen - agoLow)\n      }\n      return brar\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http:*www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * MID:=REF(HIGH+LOW,1)/2;\n * CR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\n * MA1:REF(MA(CR,M1),M1/2.5+1);\n * MA2:REF(MA(CR,M2),M2/2.5+1);\n * MA3:REF(MA(CR,M3),M3/2.5+1);\n * MA4:REF(MA(CR,M4),M4/2.5+1);\n * MID赋值:(昨日最高价+昨日最低价)/2\n * 输出带状能量线:0和最高价-MID的较大值的N日累和/0和MID-最低价的较大值的N日累和*100\n * 输出MA1:M1(5)/2.5+1日前的CR的M1(5)日简单移动平均\n * 输出MA2:M2(10)/2.5+1日前的CR的M2(10)日简单移动平均\n * 输出MA3:M3(20)/2.5+1日前的CR的M3(20)日简单移动平均\n * 输出MA4:M4/2.5+1日前的CR的M4日简单移动平均\n *\n */\nexport default {\n  name: 'CR',\n  calcParams: [26, 10, 20, 40, 60],\n  plots: [\n    { key: 'cr', title: 'CR: ', type: 'line' },\n    { key: 'ma1', title: 'MA1: ', type: 'line' },\n    { key: 'ma2', title: 'MA2: ', type: 'line' },\n    { key: 'ma3', title: 'MA3: ', type: 'line' },\n    { key: 'ma4', title: 'MA4: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    const ma1ForwardPeriod = Math.ceil(calcParams[1] / 2.5 + 1)\n    const ma2ForwardPeriod = Math.ceil(calcParams[2] / 2.5 + 1)\n    const ma3ForwardPeriod = Math.ceil(calcParams[3] / 2.5 + 1)\n    const ma4ForwardPeriod = Math.ceil(calcParams[4] / 2.5 + 1)\n    let ma1Sum = 0\n    const ma1List = []\n    let ma2Sum = 0\n    const ma2List = []\n    let ma3Sum = 0\n    const ma3List = []\n    let ma4Sum = 0\n    const ma4List = []\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const cr = {}\n      const preData = dataList[i - 1] || kLineData\n      const preMid = (preData.high + preData.close + preData.low + preData.open) / 4\n\n      const highSubPreMid = Math.max(0, kLineData.high - preMid)\n\n      const preMidSubLow = Math.max(0, preMid - kLineData.low)\n\n      if (i >= calcParams[0] - 1) {\n        if (preMidSubLow !== 0) {\n          cr.cr = highSubPreMid / preMidSubLow * 100\n        } else {\n          cr.cr = 0\n        }\n        ma1Sum += cr.cr\n        ma2Sum += cr.cr\n        ma3Sum += cr.cr\n        ma4Sum += cr.cr\n        if (i >= calcParams[0] + calcParams[1] - 2) {\n          ma1List.push(ma1Sum / calcParams[1])\n          if (i >= calcParams[0] + calcParams[1] + ma1ForwardPeriod - 3) {\n            cr.ma1 = ma1List[ma1List.length - 1 - ma1ForwardPeriod]\n          }\n          ma1Sum -= result[i - (calcParams[1] - 1)].cr\n        }\n        if (i >= calcParams[0] + calcParams[2] - 2) {\n          ma2List.push(ma2Sum / calcParams[2])\n          if (i >= calcParams[0] + calcParams[2] + ma2ForwardPeriod - 3) {\n            cr.ma2 = ma2List[ma2List.length - 1 - ma2ForwardPeriod]\n          }\n          ma2Sum -= result[i - (calcParams[2] - 1)].cr\n        }\n        if (i >= calcParams[0] + calcParams[3] - 2) {\n          ma3List.push(ma3Sum / calcParams[3])\n          if (i >= calcParams[0] + calcParams[3] + ma3ForwardPeriod - 3) {\n            cr.ma3 = ma3List[ma3List.length - 1 - ma3ForwardPeriod]\n          }\n          ma3Sum -= result[i - (calcParams[3] - 1)].cr\n        }\n        if (i >= calcParams[0] + calcParams[4] - 2) {\n          ma4List.push(ma4Sum / calcParams[4])\n          if (i >= calcParams[0] + calcParams[4] + ma4ForwardPeriod - 3) {\n            cr.ma4 = ma4List[ma4List.length - 1 - ma4ForwardPeriod]\n          }\n          ma4Sum -= result[i - (calcParams[4] - 1)].cr\n        }\n      }\n      result.push(cr)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * mtm\n * 公式 MTM（N日）=C－CN\n */\nexport default {\n  name: 'MTM',\n  calcParams: [12, 6],\n  plots: [\n    { key: 'mtm', title: 'MTM: ', type: 'line' },\n    { key: 'maMtm', title: 'MAMTM: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let mtmSum = 0\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const mtm = {}\n      if (i >= calcParams[0]) {\n        const close = kLineData.close\n        const agoClose = dataList[i - calcParams[0]].close\n        mtm.mtm = close - agoClose\n        mtmSum += mtm.mtm\n        if (i >= calcParams[0] + calcParams[1] - 1) {\n          mtm.maMtm = mtmSum / calcParams[1]\n          mtmSum -= result[i - (calcParams[1] - 1)].mtm\n        }\n      }\n      result.push(mtm)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * PSY\n * 公式：PSY=N日内的上涨天数/N×100%。\n */\nexport default {\n  name: 'PSY',\n  calcParams: [12, 6],\n  plots: [\n    { key: 'psy', title: 'PSY: ', type: 'line' },\n    { key: 'maPsy', title: 'MAPSY: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let upCount = 0\n    let psySum = 0\n    const upList = []\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const psy = {}\n      const preClose = (dataList[i - 1] || kLineData).close\n      const upFlag = kLineData.close - preClose > 0 ? 1 : 0\n      upList.push(upFlag)\n      upCount += upFlag\n      if (i >= calcParams[0] - 1) {\n        psy.psy = upCount / calcParams[0] * 100\n        psySum += psy.psy\n        if (i >= calcParams[0] + calcParams[1] - 2) {\n          psy.maPsy = psySum / calcParams[1]\n          psySum -= result[i - (calcParams[1] - 1)].psy\n        }\n        upCount -= upList[i - (calcParams[0] - 1)]\n      }\n      result.push(psy)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 变动率指标\n * 公式：ROC = (CLOSE - REF(CLOSE, N)) / REF(CLOSE, N)\n */\nexport default {\n  name: 'ROC',\n  calcParams: [12, 6],\n  shouldCheckParamCount: true,\n  plots: [\n    { key: 'roc', title: 'ROC: ', type: 'line' },\n    { key: 'maRoc', title: 'MAROC: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (kLineDataList, calcParams) => {\n    const result = []\n    let rocSum = 0\n    kLineDataList.forEach((kLineData, i) => {\n      const roc = {}\n      if (i >= calcParams[0] - 1) {\n        const close = kLineData.close\n        const agoClose = (kLineDataList[i - calcParams[0]] || kLineDataList[i - (calcParams[0] - 1)]).close\n        if (agoClose !== 0) {\n          roc.roc = (close - agoClose) / agoClose * 100\n        } else {\n          roc.roc = 0\n        }\n        rocSum += roc.roc\n        if (i >= calcParams[0] - 1 + calcParams[1] - 1) {\n          roc.maRoc = rocSum / calcParams[1]\n          rocSum -= result[i - (calcParams[1] - 1)].roc\n        }\n      }\n      result.push(roc)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * VR\n * VR=（UVS+1/2PVS）/（DVS+1/2PVS）\n * 24天以来凡是股价上涨那一天的成交量都称为AV，将24天内的AV总和相加后称为UVS\n * 24天以来凡是股价下跌那一天的成交量都称为BV，将24天内的BV总和相加后称为DVS\n * 24天以来凡是股价不涨不跌，则那一天的成交量都称为CV，将24天内的CV总和相加后称为PVS\n *\n */\nexport default {\n  name: 'VR',\n  calcParams: [26, 6],\n  plots: [\n    { key: 'vr', title: 'VR: ', type: 'line' },\n    { key: 'maVr', title: 'MAVR: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let uvs = 0\n    let dvs = 0\n    let pvs = 0\n    let vrSum = 0\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const vr = {}\n      const close = kLineData.close\n      const preClose = (dataList[i - 1] || kLineData).close\n      const volume = kLineData.volume\n      if (close > preClose) {\n        uvs += volume\n      } else if (close < preClose) {\n        dvs += volume\n      } else {\n        pvs += volume\n      }\n      if (i >= calcParams[0] - 1) {\n        const halfPvs = pvs / 2\n        if (dvs + halfPvs === 0) {\n          vr.vr = 0\n        } else {\n          vr.vr = (uvs + halfPvs) / (dvs + halfPvs) * 100\n        }\n        vrSum += vr.vr\n        if (i >= calcParams[0] + calcParams[1] - 2) {\n          vr.maVr = vrSum / calcParams[1]\n          vrSum -= result[i - (calcParams[1] - 1)].vr\n        }\n\n        const agoData = dataList[i - (calcParams[0] - 1)]\n        const agoPreData = dataList[i - calcParams[0]] || agoData\n        const agoClose = agoData.close\n        const agoVolume = agoData.volume\n        if (agoClose > agoPreData.close) {\n          uvs -= agoVolume\n        } else if (agoClose < agoPreData.close) {\n          dvs -= agoVolume\n        } else {\n          pvs -= agoVolume\n        }\n      }\n      result.push(vr)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  name: 'AO',\n  calcParams: [5, 34],\n  shouldCheckParamCount: true,\n  plots: [{\n    key: 'ao',\n    title: 'AO: ',\n    type: 'bar',\n    color: (data, technicalIndicatorOptions) => {\n      const { preData, currentData } = data\n      const preAo = (preData.technicalIndicatorData || {}).ao\n      const ao = (currentData.technicalIndicatorData || {}).ao\n      if (ao > preAo) {\n        return technicalIndicatorOptions.bar.upColor\n      } else {\n        return technicalIndicatorOptions.bar.downColor\n      }\n    },\n    isStroke: (data) => {\n      const { preData, currentData } = data\n      const preAo = (preData.technicalIndicatorData || {}).ao\n      const ao = (currentData.technicalIndicatorData || {}).ao\n      return ao > preAo\n    }\n  }],\n  baseValue: 0,\n  calcTechnicalIndicator: (kLineDataList, calcParams) => {\n    const maxParam = Math.max(calcParams[0], calcParams[1])\n    let shortSum = 0\n    let longSum = 0\n    let short = 0\n    let long = 0\n    return kLineDataList.map((kLineData, i) => {\n      const ao = {}\n      const middle = (kLineData.low + kLineData.high) / 2\n      shortSum += middle\n      longSum += middle\n      if (i >= calcParams[0] - 1) {\n        short = shortSum / calcParams[0]\n        const agoKLineData = kLineDataList[i - (calcParams[0] - 1)]\n        shortSum -= ((agoKLineData.low + agoKLineData.high) / 2)\n      }\n      if (i >= calcParams[1] - 1) {\n        long = longSum / calcParams[1]\n        const agoKLineData = kLineDataList[i - (calcParams[1] - 1)]\n        longSum -= ((agoKLineData.low + agoKLineData.high) / 2)\n      }\n      if (i >= maxParam - 1) {\n        ao.ao = short - long\n      }\n      return ao\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * BIAS\n * 乖离率=[(当日收盘价-N日平均价)/N日平均价]*100%\n */\nexport default {\n  name: 'BIAS',\n  calcParams: [6, 12, 24],\n  shouldCheckParamCount: false,\n  plots: [\n    { key: 'bias6', title: 'BIAS6: ', type: 'line' },\n    { key: 'bias12', title: 'BIAS12: ', type: 'line' },\n    { key: 'bias24', title: 'BIAS24: ', type: 'line' }\n  ],\n  regeneratePlots: (params) => {\n    return params.map(p => {\n      return { key: `bias${p}`, title: `BIAS${p}: `, type: 'line' }\n    })\n  },\n  calcTechnicalIndicator: (dataList, calcParams, plots) => {\n    const closeSums = []\n    return dataList.map((kLineData, i) => {\n      const bias = {}\n      const close = kLineData.close\n      calcParams.forEach((param, j) => {\n        closeSums[j] = (closeSums[j] || 0) + close\n        if (i >= param - 1) {\n          const mean = closeSums[j] / calcParams[j]\n          bias[plots[j].key] = (close - mean) / mean * 100\n\n          closeSums[j] -= dataList[i - (param - 1)].close\n        }\n      })\n      return bias\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * CCI\n * CCI（N日）=（TP－MA）÷MD÷0.015\n * 其中，TP=（最高价+最低价+收盘价）÷3\n * MA=近N日TP价的累计之和÷N\n * MD=近N日TP - 当前MA绝对值的累计之和÷N\n *\n */\nexport default {\n  name: 'CCI',\n  calcParams: [20],\n  plots: [\n    { key: 'cci', title: 'CCI: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    const p = calcParams[0] - 1\n    let tpSum = 0\n    const tpList = []\n    return dataList.map((kLineData, i) => {\n      const cci = {}\n      const tp = (kLineData.high + kLineData.low + kLineData.close) / 3\n      tpSum += tp\n      tpList.push(tp)\n      if (i >= p) {\n        const maTp = tpSum / calcParams[0]\n        const sliceTpList = tpList.slice(i - p, i + 1)\n        let sum = 0\n        sliceTpList.forEach(tp => {\n          sum += Math.abs(tp - maTp)\n        })\n        const md = sum / calcParams[0]\n        cci.cci = md !== 0 ? (tp - maTp) / md / 0.015 : 0\n        const agoTp = (dataList[i - p].high + dataList[i - p].low + dataList[i - p].close) / 3\n        tpSum -= agoTp\n      }\n      return cci\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * RSI\n * RSI = SUM(MAX(CLOSE - REF(CLOSE,1),0),N) / SUM(ABS(CLOSE - REF(CLOSE,1)),N) × 100\n */\nexport default {\n  name: 'RSI',\n  calcParams: [6, 12, 24],\n  shouldCheckParamCount: false,\n  plots: [\n    { key: 'rsi1', title: 'RSI1: ', type: 'line' },\n    { key: 'rsi2', title: 'RSI2: ', type: 'line' },\n    { key: 'rsi3', title: 'RSI3: ', type: 'line' }\n  ],\n  regeneratePlots: (params) => {\n    return params.map((_, index) => {\n      const num = index + 1\n      return { key: `rsi${num}`, title: `RSI${num}: `, type: 'line' }\n    })\n  },\n  calcTechnicalIndicator: (dataList, calcParams, plots) => {\n    const sumCloseAs = []\n    const sumCloseBs = []\n    return dataList.map((kLineData, i) => {\n      const rsi = {}\n      const preClose = (dataList[i - 1] || kLineData).close\n      const tmp = kLineData.close - preClose\n      calcParams.forEach((param, j) => {\n        if (tmp > 0) {\n          sumCloseAs[j] = (sumCloseAs[j] || 0) + tmp\n        } else {\n          sumCloseBs[j] = (sumCloseBs[j] || 0) + Math.abs(tmp)\n        }\n        if (i >= param - 1) {\n          if (sumCloseBs[j] !== 0) {\n            rsi[plots[j].key] = 100 - (100.0 / (1 + sumCloseAs[j] / sumCloseBs[j]))\n          } else {\n            rsi[plots[j].key] = 0\n          }\n          const agoData = dataList[i - (param - 1)]\n          const agoPreData = dataList[i - param] || agoData\n          const agoTmp = agoData.close - agoPreData.close\n          if (agoTmp > 0) {\n            sumCloseAs[j] -= agoTmp\n          } else {\n            sumCloseBs[j] -= Math.abs(agoTmp)\n          }\n        }\n      })\n      return rsi\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 计算n周期内最高和最低\n * @param dataList\n * @returns {{ln: number, hn: number}}\n */\nexport default function calcHnLn (dataList = []) {\n  let hn = Number.MIN_SAFE_INTEGER\n  let ln = Number.MAX_SAFE_INTEGER\n  dataList.forEach(data => {\n    hn = Math.max(data.high, hn)\n    ln = Math.min(data.low, ln)\n  })\n  return { hn, ln }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport calcHnLn from '../calcHnLn'\n\n/**\n * KDJ\n *\n * 当日K值=2/3×前一日K值+1/3×当日RSV\n * 当日D值=2/3×前一日D值+1/3×当日K值\n * 若无前一日K 值与D值，则可分别用50来代替。\n * J值=3*当日K值-2*当日D值\n */\nexport default {\n  name: 'KDJ',\n  calcParams: [9, 3, 3],\n  plots: [\n    { key: 'k', title: 'K: ', type: 'line' },\n    { key: 'd', title: 'D: ', type: 'line' },\n    { key: 'j', title: 'J: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const kdj = {}\n      const close = kLineData.close\n      if (i >= calcParams[0] - 1) {\n        const lhn = calcHnLn(dataList.slice(i - (calcParams[0] - 1), i + 1))\n        const ln = lhn.ln\n        const hn = lhn.hn\n        const hnSubLn = hn - ln\n        const rsv = (close - ln) / (hnSubLn === 0 ? 1 : hnSubLn) * 100\n        kdj.k = ((calcParams[1] - 1) * (result[i - 1].k || 50) + rsv) / calcParams[1]\n        kdj.d = ((calcParams[2] - 1) * (result[i - 1].d || 50) + kdj.k) / calcParams[2]\n        kdj.j = 3.0 * kdj.k - 2.0 * kdj.d\n      }\n      result.push(kdj)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport calcHnLn from '../calcHnLn'\n\n/**\n * WR\n * 公式 WR(N) = 100 * [ C - HIGH(N) ] / [ HIGH(N)-LOW(N) ]\n */\nexport default {\n  name: 'WR',\n  calcParams: [6, 10, 14],\n  shouldCheckParamCount: false,\n  plots: [\n    { key: 'wr1', title: 'WR1: ', type: 'line' },\n    { key: 'wr2', title: 'WR2: ', type: 'line' },\n    { key: 'wr3', title: 'WR3: ', type: 'line' }\n  ],\n  regeneratePlots: (params) => {\n    return params.map((_, i) => {\n      return { key: `wr${i + 1}`, title: `WR${i + 1}: `, type: 'line' }\n    })\n  },\n  calcTechnicalIndicator: (dataList, calcParams, plots) => {\n    return dataList.map((kLineData, i) => {\n      const wr = {}\n      const close = kLineData.close\n      calcParams.forEach((param, index) => {\n        const p = param - 1\n        if (i >= p) {\n          const hln = calcHnLn(dataList.slice(i - p, i + 1))\n          const hn = hln.hn\n          const ln = hln.ln\n          const hnSubLn = hn - ln\n          wr[plots[index].key] = hnSubLn === 0 ? 0 : (close - hn) / hnSubLn * 100\n        }\n      })\n      return wr\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 计算布林指标中的标准差\n * @param dataList\n * @param ma\n * @return {number}\n */\nfunction getBollMd (dataList, ma) {\n  const dataSize = dataList.length\n  let sum = 0\n  dataList.forEach(data => {\n    const closeMa = data.close - ma\n    sum += closeMa * closeMa\n  })\n  const b = sum > 0\n  sum = Math.abs(sum)\n  const md = Math.sqrt(sum / dataSize)\n  return b ? md : -1 * md\n}\n\n/**\n * BOLL\n */\nexport default {\n  name: 'BOLL',\n  series: 'price',\n  calcParams: [20, 2],\n  calcParamsAllowDecimal: { 1: true },\n  precision: 2,\n  shouldOhlc: true,\n  plots: [\n    { key: 'up', title: 'UP: ', type: 'line' },\n    { key: 'mid', title: 'MID: ', type: 'line' },\n    { key: 'dn', title: 'DN: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    const p = calcParams[0] - 1\n    let closeSum = 0\n    return dataList.map((kLineData, i) => {\n      const close = kLineData.close\n      const boll = {}\n      closeSum += close\n      if (i >= p) {\n        boll.mid = closeSum / calcParams[0]\n        const md = getBollMd(dataList.slice(i - p, i + 1), boll.mid)\n        boll.up = boll.mid + calcParams[1] * md\n        boll.dn = boll.mid - calcParams[1] * md\n        closeSum -= dataList[i - p].close\n      }\n      return boll\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  name: 'SAR',\n  series: 'price',\n  calcParams: [2, 2, 20],\n  precision: 2,\n  shouldOhlc: true,\n  plots: [\n    {\n      key: 'sar',\n      title: 'SAR: ',\n      type: 'circle',\n      color: (data, options) => {\n        const { currentData } = data\n        const kLineData = currentData.kLineData || {}\n        const technicalIndicatorData = currentData.technicalIndicatorData || {}\n        const halfHL = (kLineData.high + kLineData.low) / 2\n        if (technicalIndicatorData.sar < halfHL) {\n          return options.circle.upColor\n        }\n        return options.circle.downColor\n      }\n    }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    const startAf = calcParams[0] / 100\n    const step = calcParams[1] / 100\n    const maxAf = calcParams[2] / 100\n\n    // 加速因子\n    let af = startAf\n    // 极值\n    let ep = -100\n    // 判断是上涨还是下跌  false：下跌\n    let isIncreasing = false\n    let sar = 0\n    return dataList.map((kLineData, i) => {\n      // 上一个周期的sar\n      const preSar = sar\n      const high = kLineData.high\n      const low = kLineData.low\n      if (isIncreasing) {\n        // 上涨\n        if (ep === -100 || ep < high) {\n          // 重新初始化值\n          ep = high\n          af = Math.min(af + step, maxAf)\n        }\n        sar = preSar + af * (ep - preSar)\n        const lowMin = Math.min(dataList[Math.max(1, i) - 1].low, low)\n        if (sar > kLineData.low) {\n          sar = ep\n          // 重新初始化值\n          af = startAf\n          ep = -100\n          isIncreasing = !isIncreasing\n        } else if (sar > lowMin) {\n          sar = lowMin\n        }\n      } else {\n        if (ep === -100 || ep > low) {\n          // 重新初始化值\n          ep = low\n          af = Math.min(af + step, maxAf)\n        }\n        sar = preSar + af * (ep - preSar)\n        const highMax = Math.max(dataList[Math.max(1, i) - 1].high, high)\n        if (sar < kLineData.high) {\n          sar = ep\n          // 重新初始化值\n          af = 0\n          ep = -100\n          isIncreasing = !isIncreasing\n        } else if (sar < highMax) {\n          sar = highMax\n        }\n      }\n      return { sar }\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * OBV\n * OBV = REF(OBV) + sign * V\n */\nexport default {\n  name: 'OBV',\n  calcParams: [30],\n  plots: [\n    { key: 'obv', title: 'OBV: ', type: 'line' },\n    { key: 'maObv', title: 'MAOBV: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (dataList, calcParams) => {\n    let obvSum = 0\n    let oldObv = 0\n    const result = []\n    dataList.forEach((kLineData, i) => {\n      const preKLineData = dataList[i - 1] || kLineData\n      if (kLineData.close < preKLineData.close) {\n        oldObv -= kLineData.volume\n      } else if (kLineData.close > preKLineData.close) {\n        oldObv += kLineData.volume\n      }\n      const obv = { obv: oldObv }\n      obvSum += oldObv\n      if (i >= calcParams[0] - 1) {\n        obv.maObv = obvSum / calcParams[0]\n        obvSum -= result[i - (calcParams[0] - 1)].obv\n      }\n      result.push(obv)\n    })\n    return result\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 价量趋势指标\n * 公式:\n * X = (CLOSE - REF(CLOSE, 1)) / REF(CLOSE, 1) * VOLUME\n * PVT = SUM(X)\n *\n */\nexport default {\n  name: 'PVT',\n  plots: [\n    { key: 'pvt', title: 'PVT: ', type: 'line' }\n  ],\n  calcTechnicalIndicator: (kLineDataList) => {\n    let sum = 0\n    return kLineDataList.map((kLineData, i) => {\n      const pvt = {}\n      const close = kLineData.close\n      const volume = kLineData.volume\n      const preClose = (kLineDataList[i - 1] || kLineData).close\n      let x = 0\n      if (preClose !== 0) {\n        x = (close - preClose) / preClose * volume\n      }\n      sum += x\n      pvt.pvt = sum\n      return pvt\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  name: 'VOL',\n  series: 'volume',\n  calcParams: [5, 10, 20],\n  shouldCheckParamCount: false,\n  shouldFormatBigNumber: true,\n  precision: 0,\n  baseValue: 0,\n  minValue: 0,\n  plots: [\n    { key: 'ma5', title: 'MA5: ', type: 'line' },\n    { key: 'ma10', title: 'MA10: ', type: 'line' },\n    { key: 'ma20', title: 'MA20: ', type: 'line' },\n    {\n      key: 'volume',\n      title: 'VOLUME: ',\n      type: 'bar',\n      color: (data, options) => {\n        const kLineData = data.currentData.kLineData || {}\n        if (kLineData.close > kLineData.open) {\n          return options.bar.upColor\n        } else if (kLineData.close < kLineData.open) {\n          return options.bar.downColor\n        }\n        return options.bar.noChangeColor\n      }\n    }\n  ],\n  regeneratePlots: (params) => {\n    const plots = params.map(p => {\n      return { key: `ma${p}`, title: `MA${p}: `, type: 'line' }\n    })\n    plots.push({\n      key: 'volume',\n      title: 'VOLUME: ',\n      type: 'bar',\n      color: (data, options) => {\n        const kLineData = data.currentData.kLineData || {}\n        if (kLineData.close > kLineData.open) {\n          return options.bar.upColor\n        } else if (kLineData.close < kLineData.open) {\n          return options.bar.downColor\n        }\n        return options.bar.noChangeColor\n      }\n    })\n    return plots\n  },\n  calcTechnicalIndicator: (dataList, calcParams, plots) => {\n    const volSums = []\n    return dataList.map((kLineData, i) => {\n      const volume = kLineData.volume || 0\n      const vol = { volume }\n      calcParams.forEach((param, j) => {\n        volSums[j] = (volSums[j] || 0) + volume\n        if (i >= param - 1) {\n          vol[plots[j].key] = volSums[j] / param\n          volSums[j] -= dataList[i - (param - 1)].volume\n        }\n      })\n      return vol\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  technicalIndicatorExtensions: {},\n  graphicMarkExtensions: {},\n  addTechnicalIndicator (technicalIndicators) {\n    if (technicalIndicators) {\n      ([].concat(technicalIndicators)).forEach(\n        technicalIndicator => {\n          if (technicalIndicator.name) {\n            this.technicalIndicatorExtensions[technicalIndicator.name] = technicalIndicator\n          }\n        }\n      )\n    }\n  },\n  addGraphicMark (graphicMarks) {\n    if (graphicMarks) {\n      ([].concat(graphicMarks)).forEach(\n        graphicMark => {\n          if (graphicMark.name) {\n            this.graphicMarkExtensions[graphicMark.name] = graphicMark\n          }\n        }\n      )\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 合并\n * @param target\n * @param source\n */\nexport function merge (target, source) {\n  if (!isObject(target) || !isObject(source)) {\n    return\n  }\n  for (const key in source) {\n    if (key in target) {\n      const targetProp = target[key]\n      const sourceProp = source[key]\n      if (\n        isObject(sourceProp) &&\n        isObject(targetProp) &&\n        !isArray(sourceProp) &&\n        !isArray(targetProp)\n      ) {\n        merge(targetProp, sourceProp)\n      } else {\n        if (isValid(source[key])) {\n          target[key] = source[key]\n        }\n      }\n    }\n  }\n}\n\n/**\n * 克隆\n * @param target\n * @return {{}|*}\n */\nexport function clone (target) {\n  if (!isObject(target)) {\n    return target\n  }\n\n  let copy\n  if (isArray(target)) {\n    copy = []\n  } else {\n    copy = {}\n  }\n  for (const key in target) {\n    if (target.hasOwnProperty(key)) {\n      const v = target[key]\n      if (isObject(v)) {\n        copy[key] = clone(v)\n      } else {\n        copy[key] = v\n      }\n    }\n  }\n  return copy\n}\n\n/**\n * 是否是数组\n * @param value\n * @return {boolean}\n */\nexport function isArray (value) {\n  return Object.prototype.toString.call(value) === '[object Array]'\n}\n\n/**\n * 是否是方法\n * @param {*} value\n * @return {boolean}\n */\nexport function isFunction (value) {\n  return typeof value === 'function'\n}\n\n/**\n * 是否是对象\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject (value) {\n  return (!!value && typeof value === 'object')\n}\n\n/**\n * 判断是否是数字\n * @param value\n * @returns {boolean}\n */\nexport function isNumber (value) {\n  return typeof value === 'number' && !isNaN(value)\n}\n\n/**\n * 判断是否有效\n * @param value\n * @returns {boolean}\n */\nexport function isValid (value) {\n  return value !== null && value !== undefined\n}\n\n/**\n * 判断是否是boolean\n * @param value\n * @returns {boolean}\n */\nexport function isBoolean (value) {\n  return typeof value === 'boolean'\n}\n\n/**\n * 是否是字符串\n * @param value\n * @return {boolean}\n */\nexport function isString (value) {\n  return typeof value === 'string'\n}\n\n/**\n * 是否是容器元素\n * @param dom\n * @return {boolean}\n */\nexport function isContainerDom (dom) {\n  return dom && (dom instanceof HTMLElement) && dom.appendChild && (typeof dom.appendChild === 'function')\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 线的样式\n * @type {{DASH: string, SOLID: string}}\n */\nexport const LineStyle = {\n  DASH: 'dash',\n  SOLID: 'solid'\n}\n\n/**\n * y轴位置\n * @type {{LEFT: string, RIGHT: string}}\n */\nexport const YAxisPosition = {\n  LEFT: 'left',\n  RIGHT: 'right'\n}\n\n/**\n * y轴类型\n * @type {{PERCENTAGE: string, NORMAL: string}}\n */\nexport const YAxisType = {\n  NORMAL: 'normal',\n  PERCENTAGE: 'percentage',\n  LOG: 'log'\n}\n\n/**\n * 蜡烛图样式\n * @type {{AREA: string, OHLC: string, CANDLE_STROKE: string, CANDLE_SOLID: string, CANDLE_DOWN_STROKE: string, CANDLE_UP_STROKE: string}}\n */\nexport const CandleType = {\n  CANDLE_SOLID: 'candle_solid',\n  CANDLE_STROKE: 'candle_stroke',\n  CANDLE_UP_STROKE: 'candle_up_stroke',\n  CANDLE_DOWN_STROKE: 'candle_down_stroke',\n  OHLC: 'ohlc',\n  AREA: 'area'\n}\n\n/**\n * 说明显示规则\n * @type {{FOLLOW_CROSS: string, NONE: string, ALWAYS: string}}\n */\nexport const TooltipShowRule = {\n  ALWAYS: 'always',\n  FOLLOW_CROSS: 'follow_cross',\n  NONE: 'none'\n}\n\n/**\n * 数据提示显示类型\n * @type {{RECT: string, STANDARD: string}}\n */\nexport const TooltipShowType = {\n  RECT: 'rect',\n  STANDARD: 'standard'\n}\n\n/**\n * 注解标识类似\n * @type {{RECT: string, TRIANGLE: string, DIAMOND: string, CUSTOM: string, NONE: string, CIRCLE: string}}\n */\nexport const AnnotationSymbolType = {\n  CIRCLE: 'circle',\n  RECT: 'rect',\n  TRIANGLE: 'triangle',\n  DIAMOND: 'diamond',\n  CUSTOM: 'custom',\n  NONE: 'none'\n}\n\n/**\n * 覆盖物位置\n * @type {{TOP: string, BOTTOM: string, POINT: string}}\n */\nexport const OverlayPosition = {\n  POINT: 'point',\n  TOP: 'top',\n  BOTTOM: 'bottom'\n}\n\n/**\n * 默认网格配置\n * @type {{horizontal: {size: number, color: string, dashValue: number[], show: boolean, style: string}, show: boolean, vertical: {size: number, color: string, dashValue: number[], show: boolean, style: string}}}\n */\nconst defaultGrid = {\n  show: true,\n  horizontal: {\n    show: true,\n    size: 1,\n    color: '#EDEDED',\n    style: LineStyle.DASH,\n    dashValue: [2, 2]\n  },\n  vertical: {\n    show: true,\n    size: 1,\n    color: '#EDEDED',\n    style: LineStyle.DASH,\n    dashValue: [2, 2]\n  }\n}\n\n/**\n * 默认蜡烛柱图样式配置\n * @type {{area: {fillColor: [{offset: number, color: string}, {offset: number, color: string}], lineColor: string, lineSize: number, value: string}, bar: {noChangeColor: string, upColor: string, downColor: string}, tooltip: {rect: {offsetTop: number, fillColor: string, borderColor: string, paddingBottom: number, borderRadius: number, paddingRight: number, borderSize: number, offsetLeft: number, paddingTop: number, paddingLeft: number, offsetRight: number}, showRule: string, values: null, showType: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, labels: string[]}, type: string, priceMark: {high: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, last: {noChangeColor: string, upColor: string, line: {dashValue: number[], size: number, show: boolean, style: string}, show: boolean, text: {paddingBottom: number, size: number, color: string, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}, downColor: string}, low: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, show: boolean}}}\n */\nconst defaultCandle = {\n  margin: {\n    top: 0.2,\n    bottom: 0.1\n  },\n  type: CandleType.CANDLE_SOLID,\n  bar: {\n    /**\n     * 上涨颜色\n     */\n    upColor: '#26A69A',\n    /**\n     * 下跌颜色\n     */\n    downColor: '#EF5350',\n    /**\n     * 无变化时颜色\n     */\n    noChangeColor: '#999999'\n  },\n  area: {\n    lineSize: 2,\n    lineColor: '#2196F3',\n    value: 'close',\n    fillColor: [{\n      offset: 0,\n      color: 'rgba(33, 150, 243, 0.01)'\n    }, {\n      offset: 1,\n      color: 'rgba(33, 150, 243, 0.2)'\n    }]\n  },\n  priceMark: {\n    show: true,\n    high: {\n      show: true,\n      color: '#76808F',\n      textMargin: 5,\n      textSize: 10,\n      textFamily: 'Helvetica Neue',\n      textWeight: 'normal'\n    },\n    low: {\n      show: true,\n      color: '#76808F',\n      textMargin: 5,\n      textSize: 10,\n      textFamily: 'Helvetica Neue',\n      textWeight: 'normal'\n    },\n    last: {\n      show: true,\n      upColor: '#26A69A',\n      downColor: '#EF5350',\n      noChangeColor: '#888888',\n      line: {\n        show: true,\n        style: LineStyle.DASH,\n        dashValue: [4, 4],\n        size: 1\n      },\n      text: {\n        show: true,\n        size: 12,\n        paddingLeft: 2,\n        paddingTop: 2,\n        paddingRight: 2,\n        paddingBottom: 2,\n        color: '#FFFFFF',\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        borderRadius: 2\n      }\n    }\n  },\n  tooltip: {\n    showRule: TooltipShowRule.ALWAYS,\n    showType: TooltipShowType.STANDARD,\n    labels: ['时间: ', '开: ', '收: ', '高: ', '低: ', '成交量: '],\n    values: null,\n    defaultValue: 'n/a',\n    rect: {\n      paddingLeft: 0,\n      paddingRight: 0,\n      paddingTop: 0,\n      paddingBottom: 6,\n      offsetLeft: 8,\n      offsetTop: 8,\n      offsetRight: 8,\n      borderRadius: 4,\n      borderSize: 1,\n      borderColor: '#F2F3F5',\n      fillColor: '#FEFEFE'\n    },\n    text: {\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      color: '#76808F',\n      marginLeft: 8,\n      marginTop: 6,\n      marginRight: 8,\n      marginBottom: 0\n    }\n  }\n}\n\n/**\n * 默认的技术指标样式配置\n * @type {{bar: {noChangeColor: string, upColor: string, downColor: string}, line: {size: number, colors: [string, string, string, string, string]}, tooltip: {showParams: boolean, showName: boolean, showRule: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}}, circle: {noChangeColor: string, upColor: string, downColor: string}, lastValueMark: {show: boolean, text: {paddingBottom: number, color: string, size: number, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}}}}\n */\nconst defaultTechnicalIndicator = {\n  margin: {\n    top: 0.2,\n    bottom: 0.1\n  },\n  bar: {\n    upColor: 'rgba(38, 166, 154, .65)',\n    downColor: 'rgba(239, 83, 80, .65)',\n    noChangeColor: '#888888'\n  },\n  line: {\n    size: 1,\n    colors: ['#FF9600', '#9D65C9', '#2196F3', '#E11D74', '#01C5C4']\n  },\n  circle: {\n    upColor: 'rgba(38, 166, 154, .65)',\n    downColor: 'rgba(239, 83, 80, .65)',\n    noChangeColor: '#888888'\n  },\n  lastValueMark: {\n    show: false,\n    text: {\n      show: false,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 3,\n      paddingTop: 2,\n      paddingRight: 3,\n      paddingBottom: 2,\n      borderRadius: 2\n    }\n  },\n  tooltip: {\n    showRule: TooltipShowRule.ALWAYS,\n    showType: TooltipShowType.STANDARD,\n    showName: true,\n    showParams: true,\n    defaultValue: 'n/a',\n    text: {\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      color: '#76808F',\n      marginTop: 6,\n      marginRight: 8,\n      marginBottom: 0,\n      marginLeft: 8\n    }\n  }\n}\n\n/**\n * 默认x轴配置\n * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, tickText: {paddingBottom: number, color: string, size: number, show: boolean, weight: string, paddingTop: number, family: string}, height: null, tickLine: {size: number, color: string, show: boolean, length: number}}}\n */\nconst defaultXAxis = {\n  /**\n   * 是否显示整个轴\n   */\n  show: true,\n  /**\n   * 高度\n   */\n  height: null,\n  /**\n   * 轴线配置\n   */\n  axisLine: {\n    show: true,\n    color: '#DDDDDD',\n    size: 1\n  },\n\n  /**\n   * tick文字\n   */\n  tickText: {\n    show: true,\n    color: '#76808F',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingTop: 3,\n    paddingBottom: 6\n  },\n  // tick线\n  tickLine: {\n    show: true,\n    size: 1,\n    length: 3,\n    color: '#DDDDDD'\n  }\n}\n\n/**\n * 默认y轴配置\n * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, width: null, position: string, tickText: {color: string, size: number, paddingRight: number, show: boolean, weight: string, family: string, paddingLeft: number}, type: string, inside: boolean, tickLine: {size: number, color: string, show: boolean, length: number}}}\n */\nconst defaultYAxis = {\n  /**\n   * 是否显示整个轴\n   */\n  show: true,\n  /**\n   * 宽度\n   */\n  width: null,\n  /**\n   * y轴类型\n   */\n  type: YAxisType.NORMAL,\n  /**\n   * 轴位置\n   */\n  position: YAxisPosition.RIGHT,\n  /**\n   * 轴是否在内部\n   */\n  inside: false,\n  /**\n   * 轴线配置\n   */\n  axisLine: {\n    show: true,\n    color: '#DDDDDD',\n    size: 1\n  },\n\n  /**\n   * tick文字\n   */\n  tickText: {\n    show: true,\n    color: '#76808F',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 3,\n    paddingRight: 6\n  },\n  // tick线\n  tickLine: {\n    show: true,\n    size: 1,\n    length: 3,\n    color: '#DDDDDD'\n  }\n}\n\nconst defaultCrosshair = {\n  show: true,\n  horizontal: {\n    show: true,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#76808F'\n    },\n    text: {\n      show: true,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderSize: 1,\n      borderColor: '#686D76',\n      borderRadius: 2,\n      backgroundColor: '#686D76'\n    }\n  },\n  vertical: {\n    show: true,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#76808F'\n    },\n    text: {\n      show: true,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderSize: 1,\n      borderRadius: 2,\n      borderColor: '#686D76',\n      backgroundColor: '#686D76'\n    }\n  }\n}\n\n/**\n * 默认图形标记配置\n * @type {{arc: {fill: {color: string}, stroke: {size: number, color: string}}, polygon: {fill: {color: string}, stroke: {size: number, color: string}}, line: {color: string, size: number}, text: {marginRight: number, color: string, size: number, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, point: {backgroundColor: string, borderColor: string, activeBorderSize: number, activeRadius: number, activeBorderColor: string, activeBackgroundColor: string, borderSize: number, radius: number}}}\n */\nconst defaultGraphicMark = {\n  point: {\n    backgroundColor: '#2196F3',\n    borderColor: 'rgba(33, 150, 243, 0.35)',\n    borderSize: 1,\n    radius: 5,\n    activeBackgroundColor: '#2196F3',\n    activeBorderColor: 'rgba(33, 150, 243, 0.35)',\n    activeBorderSize: 3,\n    activeRadius: 5\n  },\n  line: {\n    color: '#2196F3',\n    size: 1,\n    dashValue: [2, 2]\n  },\n  polygon: {\n    stroke: {\n      size: 1,\n      color: '#2196F3'\n    },\n    fill: {\n      color: 'rgba(33, 150, 243, 0.1)'\n    }\n  },\n  arc: {\n    stroke: {\n      size: 1,\n      color: '#2196F3'\n    },\n    fill: {\n      color: 'rgba(33, 150, 243, 0.1)'\n    }\n  },\n  text: {\n    color: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    marginLeft: 2,\n    marginRight: 2,\n    marginTop: 2,\n    marginBottom: 6\n  }\n}\n\n/**\n * 默认注解信息配置\n * @type {{}}\n */\nconst defaultAnnotation = {\n  symbol: {\n    type: AnnotationSymbolType.DIAMOND,\n    position: OverlayPosition.TOP,\n    size: 8,\n    color: '#2196F3',\n    activeSize: 10,\n    activeColor: '#FF9600',\n    offset: [0, 20]\n  }\n}\n\nconst defaultTag = {\n  position: OverlayPosition.POINT,\n  offset: 0,\n  line: {\n    show: true,\n    style: LineStyle.DASH,\n    dashValue: [4, 2],\n    size: 1,\n    color: '#2196F3'\n  },\n  text: {\n    color: '#FFFFFF',\n    backgroundColor: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 2,\n    paddingRight: 2,\n    paddingTop: 2,\n    paddingBottom: 2,\n    borderRadius: 2\n  },\n  mark: {\n    color: '#FFFFFF',\n    backgroundColor: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 2,\n    paddingRight: 2,\n    paddingTop: 2,\n    paddingBottom: 2,\n    borderRadius: 2\n  }\n}\n\n/**\n * 图表之间默认分割配置\n * @type {{size: number, color: string}}\n */\nconst defaultSeparator = {\n  size: 1,\n  color: '#DDDDDD',\n  fill: true,\n  activeBackgroundColor: 'rgba(33, 150, 243, 0.08)'\n}\n\nexport const defaultStyleOptions = {\n  grid: defaultGrid,\n  candle: defaultCandle,\n  technicalIndicator: defaultTechnicalIndicator,\n  xAxis: defaultXAxis,\n  yAxis: defaultYAxis,\n  separator: defaultSeparator,\n  crosshair: defaultCrosshair,\n  graphicMark: defaultGraphicMark,\n  annotation: defaultAnnotation,\n  tag: defaultTag\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNumber, isObject, isValid } from './typeChecks'\n\n/**\n * 格式化值\n * @param data\n * @param key\n * @param defaultValue\n * @returns {string|*}\n */\nexport function formatValue (data, key, defaultValue = '--') {\n  if (isObject(data)) {\n    const value = data[key]\n    if (isValid(value)) {\n      return value\n    }\n  }\n  return defaultValue\n}\n\n/**\n * 格式化时间\n * @param dateTimeFormat\n * @param timestamp\n * @param format\n * @returns {string}\n */\nexport function formatDate (dateTimeFormat, timestamp, format = 'MM-DD hh:mm') {\n  if (isNumber(timestamp)) {\n    const dateTimeString = dateTimeFormat.format(new Date(timestamp))\n    const dateTimeStringArray = dateTimeString.split(', ')\n    const dateStringArray = dateTimeStringArray[0].split('/')\n    const date = {\n      YYYY: dateStringArray[2],\n      MM: dateStringArray[0],\n      DD: dateStringArray[1],\n      'hh:mm': dateTimeStringArray[1].match(/^[\\d]{2}/)[0] === '24'\n        ? dateTimeStringArray[1].replace(/^[\\d]{2}/, '00')\n        : dateTimeStringArray[1]\n    }\n    return format.replace(/YYYY|MM|DD|(hh:mm)/g, key => date[key])\n  }\n  return '--'\n}\n\n/**\n * 格式化精度\n */\nexport function formatPrecision (value, precision = 2) {\n  const v = +value\n  if ((v || v === 0) && isNumber(v)) {\n    return v.toFixed(precision)\n  }\n  return `${v}`\n}\n\n/**\n * 格式化大数据\n * @param value\n */\nexport function formatBigNumber (value) {\n  if (isNumber(+value)) {\n    if (value > 1000000000) {\n      return `${+((value / 1000000000).toFixed(3))}B`\n    }\n    if (value > 1000000) {\n      return `${+((value / 1000000).toFixed(3))}M`\n    }\n    if (value > 1000) {\n      return `${+((value / 1000).toFixed(3))}K`\n    }\n    return value\n  }\n  return '--'\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 二分查找最接近的数\n * @param dataList\n * @param valueKey\n * @param targetNumber\n * @return {number}\n */\nexport function binarySearchNearest (dataList, valueKey, targetNumber) {\n  let left = 0\n  let right = 0\n  for (right = dataList.length - 1; left !== right;) {\n    const midIndex = Math.floor((right + left) / 2)\n    const mid = right - left\n    const midValue = dataList[midIndex][valueKey]\n    if (targetNumber === dataList[left][valueKey]) {\n      return left\n    }\n    if (targetNumber === dataList[right][valueKey]) {\n      return right\n    }\n    if (targetNumber === midValue) {\n      return midIndex\n    }\n\n    if (targetNumber > midValue) {\n      left = midIndex\n    } else {\n      right = midIndex\n    }\n\n    if (mid <= 2) {\n      break\n    }\n  }\n  return left\n}\n\n/**\n * 优化数字\n * @param value\n * @return {number|number}\n */\nexport function nice (value) {\n  const exponent = Math.floor(log10(value))\n  const exp10 = index10(exponent)\n  const f = value / exp10 // 1 <= f < 10\n  let nf = 0\n  if (f < 1.5) {\n    nf = 1\n  } else if (f < 2.5) {\n    nf = 2\n  } else if (f < 3.5) {\n    nf = 3\n  } else if (f < 4.5) {\n    nf = 4\n  } else if (f < 5.5) {\n    nf = 5\n  } else if (f < 6.5) {\n    nf = 6\n  } else {\n    nf = 8\n  }\n  value = nf * exp10\n  return exponent >= -20 ? +value.toFixed(exponent < 0 ? -exponent : 0) : value\n}\n\n/**\n * 四和五入\n * @param value\n * @param precision\n * @return {number}\n */\nexport function round (value, precision) {\n  if (precision == null) {\n    precision = 10\n  }\n  precision = Math.min(Math.max(0, precision), 20)\n  value = (+value).toFixed(precision)\n  return +value\n}\n\n/**\n * 获取小数位数\n * @param value\n * @return {number|number}\n */\nexport function getPrecision (value) {\n  const str = value.toString()\n  const eIndex = str.indexOf('e')\n  if (eIndex > 0) {\n    const precision = +str.slice(eIndex + 1)\n    return precision < 0 ? -precision : 0\n  } else {\n    const dotIndex = str.indexOf('.')\n    return dotIndex < 0 ? 0 : str.length - 1 - dotIndex\n  }\n}\n\n/**\n * 10为低的对数函数\n * @param value\n * @return {number}\n */\nexport function log10 (value) {\n  return Math.log(value) / Math.log(10)\n}\n\n/**\n * 10的指数函数\n * @param value\n * @return {number}\n */\nexport function index10 (value) {\n  return Math.pow(10, value)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEV = '__BUILD_ENV__' === 'development'\n\n/**\n * 打印警告日志\n * @param api\n * @param invalidParam\n * @param append\n */\nexport function logWarn (api, invalidParam, append = '') {\n  if (DEV) {\n    console.log(\n      '%c😑 klinecharts warning: \\n%s%s%s',\n      'color:#fcaf17;font-weight:bold',\n      api ? `Call api ${api}${invalidParam || append ? ', ' : '.'}` : '',\n      invalidParam ? `invalid parameter ${invalidParam}${append ? ', ' : '.'}` : '',\n      append ? `${append}` : ''\n    )\n  }\n}\n\n/**\n * 打印错误日志\n * @param api\n * @param invalidParam\n * @param append\n */\nexport function logError (api, invalidParam, append = '') {\n  if (DEV) {\n    console.log(\n      '%c😟 klinecharts error: \\n%s%s%s',\n      'color:#ed1941;font-weight:bold',\n      api ? `Call api ${api}${invalidParam || append ? ', ' : '.'},` : '',\n      invalidParam ? `invalid parameter ${invalidParam}${append ? ', ' : '.'}` : '',\n      append ? `${append}` : ''\n    )\n  }\n}\n\n/**\n * 打印标识\n */\nexport function logTag () {\n  if (DEV) {\n    console.log(\n      '%c❤️ Welcome to klinecharts. Version is __BUILD_VERSION__',\n      'border-radius:2px;border:dashed 1px #2196F3;padding:26px 20px;font-size:14px;color:#2196F3'\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clone, isArray, isBoolean, isNumber, merge, isObject } from '../../utils/typeChecks'\n\n/**\n * 技术指标系列\n * @type {{PRICE: string, VOLUME: string, NORMAL: string}}\n */\nexport const TechnicalIndicatorSeries = {\n  PRICE: 'price',\n  VOLUME: 'volume',\n  NORMAL: 'normal'\n}\n\n/**\n * 绘制类型\n * @type {{BAR: string, LINE: string, CIRCLE: string}}\n */\nexport const TechnicalIndicatorPlotType = {\n  LINE: 'line',\n  BAR: 'bar',\n  CIRCLE: 'circle'\n}\n\nexport default class TechnicalIndicator {\n  constructor ({\n    name, series, calcParams, plots, precision,\n    calcParamsAllowDecimal, shouldCheckParamCount,\n    shouldOhlc, shouldFormatBigNumber,\n    baseValue, minValue, maxValue, styles\n  }) {\n    // 指标名\n    this.name = name || ''\n    // 指标系列，值有 'price', 'volume', 'normal\n    this.series = series || 'normal'\n    // 精度\n    this.precision = isNumber(precision) && precision >= 0 ? precision : 4\n    // 计算参数\n    this.calcParams = isArray(calcParams) ? calcParams : []\n    // 数据信息\n    this.plots = isArray(plots) ? plots : []\n    // 计算参数是否允许小数\n    this.calcParamsAllowDecimal = isObject(calcParamsAllowDecimal) ? calcParamsAllowDecimal : {}\n    // 是否需要检查参数\n    this.shouldCheckParamCount = isBoolean(shouldCheckParamCount) ? shouldCheckParamCount : true\n    // 是否需要ohlc\n    this.shouldOhlc = shouldOhlc\n    // 是否需要格式化大数据值，从1000开始格式化，比如100000是否需要格式化100K\n    this.shouldFormatBigNumber = shouldFormatBigNumber\n    // 基础比对数据\n    this.baseValue = isNumber(baseValue) ? baseValue : null\n    // 指定的最小值\n    this.minValue = minValue\n    // 指定的最大值\n    this.maxValue = maxValue\n    // 样式\n    this.styles = styles\n  }\n\n  setPrecision (precision) {\n    if (isNumber(precision) && precision >= 0) {\n      this.precision = parseInt(precision, 10)\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 设置计算参数是否允许小数\n   * @param calcParamsAllowDecimal\n   */\n  setCalcParamsAllowDecimal (calcParamsAllowDecimal) {\n    if (isObject(calcParamsAllowDecimal)) {\n      this.calcParamsAllowDecimal = calcParamsAllowDecimal\n    }\n  }\n\n  setCalcParams (params) {\n    if (!isArray(params)) {\n      return false\n    }\n    if (this.shouldCheckParamCount && params.length !== this.calcParams.length) {\n      return false\n    }\n    for (let i = 0; i < params.length; i++) {\n      const v = params[i]\n      if (!isNumber(v) || v <= 0 || (!this.calcParamsAllowDecimal[i] && parseInt(v, 10) !== v)) {\n        return false\n      }\n    }\n    this.calcParams = clone(params)\n    const plots = this.regeneratePlots(params)\n    if (plots && isArray(plots)) {\n      this.plots = plots\n    }\n    return true\n  }\n\n  setStyles (styles, defaultStyles) {\n    if (!isObject(styles)) {\n      return false\n    }\n    if (!this.styles) {\n      this.styles = {\n        bar: clone(defaultStyles.bar),\n        line: clone(defaultStyles.line),\n        circle: clone(defaultStyles.circle)\n      }\n    }\n    merge(this.styles, styles)\n    return true\n  }\n\n  /**\n   * 计算技术指标\n   */\n  calcTechnicalIndicator (dataList, calcParams) {}\n\n  /**\n   * 重新生成各项数据\n   * @private\n   */\n  regeneratePlots (params) {}\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicator from './TechnicalIndicator'\n\nimport extension from '../../data/extension'\n\nimport { isFunction, isValid } from '../../utils/typeChecks'\nimport { formatBigNumber, formatPrecision } from '../../utils/format'\nimport { logWarn } from '../../utils/logger'\n\n/**\n * 创建技术指标映射\n * @return {{}}\n */\nexport function createTechnicalIndicatorMapping () {\n  const mapping = {}\n  const technicalIndicatorExtensions = extension.technicalIndicatorExtensions\n  for (const name in technicalIndicatorExtensions) {\n    const technicalIndicatorInstance = createTechnicalIndicatorInstance(technicalIndicatorExtensions[name])\n    if (technicalIndicatorInstance) {\n      mapping[name] = technicalIndicatorInstance\n    }\n  }\n  return mapping\n}\n\n/**\n * 创建一个新的技术指标\n * @param name\n * @param series\n * @param calcParams\n * @param plots\n * @param precision\n * @param calcParamsAllowDecimal\n * @param shouldCheckParamCount\n * @param shouldOhlc\n * @param shouldFormatBigNumber\n * @param baseValue\n * @param minValue\n * @param maxValue\n * @param styles\n * @param calcTechnicalIndicator\n * @param regeneratePlots\n * @param render\n * @returns {TechnicalIndicatorClass|null}\n */\nexport function createTechnicalIndicatorInstance ({\n  name, series, calcParams, plots, precision,\n  calcParamsAllowDecimal, shouldCheckParamCount,\n  shouldOhlc, shouldFormatBigNumber, baseValue, minValue, maxValue, styles,\n  calcTechnicalIndicator, regeneratePlots, render\n}) {\n  if (!name || !isFunction(calcTechnicalIndicator)) {\n    logWarn('', '', 'The required attribute \"name\" and method \"calcTechnicalIndicator\" are missing, and new technical indicator cannot be generated!!!')\n    return null\n  }\n  class TechnicalIndicatorClass extends TechnicalIndicator {\n    constructor () {\n      super(\n        {\n          name,\n          series,\n          calcParams,\n          plots,\n          precision,\n          calcParamsAllowDecimal,\n          shouldCheckParamCount,\n          shouldOhlc,\n          shouldFormatBigNumber,\n          baseValue,\n          minValue,\n          maxValue,\n          styles\n        }\n      )\n    }\n  }\n  TechnicalIndicatorClass.prototype.calcTechnicalIndicator = calcTechnicalIndicator\n  if (regeneratePlots && isFunction(regeneratePlots)) {\n    TechnicalIndicatorClass.prototype.regeneratePlots = regeneratePlots\n  }\n  if (render && isFunction(render)) {\n    TechnicalIndicatorClass.prototype.render = render\n  }\n  return new TechnicalIndicatorClass()\n}\n\n/**\n * 获取技术指标信息\n * @param technicalIndicator\n * @return {{series, calcParams, precision, name, styles}}\n */\nexport function createTechnicalIndicatorInfo (technicalIndicator) {\n  return {\n    name: technicalIndicator.name,\n    series: technicalIndicator.series,\n    calcParams: technicalIndicator.calcParams,\n    calcParamsAllowDecimal: technicalIndicator.calcParamsAllowDecimal,\n    shouldCheckParamCount: technicalIndicator.shouldCheckParamCount,\n    shouldOhlc: technicalIndicator.shouldOhlc,\n    shouldFormatBigNumber: technicalIndicator.shouldFormatBigNumber,\n    precision: technicalIndicator.precision,\n    styles: technicalIndicator.styles,\n    result: technicalIndicator.result || []\n  }\n}\n\n/**\n * 获取技术指标提示数据\n * @param technicalIndicatorData\n * @param technicalIndicator\n * @return {{calcParamText: string, values: [], name: string}}\n */\nexport function getTechnicalIndicatorTooltipData (technicalIndicatorData = {}, technicalIndicator) {\n  const calcParams = technicalIndicator.calcParams\n  const plots = technicalIndicator.plots\n  const precision = technicalIndicator.precision\n  const shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n\n  const values = []\n  let name = ''\n  let calcParamText = ''\n  if (plots.length > 0) {\n    name = technicalIndicator.name\n  }\n  if (calcParams.length > 0) {\n    calcParamText = `(${calcParams.join(',')})`\n  }\n  plots.forEach(plot => {\n    const data = {}\n    if (isValid(plot.title)) {\n      let value = technicalIndicatorData[plot.key]\n      if (isValid(value)) {\n        value = formatPrecision(value, precision)\n        if (shouldFormatBigNumber) {\n          value = formatBigNumber(value)\n        }\n      }\n      data.title = plot.title\n      data.value = value\n    }\n    values.push(data)\n  })\n  return { values, name, calcParamText }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isObject, clone, merge } from '../../utils/typeChecks'\n\n/**\n * 覆盖物\n */\nexport default class Overlay {\n  constructor ({\n    id, chartData, xAxis, yAxis\n  }) {\n    this._id = id\n    this._chartData = chartData\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._styles = null\n  }\n\n  /**\n   * 绘制\n   * @param ctx\n   */\n  draw (ctx) {}\n\n  /**\n   * 设置样式\n   * @param styles\n   * @param defaultStyles\n   */\n  setStyles (styles, defaultStyles) {\n    if (!isObject(styles)) {\n      return false\n    }\n    if (!this._styles) {\n      this._styles = clone(defaultStyles)\n    }\n    merge(this._styles, styles)\n    return true\n  }\n\n  /**\n   * 获取id\n   * @return {*}\n   */\n  id () {\n    return this._id\n  }\n\n  /**\n   * 获取样式\n   * @return {null}\n   */\n  styles () {\n    return this._styles\n  }\n\n  /**\n   * 检查鼠标点是否在图形上\n   * @param point\n   */\n  checkMousePointOnGraphic (point) {}\n\n  // -------------------- 事件开始 -------------------\n\n  /**\n   * 点击事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onClick ({ id, points, event }) {}\n\n  /**\n   * 右击事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onRightClick ({ id, points, event }) {}\n\n  /**\n   * 鼠标进入事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onMouseEnter ({ id, points, event }) {}\n\n  /**\n   * 鼠标离开事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onMouseLeave ({ id, points, event }) {}\n\n  // -------------------- 事件结束 -------------------\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制边框圆\n * @param ctx\n * @param borderColor\n * @param borderSize\n * @param circlePoint\n * @param radius\n */\nexport function renderStrokeCircle (ctx, borderColor, borderSize, circlePoint, radius) {\n  ctx.lineWidth = borderSize\n  ctx.strokeStyle = borderColor\n  ctx.beginPath()\n  ctx.arc(circlePoint.x, circlePoint.y, radius, 0, Math.PI * 2)\n  ctx.closePath()\n  ctx.stroke()\n}\n\n/**\n * 绘制实心圆\n * @param ctx\n * @param fillColor\n * @param circlePoint\n * @param radius\n */\nexport function renderFillCircle (ctx, fillColor, circlePoint, radius) {\n  ctx.fillStyle = fillColor\n  ctx.beginPath()\n  ctx.arc(circlePoint.x, circlePoint.y, radius, 0, Math.PI * 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEVIATION = 2\n\n/**\n * 获取两点之间的距离\n * @param point1\n * @param point2\n * @return {number}\n */\nexport function getDistance (point1, point2) {\n  const xDif = point1.x - point2.x\n  const yDif = point1.y - point2.y\n  return Math.sqrt(xDif * xDif + yDif * yDif)\n}\n\n/**\n * 根据三角形三个点获取三角形面积\n * @param point1\n * @param point2\n * @param point3\n * @return {number}\n */\nexport function getTriangleSquare (point1, point2, point3) {\n  const x1 = Math.abs(point2.x - point1.x)\n  const y1 = Math.abs(point2.y - point1.y)\n  const x2 = Math.abs(point3.x - point1.x)\n  const y2 = Math.abs(point3.y - point1.y)\n  return Math.abs(x1 * y2 - x2 * y1) / 2\n}\n\n/**\n * 获取一点绕另一点旋转一定角度后新的点坐标\n * @param point 旋转点\n * @param targetPoint 参照点\n * @param angle 角度\n * @return {{x: *, y: *}}\n */\nexport function getRotatePoint (point, targetPoint, angle) {\n  const x = (point.x - targetPoint.x) * Math.cos(angle) - (point.y - targetPoint.y) * Math.sin(angle) + targetPoint.x\n  const y = (point.x - targetPoint.x) * Math.sin(angle) + (point.y - targetPoint.y) * Math.cos(angle) + targetPoint.y\n  return { x, y }\n}\n\n/**\n * 获取一次函数斜率和截距，即 y = kx + b 中的k值和b值\n * @param point1\n * @param point2\n */\nexport function getLinearSlopeIntercept (point1, point2) {\n  const difX = (point1.x - point2.x)\n  if (difX !== 0) {\n    const k = (point1.y - point2.y) / difX\n    const b = point1.y - k * point1.x\n    return { k, b }\n  }\n}\n\n/**\n * 获取点在两点决定的一次函数上的y值\n * @param point1\n * @param point2\n * @param targetPoint\n */\nexport function getLinearYFromPoints (point1, point2, targetPoint) {\n  const kb = getLinearSlopeIntercept(point1, point2)\n  return getLinearYFromSlopeIntercept(kb, targetPoint)\n}\n\n/**\n * 获取点在斜率和截距确定的线上的y值\n * @param kb\n * @param targetPoint\n */\nexport function getLinearYFromSlopeIntercept (kb, targetPoint) {\n  if (kb) {\n    return targetPoint.x * kb.k + kb.b\n  }\n  return targetPoint.y\n}\n\n/**\n * 点是否在线上\n * @param point1\n * @param point2\n * @param targetPoint\n */\nexport function checkPointOnStraightLine (point1, point2, targetPoint) {\n  if (!targetPoint || !point1 || !point2) {\n    return false\n  }\n  if (point1.x === point2.x) {\n    return Math.abs(targetPoint.x - point1.x) < DEVIATION\n  }\n  const kb = getLinearSlopeIntercept(point1, point2)\n  const y = getLinearYFromSlopeIntercept(kb, targetPoint)\n  const yDif = Math.abs(y - targetPoint.y)\n  return yDif * yDif / (kb.k * kb.k + 1) < DEVIATION * DEVIATION\n}\n\n/**\n * 点是否在线段上\n * @param point1\n * @param point2\n * @param targetPoint\n * @returns {boolean}\n */\nexport function checkPointOnRayLine (point1, point2, targetPoint) {\n  if (checkPointOnStraightLine(point1, point2, targetPoint)) {\n    if (point1.x === point2.x) {\n      if (point1.y < point2.y) {\n        return point1.y - targetPoint.y < DEVIATION\n      } else {\n        return targetPoint.y - point1.y < DEVIATION\n      }\n    }\n    if (point1.x < point2.x) {\n      return point1.x - targetPoint.x < DEVIATION\n    } else {\n      return targetPoint.x - point1.x < DEVIATION\n    }\n  }\n  return false\n}\n\n/**\n * 判断点是否在线段上面\n * @param point1\n * @param point2\n * @param targetPoint\n */\nexport function checkPointOnSegment (point1, point2, targetPoint) {\n  if (checkPointOnStraightLine(point1, point2, targetPoint)) {\n    if (point1.x === point2.x) {\n      return Math.abs(point1.y - targetPoint.y) + Math.abs(point2.y - targetPoint.y) - Math.abs(point1.y - point2.y) < DEVIATION * 2\n    }\n    return Math.abs(point1.x - targetPoint.x) + Math.abs(point2.x - targetPoint.x) - Math.abs(point1.x - point2.x) < DEVIATION * 2\n  }\n  return false\n}\n\n/**\n * 点是否在圆内\n * @param circleCenterPoint\n * @param radius\n * @param targetPoint\n * @returns {boolean}\n */\nexport function checkPointInCircle (circleCenterPoint, radius, targetPoint) {\n  if (!targetPoint) {\n    return false\n  }\n  const difX = targetPoint.x - circleCenterPoint.x\n  const difY = targetPoint.y - circleCenterPoint.y\n  return !(difX * difX + difY * difY > radius * radius)\n}\n\n/**\n * 点是否在圆上\n * @param circleCenterPoint\n * @param radius\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointOnCircle (circleCenterPoint, radius, targetPoint) {\n  if (!targetPoint) {\n    return false\n  }\n  return Math.abs(getDistance(targetPoint, circleCenterPoint) - radius) < DEVIATION\n}\n\n/**\n * 检查点是否在圆弧上\n * @param circleCenterPoint\n * @param radius\n * @param startAngle\n * @param endAngle\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointOnArc (circleCenterPoint, radius, startAngle, endAngle, targetPoint) {\n  if (checkPointOnCircle(circleCenterPoint, radius, targetPoint)) {\n    const startPointX = radius * Math.cos(startAngle) + circleCenterPoint.x\n    const startPointY = radius * Math.sin(startAngle) + circleCenterPoint.y\n    const endPointX = radius * Math.cos(endAngle) + circleCenterPoint.x\n    const endPointY = radius * Math.sin(endAngle) + circleCenterPoint.y\n    return (\n      targetPoint.x <= Math.max(startPointX, endPointX) + DEVIATION &&\n      targetPoint.x >= Math.min(startPointX, endPointX) - DEVIATION &&\n      targetPoint.y <= Math.max(startPointY, endPointY) + DEVIATION &&\n      targetPoint.y >= Math.min(startPointY, endPointY) - DEVIATION\n    )\n  }\n}\n\n/**\n * 检查点是否在三角形内部\n * @param trianglePoints\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointInTriangle (trianglePoints, targetPoint) {\n  const square = getTriangleSquare(trianglePoints[0], trianglePoints[1], trianglePoints[2])\n  const compareSquare =\n    getTriangleSquare(trianglePoints[0], trianglePoints[1], targetPoint) +\n    getTriangleSquare(trianglePoints[0], trianglePoints[2], targetPoint) +\n    getTriangleSquare(trianglePoints[1], trianglePoints[2], targetPoint)\n  return Math.abs(square - compareSquare) < DEVIATION\n}\n\n/**\n * 检查点是否在三角形菱形内部\n * @param centerPoint\n * @param width\n * @param height\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointInDiamond (centerPoint, width, height, targetPoint) {\n  const xDis = Math.abs(centerPoint.x - targetPoint.x)\n  const yDis = Math.abs(centerPoint.y - targetPoint.y)\n  return xDis * height + yDis * width < width * height / 2 + DEVIATION\n}\n\n/**\n * 检查点是否在矩形内部\n * @param point1\n * @param point2\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointInRect (point1, point2, targetPoint) {\n  return targetPoint.x >= point1.x && targetPoint.x <= point2.x && targetPoint.y >= point1.y && targetPoint.y <= point2.y\n}\n\n/**\n * 根据两点获取一条射线\n * @param point1\n * @param point2\n * @param xyMax\n * @return {(*|{x: *, y: *})[]|*[]}\n */\nexport function getRayLine (point1, point2, xyMax) {\n  if (point1 && point2) {\n    let point\n    if (point1.x === point2.x && point1.y !== point2.y) {\n      if (point1.y < point2.y) {\n        point = {\n          x: point1.x,\n          y: xyMax.y\n        }\n      } else {\n        point = {\n          x: point1.x,\n          y: 0\n        }\n      }\n    } else if (point1.x > point2.x) {\n      point = {\n        x: 0,\n        y: getLinearYFromPoints(point1, point2, { x: 0, y: point1.y })\n      }\n    } else {\n      point = {\n        x: xyMax.x,\n        y: getLinearYFromPoints(point1, point2, { x: xyMax.x, y: point1.y })\n      }\n    }\n    return [point1, point]\n  }\n  return []\n}\n\n/**\n * 获取平行线\n * @param points\n * @param xyMax\n * @param extendParallelLineCount\n * @returns {Array}\n */\nexport function getParallelLines (points, xyMax, extendParallelLineCount = 0) {\n  const lines = []\n  if (points.length > 1) {\n    if (points[0].x === points[1].x) {\n      const startY = 0\n      const endY = xyMax.y\n      lines.push([{ x: points[0].x, y: startY }, { x: points[0].x, y: endY }])\n      if (points.length > 2) {\n        lines.push([{ x: points[2].x, y: startY }, { x: points[2].x, y: endY }])\n        const distance = points[0].x - points[2].x\n        for (let i = 0; i < extendParallelLineCount; i++) {\n          const d = distance * (i + 1)\n          lines.push([{ x: points[0].x + d, y: startY }, { x: points[0].x + d, y: endY }])\n        }\n      }\n    } else {\n      const startX = 0\n      const endX = xyMax.x\n      const kb = getLinearSlopeIntercept(points[0], points[1])\n      const k = kb.k\n      const b = kb.b\n      lines.push([{ x: startX, y: startX * k + b }, { x: endX, y: endX * k + b }])\n      if (points.length > 2) {\n        const b1 = points[2].y - k * points[2].x\n        lines.push([{ x: startX, y: startX * k + b1 }, { x: endX, y: endX * k + b1 }])\n        const distance = b - b1\n        for (let i = 0; i < extendParallelLineCount; i++) {\n          const b2 = b + distance * (i + 1)\n          lines.push([{ x: startX, y: startX * k + b2 }, { x: endX, y: endX * k + b2 }])\n        }\n      }\n    }\n  }\n  return lines\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制水平直线\n * @param ctx\n * @param y\n * @param left\n * @param right\n */\nexport function renderHorizontalLine (ctx, y, left, right) {\n  ctx.beginPath()\n  const correction = (ctx.lineWidth % 2) ? 0.5 : 0\n  ctx.moveTo(left, y + correction)\n  ctx.lineTo(right, y + correction)\n  ctx.stroke()\n  ctx.closePath()\n}\n\n/**\n * 绘制垂直直线\n * @param ctx\n * @param x\n * @param top\n * @param bottom\n */\nexport function renderVerticalLine (ctx, x, top, bottom) {\n  ctx.beginPath()\n  const correction = (ctx.lineWidth % 2) ? 0.5 : 0\n  ctx.moveTo(x + correction, top)\n  ctx.lineTo(x + correction, bottom)\n  ctx.stroke()\n  ctx.closePath()\n}\n\n/**\n * 绘制线\n * @param ctx\n * @param renderFuc\n */\nexport function renderLine (ctx, renderFuc) {\n  ctx.save()\n  if (ctx.lineWidth % 2) {\n    ctx.translate(0.5, 0.5)\n  }\n  renderFuc()\n  ctx.restore()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from '../Overlay'\n\nimport { renderFillCircle } from '../../../renderer/circle'\nimport { checkPointInCircle } from '../../../extension/mark/graphicHelper'\nimport { renderHorizontalLine, renderLine, renderVerticalLine } from '../../../renderer/line'\nimport { isValid, isArray, clone } from '../../../utils/typeChecks'\n\n// 标记图形绘制步骤开始\nconst GRAPHIC_MARK_DRAW_STEP_START = 1\n\n// 标记图形绘制步骤结束\nconst GRAPHIC_MARK_DRAW_STEP_FINISHED = -1\n\n/**\n * 图形标记鼠标操作元素类型\n * @type {{OTHER: string, POINT: string, NONE: string}}\n */\nexport const GraphicMarkMouseOperateElement = {\n  OTHER: 'other',\n  POINT: 'point',\n  NONE: 'none'\n}\n\n/**\n * 绘制类型\n * @type {{ARC: string, POLYGON: string, LINE: string, CONTINUOUS_LINE: string, TEXT: string}}\n */\nconst GraphicMarkDrawType = {\n  LINE: 'line',\n  TEXT: 'text',\n  CONTINUOUS_LINE: 'continuous_line',\n  POLYGON: 'polygon',\n  ARC: 'arc'\n}\n\n/**\n * 绘制风格\n * @type {{STROKE: string, FILL: string, SOLID: string, DASH: string}}\n */\nconst GraphicMarkDrawStyle = {\n  STROKE: 'stroke',\n  FILL: 'fill',\n  SOLID: 'solid',\n  DASH: 'dash'\n}\n\n/**\n * 线类型\n * @type {{VERTICAL: number, COMMON: number, HORIZONTAL: number}}\n */\nconst LineType = {\n  COMMON: 0,\n  HORIZONTAL: 1,\n  VERTICAL: 2\n}\n\n/**\n * 获取绘制线类型\n * @param point1\n * @param point2\n * @private\n */\nfunction getLineType (point1, point2) {\n  if (point1.x === point2.x) {\n    return LineType.VERTICAL\n  }\n  if (point1.y === point2.y) {\n    return LineType.HORIZONTAL\n  }\n  return LineType.COMMON\n}\n\n/**\n * 标记图形\n */\nexport default class GraphicMark extends Overlay {\n  constructor ({\n    id, name, totalStep,\n    chartData, xAxis, yAxis,\n    points, styles, lock\n  }) {\n    super({ id, chartData, xAxis, yAxis })\n    this._name = name\n    this._totalStep = totalStep\n    this._lock = lock\n    this._drawStep = GRAPHIC_MARK_DRAW_STEP_START\n    this._points = []\n    this.setPoints(points)\n    this.setStyles(styles, chartData.styleOptions().graphicMark)\n  }\n\n  /**\n   * 加载点\n   * @param points\n   */\n  setPoints (points) {\n    if (isArray(points) && points.length > 0) {\n      let repeatTotalStep\n      if (points.length >= this._totalStep - 1) {\n        this._drawStep = GRAPHIC_MARK_DRAW_STEP_FINISHED\n        this._points = points.slice(0, this._totalStep - 1)\n        repeatTotalStep = this._totalStep - 1\n      } else {\n        this._drawStep = points.length + 1\n        this._points = clone(points)\n        repeatTotalStep = points.length\n      }\n      // 重新演练绘制一遍，防止因为点不对而绘制出错误的图形\n      for (let i = 0; i < repeatTotalStep; i++) {\n        this.performMouseMoveForDrawing(i + 2, this.points, this._points[i], this._xAxis, this._yAxis)\n      }\n      if (this._drawStep === GRAPHIC_MARK_DRAW_STEP_FINISHED) {\n        this.performMousePressedMove(this._points, this._points.length - 1, this._points[this._points.length - 1], this._xAxis, this._yAxis)\n      }\n    }\n  }\n\n  /**\n   * 时间戳转换成x轴上点的位置\n   * @param point\n   * @return {*|number}\n   * @private\n   */\n  _timestampOrDataIndexToPointX ({ timestamp, dataIndex }) {\n    return timestamp\n      ? this._xAxis.convertToPixel(this._chartData.timestampToDataIndex(timestamp))\n      : this._xAxis.convertToPixel(dataIndex)\n  }\n\n  /**\n   * 绘制线\n   * @param ctx\n   * @param lines\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawLines (ctx, lines, style, markOptions) {\n    ctx.save()\n    ctx.strokeStyle = markOptions.line.color\n    ctx.lineWidth = markOptions.line.size\n    if (style === GraphicMarkDrawStyle.DASH) {\n      ctx.setLineDash(markOptions.line.dashValue)\n    }\n    lines.forEach(points => {\n      if (points.length > 1) {\n        const lineType = getLineType(points[0], points[1])\n        switch (lineType) {\n          case LineType.COMMON: {\n            renderLine(ctx, () => {\n              ctx.beginPath()\n              ctx.moveTo(points[0].x, points[0].y)\n              ctx.lineTo(points[1].x, points[1].y)\n              ctx.stroke()\n              ctx.closePath()\n            })\n            break\n          }\n          case LineType.HORIZONTAL: {\n            renderHorizontalLine(ctx, points[0].y, points[0].x, points[1].x)\n            break\n          }\n          case LineType.VERTICAL: {\n            renderVerticalLine(ctx, points[0].x, points[0].y, points[1].y)\n            break\n          }\n          default: { break }\n        }\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制连续线\n   * @param ctx\n   * @param continuousLines\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawContinuousLines (ctx, continuousLines, style, markOptions) {\n    ctx.save()\n    ctx.strokeStyle = markOptions.line.color\n    ctx.lineWidth = markOptions.line.size\n    if (style === GraphicMarkDrawStyle.DASH) {\n      ctx.setLineDash(markOptions.line.dashValue)\n    }\n    continuousLines.forEach(points => {\n      if (points.length > 0) {\n        renderLine(ctx, () => {\n          ctx.beginPath()\n          ctx.moveTo(points[0].x, points[0].y)\n          for (let i = 1; i < points.length; i++) {\n            ctx.lineTo(points[i].x, points[i].y)\n          }\n          ctx.stroke()\n          ctx.closePath()\n        })\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制多边形\n   * @param ctx\n   * @param polygons\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawPolygons (ctx, polygons, style, markOptions) {\n    ctx.save()\n    let fillStroke\n    if (style === GraphicMarkDrawStyle.FILL) {\n      ctx.fillStyle = markOptions.polygon.fill.color\n      fillStroke = ctx.fill\n    } else {\n      ctx.lineWidth = markOptions.polygon.stroke.size\n      ctx.strokeStyle = markOptions.polygon.stroke.color\n      fillStroke = ctx.stroke\n    }\n    polygons.forEach(points => {\n      if (points.length > 0) {\n        renderLine(ctx, () => {\n          ctx.beginPath()\n          ctx.moveTo(points[0].x, points[0].y)\n          for (let i = 1; i < points.length; i++) {\n            ctx.lineTo(points[i].x, points[i].y)\n          }\n          ctx.closePath()\n          fillStroke.call(ctx)\n        })\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 画圆弧\n   * @param ctx\n   * @param arcs\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawArcs (ctx, arcs, style, markOptions) {\n    ctx.save()\n    if (style === GraphicMarkDrawStyle.FILL) {\n      ctx.fillStyle = markOptions.arc.fill.color\n    } else {\n      ctx.lineWidth = markOptions.arc.stroke.size\n      ctx.strokeStyle = markOptions.arc.stroke.color\n    }\n    arcs.forEach(({ x, y, radius, startAngle, endAngle }) => {\n      ctx.beginPath()\n      ctx.arc(x, y, radius, startAngle, endAngle)\n      if (style === GraphicMarkDrawStyle.FILL) {\n        ctx.closePath()\n        ctx.fill()\n      } else {\n        ctx.stroke()\n        ctx.closePath()\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制文字\n   * @param ctx\n   * @param texts\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawText (ctx, texts, style, markOptions) {\n    ctx.save()\n    let fillStroke\n    if (style === GraphicMarkDrawStyle.STROKE) {\n      ctx.strokeStyle = markOptions.text.color\n      fillStroke = ctx.strokeText\n    } else {\n      ctx.fillStyle = markOptions.text.color\n      fillStroke = ctx.fillText\n    }\n    ctx.font = `${markOptions.text.weight} ${markOptions.text.size}px ${markOptions.text.family}`\n    texts.forEach(({ x, y, text }) => {\n      fillStroke.call(ctx, text, x + markOptions.text.marginLeft, y - markOptions.text.marginBottom)\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制\n   * @param ctx\n   */\n  draw (ctx) {\n    const coordinates = this._points.map(({ timestamp, price, dataIndex }) => {\n      return {\n        x: this._timestampOrDataIndexToPointX({ timestamp, dataIndex }),\n        y: this._yAxis.convertToPixel(price)\n      }\n    })\n    const markOptions = this._styles || this._chartData.styleOptions().graphicMark\n    if (this._drawStep !== GRAPHIC_MARK_DRAW_STEP_START && coordinates.length > 0) {\n      const viewport = { width: this._xAxis.width(), height: this._yAxis.height() }\n      const precision = { price: this._chartData.pricePrecision(), volume: this._chartData.volumePrecision() }\n      const graphicDataSources = this.createGraphicDataSource(\n        this._drawStep, this._points, coordinates, viewport,\n        precision, this._xAxis, this._yAxis\n      ) || []\n      graphicDataSources.forEach(({ type, isDraw, style, dataSource = [] }) => {\n        if (!isValid(isDraw) || isDraw) {\n          switch (type) {\n            case GraphicMarkDrawType.LINE: {\n              this._drawLines(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.CONTINUOUS_LINE: {\n              this._drawContinuousLines(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.POLYGON: {\n              this._drawPolygons(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.ARC: {\n              this._drawArcs(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.TEXT: {\n              this._drawText(ctx, dataSource, style, markOptions)\n              break\n            }\n            default: { break }\n          }\n        }\n      })\n      if (this.drawExtend) {\n        ctx.save()\n        this.drawExtend(\n          ctx, graphicDataSources, markOptions,\n          viewport, precision, this._xAxis, this._yAxis\n        )\n        ctx.restore()\n      }\n    }\n    const graphicMarkMouseOperate = this._chartData.graphicMarkMouseOperate()\n    if (\n      (graphicMarkMouseOperate.hover.id === this._id && graphicMarkMouseOperate.hover.element !== GraphicMarkMouseOperateElement.NONE) ||\n      (graphicMarkMouseOperate.click.id === this._id && graphicMarkMouseOperate.click.element !== GraphicMarkMouseOperateElement.NONE)\n    ) {\n      coordinates.forEach(({ x, y }, index) => {\n        let radius = markOptions.point.radius\n        let color = markOptions.point.backgroundColor\n        let borderColor = markOptions.point.borderColor\n        let borderSize = markOptions.point.borderSize\n        if (\n          graphicMarkMouseOperate.hover.id === this._id &&\n          graphicMarkMouseOperate.hover.element === GraphicMarkMouseOperateElement.POINT &&\n          index === graphicMarkMouseOperate.hover.elementIndex\n        ) {\n          radius = markOptions.point.activeRadius\n          color = markOptions.point.activeBackgroundColor\n          borderColor = markOptions.point.activeBorderColor\n          borderSize = markOptions.point.activeBorderSize\n        }\n        renderFillCircle(ctx, borderColor, { x, y }, radius + borderSize)\n        renderFillCircle(ctx, color, { x, y }, radius)\n      })\n    }\n  }\n\n  /**\n   * 设置是否锁定\n   * @param lock\n   */\n  setLock (lock) {\n    this._lock = lock\n  }\n\n  /**\n   * 获取名字\n   * @return {*}\n   */\n  name () {\n    return this._name\n  }\n\n  /**\n   * 是否锁定\n   * @return {*}\n   */\n  lock () {\n    return this._lock\n  }\n\n  /**\n   * 总步骤数\n   * @return {*}\n   */\n  totalStep () {\n    return this._totalStep\n  }\n\n  /**\n   * 获取点\n   * @return {[]}\n   */\n  points () {\n    return this._points\n  }\n\n  /**\n   * 是否在绘制中\n   * @return {boolean}\n   */\n  isDrawing () {\n    return this._drawStep !== GRAPHIC_MARK_DRAW_STEP_FINISHED\n  }\n\n  /**\n   * 检查鼠标点是否在图形上\n   * @param mouseCoordinate\n   * @return {{id: *, elementIndex: number, element: string}}\n   */\n  checkMousePointOnGraphic (mouseCoordinate) {\n    const markOptions = this._styles || this._chartData.styleOptions().graphicMark\n    const coordinates = []\n    // 检查鼠标点是否在图形的点上\n    for (let i = 0; i < this._points.length; i++) {\n      const { timestamp, price, dataIndex } = this._points[i]\n      const coordinate = {\n        x: this._timestampOrDataIndexToPointX({ timestamp, dataIndex }),\n        y: this._yAxis.convertToPixel(price)\n      }\n      coordinates.push(coordinate)\n      if (checkPointInCircle(coordinate, markOptions.point.radius, mouseCoordinate)) {\n        return {\n          id: this._id,\n          element: GraphicMarkMouseOperateElement.POINT,\n          elementIndex: i,\n          instance: this\n        }\n      }\n    }\n    // 检查鼠标点是否在点构成的其它图形上\n    const graphicDataSources = this.createGraphicDataSource(\n      this._drawStep,\n      this._points,\n      coordinates,\n      {\n        width: this._xAxis.width(),\n        height: this._yAxis.height()\n      },\n      {\n        price: this._chartData.pricePrecision(),\n        volume: this._chartData.volumePrecision()\n      },\n      this._xAxis,\n      this._yAxis\n    ) || []\n    for (const { key, type, isCheck, dataSource = [] } of graphicDataSources) {\n      if (isCheck) {\n        for (let i = 0; i < dataSource.length; i++) {\n          const sources = dataSource[i]\n          if (this.checkMousePointOn(key, type, sources, mouseCoordinate)) {\n            return {\n              id: this._id,\n              element: GraphicMarkMouseOperateElement.OTHER,\n              elementIndex: i,\n              instance: this\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * 绘制过程中鼠标移动事件\n   * @param point\n   */\n  mouseMoveForDrawing (point) {\n    const dataIndex = this._xAxis.convertFromPixel(point.x)\n    const timestamp = this._chartData.dataIndexToTimestamp(dataIndex)\n    const price = this._yAxis.convertFromPixel(point.y)\n    this._points[this._drawStep - 1] = { timestamp, price, dataIndex }\n    this.performMouseMoveForDrawing(this._drawStep, this._points, { timestamp, price, dataIndex }, this._xAxis, this._yAxis)\n    this.onDrawing({ id: this._id, step: this._drawStep, points: this._points })\n  }\n\n  /**\n   * 鼠标左边按钮点击事件\n   */\n  mouseLeftButtonDownForDrawing () {\n    if (this._drawStep === this._totalStep - 1) {\n      this._drawStep = GRAPHIC_MARK_DRAW_STEP_FINISHED\n      this.onDrawEnd({ id: this._id, points: this._points })\n    } else {\n      this._drawStep++\n    }\n  }\n\n  /**\n   * 鼠标按住移动方法\n   * @param point\n   * @param event\n   */\n  mousePressedMove (point, event) {\n    const graphicMarkMouseOperate = this._chartData.graphicMarkMouseOperate()\n    const elementIndex = graphicMarkMouseOperate.click.elementIndex\n    if (\n      !this._lock &&\n      graphicMarkMouseOperate.click.id === this._id &&\n      graphicMarkMouseOperate.click.element === GraphicMarkMouseOperateElement.POINT &&\n      elementIndex !== -1\n    ) {\n      const dataIndex = this._xAxis.convertFromPixel(point.x)\n      const timestamp = this._chartData.dataIndexToTimestamp(dataIndex)\n      const price = this._yAxis.convertFromPixel(point.y)\n      this._points[elementIndex].timestamp = timestamp\n      this._points[elementIndex].dataIndex = dataIndex\n      this._points[elementIndex].price = price\n      this.performMousePressedMove(this._points, elementIndex, { dataIndex, timestamp, price }, this._xAxis, this._yAxis)\n      this.onPressedMove({\n        id: graphicMarkMouseOperate.click.id,\n        points: this._points,\n        event\n      })\n    }\n  }\n\n  // -------------------- 事件开始 -------------------\n\n  /**\n   * 开始绘制事件回调\n   * @param id\n   */\n  onDrawStart ({ id }) {}\n\n  /**\n   * 绘制过程中事件回调\n   * @param id\n   * @param step\n   * @param points\n   */\n  onDrawing ({ id, step, points }) {}\n\n  /**\n   * 绘制结束事件回调\n   * @param id\n   * @param points\n   */\n  onDrawEnd ({ id, points }) {}\n\n  /**\n   * 按住移动事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onPressedMove ({ id, points, event }) {}\n\n  /**\n   * 移除事件回调\n   * @param id\n   */\n  onRemove ({ id }) {}\n\n  // -------------------- 事件结束 -------------------\n\n  // --------------------- 自定义时需要实现的一些方法开始 ----------------------\n\n  /**\n   * 检查鼠标点在其它图形上\n   * @param key\n   * @param type\n   * @param points\n   * @param mousePoint\n   */\n  checkMousePointOn (key, type, points, mousePoint) {}\n\n  /**\n   * 创建图形配置\n   * @param step\n   * @param points\n   * @param coordinates\n   * @param viewport\n   * @param precision\n   * @param xAxis\n   * @param yAxis\n   */\n  createGraphicDataSource (step, points, coordinates, viewport, precision, xAxis, yAxis) {}\n\n  /**\n   * 处理绘制过程中鼠标移动\n   * @param step\n   * @param points\n   * @param point\n   * @param xAxis\n   * @param yAxis\n   */\n  performMouseMoveForDrawing (step, points, point, xAxis, yAxis) {}\n\n  /**\n   * 处理鼠标按住移动\n   * @param points\n   * @param pressedPointIndex\n   * @param point\n   * @param xAxis\n   * @param yAxis\n   */\n  performMousePressedMove (points, pressedPointIndex, point, xAxis, yAxis) {}\n\n  // --------------------- 自定义时需要实现的一些方法结束 ----------------------\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default class Delegate {\n  constructor () {\n    this._observers = []\n  }\n\n  subscribe (observer) {\n    if (this._observers.indexOf(observer) < 0) {\n      this._observers.push(observer)\n    }\n  }\n\n  unsubscribe (observer) {\n    const index = this._observers.indexOf(observer)\n    if (index > -1) {\n      this._observers.splice(index, 1)\n    } else {\n      this._observers = []\n    }\n  }\n\n  execute (data) {\n    this._observers.forEach(observer => {\n      observer(data)\n    })\n  }\n\n  hasObservers () {\n    return this._observers.length > 0\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFunction, isNumber } from '../../../utils/typeChecks'\nimport { logWarn } from '../../../utils/logger'\n\nimport extension from '../../../data/extension'\n\nimport GraphicMark from './GraphicMark'\n\n/**\n * 创建图形标记映射\n * @return {{}}\n */\nexport function createGraphicMarkMapping () {\n  const mapping = {}\n  const graphicMarkExtensions = extension.graphicMarkExtensions\n  for (const name in graphicMarkExtensions) {\n    const graphicMarkClass = createGraphicMarkClass(graphicMarkExtensions[name])\n    if (graphicMarkClass) {\n      mapping[name] = graphicMarkClass\n    }\n  }\n  return mapping\n}\n\n/**\n * 创建图形标记类\n * @param name\n * @param series\n * @param checkMousePointOn\n * @param createGraphicDataSource\n * @param performMousePressedMove\n * @param performMouseMoveForDrawing\n * @param drawExtend\n * @return {Mark|null}\n */\nexport function createGraphicMarkClass ({\n  name, totalStep, checkMousePointOn, createGraphicDataSource,\n  performMousePressedMove, performMouseMoveForDrawing, drawExtend\n}) {\n  if (\n    !name ||\n    !isNumber(totalStep) ||\n    !isFunction(checkMousePointOn) ||\n    !isFunction(createGraphicDataSource)\n  ) {\n    logWarn('', '', 'Required attribute \"name\" and \"totalStep\", method \"checkMousePointOn\" and \"createGraphicDataSource\", new graphic mark cannot be generated!!!')\n    return null\n  }\n  class Mark extends GraphicMark {\n    constructor ({\n      id, chartData, xAxis, yAxis, points, styles, lock\n    }) {\n      super({\n        id, name, totalStep, chartData, xAxis, yAxis, points, styles, lock\n      })\n    }\n  }\n  Mark.prototype.checkMousePointOn = checkMousePointOn\n  Mark.prototype.createGraphicDataSource = createGraphicDataSource\n  if (isFunction(performMousePressedMove)) {\n    Mark.prototype.performMousePressedMove = performMousePressedMove\n  }\n  if (isFunction(performMouseMoveForDrawing)) {\n    Mark.prototype.performMouseMoveForDrawing = performMouseMoveForDrawing\n  }\n  if (isFunction(drawExtend)) {\n    Mark.prototype.drawExtend = drawExtend\n  }\n  return Mark\n}\n\n/**\n * 获取图形标记信息\n * @param graphicMark\n * @return {{name, lock: *, styles, id, points: (*|*[])}}\n */\nexport function getGraphicMarkInfo (graphicMark) {\n  return {\n    name: graphicMark.name(),\n    id: graphicMark.id(),\n    totalStep: graphicMark.totalStep(),\n    lock: graphicMark.lock(),\n    points: graphicMark.tpPoints(),\n    styles: graphicMark.styles()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// 默认技术指标窗口高度\nexport const DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT = 100\n\n// 技术指标窗口id前缀\nexport const TECHNICAL_INDICATOR_PANE_ID_PREFIX = 'technical_indicator_pane_'\n\n// 图形标记id前缀\nexport const GRAPHIC_MARK_ID_PREFIX = 'graphic_mark_'\n\n// 蜡烛图窗口id\nexport const CANDLE_PANE_ID = 'candle_pane'\n\n// 最小单条数据宽度\nexport const MIN_DATA_SPACE = 1\n\n// 最大单条数据宽度\nexport const MAX_DATA_SPACE = 50\n\n/**\n * 刷新层级\n * @type {{OVERLAY: number, MAIN: number, NONE: number, FULL: number}}\n */\nexport const InvalidateLevel = {\n  NONE: 0,\n  OVERLAY: 1,\n  MAIN: 2,\n  FULL: 3\n}\n\n/**\n * 图表动作\n * @type {{DRAW_CANDLE: string, SCROLL: string, PANE_DRAG: string, ZOOM: string, CROSSHAIR: string, DRAW_TECHNICAL_INDICATOR: string}}\n */\nexport const ActionType = {\n  DRAW_CANDLE: 'drawCandle',\n  DRAW_TECHNICAL_INDICATOR: 'drawTechnicalIndicator',\n  ZOOM: 'zoom',\n  SCROLL: 'scroll',\n  CROSSHAIR: 'crosshair',\n  PANE_DRAG: 'pane_drag'\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  isArray, isObject,\n  isFunction, isBoolean,\n  isValid, merge, clone\n} from '../utils/typeChecks'\nimport { defaultStyleOptions } from './options/styleOptions'\n\nimport { formatValue } from '../utils/format'\nimport { binarySearchNearest } from '../utils/number'\nimport { logWarn } from '../utils/logger'\n\nimport {\n  createTechnicalIndicatorInstance,\n  createTechnicalIndicatorMapping,\n  createTechnicalIndicatorInfo\n} from '../base/technicalindicator/technicalIndicatorControl'\nimport { TechnicalIndicatorSeries } from '../base/technicalindicator/TechnicalIndicator'\nimport { GraphicMarkMouseOperateElement } from '../base/overlay/mark/GraphicMark'\nimport Delegate from './delegate/Delegate'\nimport {\n  createGraphicMarkClass,\n  createGraphicMarkMapping,\n  getGraphicMarkInfo\n} from '../base/overlay/mark/graphicMarkControl'\n\nimport { MIN_DATA_SPACE, MAX_DATA_SPACE, InvalidateLevel, ActionType } from './constants'\n\nexport default class ChartData {\n  constructor (styleOptions, handler) {\n    // 持有者\n    this._handler = handler\n    // 样式配置\n    this._styleOptions = clone(defaultStyleOptions)\n    merge(this._styleOptions, styleOptions)\n    // 所有技术指标映射\n    this._technicalIndicatorMapping = createTechnicalIndicatorMapping()\n    // 是否可以缩放\n    this._zoomEnabled = true\n    // 是否可以拖拽滑动\n    this._scrollEnabled = true\n\n    // 价格精度\n    this._pricePrecision = 2\n    // 数量精度\n    this._volumePrecision = 0\n\n    this._dateTimeFormat = new Intl.DateTimeFormat(\n      'en', {\n        hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit'\n      }\n    )\n\n    // 数据源\n    this._dataList = []\n    // 可见的数据(需要绘制的数据)\n    this._visibleDataList = []\n\n    // 是否在加载中\n    this._loading = true\n    // 加载更多回调\n    this._loadMoreCallback = null\n    // 还有更多\n    this._more = true\n\n    // 可见区域数据占用的空间\n    this._totalDataSpace = 0\n    // 每一条数据的空间\n    this._dataSpace = 6\n    // bar的空间\n    this._barSpace = this._calcBarSpace()\n    // 向右偏移的空间\n    this._offsetRightSpace = 50\n    // 向右偏移的数量\n    this._offsetRightBarCount = this._offsetRightSpace / this._dataSpace\n    // 左边最小可见bar的个数\n    this._leftMinVisibleBarCount = 2\n    // 右边最小可见bar的个数\n    this._rightMinVisibleBarCount = 2\n    // 开始绘制的索引\n    this._from = 0\n    // 结束的索引\n    this._to = 0\n\n    // 十字光标信息\n    this._crosshair = {}\n    // 用来记录开始拖拽时向右偏移的数量\n    this._preOffsetRightBarCount = 0\n\n    // 拖拽标记图形标记\n    this._dragGraphicMarkFlag = false\n    // 图形标记映射\n    this._graphicMarkMapping = createGraphicMarkMapping()\n    // 图形标记鼠标操作信息\n    this._graphicMarkMouseOperate = {\n      click: {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      },\n      hover: {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    }\n    // 绘图标记数据\n    this._graphicMarks = []\n\n    // 注解标记\n    this._annotations = new Map()\n    // 可见的注解标记\n    this._visibleAnnotations = []\n    // 注解鼠标操作信息\n    this._annotationMouseOperate = { id: '' }\n\n    // 标签\n    this._tags = new Map()\n\n    // 调整pane标记\n    this._dragPaneFlag = false\n\n    // 事件代理\n    this._actionDelegate = new Map()\n  }\n\n  /**\n   * 计算一条柱子的空间\n   * @returns {number}\n   * @private\n   */\n  _calcBarSpace () {\n    const rateBarSpace = Math.floor(this._dataSpace * 0.8)\n    const floorBarSpace = Math.floor(this._dataSpace)\n    const optimalBarSpace = Math.min(rateBarSpace, floorBarSpace - 1)\n    return Math.max(1, optimalBarSpace)\n  }\n\n  /**\n   * 调整可见数据\n   * @private\n   */\n  _adjustVisibleDataList () {\n    // 处理需要绘制的数据\n    const dataSize = this._dataList.length\n    this._visibleDataList = []\n    this._visibleAnnotations = []\n    for (let i = this._from; i < this._to; i++) {\n      const kLineData = this._dataList[i]\n      const deltaFromRight = dataSize + this._offsetRightBarCount - i\n      const x = this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace\n      this._visibleDataList.push({\n        index: i,\n        x,\n        data: kLineData\n      })\n      const annotation = this._annotations.get(kLineData.timestamp) || []\n      if (annotation.length > 0) {\n        for (const an of annotation) {\n          an.createSymbolCoordinate(x)\n          this._visibleAnnotations.push(an)\n        }\n      }\n    }\n  }\n\n  /**\n   * 调整绘制起点终点位置\n   * @private\n   */\n  _adjustFromTo () {\n    const dataSize = this._dataList.length\n    const barLength = this._totalDataSpace / this._dataSpace\n    const maxRightOffsetBarCount = barLength - Math.min(this._leftMinVisibleBarCount, dataSize)\n    if (this._offsetRightBarCount > maxRightOffsetBarCount) {\n      this._offsetRightBarCount = maxRightOffsetBarCount\n    }\n\n    const minRightOffsetBarCount = -dataSize + Math.min(this._rightMinVisibleBarCount, dataSize)\n\n    if (this._offsetRightBarCount < minRightOffsetBarCount) {\n      this._offsetRightBarCount = minRightOffsetBarCount\n    }\n    this._to = Math.round(this._offsetRightBarCount + dataSize + 0.5)\n    this._from = Math.round(this._to - barLength) - 1\n    if (this._to > dataSize) {\n      this._to = dataSize\n    }\n    if (this._from < 0) {\n      this._from = 0\n    }\n    this._adjustVisibleDataList()\n    // 处理加载更多，有更多并且没有在加载则去加载更多\n    if (this._from === 0 && this._more && !this._loading && this._loadMoreCallback && isFunction(this._loadMoreCallback)) {\n      this._loading = true\n      this._loadMoreCallback(formatValue(this._dataList[0], 'timestamp'))\n    }\n  }\n\n  /**\n   * 获取样式配置\n   * @return {{}}\n   */\n  styleOptions () {\n    return this._styleOptions\n  }\n\n  /**\n   * 设置样式配置\n   * @param options\n   */\n  applyStyleOptions (options) {\n    merge(this._styleOptions, options)\n  }\n\n  /**\n   * 获取技术指标信息\n   * @param name\n   * @return {{}|{series: *, calcParams: *, precision: *, name: *}}\n   */\n  getTechnicalIndicatorInfo (name) {\n    if (isValid(name)) {\n      const tech = this.getTechnicalIndicatorInstance(name)\n      if (tech) {\n        return createTechnicalIndicatorInfo(tech)\n      }\n    } else {\n      const techs = {}\n      for (const name in this._technicalIndicatorMapping) {\n        const instance = this._technicalIndicatorMapping[name]\n        techs[name] = createTechnicalIndicatorInfo(instance)\n      }\n      return techs\n    }\n    return {}\n  }\n\n  /**\n   * 根据指标类型获取指标类\n   * @param name\n   * @return {*}\n   */\n  getTechnicalIndicatorInstance (name) {\n    return this._technicalIndicatorMapping[name]\n  }\n\n  /**\n   * 价格精度\n   * @returns {number}\n   */\n  pricePrecision () {\n    return this._pricePrecision\n  }\n\n  /**\n   * 数量精度\n   * @returns {number}\n   */\n  volumePrecision () {\n    return this._volumePrecision\n  }\n\n  /**\n   * 获取时间格式化\n   * @returns {Intl.DateTimeFormat | Intl.DateTimeFormat}\n   */\n  dateTimeFormat () {\n    return this._dateTimeFormat\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    let dateTimeFormat\n    try {\n      dateTimeFormat = new Intl.DateTimeFormat(\n        'en', {\n          hour12: false, timeZone: timezone, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit'\n        }\n      )\n    } catch (e) {\n      logWarn('', '', 'Timezone is error!!!')\n    }\n    if (dateTimeFormat) {\n      this._dateTimeFormat = dateTimeFormat\n    }\n  }\n\n  /**\n   * 获取时区\n   * @returns {null}\n   */\n  timezone () {\n    return this._dateTimeFormat.resolvedOptions().timeZone\n  }\n\n  /**\n   * 设置价格和数量精度\n   * @param pricePrecision\n   * @param volumePrecision\n   */\n  setPriceVolumePrecision (pricePrecision, volumePrecision) {\n    this._pricePrecision = pricePrecision\n    this._volumePrecision = volumePrecision\n    for (const name in this._technicalIndicatorMapping) {\n      const series = this._technicalIndicatorMapping[name].series\n      switch (series) {\n        case TechnicalIndicatorSeries.PRICE: {\n          this._technicalIndicatorMapping[name].setPrecision(pricePrecision)\n          break\n        }\n        case TechnicalIndicatorSeries.VOLUME: {\n          this._technicalIndicatorMapping[name].setPrecision(volumePrecision)\n          break\n        }\n        default: { break }\n      }\n    }\n  }\n\n  /**\n   * 获取数据源\n   * @returns {[]|*[]}\n   */\n  dataList () {\n    return this._dataList\n  }\n\n  /**\n   * 获取可见数据源\n   * @returns {[]|*[]}\n   */\n  visibleDataList () {\n    return this._visibleDataList\n  }\n\n  /**\n   * 清空数据源\n   */\n  clearDataList () {\n    this._more = true\n    this._loading = true\n    this._dataList = []\n    this._visibleDataList = []\n    this._from = 0\n    this._to = 0\n  }\n\n  /**\n   * 添加数据\n   * @param data\n   * @param pos\n   * @param more\n   */\n  addData (data, pos, more) {\n    if (isObject(data)) {\n      if (isArray(data)) {\n        this._loading = false\n        this._more = isBoolean(more) ? more : true\n        const isFirstAdd = this._dataList.length === 0\n        this._dataList = data.concat(this._dataList)\n        if (isFirstAdd) {\n          this.setOffsetRightSpace(this._offsetRightSpace)\n        }\n        this._adjustFromTo()\n      } else {\n        const dataSize = this._dataList.length\n        if (pos >= dataSize) {\n          this._dataList.push(data)\n          if (this._offsetRightBarCount < 0) {\n            this._offsetRightBarCount -= 1\n          }\n          this._adjustFromTo()\n        } else {\n          this._dataList[pos] = data\n          this._adjustVisibleDataList()\n        }\n      }\n      this.setCrosshair(this._crosshair, true)\n    }\n  }\n\n  /**\n   * 获取一条数据的空间\n   * @returns {number}\n   */\n  dataSpace () {\n    return this._dataSpace\n  }\n\n  /**\n   * 获取绘制一条数据的空间（不包括bar之间的间隙）\n   * @returns {*}\n   */\n  barSpace () {\n    return this._barSpace\n  }\n\n  /**\n   * 设置一条数据的空间\n   * @param dataSpace\n   * @param adjustBeforeFuc\n   */\n  setDataSpace (dataSpace, adjustBeforeFuc) {\n    if (dataSpace < MIN_DATA_SPACE || dataSpace > MAX_DATA_SPACE || this._dataSpace === dataSpace) {\n      return\n    }\n    this._dataSpace = dataSpace\n    this._barSpace = this._calcBarSpace()\n    adjustBeforeFuc && adjustBeforeFuc()\n    this._adjustFromTo()\n    this.setCrosshair(this._crosshair, true)\n    this.invalidate()\n  }\n\n  /**\n   * 设置可见区域数据占用的总空间\n   * @param totalSpace\n   */\n  setTotalDataSpace (totalSpace) {\n    if (this._totalDataSpace === totalSpace) {\n      return\n    }\n    this._totalDataSpace = totalSpace\n    this._adjustFromTo()\n    this.setCrosshair(this._crosshair, true)\n  }\n\n  /**\n   * 设置右边可以偏移的空间\n   * @param space\n   * @param invalidate\n   */\n  setOffsetRightSpace (space, invalidate) {\n    this._offsetRightSpace = space\n    this._offsetRightBarCount = space / this._dataSpace\n    if (invalidate) {\n      this._adjustFromTo()\n      this.setCrosshair(this._crosshair, true)\n      this.invalidate()\n    }\n  }\n\n  /**\n   * 右偏移距离\n   * @return {number}\n   */\n  offsetRightSpace () {\n    return this._offsetRightSpace\n  }\n\n  /**\n   * 右偏移bar数量\n   * @return {*|number}\n   */\n  offsetRightBarCount () {\n    return this._offsetRightBarCount\n  }\n\n  /**\n   * 设置左边可见的最小bar数量\n   * @param barCount\n   */\n  setLeftMinVisibleBarCount (barCount) {\n    this._leftMinVisibleBarCount = barCount\n  }\n\n  /**\n   * 设置右边可见的最小bar数量\n   * @param barCount\n   */\n  setRightMinVisibleBarCount (barCount) {\n    this._rightMinVisibleBarCount = barCount\n  }\n\n  /**\n   * 获取数据绘制起点\n   * @returns {number}\n   */\n  from () {\n    return this._from\n  }\n\n  /**\n   * 获取数据绘制终点\n   * @returns {number}\n   */\n  to () {\n    return this._to\n  }\n\n  /**\n   * 获取十字光标信息\n   * @returns {{}}\n   */\n  crosshair () {\n    return this._crosshair\n  }\n\n  /**\n   * 设置十字光标点信息\n   * @param crosshair\n   * @param notInvalidate\n   */\n  setCrosshair (crosshair, notInvalidate) {\n    const cr = crosshair || {}\n    let realDataIndex\n    let dataIndex\n    if (isValid(cr.x)) {\n      realDataIndex = this.coordinateToDataIndex(cr.x)\n      if (realDataIndex < 0) {\n        dataIndex = 0\n      } else if (realDataIndex > this._dataList.length - 1) {\n        dataIndex = this._dataList.length - 1\n      } else {\n        dataIndex = realDataIndex\n      }\n    } else {\n      realDataIndex = this._dataList.length - 1\n      dataIndex = realDataIndex\n    }\n    const kLineData = this._dataList[dataIndex]\n    const realX = this.dataIndexToCoordinate(realDataIndex)\n    const prevCrosshair = { x: this._crosshair.x, y: this._crosshair.y, paneId: this._crosshair.paneId }\n    this._crosshair = { ...cr, realX, kLineData, realDataIndex, dataIndex }\n    if (cr.paneId && kLineData) {\n      this._handler.crosshair({\n        realDataIndex,\n        dataIndex,\n        kLineData,\n        x: cr.x,\n        y: cr.y\n      })\n    }\n    if (\n      (prevCrosshair.x !== cr.x || prevCrosshair.y !== cr.y || prevCrosshair.paneId !== cr.paneId) && !notInvalidate\n    ) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 开始滚动\n   */\n  startScroll () {\n    this._preOffsetRightBarCount = this._offsetRightBarCount\n  }\n\n  /**\n   * 滚动\n   * @param distance\n   * @param crosshair\n   */\n  scroll (distance, crosshair) {\n    if (!this._scrollEnabled) {\n      return\n    }\n    const distanceBarCount = distance / this._dataSpace\n    this.actionExecute(ActionType.SCROLL, { barCount: distanceBarCount, distance })\n    this._offsetRightBarCount = this._preOffsetRightBarCount - distanceBarCount\n    this._adjustFromTo()\n    const cross = crosshair || this._crosshair\n    this.setCrosshair(cross, true)\n    this.invalidate()\n  }\n\n  /**\n   * x转换成浮点数的位置\n   * @param x\n   * @returns {number}\n   */\n  coordinateToFloatIndex (x) {\n    const dataSize = this._dataList.length\n    const deltaFromRight = (this._totalDataSpace - x) / this._dataSpace\n    const index = dataSize + this._offsetRightBarCount - deltaFromRight\n    return Math.round(index * 1000000) / 1000000\n  }\n\n  /**\n   * 数据索引转换成时间戳\n   * @param dataIndex\n   * @return {*}\n   */\n  dataIndexToTimestamp (dataIndex) {\n    const data = this._dataList[dataIndex]\n    if (data) {\n      return data.timestamp\n    }\n  }\n\n  /**\n   * 将时间戳转换成数据索引位置\n   * @param timestamp\n   * @return {number}\n   */\n  timestampToDataIndex (timestamp) {\n    if (this._dataList.length === 0) {\n      return 0\n    }\n    return binarySearchNearest(this._dataList, 'timestamp', timestamp)\n  }\n\n  /**\n   * 数据索引转换成坐标\n   * @param dataIndex\n   */\n  dataIndexToCoordinate (dataIndex) {\n    const dataSize = this._dataList.length\n    const deltaFromRight = dataSize + this._offsetRightBarCount - dataIndex\n    // return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace + this._barSpace / 2\n    return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace\n  }\n\n  /**\n   * 坐标换成数据索引转\n   * @param pixel\n   */\n  coordinateToDataIndex (pixel) {\n    return Math.ceil(this.coordinateToFloatIndex(pixel)) - 1\n  }\n\n  /**\n   * 缩放\n   * @param scale\n   * @param point\n   */\n  zoom (scale, point) {\n    if (!this._zoomEnabled) {\n      return\n    }\n    if (!point || !isValid(point.x)) {\n      point = { x: isValid(this._crosshair.x) ? this._crosshair.x : this._totalDataSpace / 2 }\n    }\n    this.actionExecute(ActionType.ZOOM, { point, scale })\n    const floatIndex = this.coordinateToFloatIndex(point.x)\n    const dataSpace = this._dataSpace + scale * (this._dataSpace / 10)\n    this.setDataSpace(dataSpace, () => {\n      this._offsetRightBarCount += (floatIndex - this.coordinateToFloatIndex(point.x))\n    })\n  }\n\n  /**\n   * 刷新\n   * @param invalidateLevel\n   */\n  invalidate (invalidateLevel) {\n    this._handler.invalidate(invalidateLevel)\n  }\n\n  /**\n   * 设置是否可以缩放\n   * @param enabled\n   */\n  setZoomEnabled (enabled) {\n    this._zoomEnabled = enabled\n  }\n\n  /**\n   * 获取是否可以缩放\n   * @return {boolean}\n   */\n  zoomEnabled () {\n    return this._zoomEnabled\n  }\n\n  /**\n   * 设置是否可以拖拽滚动\n   * @param enabled\n   */\n  setScrollEnabled (enabled) {\n    this._scrollEnabled = enabled\n  }\n\n  /**\n   * 获取是否可以拖拽滚动\n   * @return {boolean}\n   */\n  scrollEnabled () {\n    return this._scrollEnabled\n  }\n\n  /**\n   * 设置加载更多\n   * @param callback\n   */\n  setLoadMoreCallback (callback) {\n    this._loadMoreCallback = callback\n  }\n\n  /**\n   * 添加标记实例\n   * @param graphicMark\n   */\n  addGraphicMarkInstance (graphicMark) {\n    if (this._graphicMarks.find(gm => gm.id() === graphicMark.id())) {\n      return false\n    }\n    const lastGraphicMark = this._graphicMarks[this._graphicMarks.length - 1]\n    if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n      this._graphicMarks[this._graphicMarks.length - 1] = graphicMark\n    } else {\n      this._graphicMarks.push(graphicMark)\n    }\n    this.invalidate(InvalidateLevel.OVERLAY)\n    return true\n  }\n\n  /**\n   * 添加自定义标记图形\n   * @param graphicMarks\n   */\n  addCustomGraphicMark (graphicMarks) {\n    graphicMarks.forEach(mark => {\n      const GraphicMarkClass = createGraphicMarkClass(mark)\n      if (GraphicMarkClass) {\n        this._graphicMarkMapping[mark.name] = GraphicMarkClass\n      }\n    })\n  }\n\n  /**\n   * 设置图形标记配置\n   * @param id\n   * @param options\n   */\n  setGraphicMarkOptions (id, options = {}) {\n    const { styles, lock } = options\n    const graphicMark = this._graphicMarks.find(gm => gm.id() === id)\n    if (graphicMark) {\n      graphicMark.setLock(lock)\n      if (graphicMark.setStyles(styles, this._styleOptions.graphicMark)) {\n        this.invalidate(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 获取图形标记信息\n   * @param id\n   * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n   */\n  getGraphicMark (id) {\n    if (id) {\n      const graphicMark = this._graphicMarks.find(gm => gm.id() === id)\n      if (graphicMark) {\n        return getGraphicMarkInfo(graphicMark)\n      }\n    } else {\n      return this._graphicMarks.map(graphicMark => {\n        return getGraphicMarkInfo(graphicMark)\n      })\n    }\n    return null\n  }\n\n  /**\n   * 移除图形实例\n   * @param id 参数\n   */\n  removeGraphicMarkInstance (id) {\n    const graphicMarks = this._graphicMarks\n    if (isValid(id)) {\n      const removeIndex = graphicMarks.findIndex(gm => gm.id() === id)\n      if (removeIndex > -1) {\n        graphicMarks[removeIndex].onRemove({ id: graphicMarks[removeIndex].id() })\n        graphicMarks.splice(removeIndex, 1)\n        this.invalidate(InvalidateLevel.OVERLAY)\n      }\n    } else {\n      if (graphicMarks.length > 0) {\n        graphicMarks.forEach(gm => {\n          gm.onRemove({ id: gm.id() })\n        })\n        this._graphicMarks = []\n        this.invalidate(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 获取图形标记拖拽标记\n   * @returns {boolean}\n   */\n  dragGraphicMarkFlag () {\n    return this._dragGraphicMarkFlag\n  }\n\n  /**\n   * 设置图形标记拖拽标记\n   * @param flag\n   */\n  setDragGraphicMarkFlag (flag) {\n    this._dragGraphicMarkFlag = flag\n  }\n\n  /**\n   * 获取图形标记鼠标操作信息\n   * @return {{hover: {id: string, elementIndex: number, element: string}, click: {id: string, elementIndex: number, element: string}}}\n   */\n  graphicMarkMouseOperate () {\n    return this._graphicMarkMouseOperate\n  }\n\n  /**\n   * 获取拖拽Pane标记\n   * @return {boolean}\n   */\n  dragPaneFlag () {\n    return this._dragPaneFlag\n  }\n\n  /**\n   * 设置拖拽Pane标记\n   * @param flag\n   */\n  setDragPaneFlag (flag) {\n    this._dragPaneFlag = flag\n  }\n\n  /**\n   * 获取图形标记映射\n   * @returns {{}}\n   */\n  graphicMarkMapping () {\n    return this._graphicMarkMapping\n  }\n\n  /**\n   * 获取图形标记的数据\n   * @returns {{}}\n   */\n  graphicMarks () {\n    return this._graphicMarks\n  }\n\n  /**\n   * 获取可见的注解\n   * @return {[]}\n   */\n  visibleAnnotations () {\n    return this._visibleAnnotations\n  }\n\n  /**\n   * 获取注解鼠标操作信息\n   * @return {null}\n   */\n  annotationMouseOperate () {\n    return this._annotationMouseOperate\n  }\n\n  /**\n   * 创建注解\n   * @param annotations\n   */\n  addAnnotations (annotations) {\n    annotations.forEach(annotation => {\n      if (this._annotations.has(annotation.id())) {\n        this._annotations.get(annotation.id()).push(annotation)\n      } else {\n        this._annotations.set(annotation.id(), [annotation])\n      }\n    })\n    this._adjustVisibleDataList()\n    this.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n   * 移除注解\n   * @param points\n   */\n  removeAnnotation (points) {\n    let shouldAdjust = false\n    if (isValid(points)) {\n      ([].concat(points)).forEach(({ timestamp }) => {\n        if (this._annotations.has(timestamp)) {\n          shouldAdjust = true\n          this._annotations.delete(timestamp)\n        }\n      })\n      if (shouldAdjust) {\n        this._adjustVisibleDataList()\n      }\n    } else {\n      shouldAdjust = true\n      this._annotations.clear()\n      this._visibleAnnotations = []\n    }\n    if (shouldAdjust) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 获取标签\n   * @return {Map<any, any>}\n   */\n  tags () {\n    return this._tags\n  }\n\n  /**\n   * 根据id获取标签实例\n   * @param id\n   * @return\n   */\n  getTag (id) {\n    return this._tags.get(id)\n  }\n\n  /**\n   * 添加标签\n   * @param tags\n   */\n  addTags (tags) {\n    tags.forEach(tag => {\n      this._tags.set(tag.id(), tag)\n    })\n    this.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n   * 移除标签\n   * @param id\n   */\n  removeTag (id) {\n    let shouldInvalidate = false\n    if (isValid(id)) {\n      const ids = [].concat(id)\n      ids.forEach(id => {\n        if (this._tags.has(id)) {\n          shouldInvalidate = true\n          this._tags.delete(id)\n        }\n      })\n    } else {\n      shouldInvalidate = true\n      this._tags.clear()\n    }\n    if (shouldInvalidate) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 设置覆盖物鼠标操作信息\n   * @param graphicMarkOperate\n   * @param annotationOperate\n   */\n  setOverlayMouseOperate (graphicMarkOperate, annotationOperate) {\n    const { hover, click } = this._graphicMarkMouseOperate\n    const { id } = this._annotationMouseOperate\n    const lastGraphicMark = this._graphicMarks[this._graphicMarks.length - 1]\n    let shouldInvalidate = false\n    if (graphicMarkOperate.hover &&\n      (hover.id !== graphicMarkOperate.hover.id || hover.element !== graphicMarkOperate.hover.element || hover.elementIndex !== graphicMarkOperate.hover.elementIndex)\n    ) {\n      this._graphicMarkMouseOperate.hover = { ...graphicMarkOperate.hover }\n      shouldInvalidate = true\n    }\n    if (graphicMarkOperate.click &&\n      (click.id !== graphicMarkOperate.click.id || click.element !== graphicMarkOperate.click.element || click.elementIndex !== graphicMarkOperate.click.elementIndex)\n    ) {\n      this._graphicMarkMouseOperate.click = { ...graphicMarkOperate.click }\n      shouldInvalidate = true\n    }\n    if (annotationOperate && id !== annotationOperate.id) {\n      this._annotationMouseOperate = { ...annotationOperate }\n      shouldInvalidate = true\n    }\n    if (shouldInvalidate || (lastGraphicMark && lastGraphicMark.isDrawing())) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 添加一个自定义指标\n   * @param techs\n   */\n  addCustomTechnicalIndicator (techs) {\n    techs.forEach(tech => {\n      const instance = createTechnicalIndicatorInstance(tech || {})\n      if (instance) {\n        // 将生成的新的指标类放入集合\n        this._technicalIndicatorMapping[instance.name] = instance\n      }\n    })\n  }\n\n  /**\n   * 事件执行\n   * @param type\n   * @param data\n   * @param executeBeforeFun\n   * @param executeAfterFun\n   */\n  actionExecute (type, data, executeBeforeFun, executeAfterFun) {\n    if (this.hasAction(type)) {\n      executeBeforeFun && executeBeforeFun()\n      this._actionDelegate.get(type).execute(data)\n      executeAfterFun && executeAfterFun()\n    }\n  }\n\n  /**\n   * 是否有事件监听\n   * @param type\n   * @return {boolean}\n   */\n  hasAction (type) {\n    return this._actionDelegate.has(type) && this._actionDelegate.get(type).hasObservers()\n  }\n\n  /**\n   * 订阅事件\n   * @param type\n   * @param callback\n   * @return {boolean}\n   */\n  subscribeAction (type, callback) {\n    if (Object.values(ActionType).indexOf(type) < 0) {\n      return false\n    }\n    if (!this._actionDelegate.has(type)) {\n      this._actionDelegate.set(type, new Delegate())\n    }\n    this._actionDelegate.get(type).subscribe(callback)\n    return true\n  }\n\n  /**\n   * 取消事件订阅\n   * @param type\n   * @param callback\n   * @return {boolean}\n   */\n  unsubscribeAction (type, callback) {\n    if (Object.values(ActionType).indexOf(type) < 0) {\n      return false\n    }\n    if (this._actionDelegate.has(type)) {\n      const delegate = this._actionDelegate.get(type)\n      delegate.unsubscribe(callback)\n      if (!delegate.hasObservers()) {\n        this._actionDelegate.delete(type)\n      }\n      return true\n    }\n    return false\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 获取屏幕比\n * @param canvas\n * @returns {number}\n */\nexport function getPixelRatio (canvas) {\n  return (canvas.ownerDocument && canvas.ownerDocument.defaultView && canvas.ownerDocument.defaultView.devicePixelRatio) || 2\n}\n\n/**\n * 测量文字的宽度\n * @param ctx\n * @param text\n * @returns {number}\n */\nexport function calcTextWidth (ctx, text) {\n  return Math.round(ctx.measureText(text).width)\n}\n\n/**\n * 创建字体\n * @param fontSize\n * @param fontFamily\n * @param fontWeight\n * @returns {string}\n */\nexport function createFont (fontSize = 12, fontWeight = 'normal', fontFamily = 'Helvetica Neue') {\n  return `${fontWeight} ${fontSize}px ${fontFamily}`\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\n\nexport default class Pane {\n  constructor (props) {\n    this._height = -1\n    this._container = props.container\n    this._chartData = props.chartData\n    this._initBefore(props)\n    this._initElement()\n    this._mainWidget = this._createMainWidget(this._element, props)\n    this._yAxisWidget = this._createYAxisWidget(this._element, props)\n  }\n\n  _initBefore (props) {}\n\n  _initElement () {\n    this._element = document.createElement('div')\n    this._element.style.margin = '0'\n    this._element.style.padding = '0'\n    this._element.style.position = 'relative'\n    this._element.style.overflow = 'hidden'\n    this._element.style.width = '100%'\n    const lastElement = this._container.lastChild\n    if (lastElement) {\n      this._container.insertBefore(this._element, lastElement)\n    } else {\n      this._container.appendChild(this._element)\n    }\n  }\n\n  /**\n   * 创建主组件\n   * @param container\n   * @param props\n   * @private\n   */\n  _createMainWidget (container, props) {}\n\n  /**\n   * 创建y轴组件\n   * @param container\n   * @param props\n   * @private\n   */\n  _createYAxisWidget (container, props) {}\n\n  /**\n   * 获取宽度\n   * @returns {number}\n   */\n  width () {\n    return this._element.offsetWidth\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    this._mainWidget.setWidth(mainWidgetWidth)\n    this._yAxisWidget && this._yAxisWidget.setWidth(yAxisWidgetWidth)\n  }\n\n  /**\n   * 获取高度\n   */\n  height () {\n    return this._height\n  }\n\n  /**\n   * 设置临时高度\n   * @param height\n   */\n  setHeight (height) {\n    this._height = height\n    this._mainWidget.setHeight(height)\n    this._yAxisWidget && this._yAxisWidget.setHeight(height)\n  }\n\n  setOffsetLeft (mainWidgetOffsetLeft, yAxisWidgetOffsetLeft) {\n    this._mainWidget.setOffsetLeft(mainWidgetOffsetLeft)\n    this._yAxisWidget && this._yAxisWidget.setOffsetLeft(yAxisWidgetOffsetLeft)\n  }\n\n  layout () {\n    if (this._element.offsetHeight !== this._height) {\n      this._element.style.height = `${this._height}px`\n    }\n    this._mainWidget.layout()\n    this._yAxisWidget && this._yAxisWidget.layout()\n  }\n\n  /**\n   * 刷新\n   * @param level\n   */\n  invalidate (level) {\n    this._yAxisWidget && this._yAxisWidget.invalidate(level)\n    this._mainWidget.invalidate(level)\n  }\n\n  /**\n   * 将canvas转换成图片\n   * @param includeOverlay\n   * @return {HTMLCanvasElement}\n   */\n  getImage (includeOverlay) {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    const width = this._element.offsetWidth\n    const height = this._element.offsetHeight\n    canvas.style.width = `${width}px`\n    canvas.style.height = `${height}px`\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    const mainWidgetElement = this._mainWidget.getElement()\n    const mainWidgetWidth = mainWidgetElement.offsetWidth\n    const mainWidgetHeight = mainWidgetElement.offsetHeight\n    const mainWidgetOffsetLeft = parseInt(mainWidgetElement.style.left, 10)\n\n    ctx.drawImage(\n      this._mainWidget.getImage(includeOverlay),\n      mainWidgetOffsetLeft, 0,\n      mainWidgetWidth, mainWidgetHeight\n    )\n    if (this._yAxisWidget) {\n      const yAxisWidgetElement = this._yAxisWidget.getElement()\n      const yAxisWidgetWidth = yAxisWidgetElement.offsetWidth\n      const yAxisWidgetHeight = yAxisWidgetElement.offsetHeight\n      const yAxisWidgetOffsetLeft = parseInt(yAxisWidgetElement.style.left, 10)\n      ctx.drawImage(\n        this._yAxisWidget.getImage(includeOverlay),\n        yAxisWidgetOffsetLeft, 0,\n        yAxisWidgetWidth, yAxisWidgetHeight\n      )\n    }\n    return canvas\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._container.removeChild(this._element)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InvalidateLevel } from '../data/constants'\nimport { getPixelRatio } from '../utils/canvas'\n\nexport default class Widget {\n  constructor (props) {\n    this._width = 0\n    this._height = 0\n    this._initElement(props.container)\n    this._mainView = this._createMainView(this._element, props)\n    this._overlayView = this._createOverlayView(this._element, props)\n  }\n\n  /**\n   * 初始化element\n   * @param container\n   * @private\n   */\n  _initElement (container) {\n    this._element = document.createElement('div')\n    this._element.style.top = '0'\n    this._element.style.margin = '0'\n    this._element.style.padding = '0'\n    this._element.style.position = 'absolute'\n    this._element.style.overflow = 'hidden'\n    container.appendChild(this._element)\n  }\n\n  /**\n   * 创建主view\n   * @param container\n   * @param props\n   * @private\n   */\n  _createMainView (container, props) {}\n\n  /**\n   * 创建浮层view\n   * @param container\n   * @param props\n   * @private\n   */\n  _createOverlayView (container, props) {}\n\n  getElement () {\n    return this._element\n  }\n\n  setWidth (width) {\n    this._width = width\n    this._mainView.setWidth(width)\n    this._overlayView.setWidth(width)\n  }\n\n  setHeight (height) {\n    this._height = height\n    this._mainView.setHeight(height)\n    this._overlayView.setHeight(height)\n  }\n\n  setOffsetLeft (offsetLeft) {\n    this._element.style.left = `${offsetLeft}px`\n  }\n\n  layout () {\n    if (this._element.offsetWidth !== this._width) {\n      this._element.style.width = `${this._width}px`\n    }\n    if (this._element.offsetHeight !== this._height) {\n      this._element.style.height = `${this._height}px`\n    }\n    this._mainView.layout()\n    this._overlayView.layout()\n  }\n\n  /**\n   * 更新\n   * @param level\n   */\n  invalidate (level) {\n    switch (level) {\n      case InvalidateLevel.OVERLAY: {\n        this._overlayView.flush()\n        break\n      }\n      case InvalidateLevel.MAIN:\n      case InvalidateLevel.FULL: {\n        this._mainView.flush()\n        this._overlayView.flush()\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  /**\n   * 将widget转换成图片\n   * @param includeOverlay\n   * @returns {HTMLCanvasElement}\n   */\n  getImage (includeOverlay) {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    canvas.style.width = `${this._width}px`\n    canvas.style.height = `${this._height}px`\n    canvas.width = this._width * pixelRatio\n    canvas.height = this._height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    ctx.drawImage(this._mainView.getImage(), 0, 0, this._width, this._height)\n\n    if (includeOverlay && this._overlayView) {\n      ctx.drawImage(this._overlayView.getImage(), 0, 0, this._width, this._height)\n    }\n    return canvas\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * requestAnimationFrame兼容\n * @param fn\n */\nexport function requestAnimationFrame (fn) {\n  if (!window.requestAnimationFrame) {\n    return window.setTimeout(fn, 20)\n  }\n  return window.requestAnimationFrame(fn)\n}\n\n/**\n * cancelAnimationFrame兼容\n * @param id\n */\nexport function cancelAnimationFrame (id) {\n  if (!window.cancelAnimationFrame) {\n    clearTimeout(id)\n  }\n  window.cancelAnimationFrame(id)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\nimport { cancelAnimationFrame, requestAnimationFrame } from '../utils/compatible'\n\nclass View {\n  constructor (container, chartData) {\n    this._chartData = chartData\n    this._initCanvas(container)\n  }\n\n  /**\n   * 初始化画布\n   * @param container\n   * @private\n   */\n  _initCanvas (container) {\n    this._canvas = document.createElement('canvas')\n    this._canvas.style.position = 'absolute'\n    this._canvas.style.top = '0'\n    this._canvas.style.left = '0'\n    this._canvas.style.zIndex = '2'\n    this._ctx = this._canvas.getContext('2d')\n    container.appendChild(this._canvas)\n  }\n\n  /**\n   * 重新绘制\n   * @param extendFun\n   * @private\n   */\n  _redraw (extendFun) {\n    this._ctx.clearRect(0, 0, this._canvas.offsetWidth, this._canvas.offsetHeight)\n    extendFun && extendFun()\n    this._draw()\n  }\n\n  /**\n   * 绘制\n   */\n  _draw () {\n  }\n\n  setWidth (width) {\n    this._width = width\n  }\n\n  setHeight (height) {\n    this._height = height\n  }\n\n  layout () {\n    if (this._height !== this._canvas.offsetHeight || this._width !== this._canvas.offsetWidth) {\n      this._redraw(() => {\n        const pixelRatio = getPixelRatio(this._canvas)\n        this._canvas.style.width = `${this._width}px`\n        this._canvas.style.height = `${this._height}px`\n        this._canvas.width = Math.floor(this._width * pixelRatio)\n        this._canvas.height = Math.floor(this._height * pixelRatio)\n        this._ctx.scale(pixelRatio, pixelRatio)\n      })\n    } else {\n      this.flush()\n    }\n  }\n\n  /**\n   * 刷新\n   */\n  flush () {\n    if (this.requestAnimationId) {\n      cancelAnimationFrame(this.requestAnimationId)\n      this.requestAnimationId = null\n    }\n    this.requestAnimationId = requestAnimationFrame(() => {\n      this._redraw()\n    })\n  }\n\n  /**\n   * 获取图片\n   * @returns {HTMLCanvasElement}\n   */\n  getImage () {\n    return this._canvas\n  }\n}\n\nexport default View\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\n\nimport { CandleType, LineStyle } from '../data/options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { renderHorizontalLine, renderVerticalLine, renderLine } from '../renderer/line'\nimport { isValid } from '../utils/typeChecks'\nimport { ActionType } from '../data/constants'\n\nexport default class TechnicalIndicatorView extends View {\n  constructor (container, chartData, xAxis, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    this._drawGrid()\n    this._drawTechnicalIndicators()\n  }\n\n  /**\n   * 绘制网格\n   * @private\n   */\n  _drawGrid () {\n    const gridOptions = this._chartData.styleOptions().grid\n    if (!gridOptions.show) {\n      return\n    }\n    const gridHorizontalOptions = gridOptions.horizontal\n    this._ctx.save()\n    if (gridHorizontalOptions.show) {\n      this._ctx.strokeStyle = gridHorizontalOptions.color\n      this._ctx.lineWidth = gridHorizontalOptions.size\n      if (gridHorizontalOptions.style === LineStyle.DASH) {\n        this._ctx.setLineDash(gridHorizontalOptions.dashValue)\n      } else {\n        this._ctx.setLineDash([])\n      }\n      this._yAxis.ticks().forEach(tick => {\n        renderHorizontalLine(this._ctx, tick.y, 0, this._width)\n      })\n    }\n\n    const gridVerticalOptions = gridOptions.vertical\n    if (gridVerticalOptions.show) {\n      this._ctx.strokeStyle = gridVerticalOptions.color\n      this._ctx.lineWidth = gridVerticalOptions.size\n      if (gridVerticalOptions.style === LineStyle.DASH) {\n        this._ctx.setLineDash(gridVerticalOptions.dashValue)\n      } else {\n        this._ctx.setLineDash([])\n      }\n      this._xAxis.ticks().forEach(tick => {\n        renderVerticalLine(this._ctx, tick.x, 0, this._height)\n      })\n    }\n    this._ctx.restore()\n  }\n\n  /**\n   * 绘制指标\n   * @private\n   */\n  _drawTechnicalIndicators () {\n    const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    technicalIndicators.forEach(technicalIndicator => {\n      const plots = technicalIndicator.plots\n      const lines = []\n      const dataList = this._chartData.dataList()\n      const technicalIndicatorResult = technicalIndicator.result\n      const styles = technicalIndicator.styles || technicalIndicatorOptions\n      // 技术指标自定义绘制\n      if (technicalIndicator.render) {\n        this._ctx.save()\n        technicalIndicator.render(\n          this._ctx,\n          {\n            from: this._chartData.from(),\n            to: this._chartData.to(),\n            kLineDataList: this._chartData.dataList(),\n            technicalIndicatorDataList: technicalIndicatorResult\n          },\n          {\n            width: this._width,\n            height: this._height,\n            dataSpace: this._chartData.dataSpace(),\n            barSpace: this._chartData.barSpace()\n          },\n          styles,\n          {\n            convertFromPixel: this._xAxis.convertFromPixel.bind(this._xAxis),\n            convertToPixel: this._xAxis.convertToPixel.bind(this._xAxis)\n          },\n          {\n            convertFromPixel: this._yAxis.convertFromPixel.bind(this._yAxis),\n            convertToPixel: this._yAxis.convertToPixel.bind(this._yAxis)\n          },\n          this._yAxis.isCandleYAxis()\n        )\n        this._ctx.restore()\n      }\n\n      let baseValue = technicalIndicator.baseValue\n      if (!isValid(baseValue)) {\n        baseValue = this._yAxis.min()\n      }\n      const baseValueY = this._yAxis.convertToPixel(baseValue)\n      const isCandleYAxis = this._yAxis.isCandleYAxis()\n\n      this._ctx.lineWidth = 1\n\n      this._drawGraphics(\n        (x, i, kLineData, halfBarSpace, barSpace) => {\n          const technicalIndicatorData = technicalIndicatorResult[i] || {}\n          let lineValueIndex = 0\n          if (technicalIndicator.shouldOhlc && !isCandleYAxis) {\n            this._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, styles.bar, CandleType.OHLC)\n          }\n          const coordinateY = {}\n          plots.forEach(plot => {\n            const value = technicalIndicatorData[plot.key]\n            const valueY = this._yAxis.convertToPixel(value)\n            coordinateY[plot.key] = valueY\n            switch (plot.type) {\n              case TechnicalIndicatorPlotType.CIRCLE: {\n                if (isValid(value)) {\n                  const cbData = {\n                    preData: { kLineData: dataList[i - 1], technicalIndicatorData: technicalIndicatorResult[i - 1] },\n                    currentData: { kLineData, technicalIndicatorData },\n                    nextData: { kLineData: dataList[i + 1], technicalIndicatorData: technicalIndicatorResult[i + 1] }\n                  }\n                  const circle = {\n                    x,\n                    y: valueY,\n                    radius: halfBarSpace,\n                    color: (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor,\n                    isStroke: plot.isStroke ? plot.isStroke(cbData) : true\n                  }\n                  this._drawCircle(circle)\n                }\n                break\n              }\n              case TechnicalIndicatorPlotType.BAR: {\n                if (isValid(value)) {\n                  const cbData = {\n                    preData: { kLineData: dataList[i - 1], technicalIndicatorData: technicalIndicatorResult[i - 1] },\n                    currentData: { kLineData, technicalIndicatorData },\n                    nextData: { kLineData: dataList[i + 1], technicalIndicatorData: technicalIndicatorResult[i + 1] }\n                  }\n                  const height = Math.abs(baseValueY - valueY)\n                  const bar = {\n                    x: x - halfBarSpace,\n                    width: halfBarSpace * 2,\n                    height: Math.max(1, height)\n                  }\n                  if (valueY > baseValueY) {\n                    bar.y = baseValueY\n                  } else {\n                    bar.y = height < 1 ? baseValueY - 1 : valueY\n                  }\n                  bar.color = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n                  bar.isStroke = plot.isStroke ? plot.isStroke(cbData) : false\n                  this._drawBar(bar)\n                }\n                break\n              }\n              case TechnicalIndicatorPlotType.LINE: {\n                let line = null\n                if (isValid(value)) {\n                  line = { x: x, y: valueY }\n                }\n                if (lines[lineValueIndex]) {\n                  lines[lineValueIndex].push(line)\n                } else {\n                  lines[lineValueIndex] = [line]\n                }\n                lineValueIndex++\n                break\n              }\n              default: { break }\n            }\n            this._drawActionExecute(ActionType.DRAW_TECHNICAL_INDICATOR, {\n              ctx: this._ctx,\n              kLineData,\n              dataIndex: i,\n              technicalIndicatorData,\n              technicalIndicatorName: technicalIndicator.name,\n              coordinate: { x, ...coordinateY },\n              viewport: { width: this._width, height: this._height },\n              barSpace,\n              halfBarSpace,\n              isCandle: isCandleYAxis\n            })\n          })\n        },\n        () => {\n          this._drawLines(lines, styles)\n        }\n      )\n    })\n  }\n\n  /**\n   * 绘制图形\n   * @param onDrawing\n   * @param onDrawEnd\n   * @private\n   */\n  _drawGraphics (onDrawing, onDrawEnd) {\n    const visibleDataList = this._chartData.visibleDataList()\n    const barSpace = this._chartData.barSpace()\n    const halfBarSpace = barSpace / 2\n    visibleDataList.forEach(({ x, index, data }, n) => {\n      onDrawing(x, index, data, halfBarSpace, barSpace, n)\n    })\n    onDrawEnd && onDrawEnd()\n  }\n\n  /**\n   * 绘制线\n   * @param lines\n   * @param technicalIndicatorOptions\n   */\n  _drawLines (lines, technicalIndicatorOptions) {\n    const colors = technicalIndicatorOptions.line.colors || []\n    const colorSize = colors.length\n    this._ctx.lineWidth = technicalIndicatorOptions.line.size\n    renderLine(this._ctx, () => {\n      lines.forEach((lineItem, i) => {\n        this._ctx.strokeStyle = colors[i % colorSize]\n        this._ctx.beginPath()\n        let isStart = true\n        lineItem.forEach(line => {\n          if (isValid(line)) {\n            if (isStart) {\n              this._ctx.moveTo(line.x, line.y)\n              isStart = false\n            } else {\n              this._ctx.lineTo(line.x, line.y)\n            }\n          }\n        })\n        this._ctx.stroke()\n        this._ctx.closePath()\n      })\n    })\n  }\n\n  /**\n   * 绘制柱\n   */\n  _drawBar (bar) {\n    if (bar.isStroke) {\n      this._ctx.strokeStyle = bar.color\n      this._ctx.strokeRect(bar.x + 0.5, bar.y, bar.width - 1, bar.height)\n    } else {\n      this._ctx.fillStyle = bar.color\n      this._ctx.fillRect(bar.x, bar.y, bar.width, bar.height)\n    }\n  }\n\n  /**\n   * 绘制圆点\n   * @param circle\n   * @private\n   */\n  _drawCircle (circle) {\n    this._ctx.strokeStyle = circle.color\n    this._ctx.fillStyle = circle.color\n    this._ctx.beginPath()\n    this._ctx.arc(circle.x, circle.y, circle.radius, Math.PI * 2, 0, true)\n    if (circle.isStroke) {\n      this._ctx.stroke()\n    } else {\n      this._ctx.fill()\n    }\n    this._ctx.closePath()\n  }\n\n  /**\n   * 绘制蜡烛柱\n   * @param x\n   * @param halfBarSpace\n   * @param barSpace\n   * @param dataIndex\n   * @param kLineData\n   * @param barOptions\n   * @param barStyle\n   * @private\n   */\n  _drawCandleBar (x, halfBarSpace, barSpace, dataIndex, kLineData, barOptions, barStyle) {\n    const { open, close, high, low } = kLineData\n    if (close > open) {\n      this._ctx.strokeStyle = barOptions.upColor\n      this._ctx.fillStyle = barOptions.upColor\n    } else if (close < open) {\n      this._ctx.strokeStyle = barOptions.downColor\n      this._ctx.fillStyle = barOptions.downColor\n    } else {\n      this._ctx.strokeStyle = barOptions.noChangeColor\n      this._ctx.fillStyle = barOptions.noChangeColor\n    }\n    const openY = this._yAxis.convertToPixel(open)\n    const closeY = this._yAxis.convertToPixel(close)\n    const highY = this._yAxis.convertToPixel(high)\n    const lowY = this._yAxis.convertToPixel(low)\n\n    const highEndY = Math.min(openY, closeY)\n    const lowStartY = Math.max(openY, closeY)\n    this._ctx.fillRect(x - 0.5, highY, 1, highEndY - highY)\n    this._ctx.fillRect(x - 0.5, lowStartY, 1, lowY - lowStartY)\n\n    const barHeight = Math.max(1, lowStartY - highEndY)\n    switch (barStyle) {\n      case CandleType.CANDLE_SOLID: {\n        this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        break\n      }\n      case CandleType.CANDLE_STROKE: {\n        this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        break\n      }\n      case CandleType.CANDLE_UP_STROKE: {\n        if (close > open) {\n          this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        } else {\n          this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        }\n        break\n      }\n      case CandleType.CANDLE_DOWN_STROKE: {\n        if (close > open) {\n          this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        } else {\n          this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        }\n        break\n      }\n      default: {\n        this._ctx.fillRect(x - 0.5, highY, 1, lowY - highY)\n        this._ctx.fillRect(x - halfBarSpace, openY - 0.5, halfBarSpace, 1)\n        this._ctx.fillRect(x, closeY - 0.5, halfBarSpace, 1)\n        break\n      }\n    }\n    this._drawActionExecute(ActionType.DRAW_CANDLE, {\n      ctx: this._ctx,\n      dataIndex,\n      kLineData,\n      coordinate: { x, open: openY, close: closeY, high: highY, low: lowY },\n      viewport: { width: this._width, height: this._height },\n      barSpace,\n      halfBarSpace,\n      isCandle: this._yAxis.isCandleYAxis()\n    })\n  }\n\n  /**\n   * 执行绘制事件监听\n   * @param type\n   * @param data\n   * @private\n   */\n  _drawActionExecute (type, data) {\n    this._chartData.actionExecute(\n      type,\n      data,\n      () => {\n        this._ctx.save()\n      },\n      () => {\n        this._ctx.restore()\n      }\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制文字\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param text\n */\nexport function renderText (ctx, color, x, y, text) {\n  ctx.fillStyle = color\n  ctx.fillText(text, x, y)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { TooltipShowRule, LineStyle } from '../data/options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { isValid } from '../utils/typeChecks'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { getTechnicalIndicatorTooltipData } from '../base/technicalindicator/technicalIndicatorControl'\nimport { renderText } from '../renderer/text'\n\nexport default class TechnicalIndicatorOverlayView extends View {\n  constructor (container, chartData, xAxis, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    this._drawCover()\n    const crosshair = this._chartData.crosshair()\n    if (crosshair.kLineData) {\n      const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n      const styleOptions = this._chartData.styleOptions()\n      const crosshairOptions = styleOptions.crosshair\n      if (crosshair.paneId === this._additionalDataProvider.id()) {\n        // 绘制十字光标水平线\n        this._drawCrosshairLine(crosshairOptions, 'horizontal', crosshair.y, 0, this._width, renderHorizontalLine)\n      }\n      if (crosshair.paneId) {\n        // 绘制十字光标垂直线\n        this._drawCrosshairLine(crosshairOptions, 'vertical', crosshair.realX, 0, this._height, renderVerticalLine)\n      }\n      this._drawTooltip(crosshair, technicalIndicators)\n    }\n  }\n\n  /**\n   * 绘制覆盖物\n   * @private\n   */\n  _drawCover () {}\n\n  /**\n   * 绘制图例\n   * @param crosshair\n   * @param technicalIndicators\n   * @private\n   */\n  _drawTooltip (crosshair, technicalIndicators) {\n    const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n    this._drawBatchTechnicalIndicatorToolTip(\n      crosshair,\n      technicalIndicators,\n      technicalIndicatorOptions,\n      0,\n      this._shouldDrawTooltip(crosshair, technicalIndicatorOptions.tooltip)\n    )\n  }\n\n  /**\n   * 绘制十字光标线\n   * @param crosshairOptions\n   * @param optionsKey\n   * @param fixedCoordinate\n   * @param startCoordinate\n   * @param endCoordinate\n   * @param drawLine\n   * @private\n   */\n  _drawCrosshairLine (crosshairOptions, optionsKey, fixedCoordinate, startCoordinate, endCoordinate, drawLine) {\n    const crosshairDirectionOptions = crosshairOptions[optionsKey]\n    const crosshairLineOptions = crosshairDirectionOptions.line\n    if (!crosshairOptions.show || !crosshairDirectionOptions.show || !crosshairLineOptions.show) {\n      return\n    }\n    this._ctx.save()\n    this._ctx.lineWidth = crosshairLineOptions.size\n    this._ctx.strokeStyle = crosshairLineOptions.color\n\n    if (crosshairLineOptions.style === LineStyle.DASH) {\n      this._ctx.setLineDash(crosshairLineOptions.dashValue)\n    }\n    drawLine(this._ctx, fixedCoordinate, startCoordinate, endCoordinate)\n    this._ctx.restore()\n  }\n\n  /**\n   * 批量绘制技术指标提示\n   * @param crosshair\n   * @param technicalIndicators\n   * @param technicalIndicatorOptions\n   * @param offsetTop\n   * @param isDrawTechnicalIndicatorTooltip\n   * @private\n   */\n  _drawBatchTechnicalIndicatorToolTip (crosshair, technicalIndicators, technicalIndicatorOptions, offsetTop = 0, isDrawTechnicalIndicatorTooltip) {\n    if (!isDrawTechnicalIndicatorTooltip) {\n      return\n    }\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n    let top = offsetTop\n    technicalIndicators.forEach(technicalIndicator => {\n      this._drawTechnicalIndicatorTooltip(crosshair, technicalIndicator, technicalIndicatorOptions, top)\n      top += (\n        technicalIndicatorTooltipOptions.text.marginTop +\n        technicalIndicatorTooltipOptions.text.size +\n        technicalIndicatorTooltipOptions.text.marginBottom\n      )\n    })\n  }\n\n  /**\n   * 绘制指标图例\n   * @param crosshair\n   * @param technicalIndicator\n   * @param technicalIndicatorOptions\n   * @param offsetTop\n   * @private\n   */\n  _drawTechnicalIndicatorTooltip (crosshair, technicalIndicator, technicalIndicatorOptions, offsetTop = 0) {\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n    const styles = technicalIndicator.styles || technicalIndicatorOptions\n    const technicalIndicatorResult = technicalIndicator.result\n    const technicalIndicatorData = technicalIndicatorResult[crosshair.dataIndex]\n    const tooltipData = getTechnicalIndicatorTooltipData(technicalIndicatorData, technicalIndicator)\n    const colors = styles.line.colors\n    const dataList = this._chartData.dataList()\n    const cbData = {\n      preData: { kLineData: dataList[crosshair.dataIndex - 1], technicalIndicatorData: technicalIndicatorResult[crosshair.dataIndex - 1] },\n      currentData: { kLineData: dataList[crosshair.dataIndex], technicalIndicatorData },\n      nextData: { kLineData: dataList[crosshair.dataIndex + 1], technicalIndicatorData: technicalIndicatorResult[crosshair.dataIndex + 1] }\n    }\n    const plots = technicalIndicator.plots\n    const technicalIndicatorTooltipTextOptions = technicalIndicatorTooltipOptions.text\n    const values = tooltipData.values\n    const textMarginLeft = technicalIndicatorTooltipTextOptions.marginLeft\n    const textMarginRight = technicalIndicatorTooltipTextOptions.marginRight\n    let labelX = 0\n    const labelY = technicalIndicatorTooltipTextOptions.marginTop + offsetTop\n    const textSize = technicalIndicatorTooltipTextOptions.size\n    const textColor = technicalIndicatorTooltipTextOptions.color\n    const colorSize = colors.length\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(textSize, technicalIndicatorTooltipTextOptions.weight, technicalIndicatorTooltipTextOptions.family)\n\n    if (technicalIndicatorTooltipOptions.showName) {\n      const nameText = tooltipData.name\n      const nameTextWidth = calcTextWidth(this._ctx, nameText)\n      labelX += textMarginLeft\n      renderText(this._ctx, textColor, labelX, labelY, nameText)\n      labelX += nameTextWidth\n      if (!technicalIndicatorTooltipOptions.showParams) {\n        labelX += textMarginRight\n      }\n    }\n    if (technicalIndicatorTooltipOptions.showParams) {\n      const calcParamText = tooltipData.calcParamText\n      const calcParamTextWidth = calcTextWidth(this._ctx, calcParamText)\n      if (!technicalIndicatorTooltipOptions.showName) {\n        labelX += textMarginLeft\n      }\n      renderText(this._ctx, textColor, labelX, labelY, calcParamText)\n      labelX += (calcParamTextWidth + textMarginRight)\n    }\n    let lineCount = 0\n    let valueColor\n    plots.forEach((plot, i) => {\n      switch (plot.type) {\n        case TechnicalIndicatorPlotType.CIRCLE: {\n          valueColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n          break\n        }\n        case TechnicalIndicatorPlotType.BAR: {\n          valueColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n          break\n        }\n        case TechnicalIndicatorPlotType.LINE: {\n          valueColor = colors[lineCount % colorSize] || textColor\n          lineCount++\n          break\n        }\n        default: { break }\n      }\n      const title = values[i].title\n      if (isValid(title)) {\n        labelX += textMarginLeft\n        const text = `${title}${values[i].value || technicalIndicatorTooltipOptions.defaultValue}`\n        const textWidth = calcTextWidth(this._ctx, text)\n        renderText(this._ctx, valueColor, labelX, labelY, text)\n        labelX += (textWidth + textMarginRight)\n      }\n    })\n  }\n\n  /**\n   * 是否需要绘制图例\n   * @param crosshair\n   * @param tooltipOptions\n   * @return {boolean|boolean|*}\n   * @private\n   */\n  _shouldDrawTooltip (crosshair, tooltipOptions) {\n    const showRule = tooltipOptions.showRule\n    return showRule === TooltipShowRule.ALWAYS ||\n      (showRule === TooltipShowRule.FOLLOW_CROSS && (!!crosshair.paneId))\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport TechnicalIndicatorView from '../view/TechnicalIndicatorView'\nimport TechnicalIndicatorOverlayView from '../view/TechnicalIndicatorOverlayView'\n\nexport default class TechnicalIndicatorWidget extends Widget {\n  _createMainView (container, props) {\n    return new TechnicalIndicatorView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n\n  _createOverlayView (container, props) {\n    return new TechnicalIndicatorOverlayView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制带边框的圆角填充矩形\n * @param ctx\n * @param fillColor\n * @param borderColor\n * @param borderSize\n * @param x\n * @param y\n * @param width\n * @param height\n * @param borderRadius\n */\nexport function renderStrokeFillRoundRect (\n  ctx, fillColor, borderColor, borderSize,\n  x, y, width, height, borderRadius\n) {\n  renderFillRoundRect(ctx, fillColor, x, y, width, height, borderRadius)\n  renderStrokeRoundRect(ctx, borderColor, borderSize, x, y, width, height, borderRadius)\n}\n\n/**\n * 绘制填充的矩形\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param width\n * @param height\n */\nexport function renderFillRect (ctx, color, x, y, width, height) {\n  ctx.fillStyle = color\n  ctx.fillRect(x, y, width, height)\n}\n\n/**\n * 绘制圆角空心矩形\n * @param ctx\n * @param borderColor\n * @param borderSize\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderStrokeRoundRect (ctx, borderColor, borderSize, x, y, w, h, r) {\n  ctx.lineWidth = borderSize\n  ctx.strokeStyle = borderColor\n  renderRoundRect(ctx, x, y, w, h, r)\n  ctx.stroke()\n}\n\n/**\n * 绘制填充圆角矩形\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderFillRoundRect (ctx, color, x, y, w, h, r) {\n  ctx.fillStyle = color\n  renderRoundRect(ctx, x, y, w, h, r)\n  ctx.fill()\n}\n\n/**\n * 绘制圆角矩形\n * @param ctx\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderRoundRect (ctx, x, y, w, h, r) {\n  ctx.beginPath()\n  ctx.moveTo(x + r, y)\n  ctx.arcTo(x + w, y, x + w, y + h, r)\n  ctx.arcTo(x + w, y + h, x, y + h, r)\n  ctx.arcTo(x, y + h, x, y, r)\n  ctx.arcTo(x, y, x + w, y, r)\n  ctx.closePath()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { YAxisType } from '../data/options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { isValid } from '../utils/typeChecks'\nimport { renderFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class YAxisView extends View {\n  constructor (container, chartData, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    const yAxisOptions = this._chartData.styleOptions().yAxis\n    if (yAxisOptions.show) {\n      this._drawAxisLine(yAxisOptions)\n      this._drawTickLines(yAxisOptions)\n      this._drawTickLabels(yAxisOptions)\n      this._drawTechnicalIndicatorLastValue(yAxisOptions)\n      this._drawLastPriceLabel(yAxisOptions)\n    }\n  }\n\n  _drawAxisLine (yAxisOptions) {\n    const axisLine = yAxisOptions.axisLine\n    if (!axisLine.show) {\n      return\n    }\n    this._ctx.strokeStyle = axisLine.color\n    this._ctx.lineWidth = axisLine.size\n    let x\n    if (this._yAxis.isFromYAxisZero()) {\n      x = 0\n    } else {\n      x = this._width - 1\n    }\n    renderVerticalLine(this._ctx, x, 0, this._height)\n  }\n\n  _drawTickLines (yAxisOptions) {\n    const tickLine = yAxisOptions.tickLine\n    if (!tickLine.show) {\n      return\n    }\n    this._ctx.lineWidth = tickLine.size\n    this._ctx.strokeStyle = tickLine.color\n\n    const tickLineLength = tickLine.length\n\n    let startX\n    let endX\n    if (this._yAxis.isFromYAxisZero()) {\n      startX = 0\n      if (yAxisOptions.axisLine.show) {\n        startX += yAxisOptions.axisLine.size\n      }\n      endX = startX + tickLineLength\n    } else {\n      startX = this._width\n      if (yAxisOptions.axisLine.show) {\n        startX -= yAxisOptions.axisLine.size\n      }\n      endX = startX - tickLineLength\n    }\n    this._yAxis.ticks().forEach(tick => {\n      renderHorizontalLine(this._ctx, tick.y, startX, endX)\n    })\n  }\n\n  _drawTickLabels (yAxisOptions) {\n    const tickText = yAxisOptions.tickText\n    if (!tickText.show) {\n      return\n    }\n    const tickLine = yAxisOptions.tickLine\n    const tickLineShow = tickLine.show\n    const tickLineLength = tickLine.length\n    let labelX\n    if (this._yAxis.isFromYAxisZero()) {\n      labelX = tickText.paddingLeft\n      if (yAxisOptions.axisLine.show) {\n        labelX += yAxisOptions.axisLine.size\n      }\n      if (tickLineShow) {\n        labelX += tickLineLength\n      }\n      this._ctx.textAlign = 'left'\n    } else {\n      labelX = this._width - tickText.paddingRight\n      if (yAxisOptions.axisLine.show) {\n        labelX -= yAxisOptions.axisLine.size\n      }\n      if (tickLineShow) {\n        labelX -= tickLineLength\n      }\n      this._ctx.textAlign = 'right'\n    }\n    this._ctx.textBaseline = 'middle'\n    this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family)\n    this._ctx.fillStyle = tickText.color\n    this._yAxis.ticks().forEach(tick => {\n      this._ctx.fillText(tick.v, labelX, tick.y)\n    })\n    this._ctx.textAlign = 'left'\n  }\n\n  /**\n   * 绘制技术指标最后值\n   * @param yAxisOptions\n   * @private\n   */\n  _drawTechnicalIndicatorLastValue (yAxisOptions) {\n    const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n    const lastValueMarkOptions = technicalIndicatorOptions.lastValueMark\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    if (!lastValueMarkOptions.show || !lastValueMarkOptions.text.show) {\n      return\n    }\n    const dataList = this._chartData.dataList()\n    technicalIndicators.forEach(technicalIndicator => {\n      const technicalIndicatorResult = technicalIndicator.result || []\n      const dataSize = technicalIndicatorResult.length\n      const technicalIndicatorData = technicalIndicatorResult[dataSize - 1] || {}\n      const plots = technicalIndicator.plots\n      const cbData = {\n        preData: { kLineData: dataList[dataSize - 2], technicalIndicatorData: technicalIndicatorResult[dataSize - 2] },\n        currentData: { kLineData: dataList[dataSize - 1], technicalIndicatorData },\n        nextData: { kLineData: null, technicalIndicatorData: null }\n      }\n      const precision = technicalIndicator.precision\n      const styles = technicalIndicator.styles || technicalIndicatorOptions\n      const colors = styles.line.colors || []\n      const colorSize = colors.length\n      let lineCount = 0\n      plots.forEach(plot => {\n        const value = technicalIndicatorData[plot.key]\n        let backgroundColor\n        switch (plot.type) {\n          case TechnicalIndicatorPlotType.CIRCLE: {\n            backgroundColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n            break\n          }\n          case TechnicalIndicatorPlotType.BAR: {\n            backgroundColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n            break\n          }\n          case TechnicalIndicatorPlotType.LINE: {\n            backgroundColor = colors[lineCount % colorSize]\n            lineCount++\n            break\n          }\n          default: { break }\n        }\n        if (isValid(value)) {\n          this._drawMarkLabel(\n            yAxisOptions, value, precision, technicalIndicator.shouldFormatBigNumber,\n            {\n              ...lastValueMarkOptions.text, backgroundColor\n            }\n          )\n        }\n      })\n    })\n  }\n\n  /**\n   * 绘制最新价文字\n   * @private\n   */\n  _drawLastPriceLabel (yAxisOptions) {\n    if (!this._yAxis.isCandleYAxis()) {\n      return\n    }\n    const priceMarkOptions = this._chartData.styleOptions().candle.priceMark\n    const lastPriceMarkOptions = priceMarkOptions.last\n    if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.text.show) {\n      return\n    }\n    const dataList = this._chartData.dataList()\n    const kLineData = dataList[dataList.length - 1]\n    if (!kLineData) {\n      return\n    }\n    const close = kLineData.close\n    const open = kLineData.open\n    let backgroundColor\n    if (close > open) {\n      backgroundColor = lastPriceMarkOptions.upColor\n    } else if (close < open) {\n      backgroundColor = lastPriceMarkOptions.downColor\n    } else {\n      backgroundColor = lastPriceMarkOptions.noChangeColor\n    }\n    this._drawMarkLabel(\n      yAxisOptions, close, this._chartData.pricePrecision(), false,\n      {\n        ...lastPriceMarkOptions.text, backgroundColor\n      }\n    )\n  }\n\n  /**\n   * 绘制标记label\n   * @param yAxisOptions\n   * @param value\n   * @param precision\n   * @param shouldFormatBigNumber\n   * @param size\n   * @param weight\n   * @param family\n   * @param color\n   * @param backgroundColor\n   * @param borderRadius\n   * @param paddingLeft\n   * @param paddingTop\n   * @param paddingRight\n   * @param paddingBottom\n   * @private\n   */\n  _drawMarkLabel (\n    yAxisOptions, value, precision, shouldFormatBigNumber,\n    {\n      size, weight, family, color, backgroundColor, borderRadius,\n      paddingLeft, paddingTop, paddingRight, paddingBottom\n    }\n  ) {\n    const valueY = this._yAxis.convertToNicePixel(value)\n    let text\n    if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n      const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n      const fromClose = fromData.close\n      text = `${((value - fromClose) / fromClose * 100).toFixed(2)}%`\n    } else {\n      text = formatPrecision(value, precision)\n      if (shouldFormatBigNumber) {\n        text = formatBigNumber(text)\n      }\n    }\n    this._ctx.font = createFont(size, weight, family)\n    const rectWidth = calcTextWidth(this._ctx, text) + paddingLeft + paddingRight\n    const rectHeight = paddingTop + size + paddingBottom\n    let rectStartX\n    if (this._yAxis.isFromYAxisZero()) {\n      rectStartX = 0\n    } else {\n      rectStartX = this._width - rectWidth\n    }\n    renderFillRoundRect(\n      this._ctx, backgroundColor,\n      rectStartX, valueY - paddingTop - size / 2, rectWidth, rectHeight, borderRadius\n    )\n    this._ctx.textBaseline = 'middle'\n    renderText(this._ctx, color, rectStartX + paddingLeft, valueY, text)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { YAxisType } from '../data/options/styleOptions'\nimport { renderStrokeFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class YAxisOverlayView extends View {\n  constructor (container, chartData, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    this._ctx.textBaseline = 'middle'\n    if (this._yAxis.isCandleYAxis()) {\n      // 绘制标签\n      const tags = this._chartData.tags()\n      tags.forEach(tag => {\n        tag.drawText(this._ctx)\n      })\n    }\n    this._drawCrossHairLabel()\n  }\n\n  _drawCrossHairLabel () {\n    const crosshair = this._chartData.crosshair()\n    if (crosshair.paneId !== this._additionalDataProvider.id() || this._chartData.dataList().length === 0) {\n      return\n    }\n    const styleOptions = this._chartData.styleOptions()\n    const crosshairOptions = styleOptions.crosshair\n    const crosshairHorizontalOptions = crosshairOptions.horizontal\n    const crosshairHorizontalTextOptions = crosshairHorizontalOptions.text\n    if (!crosshairOptions.show || !crosshairHorizontalOptions.show || !crosshairHorizontalTextOptions.show) {\n      return\n    }\n    const value = this._yAxis.convertFromPixel(crosshair.y)\n    let text\n    if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n      const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n      text = `${((value - fromData.close) / fromData.close * 100).toFixed(2)}%`\n    } else {\n      const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n      let precision = 0\n      let shouldFormatBigNumber = false\n      if (this._yAxis.isCandleYAxis()) {\n        precision = this._chartData.pricePrecision()\n      } else {\n        technicalIndicators.forEach(technicalIndicator => {\n          precision = Math.max(technicalIndicator.precision, precision)\n          if (!shouldFormatBigNumber) {\n            shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n          }\n        })\n      }\n      text = formatPrecision(value, precision)\n      if (shouldFormatBigNumber) {\n        text = formatBigNumber(text)\n      }\n    }\n    const textSize = crosshairHorizontalTextOptions.size\n    this._ctx.font = createFont(textSize, crosshairHorizontalTextOptions.weight, crosshairHorizontalTextOptions.family)\n    const yAxisDataLabelWidth = calcTextWidth(this._ctx, text)\n    let rectStartX\n\n    const paddingLeft = crosshairHorizontalTextOptions.paddingLeft\n    const paddingRight = crosshairHorizontalTextOptions.paddingRight\n    const paddingTop = crosshairHorizontalTextOptions.paddingTop\n    const paddingBottom = crosshairHorizontalTextOptions.paddingBottom\n    const borderSize = crosshairHorizontalTextOptions.borderSize\n\n    const rectWidth = yAxisDataLabelWidth + borderSize * 2 + paddingLeft + paddingRight\n    const rectHeight = textSize + borderSize * 2 + paddingTop + paddingBottom\n    if (this._yAxis.isFromYAxisZero()) {\n      rectStartX = 0\n    } else {\n      rectStartX = this._width - rectWidth\n    }\n\n    const rectY = crosshair.y - borderSize - paddingTop - textSize / 2\n    // 绘制y轴文字外的边框\n    renderStrokeFillRoundRect(\n      this._ctx, crosshairHorizontalTextOptions.backgroundColor,\n      crosshairHorizontalTextOptions.borderColor, borderSize,\n      rectStartX, rectY, rectWidth, rectHeight, crosshairHorizontalTextOptions.borderRadius\n    )\n    renderText(\n      this._ctx,\n      crosshairHorizontalTextOptions.color,\n      rectStartX + borderSize + paddingLeft,\n      crosshair.y,\n      text\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport YAxisView from '../view/YAxisView'\nimport YAxisOverlayView from '../view/YAxisOverlayView'\n\nexport default class YAxisWidget extends Widget {\n  _createMainView (container, props) {\n    return new YAxisView(container, props.chartData, props.yAxis, props.additionalDataProvider)\n  }\n\n  _createOverlayView (container, props) {\n    return new YAxisOverlayView(container, props.chartData, props.yAxis, props.additionalDataProvider)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\nimport { getPrecision, nice, round } from '../utils/number'\n\nexport default class Axis {\n  constructor (chartData) {\n    this._chartData = chartData\n    this._width = 0\n    this._height = 0\n    this._cacheMinValue = 0\n    this._cacheMaxValue = 0\n    this._minValue = 0\n    this._maxValue = 0\n    this._range = 0\n    this._ticks = []\n    this._initMeasureCanvas()\n  }\n\n  _initMeasureCanvas () {\n    const measureCanvas = document.createElement('canvas')\n    const pixelRatio = getPixelRatio(measureCanvas)\n    this._measureCtx = measureCanvas.getContext('2d')\n    this._measureCtx.scale(pixelRatio, pixelRatio)\n  }\n\n  min () {\n    return this._minValue\n  }\n\n  max () {\n    return this._maxValue\n  }\n\n  width () {\n    return this._width\n  }\n\n  height () {\n    return this._height\n  }\n\n  setWidth (width) {\n    this._width = width\n  }\n\n  setHeight (height) {\n    this._height = height\n  }\n\n  /**\n   * 获取ticks\n   * @returns {[]|*[]}\n   */\n  ticks () {\n    return this._ticks\n  }\n\n  /**\n   * 计算轴\n   * @param forceCompute\n   */\n  computeAxis (forceCompute) {\n    const minMax = this._optimalMinMax(this._computeMinMax())\n    this._minValue = minMax.min\n    this._maxValue = minMax.max\n    this._range = minMax.range\n    if (this._cacheMinValue !== minMax.min || this._cacheMaxValue !== minMax.max || forceCompute) {\n      this._cacheMinValue = minMax.min\n      this._cacheMaxValue = minMax.max\n      this._ticks = this._optimalTicks(this._computeTicks())\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 计算最大最小值\n   * @private\n   */\n  _computeMinMax () {}\n\n  /**\n   * 优化最大最小值\n   * @param min\n   * @param max\n   * @param precision\n   * @private\n   */\n  _optimalMinMax ({ min, max, precision }) {}\n\n  /**\n   * 计算轴上的tick值\n   */\n  _computeTicks () {\n    const ticks = []\n    if (this._range >= 0) {\n      const intervalPrecision = this._computeInterval(this._range)\n      const interval = intervalPrecision.interval\n      const precision = intervalPrecision.precision\n      const first = round(Math.ceil(this._minValue / interval) * interval, precision)\n      const last = round(Math.floor(this._maxValue / interval) * interval, precision)\n      let n = 0\n      let f = first\n\n      if (interval !== 0) {\n        while (f <= last) {\n          ticks[n] = { v: f.toFixed(precision) }\n          ++n\n          f += interval\n        }\n      }\n    }\n    return ticks\n  }\n\n  /**\n   * 计算最佳的tick\n   * @param ticks\n   */\n  _optimalTicks (ticks) {}\n\n  /**\n   * 计算间隔\n   * @private\n   */\n  _computeInterval (range) {\n    const interval = nice(range / 8.0)\n    const precision = getPrecision(interval)\n    return {\n      interval, precision\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Axis from './Axis'\nimport { CandleType, YAxisPosition, YAxisType } from '../data/options/styleOptions'\nimport { isNumber, isValid } from '../utils/typeChecks'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { round, log10, index10 } from '../utils/number'\n\nexport default class YAxis extends Axis {\n  constructor (chartData, isCandleYAxis, additionalDataProvider) {\n    super(chartData)\n    this._realRange = 0\n    this._isCandleYAxis = isCandleYAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _computeMinMax () {\n    const minMaxArray = [Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER]\n    const plotsResult = []\n    let shouldOhlc = false\n    let minValue = Number.MAX_SAFE_INTEGER\n    let maxValue = Number.MIN_SAFE_INTEGER\n    let technicalIndicatorPrecision = Number.MAX_SAFE_INTEGER\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    technicalIndicators.forEach(tech => {\n      if (!shouldOhlc) {\n        shouldOhlc = tech.shouldOhlc\n      }\n      technicalIndicatorPrecision = Math.min(technicalIndicatorPrecision, tech.precision)\n      if (isNumber(tech.minValue)) {\n        minValue = Math.min(minValue, tech.minValue)\n      }\n      if (isNumber(tech.maxValue)) {\n        maxValue = Math.max(maxValue, tech.maxValue)\n      }\n      plotsResult.push({\n        plots: tech.plots,\n        result: tech.result\n      })\n    })\n\n    let precision = 4\n    if (this._isCandleYAxis) {\n      const pricePrecision = this._chartData.pricePrecision()\n      if (technicalIndicatorPrecision !== Number.MAX_SAFE_INTEGER) {\n        precision = Math.min(technicalIndicatorPrecision, pricePrecision)\n      } else {\n        precision = pricePrecision\n      }\n    } else {\n      if (technicalIndicatorPrecision !== Number.MAX_SAFE_INTEGER) {\n        precision = technicalIndicatorPrecision\n      }\n    }\n    const visibleDataList = this._chartData.visibleDataList()\n    const candleOptions = this._chartData.styleOptions().candle\n    const isArea = candleOptions.type === CandleType.AREA\n    const areaValueKey = candleOptions.area.value\n    const shouldCompareHighLow = (this._isCandleYAxis && !isArea) || (!this._isCandleYAxis && shouldOhlc)\n    visibleDataList.forEach(({ index, data }) => {\n      if (shouldCompareHighLow) {\n        minMaxArray[0] = Math.min(minMaxArray[0], data.low)\n        minMaxArray[1] = Math.max(minMaxArray[1], data.high)\n      }\n      if (this._isCandleYAxis && isArea) {\n        minMaxArray[0] = Math.min(minMaxArray[0], data[areaValueKey])\n        minMaxArray[1] = Math.max(minMaxArray[1], data[areaValueKey])\n      }\n      plotsResult.forEach(({ plots, result }) => {\n        const technicalIndicatorData = result[index] || {}\n        plots.forEach(plot => {\n          const value = technicalIndicatorData[plot.key]\n          if (isValid(value)) {\n            minMaxArray[0] = Math.min(minMaxArray[0], value)\n            minMaxArray[1] = Math.max(minMaxArray[1], value)\n          }\n        })\n      })\n    })\n    if (minMaxArray[0] !== Number.MAX_SAFE_INTEGER && minMaxArray[1] !== Number.MIN_SAFE_INTEGER) {\n      minMaxArray[0] = Math.min(minValue, minMaxArray[0])\n      minMaxArray[1] = Math.max(maxValue, minMaxArray[1])\n    } else {\n      minMaxArray[0] = 0\n      minMaxArray[1] = 10\n    }\n    return { min: minMaxArray[0], max: minMaxArray[1], precision, specifyMin: minValue, specifyMax: maxValue }\n  }\n\n  _optimalMinMax ({ min, max, precision, specifyMin, specifyMax }) {\n    let minValue = min\n    let maxValue = max\n    const yAxisType = this.yAxisType()\n    let dif\n    switch (yAxisType) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          minValue = (minValue - fromData.close) / fromData.close * 100\n          maxValue = (maxValue - fromData.close) / fromData.close * 100\n        }\n        dif = Math.pow(10, -2)\n        break\n      }\n      case YAxisType.LOG: {\n        minValue = log10(minValue)\n        maxValue = log10(maxValue)\n        dif = 0.05 * index10(-precision)\n        break\n      }\n      default: {\n        dif = index10(-precision)\n      }\n    }\n    if (\n      minValue === maxValue ||\n      Math.abs(minValue - maxValue) < dif\n    ) {\n      const minCheck = specifyMin === minValue\n      const maxCheck = specifyMax === maxValue\n      minValue = minCheck ? minValue : (maxCheck ? minValue - 8 * dif : minValue - 4 * dif)\n      maxValue = maxCheck ? maxValue : (minCheck ? maxValue + 8 * dif : maxValue + 4 * dif)\n    }\n    let marginOptions\n    if (this._isCandleYAxis) {\n      marginOptions = this._chartData.styleOptions().candle.margin\n    } else {\n      marginOptions = this._chartData.styleOptions().technicalIndicator.margin\n    }\n    let topRate\n    let bottomRate\n    if (marginOptions.top > 1) {\n      topRate = marginOptions.top / this._height\n    } else {\n      topRate = isNumber(marginOptions.top) ? marginOptions.top : 0.2\n    }\n    if (marginOptions.bottom > 1) {\n      bottomRate = marginOptions.bottom / this._height\n    } else {\n      bottomRate = isNumber(marginOptions.bottom) ? marginOptions.bottom : 0.1\n    }\n    let range = Math.abs(maxValue - minValue)\n    // 保证每次图形绘制上下都留间隙\n    minValue = minValue - range * bottomRate\n    maxValue = maxValue + range * topRate\n\n    range = Math.abs(maxValue - minValue)\n    if (yAxisType === YAxisType.LOG) {\n      this._realRange = Math.abs(index10(maxValue) - index10(minValue))\n    } else {\n      this._realRange = range\n    }\n    return {\n      min: minValue,\n      max: maxValue,\n      range\n    }\n  }\n\n  _optimalTicks (ticks) {\n    const optimalTicks = []\n    const yAxisType = this.yAxisType()\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    let precision = 0\n    let shouldFormatBigNumber = false\n    if (this._isCandleYAxis) {\n      precision = this._chartData.pricePrecision()\n    } else {\n      technicalIndicators.forEach(technicalIndicator => {\n        precision = Math.max(precision, technicalIndicator.precision)\n        if (!shouldFormatBigNumber) {\n          shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n        }\n      })\n    }\n    const textHeight = this._chartData.styleOptions().xAxis.tickText.size\n    let intervalPrecision\n    if (yAxisType === YAxisType.LOG) {\n      intervalPrecision = this._computeInterval(this._realRange)\n    }\n    let validY\n    ticks.forEach(({ v }) => {\n      let value\n      let y = this._innerConvertToPixel(+v)\n      switch (yAxisType) {\n        case YAxisType.PERCENTAGE: {\n          value = `${formatPrecision(v, 2)}%`\n          break\n        }\n        case YAxisType.LOG: {\n          value = round(index10(v), intervalPrecision.precision)\n          y = this._innerConvertToPixel(log10(value))\n          value = formatPrecision(value, precision)\n          break\n        }\n        default: {\n          value = formatPrecision(v, precision)\n          if (shouldFormatBigNumber) {\n            value = formatBigNumber(value)\n          }\n          break\n        }\n      }\n      if (y > textHeight && y < this._height - textHeight && ((validY && (validY - y > textHeight * 2)) || !validY)) {\n        optimalTicks.push({ v: value, y })\n        validY = y\n      }\n    })\n    return optimalTicks\n  }\n\n  /**\n   * 内部值转换成坐标\n   * @param value\n   * @return {number}\n   * @private\n   */\n  _innerConvertToPixel (value) {\n    return Math.round((1.0 - (value - this._minValue) / this._range) * this._height)\n  }\n\n  /**\n   * 是否是蜡烛图轴\n   * @return {*}\n   */\n  isCandleYAxis () {\n    return this._isCandleYAxis\n  }\n\n  /**\n   * y轴类型\n   * @return {string|*}\n   */\n  yAxisType () {\n    if (this._isCandleYAxis) {\n      return this._chartData.styleOptions().yAxis.type\n    }\n    return YAxisType.NORMAL\n  }\n\n  /**\n   * 是否从y轴0开始\n   * @return {boolean|*|boolean}\n   */\n  isFromYAxisZero () {\n    const yAxisOptions = this._chartData.styleOptions().yAxis\n    return (\n      (yAxisOptions.position === YAxisPosition.LEFT && yAxisOptions.inside) ||\n      (yAxisOptions.position === YAxisPosition.RIGHT && !yAxisOptions.inside)\n    )\n  }\n\n  /**\n   * 获取自身宽度\n   * @return {number}\n   */\n  getSelfWidth () {\n    const styleOptions = this._chartData.styleOptions()\n    const yAxisOptions = styleOptions.yAxis\n    const width = yAxisOptions.width\n    if (isNumber(width)) {\n      return width\n    }\n    let yAxisWidth = 0\n    if (yAxisOptions.show) {\n      if (yAxisOptions.axisLine.show) {\n        yAxisWidth += yAxisOptions.axisLine.size\n      }\n      if (yAxisOptions.tickLine.show) {\n        yAxisWidth += yAxisOptions.tickLine.length\n      }\n      if (yAxisOptions.tickText.show) {\n        let textWidth = 0\n        this._measureCtx.font = createFont(yAxisOptions.tickText.size, yAxisOptions.tickText.weight, yAxisOptions.tickText.family)\n        this._ticks.forEach(tick => {\n          textWidth = Math.max(textWidth, calcTextWidth(this._measureCtx, tick.v))\n        })\n        yAxisWidth += (yAxisOptions.tickText.paddingLeft + yAxisOptions.tickText.paddingRight + textWidth)\n      }\n    }\n    const crosshairOptions = styleOptions.crosshair\n    let crosshairVerticalTextWidth = 0\n    if (\n      crosshairOptions.show &&\n      crosshairOptions.horizontal.show &&\n      crosshairOptions.horizontal.text.show\n    ) {\n      const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n      let technicalIndicatorPrecision = 0\n      let shouldFormatBigNumber = false\n      technicalIndicators.forEach(technicalIndicator => {\n        technicalIndicatorPrecision = Math.max(technicalIndicator.precision, technicalIndicatorPrecision)\n        if (!shouldFormatBigNumber) {\n          shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n        }\n      })\n      this._measureCtx.font = createFont(\n        crosshairOptions.horizontal.text.size,\n        crosshairOptions.horizontal.text.weight,\n        crosshairOptions.horizontal.text.family\n      )\n      let precision = 2\n      if (this.yAxisType() !== YAxisType.PERCENTAGE) {\n        if (this._isCandleYAxis) {\n          const pricePrecision = this._chartData.pricePrecision()\n          const lastValueMarkOptions = styleOptions.technicalIndicator.lastValueMark\n          if (lastValueMarkOptions.show && lastValueMarkOptions.text.show) {\n            precision = Math.max(technicalIndicatorPrecision, pricePrecision)\n          } else {\n            precision = pricePrecision\n          }\n        } else {\n          precision = technicalIndicatorPrecision\n        }\n      }\n      let valueText = formatPrecision(this._maxValue, precision)\n      if (shouldFormatBigNumber) {\n        valueText = formatBigNumber(valueText)\n      }\n      crosshairVerticalTextWidth += (\n        crosshairOptions.horizontal.text.paddingLeft +\n        crosshairOptions.horizontal.text.paddingRight +\n        crosshairOptions.horizontal.text.borderSize * 2 +\n        calcTextWidth(this._measureCtx, valueText)\n      )\n    }\n    return Math.max(yAxisWidth, crosshairVerticalTextWidth)\n  }\n\n  convertFromPixel (pixel) {\n    const value = (1.0 - pixel / this._height) * this._range + this._minValue\n    switch (this.yAxisType()) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          return fromData.close * value / 100 + fromData.close\n        }\n        break\n      }\n      case YAxisType.LOG: {\n        return index10(value)\n      }\n      default: {\n        return value\n      }\n    }\n  }\n\n  convertToPixel (value) {\n    let v\n    switch (this.yAxisType()) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          v = (value - fromData.close) / fromData.close * 100\n        }\n        break\n      }\n      case YAxisType.LOG: {\n        v = log10(value)\n        break\n      }\n      default: {\n        v = value\n      }\n    }\n    return this._innerConvertToPixel(v)\n  }\n\n  /**\n   * 将值转换成坐标，即使坐标不在范围内，也会显示在顶部或者底部\n   * @param value\n   * @return {number}\n   */\n  convertToNicePixel (value) {\n    const y = this.convertToPixel(value)\n    return Math.round(Math.max(this._height * 0.05, Math.min(y, this._height * 0.98)))\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Pane from './Pane'\nimport TechnicalIndicatorWidget from '../widget/TechnicalIndicatorWidget'\nimport YAxisWidget from '../widget/YAxisWidget'\nimport YAxis from '../component/YAxis'\n\nexport default class TechnicalIndicatorPane extends Pane {\n  constructor (props) {\n    super(props)\n    this._techs = new Map()\n    if ('height' in props) {\n      this.setHeight(props.height)\n    }\n    this.setTechnicalIndicator(this._chartData.getTechnicalIndicatorInstance(props.name))\n  }\n\n  _initBefore (props) {\n    this._id = props.id\n    this._yAxis = this._createYAxis(props)\n  }\n\n  _createYAxis (props) {\n    return new YAxis(\n      props.chartData,\n      false,\n      { technicalIndicators: this.technicalIndicators.bind(this) })\n  }\n\n  _createMainWidget (container, props) {\n    return new TechnicalIndicatorWidget({\n      container,\n      chartData: props.chartData,\n      xAxis: props.xAxis,\n      yAxis: this._yAxis,\n      additionalDataProvider: {\n        technicalIndicators: this.technicalIndicators.bind(this),\n        id: this.id.bind(this)\n      }\n    })\n  }\n\n  _createYAxisWidget (container, props) {\n    return new YAxisWidget({\n      container,\n      chartData: props.chartData,\n      yAxis: this._yAxis,\n      additionalDataProvider: {\n        technicalIndicators: this.technicalIndicators.bind(this),\n        id: this.id.bind(this)\n      }\n    })\n  }\n\n  setHeight (height) {\n    super.setHeight(height)\n    this._yAxis.setHeight(height)\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    super.setWidth(mainWidgetWidth, yAxisWidgetWidth)\n    this._yAxis.setWidth(yAxisWidgetWidth)\n  }\n\n  /**\n   * 获取id\n   * @returns {string}\n   */\n  id () {\n    return this._id\n  }\n\n  yAxis () {\n    return this._yAxis\n  }\n\n  /**\n   * 获取技术指标\n   * @return {Map<any, any>}\n   */\n  technicalIndicators () {\n    return this._techs\n  }\n\n  /**\n   * 是否无指标\n   * @return {boolean}\n   */\n  isEmptyTechnicalIndicator () {\n    return this._techs.size === 0\n  }\n\n  /**\n   * 移除技术指标\n   * @param name\n   * @return {boolean}\n   */\n  removeTechnicalIndicator (name) {\n    if (name) {\n      if (this._techs.has(name)) {\n        this._techs.delete(name)\n        return true\n      }\n    } else {\n      this._techs.clear()\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 设置技术指标类型\n   * @param technicalIndicator\n   * @param isStack\n   */\n  setTechnicalIndicator (technicalIndicator, isStack) {\n    if (technicalIndicator) {\n      if (this._techs.has(technicalIndicator.name)) {\n        return false\n      }\n      const cloneInstance = Object.create(technicalIndicator)\n      if (isStack) {\n        this._techs.set(cloneInstance.name, cloneInstance)\n      } else {\n        this._techs = new Map([[cloneInstance.name, cloneInstance]])\n      }\n      this.calcTechnicalIndicator(cloneInstance)\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 计算单个技术指标\n   * @param technicalIndicator\n   */\n  calcTechnicalIndicator (technicalIndicator) {\n    technicalIndicator.result = technicalIndicator.calcTechnicalIndicator(this._chartData.dataList(), technicalIndicator.calcParams, technicalIndicator.plots) || []\n  }\n\n  /**\n   * 计算所有技术指标\n   */\n  calcAllTechnicalIndicator () {\n    this._techs.forEach(technicalIndicator => {\n      this.calcTechnicalIndicator(technicalIndicator)\n    })\n    return this._yAxis.computeAxis()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorView from './TechnicalIndicatorView'\nimport { CandleType, LineStyle } from '../data/options/styleOptions'\nimport { renderHorizontalLine, renderLine } from '../renderer/line'\nimport { createFont } from '../utils/canvas'\nimport { formatPrecision, formatValue } from '../utils/format'\nimport { isArray, isNumber } from '../utils/typeChecks'\n\nexport default class CandleView extends TechnicalIndicatorView {\n  _draw () {\n    this._drawGrid()\n    const candleOptions = this._chartData.styleOptions().candle\n    if (candleOptions.type === CandleType.AREA) {\n      this._drawArea(candleOptions)\n    } else {\n      this._drawCandle(candleOptions)\n      this._drawLowHighPrice(\n        candleOptions.priceMark,\n        'high',\n        'high',\n        Number.MIN_SAFE_INTEGER,\n        [-2, -5],\n        (price, comparePrice) => {\n          if (price > comparePrice) {\n            return price\n          }\n        }\n      )\n      this._drawLowHighPrice(\n        candleOptions.priceMark,\n        'low',\n        'low',\n        Number.MAX_SAFE_INTEGER,\n        [2, 5],\n        (price, comparePrice) => {\n          if (price < comparePrice) {\n            return price\n          }\n        }\n      )\n    }\n    this._drawTechnicalIndicators()\n    this._drawLastPriceLine(candleOptions.priceMark)\n  }\n\n  /**\n   * 绘制面积图\n   * @param candleOptions\n   * @private\n   */\n  _drawArea (candleOptions) {\n    const linePoints = []\n    const areaPoints = []\n    let minY = Number.MAX_SAFE_INTEGER\n    const areaOptions = candleOptions.area\n    const onDrawing = (x, i, kLineData, halfBarSpace, barSpace, n) => {\n      const value = kLineData[areaOptions.value]\n      if (isNumber(value)) {\n        const y = this._yAxis.convertToPixel(value)\n        if (n === 0) {\n          const startX = x - halfBarSpace\n          areaPoints.push({ x: startX, y: this._height })\n          areaPoints.push({ x: startX, y })\n          linePoints.push({ x: startX, y })\n        }\n        linePoints.push({ x, y })\n        areaPoints.push({ x, y })\n        minY = Math.min(minY, y)\n      }\n    }\n    const onDrawEnd = () => {\n      const areaPointLength = areaPoints.length\n      if (areaPointLength > 0) {\n        const lastPoint = areaPoints[areaPointLength - 1]\n        const halfBarSpace = this._chartData.barSpace() / 2\n        const endX = lastPoint.x + halfBarSpace\n        linePoints.push({ x: endX, y: lastPoint.y })\n        areaPoints.push({ x: endX, y: lastPoint.y })\n        areaPoints.push({ x: endX, y: this._height })\n      }\n\n      if (linePoints.length > 0) {\n        // 绘制分时线\n        this._ctx.lineWidth = areaOptions.lineSize\n        this._ctx.strokeStyle = areaOptions.lineColor\n        renderLine(this._ctx, () => {\n          this._ctx.beginPath()\n          this._ctx.moveTo(linePoints[0].x, linePoints[0].y)\n          for (let i = 1; i < linePoints.length; i++) {\n            this._ctx.lineTo(linePoints[i].x, linePoints[i].y)\n          }\n          this._ctx.stroke()\n          this._ctx.closePath()\n        })\n      }\n\n      if (areaPoints.length > 0) {\n        // 绘制分时线填充区域\n        const fillColor = areaOptions.fillColor\n        if (isArray(fillColor)) {\n          const gradient = this._ctx.createLinearGradient(0, this._height, 0, minY)\n          try {\n            fillColor.forEach(({ offset, color }) => {\n              gradient.addColorStop(offset, color)\n            })\n          } catch (e) {\n          }\n          this._ctx.fillStyle = gradient\n        } else {\n          this._ctx.fillStyle = fillColor\n        }\n        this._ctx.beginPath()\n        this._ctx.moveTo(areaPoints[0].x, areaPoints[0].y)\n        for (let i = 1; i < areaPoints.length; i++) {\n          this._ctx.lineTo(areaPoints[i].x, areaPoints[i].y)\n        }\n        this._ctx.closePath()\n        this._ctx.fill()\n      }\n    }\n    this._drawGraphics(onDrawing, onDrawEnd)\n  }\n\n  /**\n   * 绘制蜡烛\n   * @param candleOptions\n   * @private\n   */\n  _drawCandle (candleOptions) {\n    this._drawGraphics((x, i, kLineData, halfBarSpace, barSpace) => {\n      this._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, candleOptions.bar, candleOptions.type)\n    })\n  }\n\n  /**\n   * 渲染最高最低价格\n   * @param priceMarkOptions\n   * @param optionKey\n   * @param priceKey\n   * @param initPriceValue\n   * @param offsets\n   * @param compare\n   * @private\n   */\n  _drawLowHighPrice (priceMarkOptions, optionKey, priceKey, initPriceValue, offsets, compare) {\n    const lowHighPriceMarkOptions = priceMarkOptions[optionKey]\n    if (!priceMarkOptions.show || !lowHighPriceMarkOptions.show) {\n      return\n    }\n    const visibleDataList = this._chartData.visibleDataList()\n    let price = initPriceValue\n    let pos = -1\n    visibleDataList.forEach(({ index, data }) => {\n      const comparePrice = compare(formatValue(data, priceKey, initPriceValue), price)\n      if (comparePrice) {\n        price = comparePrice\n        pos = index\n      }\n    })\n    const pricePrecision = this._chartData.pricePrecision()\n    const priceY = this._yAxis.convertToPixel(price)\n    const startX = this._xAxis.convertToPixel(pos)\n    const startY = priceY + offsets[0]\n    this._ctx.textAlign = 'left'\n    this._ctx.lineWidth = 1\n    this._ctx.strokeStyle = lowHighPriceMarkOptions.color\n    this._ctx.fillStyle = lowHighPriceMarkOptions.color\n\n    renderLine(this._ctx, () => {\n      this._ctx.beginPath()\n      this._ctx.moveTo(startX - 2, startY + offsets[0])\n      this._ctx.lineTo(startX, startY)\n      this._ctx.lineTo(startX + 2, startY + offsets[0])\n      this._ctx.stroke()\n      this._ctx.closePath()\n    })\n\n    // 绘制竖线\n    const y = startY + offsets[1]\n    renderLine(this._ctx, () => {\n      this._ctx.beginPath()\n      this._ctx.moveTo(startX, startY)\n      this._ctx.lineTo(startX, y)\n      this._ctx.lineTo(startX + 5, y)\n      this._ctx.stroke()\n      this._ctx.closePath()\n    })\n\n    this._ctx.font = createFont(lowHighPriceMarkOptions.textSize, lowHighPriceMarkOptions.textWeight, lowHighPriceMarkOptions.textFamily)\n    const text = formatPrecision(price, pricePrecision)\n    this._ctx.textBaseline = 'middle'\n    this._ctx.fillText(text, startX + 5 + lowHighPriceMarkOptions.textMargin, y)\n  }\n\n  /**\n   * 绘制最新价线\n   * @param priceMarkOptions\n   * @private\n   */\n  _drawLastPriceLine (priceMarkOptions) {\n    const lastPriceMarkOptions = priceMarkOptions.last\n    if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.line.show) {\n      return\n    }\n    const dataList = this._chartData.dataList()\n    const kLineData = dataList[dataList.length - 1]\n    if (!kLineData) {\n      return\n    }\n    const close = kLineData.close\n    const open = kLineData.open\n    const priceY = this._yAxis.convertToNicePixel(close)\n    let color\n    if (close > open) {\n      color = lastPriceMarkOptions.upColor\n    } else if (close < open) {\n      color = lastPriceMarkOptions.downColor\n    } else {\n      color = lastPriceMarkOptions.noChangeColor\n    }\n    this._ctx.save()\n    this._ctx.strokeStyle = color\n    this._ctx.lineWidth = lastPriceMarkOptions.line.size\n    if (lastPriceMarkOptions.line.style === LineStyle.DASH) {\n      this._ctx.setLineDash(lastPriceMarkOptions.line.dashValue)\n    }\n    renderHorizontalLine(this._ctx, priceY, 0, this._width)\n    this._ctx.restore()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorOverlayView from './TechnicalIndicatorOverlayView'\nimport { isFunction, isObject, isArray, isValid } from '../utils/typeChecks'\nimport { formatBigNumber, formatDate, formatPrecision, formatValue } from '../utils/format'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { TooltipShowType } from '../data/options/styleOptions'\nimport { getTechnicalIndicatorTooltipData } from '../base/technicalindicator/technicalIndicatorControl'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { renderFillRoundRect, renderStrokeRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class CandleOverlayView extends TechnicalIndicatorOverlayView {\n  _drawCover () {\n    this._ctx.textBaseline = 'alphabetic'\n    // 绘制标签\n    const tags = this._chartData.tags()\n    tags.forEach(tag => {\n      tag.drawMarkLine(this._ctx)\n    })\n    // 绘制图形标记\n    const graphicMarks = this._chartData.graphicMarks()\n    graphicMarks.forEach(graphicMark => {\n      graphicMark.draw(this._ctx)\n    })\n    // 绘制注解\n    const annotations = this._chartData.visibleAnnotations()\n    annotations.forEach(annotation => {\n      annotation.draw(this._ctx)\n    })\n  }\n\n  _drawTooltip (crosshair, technicalIndicators) {\n    const styleOptions = this._chartData.styleOptions()\n    const candleOptions = styleOptions.candle\n    const candleTooltipOptions = candleOptions.tooltip\n    const technicalIndicatorOptions = styleOptions.technicalIndicator\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n    const isDrawCandleTooltip = this._shouldDrawTooltip(crosshair, candleTooltipOptions)\n    const isDrawTechnicalIndicatorTooltip = this._shouldDrawTooltip(crosshair, technicalIndicatorTooltipOptions)\n    if (\n      candleTooltipOptions.showType === TooltipShowType.RECT &&\n      technicalIndicatorTooltipOptions.showType === TooltipShowType.RECT\n    ) {\n      this._drawCandleTooltipWithRect(\n        crosshair,\n        technicalIndicators,\n        candleOptions,\n        isDrawCandleTooltip,\n        technicalIndicatorOptions,\n        isDrawTechnicalIndicatorTooltip\n      )\n    } else {\n      if (candleTooltipOptions.showType === TooltipShowType.STANDARD) {\n        this._drawCandleTooltipWithStandard(crosshair.kLineData, candleOptions, isDrawCandleTooltip)\n        if (technicalIndicatorTooltipOptions.showType === TooltipShowType.STANDARD) {\n          const offsetTop = isDrawCandleTooltip ? candleTooltipOptions.text.size + candleTooltipOptions.text.marginTop : 0\n          this._drawBatchTechnicalIndicatorToolTip(\n            crosshair,\n            technicalIndicators,\n            technicalIndicatorOptions,\n            offsetTop,\n            isDrawTechnicalIndicatorTooltip\n          )\n        } else {\n          this._drawCandleTooltipWithRect(\n            crosshair,\n            technicalIndicators,\n            candleOptions,\n            false,\n            technicalIndicatorOptions,\n            isDrawTechnicalIndicatorTooltip\n          )\n        }\n      } else {\n        this._drawCandleTooltipWithRect(\n          crosshair,\n          technicalIndicators,\n          candleOptions,\n          isDrawCandleTooltip,\n          technicalIndicatorOptions,\n          false\n        )\n        this._drawBatchTechnicalIndicatorToolTip(\n          crosshair,\n          technicalIndicators,\n          technicalIndicatorOptions,\n          0,\n          isDrawTechnicalIndicatorTooltip\n        )\n      }\n    }\n  }\n\n  /**\n   * 绘制蜡烛默认的图例\n   * @param kLineData\n   * @param candleOptions\n   * @param isDrawCandleTooltip\n   * @private\n   */\n  _drawCandleTooltipWithStandard (kLineData, candleOptions, isDrawCandleTooltip) {\n    if (!isDrawCandleTooltip) {\n      return\n    }\n    const values = this._getCandleTooltipData(kLineData, candleOptions)\n    const candleTooltipOptions = candleOptions.tooltip\n    const textMarginLeft = candleTooltipOptions.text.marginLeft\n    const textMarginRight = candleTooltipOptions.text.marginRight\n    const textSize = candleTooltipOptions.text.size\n    const textColor = candleTooltipOptions.text.color\n    const labels = candleTooltipOptions.labels\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(textSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family)\n    let labelX = textMarginLeft\n    const labelY = candleTooltipOptions.text.marginTop\n    labels.forEach((label, i) => {\n      const labelWidth = calcTextWidth(this._ctx, label)\n      renderText(this._ctx, textColor, labelX, labelY, label)\n      labelX += labelWidth\n\n      const value = values[i] || candleTooltipOptions.defaultValue\n      let valueText\n      let valueColor\n      if (isObject(value)) {\n        valueText = value.value || candleTooltipOptions.defaultValue\n        valueColor = value.color || textColor\n      } else {\n        valueColor = textColor\n        valueText = value\n      }\n      const textWidth = calcTextWidth(this._ctx, valueText)\n      renderText(this._ctx, valueColor, labelX, labelY, valueText)\n      labelX += (textWidth + textMarginLeft + textMarginRight)\n    })\n  }\n\n  /**\n   * 绘制蜡烛图矩形类型图例\n   * @param crosshair\n   * @param technicalIndicators\n   * @param candleOptions\n   * @param isDrawCandleTooltip\n   * @param technicalIndicatorOptions\n   * @param isDrawTechnicalIndicatorTooltip\n   * @private\n   */\n  _drawCandleTooltipWithRect (\n    crosshair, technicalIndicators, candleOptions, isDrawCandleTooltip,\n    technicalIndicatorOptions, isDrawTechnicalIndicatorTooltip\n  ) {\n    if (!isDrawCandleTooltip && !isDrawTechnicalIndicatorTooltip) {\n      return\n    }\n    const candleTooltipOptions = candleOptions.tooltip\n    const baseLabels = candleTooltipOptions.labels\n    const baseValues = this._getCandleTooltipData(crosshair.kLineData, candleOptions)\n    const baseTextMarginLeft = candleTooltipOptions.text.marginLeft\n    const baseTextMarginRight = candleTooltipOptions.text.marginRight\n    const baseTextMarginTop = candleTooltipOptions.text.marginTop\n    const baseTextMarginBottom = candleTooltipOptions.text.marginBottom\n    const baseTextSize = candleTooltipOptions.text.size\n    const baseTextColor = candleTooltipOptions.text.color\n\n    const rectOptions = candleTooltipOptions.rect\n    const rectBorderSize = rectOptions.borderSize\n    const rectPaddingLeft = rectOptions.paddingLeft\n    const rectPaddingRight = rectOptions.paddingRight\n    const rectPaddingTop = rectOptions.paddingTop\n    const rectPaddingBottom = rectOptions.paddingBottom\n    const rectLeft = rectOptions.offsetLeft\n    const rectRight = rectOptions.offsetRight\n\n    let maxLabelWidth = 0\n    let rectWidth = 0\n    let rectHeight = 0\n    this._ctx.save()\n    this._ctx.textBaseline = 'top'\n    if (isDrawCandleTooltip) {\n      this._ctx.font = createFont(baseTextSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family)\n      baseLabels.forEach((label, i) => {\n        const value = baseValues[i]\n        let v\n        if (isObject(value)) {\n          v = value.value || candleTooltipOptions.defaultValue\n        } else {\n          v = value\n        }\n        const text = `${label}${v}`\n        const labelWidth = calcTextWidth(this._ctx, text) + baseTextMarginLeft + baseTextMarginRight\n        maxLabelWidth = Math.max(maxLabelWidth, labelWidth)\n      })\n      rectHeight += ((baseTextMarginBottom + baseTextMarginTop + baseTextSize) * baseLabels.length)\n    }\n\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n\n    const indicatorTextMarginLeft = technicalIndicatorTooltipOptions.text.marginLeft\n    const indicatorTextMarginRight = technicalIndicatorTooltipOptions.text.marginRight\n    const indicatorTextMarginTop = technicalIndicatorTooltipOptions.text.marginTop\n    const indicatorTextMarginBottom = technicalIndicatorTooltipOptions.text.marginBottom\n    const indicatorTextSize = technicalIndicatorTooltipOptions.text.size\n\n    const indicatorTooltipDataList = []\n    const dataList = this._chartData.dataList()\n    technicalIndicators.forEach(tech => {\n      const result = tech.result\n      indicatorTooltipDataList.push({\n        name: tech.name,\n        tooltipData: getTechnicalIndicatorTooltipData(result[crosshair.dataIndex], tech),\n        cbData: {\n          preData: { kLineData: dataList[crosshair.dataIndex - 1], technicalIndicatorData: result[crosshair.dataIndex - 1] },\n          currentData: { kLineData: dataList[crosshair.dataIndex], technicalIndicatorData: result[crosshair.dataIndex] },\n          nextData: { kLineData: dataList[crosshair.dataIndex + 1], technicalIndicatorData: result[crosshair.dataIndex + 1] }\n        }\n      })\n    })\n    if (isDrawTechnicalIndicatorTooltip) {\n      this._ctx.font = createFont(\n        indicatorTextSize,\n        technicalIndicatorTooltipOptions.text.weight,\n        technicalIndicatorTooltipOptions.text.family\n      )\n      indicatorTooltipDataList.forEach(({ tooltipData }) => {\n        tooltipData.values.forEach(({ title, value }) => {\n          if (isValid(title)) {\n            const v = value || technicalIndicatorTooltipOptions.defaultValue\n            const text = `${title}${v}`\n            const labelWidth = calcTextWidth(this._ctx, text) + indicatorTextMarginLeft + indicatorTextMarginRight\n            maxLabelWidth = Math.max(maxLabelWidth, labelWidth)\n            rectHeight += (indicatorTextMarginTop + indicatorTextMarginBottom + indicatorTextSize)\n          }\n        })\n      })\n    }\n    rectWidth += maxLabelWidth\n    if (rectWidth === 0 || rectHeight === 0) {\n      return\n    }\n    rectWidth += (rectBorderSize * 2 + rectPaddingLeft + rectPaddingRight)\n    rectHeight += (rectBorderSize * 2 + rectPaddingTop + rectPaddingBottom)\n    const centerX = this._width / 2\n    let rectX\n    if (crosshair.realX < centerX) {\n      rectX = this._width - rectRight - rectWidth\n    } else {\n      rectX = rectLeft\n    }\n    const rectY = rectOptions.offsetTop\n    const radius = rectOptions.borderRadius\n    renderFillRoundRect(this._ctx, rectOptions.fillColor, rectX, rectY, rectWidth, rectHeight, radius)\n    renderStrokeRoundRect(this._ctx, rectOptions.borderColor, rectBorderSize, rectX, rectY, rectWidth, rectHeight, radius)\n    const baseLabelX = rectX + rectBorderSize + rectPaddingLeft + baseTextMarginLeft\n    let labelY = rectY + rectBorderSize + rectPaddingTop\n    if (isDrawCandleTooltip) {\n      // 开始渲染基础数据文字\n      this._ctx.font = createFont(\n        baseTextSize,\n        candleTooltipOptions.text.weight,\n        candleTooltipOptions.text.family\n      )\n      baseLabels.forEach((label, i) => {\n        labelY += baseTextMarginTop\n        this._ctx.textAlign = 'left'\n        renderText(this._ctx, baseTextColor, baseLabelX, labelY, label)\n\n        const value = baseValues[i]\n        let text\n        let color\n        if (isObject(value)) {\n          color = value.color || baseTextColor\n          text = value.value || candleTooltipOptions.defaultValue\n        } else {\n          color = baseTextColor\n          text = value || candleTooltipOptions.defaultValue\n        }\n        this._ctx.textAlign = 'right'\n        renderText(\n          this._ctx,\n          color,\n          rectX + rectWidth - rectBorderSize - baseTextMarginRight - rectPaddingRight,\n          labelY,\n          text\n        )\n        labelY += (baseTextSize + baseTextMarginBottom)\n      })\n    }\n    if (isDrawTechnicalIndicatorTooltip) {\n      // 开始渲染指标数据文字\n      const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n      const indicatorLabelX = rectX + rectBorderSize + rectPaddingLeft + indicatorTextMarginLeft\n      this._ctx.font = createFont(\n        indicatorTextSize,\n        technicalIndicatorTooltipOptions.text.weight,\n        technicalIndicatorTooltipOptions.text.family\n      )\n      indicatorTooltipDataList.forEach(({ name, tooltipData, cbData }) => {\n        const tech = technicalIndicators.get(name)\n        const styles = tech.styles || technicalIndicatorOptions\n        const colors = styles.line.colors\n        const colorSize = colors.length\n        const plots = tech.plots\n        let lineCount = 0\n        let valueColor\n        plots.forEach((plot, i) => {\n          switch (plot.type) {\n            case TechnicalIndicatorPlotType.CIRCLE: {\n              valueColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n              break\n            }\n            case TechnicalIndicatorPlotType.BAR: {\n              valueColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n              break\n            }\n            case TechnicalIndicatorPlotType.LINE: {\n              valueColor = colors[lineCount % colorSize] || styles.text.color\n              lineCount++\n              break\n            }\n            default: { break }\n          }\n          const value = tooltipData.values[i]\n          if (isValid(value.title)) {\n            labelY += indicatorTextMarginTop\n            this._ctx.textAlign = 'left'\n            this._ctx.fillStyle = valueColor\n            this._ctx.fillText(`${value.title}`, indicatorLabelX, labelY)\n\n            this._ctx.textAlign = 'right'\n            this._ctx.fillText(\n              value.value || technicalIndicatorTooltipOptions.defaultValue,\n              rectX + rectWidth - rectBorderSize - indicatorTextMarginRight - rectPaddingRight,\n              labelY\n            )\n            labelY += (indicatorTextSize + indicatorTextMarginBottom)\n          }\n        })\n      })\n    }\n    this._ctx.restore()\n  }\n\n  /**\n   * 获取蜡烛提示数据\n   * @param kLineData\n   * @param candleOptions\n   * @returns {*}\n   * @private\n   */\n  _getCandleTooltipData (kLineData, candleOptions) {\n    const baseValues = candleOptions.tooltip.values\n    let values = []\n    if (baseValues) {\n      if (isFunction(baseValues)) {\n        values = baseValues(kLineData, candleOptions) || []\n      } else if (isArray(baseValues)) {\n        values = baseValues\n      }\n    } else {\n      const pricePrecision = this._chartData.pricePrecision()\n      const volumePrecision = this._chartData.volumePrecision()\n      values = [\n        formatValue(kLineData, 'timestamp'),\n        formatValue(kLineData, 'open'),\n        formatValue(kLineData, 'close'),\n        formatValue(kLineData, 'high'),\n        formatValue(kLineData, 'low'),\n        formatValue(kLineData, 'volume')\n      ]\n      values.forEach((value, index) => {\n        switch (index) {\n          case 0: {\n            values[index] = formatDate(this._chartData.dateTimeFormat(), value, 'YYYY-MM-DD hh:mm')\n            break\n          }\n          case values.length - 1: {\n            values[index] = formatBigNumber(formatPrecision(value, volumePrecision))\n            break\n          }\n          default: {\n            values[index] = formatPrecision(value, pricePrecision)\n            break\n          }\n        }\n      })\n    }\n    return values\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CandleView from '../view/CandleView'\nimport CandleOverlayView from '../view/CandleOverlayView'\nimport TechnicalIndicatorWidget from './TechnicalIndicatorWidget'\n\nexport default class CandleWidget extends TechnicalIndicatorWidget {\n  _createMainView (container, props) {\n    return new CandleView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n\n  _createOverlayView (container, props) {\n    return new CandleOverlayView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorPane from './TechnicalIndicatorPane'\nimport CandleWidget from '../widget/CandleWidget'\nimport YAxis from '../component/YAxis'\n\nexport default class CandlePane extends TechnicalIndicatorPane {\n  _createYAxis (props) {\n    return new YAxis(\n      props.chartData, true,\n      { technicalIndicators: this.technicalIndicators.bind(this) }\n    )\n  }\n\n  _createMainWidget (container, props) {\n    return new CandleWidget({\n      container,\n      chartData: props.chartData,\n      xAxis: props.xAxis,\n      yAxis: this._yAxis,\n      additionalDataProvider: {\n        technicalIndicators: this.technicalIndicators.bind(this),\n        id: this.id.bind(this)\n      }\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { createFont } from '../utils/canvas'\n\nexport default class XAxisView extends View {\n  constructor (container, chartData, xAxis) {\n    super(container, chartData)\n    this._xAxis = xAxis\n  }\n\n  _draw () {\n    const xAxisOptions = this._chartData.styleOptions().xAxis\n    if (xAxisOptions.show) {\n      this._drawAxisLine(xAxisOptions)\n      this._drawTickLines(xAxisOptions)\n      this._drawTickLabels(xAxisOptions)\n    }\n  }\n\n  _drawAxisLine (xAxisOptions) {\n    const xAxisLine = xAxisOptions.axisLine\n    if (!xAxisLine.show) {\n      return\n    }\n    this._ctx.strokeStyle = xAxisLine.color\n    this._ctx.lineWidth = xAxisLine.size\n    renderHorizontalLine(this._ctx, 0, 0, this._width)\n  }\n\n  _drawTickLines (xAxisOptions) {\n    const tickLine = xAxisOptions.tickLine\n    if (!tickLine.show) {\n      return\n    }\n    this._ctx.lineWidth = tickLine.size\n    this._ctx.strokeStyle = tickLine.color\n\n    const startY = xAxisOptions.axisLine.show ? xAxisOptions.axisLine.size : 0\n\n    const endY = startY + tickLine.length\n    this._xAxis.ticks().forEach(tick => {\n      renderVerticalLine(this._ctx, tick.x, startY, endY)\n    })\n  }\n\n  _drawTickLabels (xAxisOptions) {\n    const tickText = xAxisOptions.tickText\n    if (!tickText.show) {\n      return\n    }\n    const tickLine = xAxisOptions.tickLine\n\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family)\n    this._ctx.textAlign = 'center'\n    this._ctx.fillStyle = tickText.color\n\n    let labelY = tickText.paddingTop\n    if (xAxisOptions.axisLine.show) {\n      labelY += (xAxisOptions.axisLine.size)\n    }\n    if (tickLine.show) {\n      labelY += (tickLine.length)\n    }\n    const ticks = this._xAxis.ticks()\n    const tickLength = ticks.length\n    for (let i = 0; i < tickLength; i++) {\n      this._ctx.fillText(ticks[i].v, ticks[i].x, labelY)\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\n\nimport { formatDate } from '../utils/format'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { renderStrokeFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class XAxisOverlayView extends View {\n  constructor (container, chartData, xAxis) {\n    super(container, chartData)\n    this._xAxis = xAxis\n  }\n\n  _draw () {\n    this._drawCrosshairLabel()\n  }\n\n  _drawCrosshairLabel () {\n    const crosshair = this._chartData.crosshair()\n    if (!crosshair.paneId) {\n      return\n    }\n    const crosshairOptions = this._chartData.styleOptions().crosshair\n    const crosshairVerticalOptions = crosshairOptions.vertical\n    const crosshairVerticalTextOptions = crosshairVerticalOptions.text\n    if (\n      !crosshairOptions.show ||\n      !crosshairVerticalOptions.show ||\n      !crosshairVerticalTextOptions.show ||\n      crosshair.dataIndex !== crosshair.realDataIndex\n    ) {\n      return\n    }\n    const x = crosshair.realX\n    const timestamp = crosshair.kLineData.timestamp\n    const text = formatDate(this._chartData.dateTimeFormat(), timestamp, 'YYYY-MM-DD hh:mm')\n\n    const textSize = crosshairVerticalTextOptions.size\n    this._ctx.font = createFont(textSize, crosshairVerticalTextOptions.weight, crosshairVerticalTextOptions.family)\n    const labelWidth = calcTextWidth(this._ctx, text)\n    let labelX = x - labelWidth / 2\n\n    const paddingLeft = crosshairVerticalTextOptions.paddingLeft\n    const paddingRight = crosshairVerticalTextOptions.paddingRight\n    const paddingTop = crosshairVerticalTextOptions.paddingTop\n    const paddingBottom = crosshairVerticalTextOptions.paddingBottom\n    const borderSize = crosshairVerticalTextOptions.borderSize\n\n    // 保证整个x轴上的提示文字总是完全显示\n    if (labelX < paddingLeft + borderSize) {\n      labelX = paddingLeft + borderSize\n    } else if (labelX > this._width - labelWidth - borderSize - paddingRight) {\n      labelX = this._width - labelWidth - borderSize - paddingRight\n    }\n\n    const rectX = labelX - borderSize - paddingLeft\n    const rectWidth = labelWidth + borderSize * 2 + paddingRight + paddingLeft\n    const rectHeight = textSize + borderSize * 2 + paddingTop + paddingBottom\n\n    renderStrokeFillRoundRect(\n      this._ctx, crosshairVerticalTextOptions.backgroundColor,\n      crosshairVerticalTextOptions.borderColor, borderSize,\n      rectX, 0, rectWidth, rectHeight, crosshairVerticalTextOptions.borderRadius\n    )\n    // 绘制轴上的提示文字\n    this._ctx.textBaseline = 'top'\n    renderText(\n      this._ctx, crosshairVerticalTextOptions.color,\n      labelX, borderSize + paddingTop, text\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport XAxisView from '../view/XAxisView'\nimport XAxisOverlayView from '../view/XAxisOverlayView'\n\nexport default class XAxisWidget extends Widget {\n  _createMainView (container, props) {\n    return new XAxisView(container, props.chartData, props.xAxis)\n  }\n\n  _createOverlayView (container, props) {\n    return new XAxisOverlayView(container, props.chartData, props.xAxis)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Axis from './Axis'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { formatDate } from '../utils/format'\nimport { isNumber } from '../utils/typeChecks'\n\nexport default class XAxis extends Axis {\n  _computeMinMax () {\n    return { min: this._chartData.from(), max: this._chartData.to() - 1 }\n  }\n\n  _optimalMinMax ({ min, max }) {\n    return {\n      min,\n      max,\n      range: max - min + 1\n    }\n  }\n\n  _optimalTicks (ticks) {\n    const optimalTicks = []\n    const tickLength = ticks.length\n    const dataList = this._chartData.dataList()\n    if (tickLength > 0) {\n      const dateTimeFormat = this._chartData.dateTimeFormat()\n      const tickText = this._chartData.styleOptions().xAxis.tickText\n      this._measureCtx.font = createFont(tickText.size, tickText.weight, tickText.family)\n      const defaultLabelWidth = calcTextWidth(this._measureCtx, '00-00 00:00')\n      const pos = parseInt(ticks[0].v, 10)\n      const x = this.convertToPixel(pos)\n      let tickCountDif = 1\n      if (tickLength > 1) {\n        const nextPos = parseInt(ticks[1].v, 10)\n        const nextX = this.convertToPixel(nextPos)\n        const xDif = Math.abs(nextX - x)\n        if (xDif < defaultLabelWidth) {\n          tickCountDif = Math.ceil(defaultLabelWidth / xDif)\n        }\n      }\n      for (let i = 0; i < tickLength; i += tickCountDif) {\n        const pos = parseInt(ticks[i].v, 10)\n        const kLineData = dataList[pos]\n        const timestamp = kLineData.timestamp\n        let label = formatDate(dateTimeFormat, timestamp, 'hh:mm')\n        if (i !== 0) {\n          const prePos = parseInt(ticks[i - tickCountDif].v, 10)\n          const preKLineData = dataList[prePos]\n          const preTimestamp = preKLineData.timestamp\n          label = this._optimalTickLabel(dateTimeFormat, timestamp, preTimestamp) || label\n        }\n        const x = this.convertToPixel(pos)\n        optimalTicks.push({ v: label, x, oV: timestamp })\n      }\n      const optimalTickLength = optimalTicks.length\n      if (optimalTickLength === 1) {\n        optimalTicks[0].v = formatDate(dateTimeFormat, optimalTicks[0].oV, 'YYYY-MM-DD hh:mm')\n      } else {\n        const firstTimestamp = optimalTicks[0].oV\n        const secondTimestamp = optimalTicks[1].oV\n        if (optimalTicks[2]) {\n          const thirdV = optimalTicks[2].v\n          if (/^[0-9]{2}-[0-9]{2}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'MM-DD')\n          } else if (/^[0-9]{4}-[0-9]{2}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY-MM')\n          } else if (/^[0-9]{4}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY')\n          }\n        } else {\n          optimalTicks[0].v = this._optimalTickLabel(dateTimeFormat, firstTimestamp, secondTimestamp) || optimalTicks[0].v\n        }\n      }\n    }\n    return optimalTicks\n  }\n\n  _optimalTickLabel (dateTimeFormat, timestamp, comparedTimestamp) {\n    const year = formatDate(dateTimeFormat, timestamp, 'YYYY')\n    const month = formatDate(dateTimeFormat, timestamp, 'YYYY-MM')\n    const day = formatDate(dateTimeFormat, timestamp, 'MM-DD')\n    if (year !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY')) {\n      return year\n    } else if (month !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY-MM')) {\n      return month\n    } else if (day !== formatDate(dateTimeFormat, comparedTimestamp, 'MM-DD')) {\n      return day\n    }\n    return null\n  }\n\n  /**\n   * 获取自身高度\n   */\n  getSelfHeight () {\n    const stylOptions = this._chartData.styleOptions()\n    const xAxisOptions = stylOptions.xAxis\n    const height = xAxisOptions.height\n    if (isNumber(height)) {\n      return height\n    }\n    const crosshairOptions = stylOptions.crosshair\n    let xAxisHeight = 0\n    if (xAxisOptions.show) {\n      if (xAxisOptions.axisLine.show) {\n        xAxisHeight += xAxisOptions.axisLine.size\n      }\n      if (xAxisOptions.tickLine.show) {\n        xAxisHeight += xAxisOptions.tickLine.length\n      }\n      if (xAxisOptions.tickText.show) {\n        xAxisHeight += (xAxisOptions.tickText.paddingTop + xAxisOptions.tickText.paddingBottom + xAxisOptions.tickText.size)\n      }\n    }\n    let crosshairVerticalTextHeight = 0\n    if (\n      crosshairOptions.show &&\n      crosshairOptions.vertical.show &&\n      crosshairOptions.vertical.text.show\n    ) {\n      crosshairVerticalTextHeight += (\n        crosshairOptions.vertical.text.paddingTop +\n        crosshairOptions.vertical.text.paddingBottom +\n        crosshairOptions.vertical.text.borderSize * 2 +\n        crosshairOptions.vertical.text.size\n      )\n    }\n    return Math.max(xAxisHeight, crosshairVerticalTextHeight)\n  }\n\n  convertFromPixel (pixel) {\n    return this._chartData.coordinateToDataIndex(pixel)\n  }\n\n  convertToPixel (value) {\n    return this._chartData.dataIndexToCoordinate(value)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Pane from './Pane'\nimport XAxisWidget from '../widget/XAxisWidget'\nimport XAxis from '../component/XAxis'\n\nexport default class XAxisPane extends Pane {\n  _initBefore () {\n    this._xAxis = new XAxis(this._chartData)\n  }\n\n  _createMainWidget (container, props) {\n    return new XAxisWidget({ container, chartData: props.chartData, xAxis: this._xAxis })\n  }\n\n  xAxis () {\n    return this._xAxis\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    super.setWidth(mainWidgetWidth, yAxisWidgetWidth)\n    this._xAxis.setWidth(mainWidgetWidth)\n  }\n\n  setHeight (height) {\n    super.setHeight(height)\n    this._xAxis.setHeight(height)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The file comes from tradingview/lightweight-charts\n * https://www.tradingview.com/\n * Convert files from typescript to javascript.\n * Modified the class name.\n * The use of the source code of this file is also subject to the terms\n * and consitions of the license of \"lightweight-charts\" (Apache License V2, see\n * </licenses/LICENSE-lightweight-charts>).\n */\n\nconst MouseEventButton = {\n  LEFT: 0,\n  RIGHT: 2\n}\n\nconst DELAY_RESET_CLICK = 500\nconst DELAY_LONG_TAG = 600\n\nfunction getBoundingClientRect (element) {\n  return element.getBoundingClientRect() || { left: 0, top: 0 }\n}\n\nfunction isTouchEvent (event) {\n  return Boolean(event.touches)\n}\n\nfunction preventDefault (event) {\n  if (event.cancelable) {\n    event.preventDefault()\n  }\n}\n\nfunction checkTouchEvents () {\n  if ('ontouchstart' in window) {\n    return true\n  }\n\n  return Boolean(window.DocumentTouch && document instanceof window.DocumentTouch)\n}\n\nconst touch = !!navigator.maxTouchPoints || !!navigator.msMaxTouchPoints || checkTouchEvents()\nconst mobileTouch = 'onorientationchange' in window && touch\n\nfunction getDistance (p1, p2) {\n  const xDiff = p1.clientX - p2.clientX\n  const yDiff = p1.clientY - p2.clientY\n  return Math.sqrt(xDiff * xDiff + yDiff * yDiff)\n}\n\nexport const EventType = {\n  MOUSE: 'mouse',\n  TOUCH: 'touch'\n}\n\nexport default class EventBase {\n  constructor (target, eventHandler, options) {\n    this._target = target\n    this._handler = eventHandler\n    this._options = options\n\n    this._clickCount = 0\n    this._clickTimeoutId = null\n    this._longTapTimeoutId = null\n    this._longTapActive = false\n    this._mouseMoveStartPosition = null\n    this._moveExceededManhattanDistance = false\n    this._cancelClick = false\n    this._unsubscribeOutsideEvents = null\n    this._unsubscribeMousemove = null\n    this._unsubscribeRoot = null\n\n    this._startPinchMiddlePoint = null\n    this._startPinchDistance = 0\n    this._pinchPrevented = false\n    this._preventDragProcess = false\n\n    this._mousePressed = false\n\n    this._init()\n  }\n\n  destroy () {\n    if (this._unsubscribeOutsideEvents !== null) {\n      this._unsubscribeOutsideEvents()\n      this._unsubscribeOutsideEvents = null\n    }\n\n    if (this._unsubscribeMousemove !== null) {\n      this._unsubscribeMousemove()\n      this._unsubscribeMousemove = null\n    }\n\n    if (this._unsubscribeRoot !== null) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    this._clearLongTapTimeout()\n    this._resetClickTimeout()\n  }\n\n  _mouseEnterHandler (enterEvent) {\n    if (this._unsubscribeMousemove) {\n      this._unsubscribeMousemove()\n    }\n\n    {\n      const boundMouseMoveHandler = this._mouseMoveHandler.bind(this)\n      const boundMouseWheelHandler = this._mouseWheelHandler.bind(this)\n      this._unsubscribeMousemove = () => {\n        this._target.removeEventListener('mousemove', boundMouseMoveHandler)\n        this._target.removeEventListener('wheel', boundMouseWheelHandler)\n      }\n      this._target.addEventListener('mousemove', boundMouseMoveHandler)\n      this._target.addEventListener('wheel', boundMouseWheelHandler, { passive: false })\n    }\n\n    if (isTouchEvent(enterEvent)) {\n      this._mouseMoveHandler(enterEvent)\n    }\n\n    const compatEvent = this._makeCompatEvent(enterEvent)\n    this._processEvent(compatEvent, this._handler.mouseEnterEvent)\n  }\n\n  _resetClickTimeout () {\n    if (this._clickTimeoutId !== null) {\n      clearTimeout(this._clickTimeoutId)\n    }\n\n    this._clickCount = 0\n    this._clickTimeoutId = null\n  }\n\n  _mouseMoveHandler (moveEvent) {\n    if (this._mousePressed && !isTouchEvent(moveEvent)) {\n      return\n    }\n\n    const compatEvent = this._makeCompatEvent(moveEvent)\n    this._processEvent(compatEvent, this._handler.mouseMoveEvent)\n  }\n\n  _mouseWheelHandler (wheelEvent) {\n    const compatEvent = this._makeCompatEvent(wheelEvent)\n    wheelEvent.localX = compatEvent.localX\n    wheelEvent.localY = compatEvent.localY\n    this._processEvent(wheelEvent, this._handler.mouseWheelEvent)\n  }\n\n  _mouseMoveWithDownHandler (moveEvent) {\n    if ('button' in moveEvent && moveEvent.button !== MouseEventButton.LEFT) {\n      return\n    }\n\n    if (this._startPinchMiddlePoint !== null) {\n      return\n    }\n\n    const isTouch = isTouchEvent(moveEvent)\n    if (this._preventDragProcess && isTouch) {\n      return\n    }\n\n    this._pinchPrevented = true\n\n    const compatEvent = this._makeCompatEvent(moveEvent)\n\n    const startMouseMovePos = this._mouseMoveStartPosition\n    const xOffset = Math.abs(startMouseMovePos.x - compatEvent.pageX)\n    const yOffset = Math.abs(startMouseMovePos.y - compatEvent.pageY)\n\n    const moveExceededManhattanDistance = xOffset + yOffset > 5\n\n    if (!moveExceededManhattanDistance && isTouch) {\n      return\n    }\n\n    if (moveExceededManhattanDistance && !this._moveExceededManhattanDistance && isTouch) {\n      // vertical drag is more important than horizontal drag\n      // because we scroll the page vertically often than horizontally\n      const correctedXOffset = xOffset * 0.5\n\n      // a drag can be only if touch page scroll isn't allowed\n      const isVertDrag = yOffset >= correctedXOffset && !this._options.treatVertTouchDragAsPageScroll\n      const isHorzDrag = correctedXOffset > yOffset && !this._options.treatHorzTouchDragAsPageScroll\n\n      // if drag event happened then we should revert preventDefault state to original one\n      // and try to process the drag event\n      // else we shouldn't prevent default of the event and ignore processing the drag event\n      if (!isVertDrag && !isHorzDrag) {\n        this._preventDragProcess = true\n      }\n    }\n\n    if (moveExceededManhattanDistance) {\n      this._moveExceededManhattanDistance = true\n\n      // if manhattan distance is more that 5 - we should cancel click event\n      this._cancelClick = true\n\n      if (isTouch) {\n        this._clearLongTapTimeout()\n      }\n    }\n\n    if (!this._preventDragProcess) {\n      this._processEvent(compatEvent, this._handler.pressedMouseMoveEvent)\n\n      // we should prevent default in case of touch only\n      // to prevent scroll of the page\n      if (isTouch) {\n        preventDefault(moveEvent)\n      }\n    }\n  }\n\n  _mouseUpHandler (mouseUpEvent) {\n    if ('button' in mouseUpEvent && mouseUpEvent.button !== MouseEventButton.LEFT) {\n      return\n    }\n    const compatEvent = this._makeCompatEvent(mouseUpEvent)\n\n    this._clearLongTapTimeout()\n\n    this._mouseMoveStartPosition = null\n\n    this._mousePressed = false\n\n    if (this._unsubscribeRoot) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    if (isTouchEvent(mouseUpEvent)) {\n      this._mouseLeaveHandler(mouseUpEvent)\n    }\n\n    this._processEvent(compatEvent, this._handler.mouseUpEvent)\n    ++this._clickCount\n    if (this._clickTimeoutId && this._clickCount > 1) {\n      this._processEvent(compatEvent, this._handler.mouseDoubleClickEvent)\n      this._resetClickTimeout()\n    } else {\n      if (!this._cancelClick) {\n        this._processEvent(compatEvent, this._handler.mouseClickEvent)\n      }\n    }\n\n    // prevent safari's dblclick-to-zoom\n    // we handle mouseDoubleClickEvent here ourself\n    if (isTouchEvent(mouseUpEvent)) {\n      preventDefault(mouseUpEvent)\n\n      this._mouseLeaveHandler(mouseUpEvent)\n\n      if (mouseUpEvent.touches.length === 0) {\n        this._longTapActive = false\n      }\n    }\n  }\n\n  _clearLongTapTimeout () {\n    if (this._longTapTimeoutId === null) {\n      return\n    }\n\n    clearTimeout(this._longTapTimeoutId)\n    this._longTapTimeoutId = null\n  }\n\n  _mouseDownHandler (downEvent) {\n    if ('button' in downEvent && downEvent.button !== MouseEventButton.LEFT && downEvent.button !== MouseEventButton.RIGHT) {\n      return\n    }\n    const compatEvent = this._makeCompatEvent(downEvent)\n    if ('button' in downEvent && downEvent.button === MouseEventButton.RIGHT) {\n      this._processEvent(compatEvent, this._handler.mouseRightDownEvent)\n      return\n    }\n    this._cancelClick = false\n    this._moveExceededManhattanDistance = false\n    this._preventDragProcess = false\n\n    if (isTouchEvent(downEvent)) {\n      this._mouseEnterHandler(downEvent)\n    }\n\n    this._mouseMoveStartPosition = {\n      x: compatEvent.pageX,\n      y: compatEvent.pageY\n    }\n\n    if (this._unsubscribeRoot) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    {\n      const boundMouseMoveWithDownHandler = this._mouseMoveWithDownHandler.bind(this)\n      const boundMouseUpHandler = this._mouseUpHandler.bind(this)\n      const rootElement = this._target.ownerDocument.documentElement\n\n      this._unsubscribeRoot = () => {\n        rootElement.removeEventListener('touchmove', boundMouseMoveWithDownHandler)\n        rootElement.removeEventListener('touchend', boundMouseUpHandler)\n\n        rootElement.removeEventListener('mousemove', boundMouseMoveWithDownHandler)\n        rootElement.removeEventListener('mouseup', boundMouseUpHandler)\n      }\n\n      rootElement.addEventListener('touchmove', boundMouseMoveWithDownHandler, { passive: false })\n      rootElement.addEventListener('touchend', boundMouseUpHandler, { passive: false })\n\n      this._clearLongTapTimeout()\n\n      if (isTouchEvent(downEvent) && downEvent.touches.length === 1) {\n        this._longTapTimeoutId = setTimeout(this._longTapHandler.bind(this, downEvent), DELAY_LONG_TAG)\n      } else {\n        rootElement.addEventListener('mousemove', boundMouseMoveWithDownHandler)\n        rootElement.addEventListener('mouseup', boundMouseUpHandler)\n      }\n    }\n\n    this._mousePressed = true\n    this._processEvent(compatEvent, this._handler.mouseDownEvent)\n\n    if (!this._clickTimeoutId) {\n      this._clickCount = 0\n      this._clickTimeoutId = setTimeout(this._resetClickTimeout.bind(this), DELAY_RESET_CLICK)\n    }\n  }\n\n  _init () {\n    this._target.addEventListener('mouseenter', this._mouseEnterHandler.bind(this))\n\n    this._target.addEventListener('touchcancel', this._clearLongTapTimeout.bind(this))\n\n    {\n      const doc = this._target.ownerDocument\n\n      const outsideHandler = (event) => {\n        if (!this._handler.mouseDownOutsideEvent) {\n          return\n        }\n        if (event.target && this._target.contains(event.target)) {\n          return\n        }\n        this._handler.mouseDownOutsideEvent()\n      }\n\n      this._unsubscribeOutsideEvents = () => {\n        doc.removeEventListener('mousedown', outsideHandler)\n        doc.removeEventListener('touchstart', outsideHandler)\n      }\n\n      doc.addEventListener('mousedown', outsideHandler)\n      doc.addEventListener('touchstart', outsideHandler, { passive: true })\n    }\n\n    this._target.addEventListener('mouseleave', this._mouseLeaveHandler.bind(this))\n\n    this._target.addEventListener('touchstart', this._mouseDownHandler.bind(this), { passive: true })\n    if (!mobileTouch) {\n      this._target.addEventListener('mousedown', this._mouseDownHandler.bind(this))\n    }\n\n    this._initPinch()\n\n    // Hey mobile Safari, what's up?\n    // If mobile Safari doesn't have any touchmove handler with passive=false\n    // it treats a touchstart and the following touchmove events as cancelable=false,\n    // so we can't prevent them (as soon we subscribe on touchmove inside handler of touchstart).\n    // And we'll get scroll of the page along with chart's one instead of only chart's scroll.\n    this._target.addEventListener('touchmove', () => {}, { passive: false })\n  }\n\n  _initPinch () {\n    if (this._handler.pinchStartEvent === undefined &&\n      this._handler.pinchEvent === undefined &&\n      this._handler.pinchEndEvent === undefined\n    ) {\n      return\n    }\n\n    this._target.addEventListener(\n      'touchstart',\n      (event) => this._checkPinchState(event.touches),\n      { passive: true }\n    )\n\n    this._target.addEventListener(\n      'touchmove',\n      (event) => {\n        if (event.touches.length !== 2 || this._startPinchMiddlePoint === null) {\n          return\n        }\n\n        if (this._handler.pinchEvent !== undefined) {\n          const currentDistance = getDistance(event.touches[0], event.touches[1])\n          const scale = currentDistance / this._startPinchDistance\n          this._handler.pinchEvent(this._startPinchMiddlePoint, scale)\n          preventDefault(event)\n        }\n      },\n      { passive: false }\n    )\n\n    this._target.addEventListener('touchend', (event) => {\n      this._checkPinchState(event.touches)\n    })\n  }\n\n  _checkPinchState (touches) {\n    if (touches.length === 1) {\n      this._pinchPrevented = false\n    }\n\n    if (touches.length !== 2 || this._pinchPrevented || this._longTapActive) {\n      this._stopPinch()\n    } else {\n      this._startPinch(touches)\n    }\n  }\n\n  _startPinch (touches) {\n    const box = getBoundingClientRect(this._target)\n    this._startPinchMiddlePoint = {\n      x: ((touches[0].clientX - box.left) + (touches[1].clientX - box.left)) / 2,\n      y: ((touches[0].clientY - box.top) + (touches[1].clientY - box.top)) / 2\n    }\n\n    this._startPinchDistance = getDistance(touches[0], touches[1])\n\n    if (this._handler.pinchStartEvent !== undefined) {\n      this._handler.pinchStartEvent()\n    }\n\n    this._clearLongTapTimeout()\n  }\n\n  _stopPinch () {\n    if (this._startPinchMiddlePoint === null) {\n      return\n    }\n\n    this._startPinchMiddlePoint = null\n\n    if (this._handler.pinchEndEvent !== undefined) {\n      this._handler.pinchEndEvent()\n    }\n  }\n\n  _mouseLeaveHandler (event) {\n    if (this._unsubscribeMousemove) {\n      this._unsubscribeMousemove()\n    }\n    const compatEvent = this._makeCompatEvent(event)\n    this._processEvent(compatEvent, this._handler.mouseLeaveEvent)\n  }\n\n  _longTapHandler (event) {\n    const compatEvent = this._makeCompatEvent(event)\n    this._processEvent(compatEvent, this._handler.longTapEvent)\n    this._cancelClick = true\n\n    // long tap is active untill touchend event with 0 touches occured\n    this._longTapActive = true\n  }\n\n  _processEvent (event, callback) {\n    if (!callback) {\n      return\n    }\n    callback.call(this._handler, event)\n  }\n\n  _makeCompatEvent (event) {\n  // TouchEvent has no clientX/Y coordinates:\n  // We have to use the last Touch instead\n    let eventLike\n    if ('touches' in event && event.touches.length) {\n      eventLike = event.touches[0]\n    } else if ('changedTouches' in event && event.changedTouches.length) {\n      eventLike = event.changedTouches[0]\n    } else {\n      eventLike = event\n    }\n\n    const box = getBoundingClientRect(this._target)\n\n    return {\n      clientX: eventLike.clientX,\n      clientY: eventLike.clientY,\n      pageX: eventLike.pageX,\n      pageY: eventLike.pageY,\n      screenX: eventLike.screenX,\n      screenY: eventLike.screenY,\n      localX: eventLike.clientX - box.left,\n      localY: eventLike.clientY - box.top,\n\n      ctrlKey: event.ctrlKey,\n      altKey: event.altKey,\n      shiftKey: event.shiftKey,\n      metaKey: event.metaKey,\n\n      type: event.type.startsWith('mouse') ? EventType.MOUSE : EventType.TOUCH,\n\n      target: eventLike.target,\n      view: event.view\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventBase from '../event/EventBase'\nimport { getPixelRatio } from '../utils/canvas'\nimport { isValid } from '../utils/typeChecks'\n\nexport default class SeparatorPane {\n  constructor (container, chartData, topPaneId, bottomPaneId, dragEnabled, dragEventHandler) {\n    this._chartData = chartData\n    this._topPaneId = topPaneId\n    this._bottomPaneId = bottomPaneId\n    this._dragEnabled = dragEnabled\n    this._width = 0\n    this._offsetLeft = 0\n    this._dragEventHandler = dragEventHandler\n    this._dragFlag = false\n    this._initElement(container)\n    this._initEvent(dragEnabled)\n  }\n\n  /**\n   * 初始化dom元素\n   * @param container\n   * @private\n   */\n  _initElement (container) {\n    this._container = container\n    this._wrapper = this._createElement()\n    this._wrapper.style.position = 'relative'\n    this._element = this._createElement()\n    this._element.style.width = '100%'\n    this._element.style.position = 'absolute'\n    this._element.style.zIndex = '20'\n    this._element.style.top = '-3px'\n    this._element.style.height = '7px'\n    this._wrapper.appendChild(this._element)\n    const lastElement = container.lastChild\n    if (lastElement) {\n      container.insertBefore(this._wrapper, lastElement)\n    } else {\n      container.appendChild(this._wrapper)\n    }\n  }\n\n  /**\n   * 初始化事件\n   * @param dragEnabled\n   * @private\n   */\n  _initEvent (dragEnabled) {\n    if (dragEnabled) {\n      this._element.style.cursor = 'ns-resize'\n      this._dragEvent = new EventBase(this._element, {\n        mouseDownEvent: this._mouseDownEvent.bind(this),\n        mouseUpEvent: this._mouseUpEvent.bind(this),\n        pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n        mouseEnterEvent: this._mouseEnterEvent.bind(this),\n        mouseLeaveEvent: this._mouseLeaveEvent.bind(this)\n      }, {\n        treatVertTouchDragAsPageScroll: false,\n        treatHorzTouchDragAsPageScroll: true\n      })\n    }\n  }\n\n  /**\n   * 创建div节点\n   * @return {HTMLDivElement}\n   * @private\n   */\n  _createElement () {\n    const element = document.createElement('div')\n    element.style.margin = '0'\n    element.style.padding = '0'\n    return element\n  }\n\n  _mouseDownEvent (event) {\n    this._dragFlag = true\n    this._startY = event.pageY\n    this._dragEventHandler.startDrag(this._topPaneId, this._bottomPaneId)\n  }\n\n  _mouseUpEvent () {\n    this._dragFlag = false\n    this._chartData.setDragPaneFlag(false)\n  }\n\n  _pressedMouseMoveEvent (event) {\n    const dragDistance = event.pageY - this._startY\n    this._dragEventHandler.drag(dragDistance, this._topPaneId, this._bottomPaneId)\n    this._chartData.setDragPaneFlag(true)\n    this._chartData.setCrosshair()\n  }\n\n  _mouseEnterEvent () {\n    const separatorOptions = this._chartData.styleOptions().separator\n    this._element.style.background = separatorOptions.activeBackgroundColor\n    this._chartData.setDragPaneFlag(true)\n    this._chartData.setCrosshair()\n  }\n\n  _mouseLeaveEvent () {\n    if (!this._dragFlag) {\n      this._element.style.background = null\n      this._chartData.setDragPaneFlag(false)\n    }\n  }\n\n  /**\n   * 获取高度\n   * @returns {number}\n   */\n  height () {\n    return this._wrapper.offsetHeight\n  }\n\n  /**\n   * 设置尺寸\n   * 用于fill属性\n   * @param offsetLeft\n   * @param width\n   */\n  setSize (offsetLeft, width) {\n    this._offsetLeft = offsetLeft\n    this._width = width\n    this.invalidate()\n  }\n\n  /**\n   * 设置是否可以拖拽\n   * @param dragEnabled\n   */\n  setDragEnabled (dragEnabled) {\n    if (dragEnabled !== this._dragEnabled) {\n      this._dragEnabled = dragEnabled\n      if (dragEnabled) {\n        !this._dragEvent && this._initEvent(dragEnabled)\n      } else {\n        this._element.style.cursor = 'default'\n        this._dragEvent && this._dragEvent.destroy()\n        this._dragEvent = null\n      }\n    }\n  }\n\n  /**\n   * 顶部paneId\n   * @return {*}\n   */\n  topPaneId () {\n    return this._topPaneId\n  }\n\n  /**\n   * 底部paneId\n   * @return {*}\n   */\n  bottomPaneId () {\n    return this._bottomPaneId\n  }\n\n  /**\n   * 更新上下两个图表的索引\n   * @param topPaneId\n   * @param bottomPaneId\n   */\n  updatePaneId (topPaneId, bottomPaneId) {\n    if (isValid(topPaneId)) {\n      this._topPaneId = topPaneId\n    }\n    if (isValid(bottomPaneId)) {\n      this._bottomPaneId = bottomPaneId\n    }\n  }\n\n  /**\n   * 刷新\n   */\n  invalidate () {\n    const separatorOptions = this._chartData.styleOptions().separator\n    this._element.style.top = `${-Math.floor((7 - separatorOptions.size) / 2)}px`\n    this._wrapper.style.backgroundColor = separatorOptions.color\n    this._wrapper.style.height = `${separatorOptions.size}px`\n    this._wrapper.style.marginLeft = `${separatorOptions.fill ? 0 : this._offsetLeft}px`\n    this._wrapper.style.width = separatorOptions.fill ? '100%' : `${this._width}px`\n  }\n\n  /**\n   * 将图形转换成图片\n   * @returns {HTMLCanvasElement}\n   */\n  getImage () {\n    const separatorOptions = this._chartData.styleOptions().separator\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    const width = this._wrapper.offsetWidth\n    const height = separatorOptions.size\n    canvas.style.width = `${width}px`\n    canvas.style.height = `${height}px`\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n    ctx.fillStyle = separatorOptions.color\n    ctx.fillRect(this._offsetLeft, 0, width, height)\n    return canvas\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    if (this._dragEvent) {\n      this._dragEvent.destroy()\n    }\n    this._container.removeChild(this._wrapper)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EventType } from './EventBase'\n\nexport function isTouch (event) {\n  return event.type === EventType.TOUCH\n}\n\nexport function isMouse (event) {\n  return event.type === EventType.MOUSE\n}\n\nexport default class EventHandler {\n  constructor (chartData) {\n    this._chartData = chartData\n    this._chartContentSize = {}\n    this._paneContentSize = {}\n  }\n\n  _checkEventPointX (x) {\n    return x > 0 && x < this._chartContentSize.contentRight - this._chartContentSize.contentLeft\n  }\n\n  setChartContentSize (chartContentSize) {\n    this._chartContentSize = chartContentSize\n  }\n\n  setPaneContentSize (paneContentSize) {\n    this._paneContentSize = paneContentSize\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler, { isMouse, isTouch } from './EventHandler'\n\nconst TOUCH_MIN_RADIUS = 10\n\nexport default class ZoomScrollEventHandler extends EventHandler {\n  constructor (chartData) {\n    super(chartData)\n    // 开始滚动时坐标点\n    this._startScrollPoint = {}\n    // 开始触摸时坐标\n    this._touchPoint = null\n    // 是否是取消了十字光标\n    this._touchCancelCrossHair = false\n    // 是否缩放过\n    this._touchZoomed = false\n    // 用来记录捏合缩放的尺寸\n    this._pinchScale = 1\n  }\n\n  pinchStartEvent () {\n    this._pinchScale = 1\n    this._touchZoomed = true\n  }\n\n  pinchEvent (middlePoint, scale) {\n    const zoomScale = (scale - this._pinchScale) * 5\n    this._pinchScale = scale\n    this._chartData.zoom(zoomScale, middlePoint)\n  }\n\n  mouseLeaveEvent (event) {\n    if (isMouse(event)) {\n      this._chartData.setCrosshair()\n    }\n  }\n\n  mouseMoveEvent (event) {\n    if (!isMouse(event)) {\n      return\n    }\n    this._performCross(event, false, cross => {\n      this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n    }, () => {\n      this._chartData.setCrosshair()\n    })\n  }\n\n  mouseWheelEvent (event) {\n    if (!this._checkEventPointX(event.localX)) {\n      return\n    }\n    if (Math.abs(event.deltaX) > Math.abs(event.deltaY)) {\n      if (event.cancelable) {\n        event.preventDefault()\n      }\n      if (Math.abs(event.deltaX) === 0) {\n        return\n      }\n      this._chartData.startScroll()\n      this._chartData.scroll(-event.deltaX)\n    } else {\n      let deltaY = -(event.deltaY / 100)\n      if (deltaY === 0) {\n        return\n      }\n      if (event.cancelable) {\n        event.preventDefault()\n      }\n\n      switch (event.deltaMode) {\n        case event.DOM_DELTA_PAGE:\n          deltaY *= 120\n          break\n\n        case event.DOM_DELTA_LINE:\n          deltaY *= 32\n          break\n      }\n\n      if (deltaY !== 0) {\n        const scale = Math.sign(deltaY) * Math.min(1, Math.abs(deltaY))\n        this._chartData.zoom(scale, { x: event.localX, y: event.localY })\n      }\n    }\n  }\n\n  mouseClickEvent (event) {\n    this._performCross(event, true, cross => {\n      if (!this._touchPoint && !this._touchCancelCrossHair && !this._touchZoomed) {\n        this._touchPoint = { x: event.localX, y: event.localY }\n        this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n      }\n    })\n  }\n\n  mouseDownEvent (event) {\n    this._startScrollPoint = { x: event.localX, y: event.localY }\n    this._chartData.startScroll()\n    this._performCross(event, true, cross => {\n      this._touchZoomed = false\n      if (this._touchPoint) {\n        const xDif = event.localX - this._touchPoint.x\n        const yDif = event.localY - this._touchPoint.y\n        const radius = Math.sqrt(xDif * xDif + yDif * yDif)\n        if (radius < TOUCH_MIN_RADIUS) {\n          this._touchPoint = { x: event.localX, y: event.localY }\n          this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n        } else {\n          this._touchCancelCrossHair = true\n          this._touchPoint = null\n          this._chartData.setCrosshair()\n        }\n      } else {\n        this._touchCancelCrossHair = false\n      }\n    })\n  }\n\n  pressedMouseMoveEvent (event) {\n    this._performCross(event, false, cross => {\n      let crosshair = { x: event.localX, y: cross.y, paneId: cross.paneId }\n      if (isTouch(event)) {\n        if (this._touchPoint) {\n          this._touchPoint = { x: event.localX, y: event.localY }\n          this._chartData.setCrosshair(crosshair)\n          return\n        } else {\n          crosshair = null\n        }\n      }\n      const distance = event.localX - this._startScrollPoint.x\n      this._chartData.scroll(distance, crosshair)\n    })\n  }\n\n  longTapEvent (event) {\n    this._performCross(event, true, cross => {\n      this._touchPoint = { x: event.localX, y: event.localY }\n      this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n    })\n  }\n\n  /**\n   * 处理十字光标\n   * @param event\n   * @param checkTouchEvent\n   * @param performFuc\n   * @param extendFun\n   * @private\n   */\n  _performCross (event, checkTouchEvent, performFuc, extendFun) {\n    if (checkTouchEvent && !isTouch(event)) {\n      return\n    }\n    if (!this._checkEventPointX(event.localX)) {\n      if (extendFun) {\n        extendFun()\n      }\n      return\n    }\n    let isPerform = false\n    for (const paneId in this._paneContentSize) {\n      const size = this._paneContentSize[paneId]\n      if (event.localY > size.contentTop && event.localY < size.contentBottom) {\n        isPerform = true\n        if (performFuc) {\n          performFuc({ paneId, y: event.localY - size.contentTop })\n        }\n        break\n      }\n    }\n    if (!isPerform && extendFun) {\n      extendFun()\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler, { isMouse } from './EventHandler'\nimport { CANDLE_PANE_ID, InvalidateLevel } from '../data/constants'\nimport { GraphicMarkMouseOperateElement } from '../base/overlay/mark/GraphicMark'\n\nexport default class OverlayEventHandler extends EventHandler {\n  constructor (chartData) {\n    super(chartData)\n    this._pressedGraphicMark = null\n  }\n\n  /**\n   * 处理覆盖物鼠标hover事件\n   * @param overlays\n   * @param preHoverOperate\n   * @param coordinate\n   * @param event\n   * @return {*}\n   * @private\n   */\n  _performOverlayMouseHover (overlays, preHoverOperate, coordinate, event) {\n    let hoverOperate\n    for (const overlay of overlays) {\n      hoverOperate = overlay.checkMousePointOnGraphic(coordinate)\n      if (hoverOperate) {\n        break\n      }\n    }\n    if (!hoverOperate || preHoverOperate.id !== hoverOperate.id) {\n      if (preHoverOperate.id && preHoverOperate.instance && isMouse(event)) {\n        preHoverOperate.instance.onMouseLeave({\n          id: preHoverOperate.id,\n          points: preHoverOperate.instance.points(),\n          event\n        })\n      }\n      if (hoverOperate && hoverOperate.id !== preHoverOperate.id && hoverOperate.instance && isMouse(event)) {\n        hoverOperate.instance.onMouseEnter({\n          id: hoverOperate.id,\n          points: hoverOperate.instance.points(),\n          event\n        })\n      }\n    }\n    return hoverOperate\n  }\n\n  /**\n   * 鼠标抬起事件\n   * @param event\n   */\n  mouseUpEvent (event) {\n    if (this._pressedGraphicMark) {\n      this._pressedGraphicMark = null\n      this._chartData.setDragGraphicMarkFlag(false)\n    }\n  }\n\n  mouseMoveEvent (event) {\n    if (!this._checkEventPointX(event.localX) || !this._checkEventPointY(event.localY) || this._waitingForMouseMoveAnimationFrame) {\n      return\n    }\n    this._waitingForMouseMoveAnimationFrame = true\n    const coordinate = { x: event.localX, y: event.localY }\n    const graphicMarks = this._chartData.graphicMarks()\n    const visibleAnnotations = this._chartData.visibleAnnotations()\n    const lastGraphicMark = graphicMarks[graphicMarks.length - 1]\n    const preGraphicMarkHoverOperate = this._chartData.graphicMarkMouseOperate().hover\n    const preAnnotationHoverOperate = this._chartData.annotationMouseOperate()\n    let graphicMarkHoverOperate\n    let graphicMarkClickOperate\n    let annotationHoverOperate\n    if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n      lastGraphicMark.mouseMoveForDrawing(coordinate)\n      graphicMarkHoverOperate = lastGraphicMark.checkMousePointOnGraphic(coordinate)\n      graphicMarkClickOperate = {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    } else {\n      graphicMarkHoverOperate = this._performOverlayMouseHover(graphicMarks, preGraphicMarkHoverOperate, coordinate, event)\n      annotationHoverOperate = this._performOverlayMouseHover(visibleAnnotations, preAnnotationHoverOperate, coordinate, event)\n    }\n    this._chartData.setOverlayMouseOperate({\n      hover: graphicMarkHoverOperate || {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      },\n      click: graphicMarkClickOperate\n    }, annotationHoverOperate || { id: '' })\n    this._waitingForMouseMoveAnimationFrame = false\n  }\n\n  /**\n   * 鼠标按下事件\n   * @param event\n   */\n  mouseDownEvent (event) {\n    if (!this._checkEventPointX(event.localX) || !this._checkEventPointY(event.localY)) {\n      return\n    }\n    const coordinate = { x: event.localX, y: event.localY }\n    const graphicMarks = this._chartData.graphicMarks()\n    const lastGraphicMark = graphicMarks[graphicMarks.length - 1]\n    let graphicMarkHoverOperate = {\n      id: '',\n      element: GraphicMarkMouseOperateElement.NONE,\n      elementIndex: -1\n    }\n    let graphicMarkClickOperate\n    if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n      lastGraphicMark.mouseLeftButtonDownForDrawing(coordinate)\n      graphicMarkClickOperate = lastGraphicMark.checkMousePointOnGraphic(coordinate)\n    } else {\n      for (const graphicMark of graphicMarks) {\n        graphicMarkClickOperate = graphicMark.checkMousePointOnGraphic(coordinate)\n        if (graphicMarkClickOperate) {\n          if (graphicMarkClickOperate.element === GraphicMarkMouseOperateElement.POINT) {\n            this._pressedGraphicMark = graphicMark\n            this._chartData.setDragGraphicMarkFlag(true)\n            graphicMarkHoverOperate = {\n              ...graphicMarkClickOperate\n            }\n          }\n          graphicMark.onClick({\n            id: graphicMarkClickOperate.id,\n            points: graphicMark.points(),\n            event\n          })\n          break\n        }\n      }\n      const visibleAnnotations = this._chartData.visibleAnnotations()\n      for (const annotation of visibleAnnotations) {\n        const annotationOperate = annotation.checkMousePointOnGraphic(coordinate)\n        if (annotationOperate) {\n          annotation.onClick({\n            id: annotationOperate.id,\n            points: annotation.points(),\n            event\n          })\n          break\n        }\n      }\n    }\n    this._chartData.setOverlayMouseOperate({\n      hover: graphicMarkHoverOperate,\n      click: graphicMarkClickOperate || {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    })\n  }\n\n  mouseRightDownEvent (event) {\n    const graphicMark = this._chartData.graphicMarks().find(gm => gm.checkMousePointOnGraphic({ x: event.localX, y: event.localY }))\n    if (graphicMark && !graphicMark.onRightClick({ id: graphicMark.id(), points: graphicMark.points(), event })) {\n      this._chartData.removeGraphicMarkInstance(graphicMark.id())\n    }\n    const annotation = this._chartData.visibleAnnotations().find(an => an.checkMousePointOnGraphic({ x: event.localX, y: event.localY }))\n    if (annotation) {\n      annotation.onRightClick({ id: annotation.id(), points: annotation.points(), event })\n    }\n  }\n\n  pressedMouseMoveEvent (event) {\n    const graphicMarks = this._chartData.graphicMarks()\n    const lastGraphicMark = graphicMarks[graphicMarks.length - 1]\n    if ((!lastGraphicMark || !lastGraphicMark.isDrawing()) && this._pressedGraphicMark) {\n      this._pressedGraphicMark.mousePressedMove({ x: event.localX, y: event.localY }, event)\n      this._chartData.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  _checkEventPointY (y) {\n    const size = this._paneContentSize[CANDLE_PANE_ID]\n    return y > size.contentTop && y < size.contentBottom\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler from './EventHandler'\n\nconst KeyBoardCode = {\n  EQUAL: 'Equal',\n  MINUS: 'Minus',\n  ARROW_LEFT: 'ArrowLeft',\n  ARROW_RIGHT: 'ArrowRight'\n}\n\nexport default class KeyBoardEventHandler extends EventHandler {\n  /**\n   * 键盘事件\n   * @param event\n   */\n  keyBoardDownEvent (event) {\n    if (event.shiftKey) {\n      switch (event.code) {\n        case KeyBoardCode.EQUAL: {\n          this._chartData.zoom(0.5)\n          break\n        }\n        case KeyBoardCode.MINUS: {\n          this._chartData.zoom(-0.5)\n          break\n        }\n        case KeyBoardCode.ARROW_LEFT: {\n          this._chartData.startScroll()\n          this._chartData.scroll(-3 * this._chartData.dataSpace())\n          break\n        }\n        case KeyBoardCode.ARROW_RIGHT: {\n          this._chartData.startScroll()\n          this._chartData.scroll(3 * this._chartData.dataSpace())\n          break\n        }\n        default: {\n          break\n        }\n      }\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventBase from './EventBase'\nimport ZoomScrollEventHandler from './ZoomScrollEventHandler'\nimport OverlayEventHandler from './OverlayEventHandler'\nimport KeyBoardEventHandler from './KeyBoardEventHandler'\n\nexport default class ChartEvent {\n  constructor (target, chartData) {\n    this._target = target\n    this._chartData = chartData\n    this._chartContentSize = {}\n    this._event = new EventBase(this._target, {\n      pinchStartEvent: this._pinchStartEvent.bind(this),\n      pinchEvent: this._pinchEvent.bind(this),\n      mouseUpEvent: this._mouseUpEvent.bind(this),\n      mouseClickEvent: this._mouseClickEvent.bind(this),\n      mouseDownEvent: this._mouseDownEvent.bind(this),\n      mouseRightDownEvent: this._mouseRightDownEvent.bind(this),\n      mouseLeaveEvent: this._mouseLeaveEvent.bind(this),\n      mouseMoveEvent: this._mouseMoveEvent.bind(this),\n      mouseWheelEvent: this._mouseWheelEvent.bind(this),\n      pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n      longTapEvent: this._longTapEvent.bind(this)\n    }, {\n      treatVertTouchDragAsPageScroll: false,\n      treatHorzTouchDragAsPageScroll: false\n    })\n    this._boundKeyBoardDownEvent = this._keyBoardDownEvent.bind(this)\n    this._target.addEventListener('keydown', this._boundKeyBoardDownEvent)\n    this._boundContextMenuEvent = (e) => { e.preventDefault() }\n    this._target.addEventListener('contextmenu', this._boundContextMenuEvent, false)\n    this._zoomScrollEventHandler = new ZoomScrollEventHandler(chartData)\n    this._overlayEventHandler = new OverlayEventHandler(chartData)\n    this._keyBoardEventHandler = new KeyBoardEventHandler(chartData)\n  }\n\n  _keyBoardDownEvent (event) {\n    this._keyBoardEventHandler.keyBoardDownEvent(event)\n  }\n\n  _pinchStartEvent () {\n    this._zoomScrollEventHandler.pinchStartEvent()\n  }\n\n  _pinchEvent (middlePoint, scale) {\n    this._zoomScrollEventHandler.pinchEvent(middlePoint, scale)\n  }\n\n  _mouseUpEvent (event) {\n    this._target.style.cursor = 'crosshair'\n    if (this._shouldPerformOverlayEvent()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._overlayEventHandler.mouseUpEvent(event)\n    }\n  }\n\n  _mouseLeaveEvent (event) {\n    if (this._checkZoomScroll()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._zoomScrollEventHandler.mouseLeaveEvent(event)\n    }\n  }\n\n  _mouseMoveEvent (event) {\n    event.localX -= this._chartContentSize.contentLeft\n    if (this._shouldPerformOverlayEvent()) {\n      this._overlayEventHandler.mouseMoveEvent(event)\n    }\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.mouseMoveEvent(event)\n    }\n  }\n\n  _mouseWheelEvent (event) {\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.mouseWheelEvent(event)\n    }\n  }\n\n  _mouseClickEvent (event) {\n    if (this._checkZoomScroll()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._zoomScrollEventHandler.mouseClickEvent(event)\n    }\n  }\n\n  _mouseDownEvent (event) {\n    this._target.style.cursor = 'pointer'\n    event.localX -= this._chartContentSize.contentLeft\n    if (this._shouldPerformOverlayEvent()) {\n      this._overlayEventHandler.mouseDownEvent(event)\n    }\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.mouseDownEvent(event)\n    }\n  }\n\n  _mouseRightDownEvent (event) {\n    if (this._shouldPerformOverlayEvent()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._overlayEventHandler.mouseRightDownEvent(event)\n    }\n  }\n\n  _pressedMouseMoveEvent (event) {\n    event.localX -= this._chartContentSize.contentLeft\n    if (this._chartData.dragGraphicMarkFlag()) {\n      this._overlayEventHandler.pressedMouseMoveEvent(event)\n      // 这里判断一下，如果是在拖拽图形标记，让十字光标不显示\n      if (this._chartData.crosshair().paneId) {\n        this._chartData.setCrosshair()\n      }\n    }\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.pressedMouseMoveEvent(event)\n    }\n  }\n\n  _longTapEvent (event) {\n    if (this._checkZoomScroll()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._zoomScrollEventHandler.longTapEvent(event)\n    }\n  }\n\n  _checkZoomScroll () {\n    const graphicMarks = this._chartData.graphicMarks()\n    const graphicMarkCount = graphicMarks.length\n    return !this._chartData.dragPaneFlag() && !this._chartData.dragGraphicMarkFlag() && (graphicMarkCount === 0 || !graphicMarks[graphicMarkCount - 1].isDrawing())\n  }\n\n  /**\n   * 是否需要处理图形标记事件\n   * @return {boolean}\n   * @private\n   */\n  _shouldPerformOverlayEvent () {\n    return this._chartData.graphicMarks().length > 0 || this._chartData.visibleAnnotations().length > 0\n  }\n\n  setChartContentSize (chartContentSize) {\n    this._chartContentSize = chartContentSize\n    this._zoomScrollEventHandler.setChartContentSize(chartContentSize)\n    this._overlayEventHandler.setChartContentSize(chartContentSize)\n  }\n\n  setPaneContentSize (paneContentSize) {\n    this._zoomScrollEventHandler.setPaneContentSize(paneContentSize)\n    this._overlayEventHandler.setPaneContentSize(paneContentSize)\n  }\n\n  destroy () {\n    this._event.destroy()\n    this._target.removeEventListener('keydown', this._boundKeyBoardDownEvent)\n    this._target.removeEventListener('contextmenu', this._boundContextMenuEvent)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function throttle (func, wait = 20) {\n  let previous = 0\n  return function () {\n    const now = Date.now()\n    const context = this\n    const args = arguments\n    if (now - previous > wait) {\n      func.apply(context, args)\n      previous = now\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 渲染填充菱形\n * @param ctx\n * @param color\n * @param centerPoint\n * @param width\n * @param height\n */\nexport function renderFillDiamond (ctx, color, centerPoint, width, height) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.moveTo(centerPoint.x - width / 2, centerPoint.y)\n  ctx.lineTo(centerPoint.x, centerPoint.y - height / 2)\n  ctx.lineTo(centerPoint.x + width / 2, centerPoint.y)\n  ctx.lineTo(centerPoint.x, centerPoint.y + height / 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 渲染填充菱形\n * @param ctx\n * @param color\n * @param centerPoint\n * @param width\n * @param height\n */\nexport function renderFillTriangle (ctx, color, centerPoint, width, height) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.moveTo(centerPoint.x - width / 2, centerPoint.y + height / 2)\n  ctx.lineTo(centerPoint.x, centerPoint.y - height / 2)\n  ctx.lineTo(centerPoint.x + width / 2, centerPoint.y + height / 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from '../Overlay'\n\nimport { renderFillCircle } from '../../../renderer/circle'\nimport { renderFillRect } from '../../../renderer/rect'\nimport { renderFillDiamond } from '../../../renderer/diamond'\nimport { renderFillTriangle } from '../../../renderer/triangle'\nimport {\n  checkPointInCircle, checkPointInDiamond,\n  checkPointInRect, checkPointInTriangle\n} from '../../../extension/mark/graphicHelper'\n\nimport { isNumber } from '../../../utils/typeChecks'\n\nimport {\n  OverlayPosition,\n  AnnotationSymbolType\n} from '../../../data/options/styleOptions'\n\n/**\n * 注解\n */\nexport default class Annotation extends Overlay {\n  constructor ({\n    id, point, chartData, xAxis, yAxis, styles\n  }) {\n    super({ id, chartData, xAxis, yAxis })\n    this._point = point\n    this._symbolCoordinate = {}\n    this.setStyles(styles, chartData.styleOptions().annotation)\n  }\n\n  /**\n   * 绘制标识\n   * @param ctx\n   * @param isActive\n   * @param styles\n   * @private\n   */\n  _drawSymbol (ctx, isActive, styles) {\n    const barSpace = this._chartData.barSpace()\n    const symbolOptions = styles.symbol\n    const styleSize = symbolOptions.size\n    const styleActiveSize = symbolOptions.activeSize\n    const size = isActive\n      ? (isNumber(styleActiveSize) ? styleActiveSize : barSpace)\n      : (isNumber(styleSize) ? styleSize : barSpace)\n    const color = isActive ? symbolOptions.activeColor : symbolOptions.color\n    switch (symbolOptions.type) {\n      case AnnotationSymbolType.CIRCLE: {\n        renderFillCircle(ctx, color, this._symbolCoordinate, size / 2)\n        break\n      }\n      case AnnotationSymbolType.RECT: {\n        renderFillRect(\n          ctx, color,\n          this._symbolCoordinate.x - size / 2,\n          this._symbolCoordinate.y - size / 2,\n          size, size\n        )\n        break\n      }\n      case AnnotationSymbolType.DIAMOND: {\n        renderFillDiamond(ctx, color, this._symbolCoordinate, size, size)\n        break\n      }\n      case AnnotationSymbolType.TRIANGLE: {\n        renderFillTriangle(ctx, color, this._symbolCoordinate, size, size)\n        break\n      }\n      case AnnotationSymbolType.CUSTOM: {\n        this.drawCustomSymbol({\n          ctx,\n          point: this._point,\n          coordinate: this._symbolCoordinate,\n          viewport: {\n            width: this._xAxis.width(),\n            height: this._yAxis.height(),\n            barSpace\n          },\n          styles: symbolOptions,\n          isActive\n        })\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  draw (ctx) {\n    const styles = this._styles || this._chartData.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const offset = symbolOptions.offset || []\n    let y = 0\n    switch (symbolOptions.position) {\n      case OverlayPosition.POINT: {\n        y = this._yAxis.convertToPixel(this._point.price)\n        break\n      }\n      case OverlayPosition.TOP: {\n        y = 0\n        break\n      }\n      case OverlayPosition.BOTTOM: {\n        y = this._yAxis.height()\n        break\n      }\n    }\n    this._symbolCoordinate.y = y + (offset[1] || 0)\n    const isActive = this._id === this._chartData.annotationMouseOperate().id\n    this._drawSymbol(ctx, isActive, styles)\n    if (this.drawExtend) {\n      ctx.save()\n      this.drawExtend({\n        ctx,\n        point: this._point,\n        coordinate: this._symbolCoordinate,\n        viewport: {\n          width: this._xAxis.width(),\n          height: this._yAxis.height()\n        },\n        styles,\n        isActive\n      })\n      ctx.restore()\n    }\n  }\n\n  checkMousePointOnGraphic (mouseCoordinate) {\n    const barSpace = this._chartData.barSpace()\n    const styles = this._styles || this._chartData.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const size = isNumber(symbolOptions.size) ? symbolOptions.size : barSpace\n    let isOn\n    switch (symbolOptions.type) {\n      case AnnotationSymbolType.CIRCLE: {\n        isOn = checkPointInCircle(this._symbolCoordinate, size / 2, mouseCoordinate)\n        break\n      }\n      case AnnotationSymbolType.RECT: {\n        const coordinate1 = { x: this._symbolCoordinate.x - size / 2, y: this._symbolCoordinate.y - size / 2 }\n        const coordinate2 = { x: this._symbolCoordinate.x + size / 2, y: this._symbolCoordinate.y + size / 2 }\n        isOn = checkPointInRect(coordinate1, coordinate2, mouseCoordinate)\n        break\n      }\n      case AnnotationSymbolType.DIAMOND: {\n        isOn = checkPointInDiamond(this._symbolCoordinate, size, size, mouseCoordinate)\n        break\n      }\n      case AnnotationSymbolType.TRIANGLE: {\n        isOn = checkPointInTriangle(\n          [\n            { x: this._symbolCoordinate.x - size / 2, y: this._symbolCoordinate.y + size / 2 },\n            { x: this._symbolCoordinate.x, y: this._symbolCoordinate.y - size / 2 },\n            { x: this._symbolCoordinate.x + size / 2, y: this._symbolCoordinate.y + size / 2 }\n          ],\n          mouseCoordinate\n        )\n        break\n      }\n      case AnnotationSymbolType.CUSTOM: {\n        isOn = this.checkPointInCustomSymbol({\n          mouseCoordinate,\n          coordinate: this._symbolCoordinate,\n          size\n        })\n        break\n      }\n      default: {\n        break\n      }\n    }\n    if (isOn) {\n      return {\n        id: this._id,\n        instance: this\n      }\n    }\n  }\n\n  /**\n   * 生成标识坐标\n   * @param x\n   */\n  createSymbolCoordinate (x) {\n    const styles = this._styles || this._chartData.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const offset = symbolOptions.offset || []\n    this._symbolCoordinate = { x: x + (offset[0] || 0) }\n  }\n\n  /**\n   * 获取点\n   * @return {*}\n   */\n  points () {\n    return this._point\n  }\n\n  /**\n   * 检查鼠标点是否在自定义标识内\n   * @param mouseCoordinate\n   * @param coordinate\n   * @param size\n   */\n  checkPointInCustomSymbol ({ mouseCoordinate, coordinate, size }) {}\n\n  /**\n   * 绘制自定义标识\n   * @param ctx\n   * @param point\n   * @param coordinate\n   * @param viewport\n   * @param styles\n   * @param isActive\n   */\n  drawCustomSymbol ({ ctx, point, coordinate, viewport, styles, isActive }) {}\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from '../Overlay'\nimport { LineStyle, OverlayPosition, YAxisPosition } from '../../../data/options/styleOptions'\nimport { renderHorizontalLine } from '../../../renderer/line'\nimport { isValid, isObject } from '../../../utils/typeChecks'\nimport { calcTextWidth, createFont } from '../../../utils/canvas'\nimport { renderFillRoundRect } from '../../../renderer/rect'\nimport { renderText } from '../../../renderer/text'\n\nexport default class Tag extends Overlay {\n  constructor ({\n    id, point, text, mark, chartData, xAxis, yAxis, styles\n  }) {\n    super({ id, chartData, xAxis, yAxis })\n    this._point = point || {}\n    this._text = text\n    this._mark = mark\n    this.setStyles(styles, chartData.styleOptions().tag)\n  }\n\n  /**\n   * 更新\n   * @param point\n   * @param text\n   * @param mark\n   * @param styles\n   * @return {boolean}\n   */\n  update ({ point, text, mark, styles }) {\n    let success = false\n    if (isObject(point)) {\n      this._point = point\n      success = true\n    }\n    if (isValid(text)) {\n      this._text = text\n      success = true\n    }\n    if (isValid(mark)) {\n      this._mark = mark\n      success = true\n    }\n    if (this.setStyles(styles, this._chartData.styleOptions().tag)) {\n      success = true\n    }\n    return success\n  }\n\n  /**\n   * 绘制标记和线\n   * @param ctx\n   */\n  drawMarkLine (ctx) {\n    const options = this._chartData.styleOptions()\n    const yAxisOptions = options.yAxis\n    const tagOptions = this._styles || options.tag\n    const y = this._getY(tagOptions)\n    ctx.save()\n    this._drawLine(ctx, y, tagOptions.line)\n    this._drawMark(ctx, y, tagOptions, yAxisOptions)\n    ctx.restore()\n  }\n\n  /**\n   * 绘制值\n   */\n  drawText (ctx) {\n    if (!isValid(this._text)) {\n      return\n    }\n    const options = this._chartData.styleOptions()\n    const tagOptions = this._styles || options.tag\n    const tagTextOptions = tagOptions.text\n    ctx.font = createFont(tagTextOptions.size, tagTextOptions.weight, tagTextOptions.family)\n    const rectWidth = this._getTextRectWidth(ctx, tagTextOptions)\n    const rectHeight = tagTextOptions.paddingTop + tagTextOptions.paddingBottom + tagTextOptions.size\n    let x\n    if (this._yAxis.isFromYAxisZero()) {\n      x = 0\n    } else {\n      x = this._yAxis.width() - rectWidth\n    }\n    const y = this._getY(tagOptions)\n    renderFillRoundRect(\n      ctx,\n      tagTextOptions.backgroundColor,\n      x,\n      y - rectHeight / 2,\n      rectWidth,\n      rectHeight,\n      tagTextOptions.borderRadius\n    )\n    renderText(ctx, tagTextOptions.color, x + tagTextOptions.paddingLeft, y, this._text)\n  }\n\n  /**\n   * 绘制线\n   * @param ctx\n   * @param y\n   * @param tagLineOptions\n   * @private\n   */\n  _drawLine (ctx, y, tagLineOptions) {\n    if (!tagLineOptions.show) {\n      return\n    }\n    ctx.strokeStyle = tagLineOptions.color\n    ctx.lineWidth = tagLineOptions.size\n    if (tagLineOptions.style === LineStyle.DASH) {\n      ctx.setLineDash(tagLineOptions.dashValue)\n    }\n    renderHorizontalLine(ctx, y, 0, this._xAxis.width())\n  }\n\n  /**\n   * 绘制标记\n   * @param ctx\n   * @param y\n   * @param tagOptions\n   * @param yAxisOptions\n   * @private\n   */\n  _drawMark (ctx, y, tagOptions, yAxisOptions) {\n    if (!isValid(this._mark)) {\n      return\n    }\n    const tagMarkOptions = tagOptions.mark\n    ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family)\n    const rectWidth = tagMarkOptions.paddingLeft + tagMarkOptions.paddingRight + calcTextWidth(ctx, this._mark)\n    const rectHeight = tagMarkOptions.paddingTop + tagMarkOptions.paddingBottom + tagMarkOptions.size\n    let x\n    if (yAxisOptions.inside) {\n      let valueRectWidth = 0\n      if (isValid(this._text)) {\n        valueRectWidth = this._getTextRectWidth(ctx, tagOptions.text)\n      }\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        x = valueRectWidth\n      } else {\n        x = this._xAxis.width() - valueRectWidth - rectWidth\n      }\n    } else {\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        x = 0\n      } else {\n        x = this._xAxis.width() - rectWidth\n      }\n    }\n    renderFillRoundRect(\n      ctx,\n      tagMarkOptions.backgroundColor,\n      x,\n      y - rectHeight / 2,\n      rectWidth,\n      rectHeight,\n      tagMarkOptions.borderRadius\n    )\n    ctx.textBaseline = 'middle'\n    ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family)\n    renderText(ctx, tagMarkOptions.color, x + tagMarkOptions.paddingLeft, y, this._mark)\n  }\n\n  /**\n   * 获取坐标y值\n   * @param tagOptions\n   * @return {*}\n   * @private\n   */\n  _getY (tagOptions) {\n    const offset = tagOptions.offset\n    switch (tagOptions.position) {\n      case OverlayPosition.TOP: {\n        return offset\n      }\n      case OverlayPosition.BOTTOM: {\n        return this._yAxis.height() + offset\n      }\n      default: {\n        return this._yAxis.convertToNicePixel(this._point.price) + offset\n      }\n    }\n  }\n\n  /**\n   * 获取值的矩形宽度\n   * @param ctx\n   * @param textOptions\n   * @return {*}\n   * @private\n   */\n  _getTextRectWidth (ctx, textOptions) {\n    ctx.font = createFont(textOptions.size, textOptions.weight, textOptions.family)\n    return textOptions.paddingLeft + textOptions.paddingRight + calcTextWidth(ctx, this._text)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChartData from '../data/ChartData'\nimport { createTechnicalIndicatorInfo } from '../base/technicalindicator/technicalIndicatorControl'\n\nimport CandlePane from './CandlePane'\nimport XAxisPane from './XAxisPane'\n\nimport { YAxisPosition } from '../data/options/styleOptions'\nimport { isArray, isBoolean, isFunction, isValid, isNumber } from '../utils/typeChecks'\nimport { formatValue } from '../utils/format'\nimport TechnicalIndicatorPane from './TechnicalIndicatorPane'\nimport SeparatorPane from './SeparatorPane'\n\nimport ChartEvent from '../event/ChartEvent'\nimport { getPixelRatio } from '../utils/canvas'\nimport { throttle } from '../utils/performance'\nimport Annotation from '../base/overlay/annotation/Annotation'\nimport Tag from '../base/overlay/tag/Tag'\n\nimport {\n  CANDLE_PANE_ID,\n  DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT,\n  TECHNICAL_INDICATOR_PANE_ID_PREFIX,\n  GRAPHIC_MARK_ID_PREFIX,\n  ActionType, InvalidateLevel\n} from '../data/constants'\n\nexport default class ChartPane {\n  constructor (container, styleOptions) {\n    this._initChartContainer(container)\n    this._graphicMarkBaseId = 0\n    this._paneBaseId = 0\n    this._separatorDragStartTopPaneHeight = 0\n    this._separatorDragStartBottomPaneHeight = 0\n    this._chartData = new ChartData(styleOptions, {\n      invalidate: this._invalidatePane.bind(this),\n      crosshair: this._crosshairObserver.bind(this)\n    })\n    this._xAxisPane = new XAxisPane({ container: this._chartContainer, chartData: this._chartData })\n    this._panes = new Map([[CANDLE_PANE_ID, new CandlePane({\n      container: this._chartContainer,\n      chartData: this._chartData,\n      xAxis: this._xAxisPane.xAxis(),\n      id: CANDLE_PANE_ID\n    })]])\n    this._separators = new Map()\n    this._chartWidth = {}\n    this._chartHeight = {}\n    this._chartEvent = new ChartEvent(this._chartContainer, this._chartData)\n    this.adjustPaneViewport(true, true, true)\n  }\n\n  /**\n   * 初始化图表容器\n   * @param container\n   * @private\n   */\n  _initChartContainer (container) {\n    this._container = container\n    this._chartContainer = document.createElement('div')\n    this._chartContainer.style.userSelect = 'none'\n    this._chartContainer.style.webkitUserSelect = 'none'\n    this._chartContainer.style.msUserSelect = 'none'\n    this._chartContainer.style.MozUserSelect = 'none'\n    this._chartContainer.style.webkitTapHighlightColor = 'transparent'\n    this._chartContainer.style.position = 'relative'\n    this._chartContainer.style.outline = 'none'\n    this._chartContainer.style.borderStyle = 'none'\n    this._chartContainer.style.width = '100%'\n    this._chartContainer.style.cursor = 'crosshair'\n    this._chartContainer.tabIndex = 1\n    container.appendChild(this._chartContainer)\n  }\n\n  /**\n   * 十字光标观察者\n   * @private\n   */\n  _crosshairObserver ({ dataIndex, kLineData, x, y }) {\n    if (this.chartData().hasAction(ActionType.CROSSHAIR)) {\n      const technicalIndicatorData = {}\n      this._panes.forEach((pane, id) => {\n        const data = {}\n        pane.technicalIndicators().forEach(tech => {\n          const result = tech.result\n          data[tech.name] = result[dataIndex]\n        })\n        technicalIndicatorData[id] = data\n      })\n      this._chartData.actionExecute(ActionType.CROSSHAIR, {\n        coordinate: { x, y },\n        dataIndex,\n        kLineData,\n        technicalIndicatorData\n      })\n    }\n  }\n\n  /**\n   * 分割线拖拽开始\n   * @param topPaneId\n   * @param bottomPaneId\n   * @private\n   */\n  _separatorStartDrag (topPaneId, bottomPaneId) {\n    this._separatorDragStartTopPaneHeight = this._panes.get(topPaneId).height()\n    this._separatorDragStartBottomPaneHeight = this._panes.get(bottomPaneId).height()\n  }\n\n  /**\n   * 分割线拖拽\n   * @param dragDistance\n   * @param topPaneId\n   * @param bottomPaneId\n   * @private\n   */\n  _separatorDrag (dragDistance, topPaneId, bottomPaneId) {\n    let topPaneHeight = this._separatorDragStartTopPaneHeight + dragDistance\n    let bottomPaneHeight = this._separatorDragStartBottomPaneHeight - dragDistance\n    if (topPaneHeight > this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight) {\n      topPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight\n      bottomPaneHeight = 0\n    }\n    if (topPaneHeight < 0) {\n      topPaneHeight = 0\n      bottomPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight\n    }\n    this._panes.get(topPaneId).setHeight(topPaneHeight)\n    this._panes.get(bottomPaneId).setHeight(bottomPaneHeight)\n    this._chartData.actionExecute(ActionType.PANE_DRAG, { topPaneId, bottomPaneId, topPaneHeight, bottomPaneHeight })\n    this.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 更新所有pane\n   * @private\n   */\n  _invalidatePane (invalidateLevel = InvalidateLevel.FULL) {\n    if (invalidateLevel === InvalidateLevel.OVERLAY) {\n      this._xAxisPane.invalidate(invalidateLevel)\n      this._panes.forEach((pane) => {\n        pane.invalidate(invalidateLevel)\n      })\n    } else {\n      let shouldMeasureWidth = false\n      this._panes.forEach((pane) => {\n        const should = pane.yAxis().computeAxis()\n        if (should) {\n          shouldMeasureWidth = should\n        }\n      })\n      this.adjustPaneViewport(false, shouldMeasureWidth, true)\n    }\n  }\n\n  /**\n   * 计算所有pane的指标\n   * @private\n   */\n  _calcAllPaneTechnicalIndicator () {\n    const tasks = []\n    this._panes.forEach(pane => {\n      tasks.push(\n        Promise.resolve(pane.calcAllTechnicalIndicator())\n      )\n    })\n    Promise.all(tasks).then(\n      result => {\n        const shouldMeasureWidth = result.indexOf(true) > -1\n        this.adjustPaneViewport(false, shouldMeasureWidth, true)\n      }\n    )\n  }\n\n  /**\n   * 测量pane高度\n   * @private\n   */\n  _measurePaneHeight () {\n    const styleOptions = this._chartData.styleOptions()\n    const paneHeight = this._container.offsetHeight\n    const separatorSize = styleOptions.separator.size\n    const separatorTotalHeight = separatorSize * this._separators.size\n    const xAxisHeight = this._xAxisPane.xAxis().getSelfHeight()\n    const paneExcludeXAxisSeparatorHeight = paneHeight - xAxisHeight - separatorTotalHeight\n    let techPaneTotalHeight = 0\n    this._panes.forEach(pane => {\n      if (pane.id() !== CANDLE_PANE_ID) {\n        const paneHeight = pane.height()\n        if (techPaneTotalHeight + paneHeight > paneExcludeXAxisSeparatorHeight) {\n          pane.setHeight(paneExcludeXAxisSeparatorHeight - techPaneTotalHeight)\n          techPaneTotalHeight = paneExcludeXAxisSeparatorHeight\n        } else {\n          techPaneTotalHeight += paneHeight\n        }\n      }\n    })\n\n    const candlePaneHeight = paneExcludeXAxisSeparatorHeight - techPaneTotalHeight\n\n    const paneContentSize = {}\n    paneContentSize[CANDLE_PANE_ID] = { contentTop: 0, contentBottom: candlePaneHeight }\n    let contentTop = candlePaneHeight\n    let contentBottom = candlePaneHeight\n    this._panes.get(CANDLE_PANE_ID).setHeight(candlePaneHeight)\n    this._chartHeight[CANDLE_PANE_ID] = candlePaneHeight\n    this._panes.forEach(pane => {\n      if (pane.id() !== CANDLE_PANE_ID) {\n        const paneHeight = pane.height()\n        contentBottom += (paneHeight + separatorSize)\n        paneContentSize[pane.id()] = { contentTop, contentBottom }\n        this._chartHeight[pane.id()] = paneHeight\n        contentTop = contentBottom\n      }\n    })\n    this._xAxisPane.setHeight(xAxisHeight)\n    this._chartHeight.xAxis = xAxisHeight\n    this._chartHeight.total = paneHeight\n    this._chartEvent.setPaneContentSize(paneContentSize)\n  }\n\n  /**\n   * 测量pan宽度\n   * @private\n   */\n  _measurePaneWidth () {\n    const styleOptions = this._chartData.styleOptions()\n    const yAxisOptions = styleOptions.yAxis\n    const isYAxisLeft = yAxisOptions.position === YAxisPosition.LEFT\n    const isOutside = !yAxisOptions.inside\n    const paneWidth = this._container.offsetWidth\n    let mainWidth\n    let yAxisWidth = Number.MIN_SAFE_INTEGER\n    let yAxisOffsetLeft\n    let mainOffsetLeft\n    if (isOutside) {\n      this._panes.forEach(pane => {\n        yAxisWidth = Math.max(yAxisWidth, pane.yAxis().getSelfWidth())\n      })\n      mainWidth = paneWidth - yAxisWidth\n      if (isYAxisLeft) {\n        yAxisOffsetLeft = 0\n        mainOffsetLeft = yAxisWidth\n      } else {\n        mainOffsetLeft = 0\n        yAxisOffsetLeft = paneWidth - yAxisWidth\n      }\n    } else {\n      mainWidth = paneWidth\n      yAxisWidth = paneWidth\n      yAxisOffsetLeft = 0\n      mainOffsetLeft = 0\n    }\n\n    this._chartData.setTotalDataSpace(mainWidth)\n\n    this._panes.forEach((pane, paneId) => {\n      pane.setWidth(mainWidth, yAxisWidth)\n      pane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft)\n      const separator = this._separators.get(paneId)\n      separator && separator.setSize(mainOffsetLeft, mainWidth)\n    })\n    this._chartWidth = { content: mainWidth, yAxis: yAxisWidth, total: paneWidth }\n    this._xAxisPane.setWidth(mainWidth, yAxisWidth)\n    this._xAxisPane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft)\n    this._chartEvent.setChartContentSize({ contentLeft: mainOffsetLeft, contentRight: mainOffsetLeft + mainWidth })\n  }\n\n  /**\n   * 调整窗口尺寸\n   * @param shouldMeasureHeight\n   * @param shouldMeasureWidth\n   * @param shouldLayout\n   * @param shouldComputeAxis\n   * @param shouldForceComputeAxis\n   */\n  adjustPaneViewport (\n    shouldMeasureHeight, shouldMeasureWidth, shouldLayout, shouldComputeAxis, shouldForceComputeAxis\n  ) {\n    if (shouldMeasureHeight) {\n      this._measurePaneHeight()\n    }\n    let isAdjust = false\n    if (shouldComputeAxis) {\n      this._panes.forEach(pane => {\n        const adjust = pane.yAxis().computeAxis(shouldForceComputeAxis)\n        if (!isAdjust) {\n          isAdjust = adjust\n        }\n      })\n    }\n    if ((!shouldComputeAxis && shouldMeasureWidth) || (shouldComputeAxis && isAdjust)) {\n      this._measurePaneWidth()\n    }\n    if (shouldLayout) {\n      this._xAxisPane.xAxis().computeAxis(true)\n      this._xAxisPane.layout()\n      this._panes.forEach(pane => {\n        pane.layout()\n      })\n    }\n  }\n\n  /**\n   * 获取图表上的数据\n   * @returns {ChartData}\n   */\n  chartData () {\n    return this._chartData\n  }\n\n  /**\n   * 覆盖技术指标\n   * @param techInstance\n   * @param name\n   * @param calcParams\n   * @param calcParamsAllowDecimal\n   * @param precision\n   * @param styles\n   */\n  overrideTechnicalIndicator (techInstance, { name, calcParams, calcParamsAllowDecimal, precision, styles }) {\n    techInstance.setCalcParamsAllowDecimal(calcParamsAllowDecimal)\n    const calcParamsSuccess = techInstance.setCalcParams(calcParams)\n    const precisionSuccess = techInstance.setPrecision(precision)\n    const defaultTechnicalStyleOptions = this._chartData.styleOptions().technicalIndicator\n    const styleSuccess = techInstance.setStyles(styles, defaultTechnicalStyleOptions)\n    if (calcParamsSuccess || precisionSuccess || styleSuccess) {\n      let shouldAdjust = false\n      const tasks = []\n      this._panes.forEach(pane => {\n        const techs = pane.technicalIndicators()\n        if (techs.has(name)) {\n          shouldAdjust = true\n          const tech = techs.get(name)\n          if (calcParamsSuccess) {\n            tasks.push(\n              Promise.resolve(pane.calcTechnicalIndicator(tech))\n            )\n          }\n        }\n      })\n      if (shouldAdjust) {\n        Promise.all(tasks).then(\n          _ => {\n            this.adjustPaneViewport(false, true, true, true)\n          }\n        )\n      }\n    }\n  }\n\n  /**\n   * 处理数组数据\n   * @param dataList\n   * @param more\n   * @param extendFun\n   * @private\n   */\n  _applyDataList (dataList, more, extendFun) {\n    if (isArray(dataList)) {\n      if (isFunction(extendFun)) {\n        extendFun()\n      }\n      this._chartData.addData(dataList, 0, more)\n      this._calcAllPaneTechnicalIndicator()\n    }\n  }\n\n  /**\n   * 添加新数据\n   * @param dataList\n   * @param more\n   */\n  applyNewData (dataList, more) {\n    this._applyDataList(dataList, more, () => {\n      this._chartData.clearDataList()\n    })\n  }\n\n  /**\n   * 添加更多数据\n   * @param dataList\n   * @param more\n   */\n  applyMoreData (dataList, more) {\n    this._applyDataList(dataList, more)\n  }\n\n  /**\n   * 更新数据\n   * @param data\n   */\n  updateData (data) {\n    const dataList = this._chartData.dataList()\n    const dataSize = dataList.length\n    // 这里判断单个数据应该添加到哪个位置\n    const timestamp = formatValue(data, 'timestamp', 0)\n    const lastDataTimestamp = formatValue(dataList[dataSize - 1], 'timestamp', 0)\n    if (timestamp >= lastDataTimestamp) {\n      let pos = dataSize\n      if (timestamp === lastDataTimestamp) {\n        pos = dataSize - 1\n      }\n      this._chartData.addData(data, pos)\n      this._calcAllPaneTechnicalIndicator()\n    }\n  }\n\n  /**\n   * 移除指标\n   * @param paneId\n   * @param name\n   */\n  removeTechnicalIndicator (paneId, name) {\n    if (this._panes.has(paneId)) {\n      if (paneId === CANDLE_PANE_ID) {\n        if (this._panes.get(CANDLE_PANE_ID).removeTechnicalIndicator(name)) {\n          this.adjustPaneViewport(false, true, true, true)\n        }\n      } else {\n        const pane = this._panes.get(paneId)\n        const removed = pane.removeTechnicalIndicator(name)\n        if (pane.isEmptyTechnicalIndicator()) {\n          pane.destroy()\n          const deleteSeparatorTopPaneId = this._separators.get(paneId).topPaneId()\n          this._separators.get(paneId).destroy()\n          this._panes.delete(paneId)\n          this._separators.delete(paneId)\n          this._separators.forEach(separator => {\n            const topPaneId = separator.topPaneId()\n            if (!this._separators.has(topPaneId)) {\n              separator.updatePaneId(deleteSeparatorTopPaneId)\n            }\n          })\n          this.adjustPaneViewport(true, true, true, true, true)\n        } else {\n          if (removed) {\n            this.adjustPaneViewport(false, true, true, true)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * 设置指标类型\n   * @param tech 技术指标实例\n   * @param isStack 是否覆盖\n   * @param options 配置\n   */\n  createTechnicalIndicator (tech, isStack, options = {}) {\n    if (this._panes.has(options.id)) {\n      this.setPaneOptions(options, this._panes.get(options.id).setTechnicalIndicator(tech, isStack))\n      return options.id\n    }\n    const id = options.id || `${TECHNICAL_INDICATOR_PANE_ID_PREFIX}${++this._paneBaseId}`\n    const dragEnabled = isBoolean(options.dragEnabled) ? options.dragEnabled : true\n    this._separators.set(id, new SeparatorPane(\n      this._chartContainer,\n      this._chartData,\n      Array.from(this._panes.keys()).pop(),\n      id,\n      dragEnabled,\n      {\n        startDrag: this._separatorStartDrag.bind(this),\n        drag: throttle(this._separatorDrag.bind(this), 50)\n      }\n    ))\n    this._panes.set(id,\n      new TechnicalIndicatorPane({\n        container: this._chartContainer,\n        chartData: this._chartData,\n        xAxis: this._xAxisPane.xAxis(),\n        name: tech.name,\n        id,\n        height: options.height || DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT\n      })\n    )\n    this.adjustPaneViewport(true, true, true, true, true)\n    return id\n  }\n\n  /**\n   * 获取窗口技术指标\n   * @param paneId\n   * @return {{}}\n   */\n  getPaneTechnicalIndicator (paneId) {\n    const technicalIndicatorInfo = (pane) => {\n      const paneTechs = {}\n      pane.technicalIndicators().forEach(tech => {\n        paneTechs[tech.name] = createTechnicalIndicatorInfo(tech)\n      })\n      return paneTechs\n    }\n\n    if (isValid(paneId)) {\n      if (this._panes.has(paneId)) {\n        return technicalIndicatorInfo(this._panes.get(paneId))\n      }\n    } else {\n      const techs = {}\n      this._panes.forEach(pane => {\n        techs[pane.id()] = technicalIndicatorInfo(pane)\n      })\n      return techs\n    }\n    return {}\n  }\n\n  /**\n   * 创建图形标记\n   * @param GraphicMark\n   * @param options\n   */\n  createGraphicMark (GraphicMark, options = {}) {\n    const {\n      id, points, styles, lock,\n      onDrawStart, onDrawing,\n      onDrawEnd, onClick,\n      onRightClick, onPressedMove,\n      onMouseEnter, onMouseLeave,\n      onRemove\n    } = options\n    const graphicMarkId = id || `${GRAPHIC_MARK_ID_PREFIX}${++this._graphicMarkBaseId}`\n    const graphicMarkInstance = new GraphicMark({\n      id: graphicMarkId,\n      chartData: this._chartData,\n      xAxis: this._xAxisPane.xAxis(),\n      yAxis: this._panes.get(CANDLE_PANE_ID).yAxis(),\n      points,\n      styles,\n      lock\n    })\n    if (isFunction(onDrawStart)) {\n      graphicMarkInstance.onDrawStart = onDrawStart\n      graphicMarkInstance.onDrawStart({ id: graphicMarkId })\n    }\n    if (isFunction(onDrawing)) {\n      graphicMarkInstance.onDrawing = onDrawing\n    }\n    if (isFunction(onDrawEnd)) {\n      graphicMarkInstance.onDrawEnd = onDrawEnd\n    }\n    if (isFunction(onClick)) {\n      graphicMarkInstance.onClick = onClick\n    }\n    if (isFunction(onRightClick)) {\n      graphicMarkInstance.onRightClick = onRightClick\n    }\n    if (isFunction(onPressedMove)) {\n      graphicMarkInstance.onPressedMove = onPressedMove\n    }\n    if (isFunction(onMouseEnter)) {\n      graphicMarkInstance.onMouseEnter = onMouseEnter\n    }\n    if (isFunction(onMouseLeave)) {\n      graphicMarkInstance.onMouseLeave = onMouseLeave\n    }\n    if (isFunction(onRemove)) {\n      graphicMarkInstance.onRemove = onRemove\n    }\n    if (this._chartData.addGraphicMarkInstance(graphicMarkInstance)) {\n      return graphicMarkId\n    }\n  }\n\n  /**\n   * 创建注解\n   * @param annotations\n   */\n  createAnnotation (annotations) {\n    const instances = []\n    annotations.forEach(({\n      point,\n      styles,\n      checkPointInCustomSymbol,\n      drawCustomSymbol,\n      drawExtend,\n      onClick,\n      onRightClick,\n      onMouseEnter,\n      onMouseLeave\n    }) => {\n      if (point && point.timestamp) {\n        const annotationInstance = new Annotation({\n          id: point.timestamp,\n          chartData: this._chartData,\n          point,\n          xAxis: this._xAxisPane.xAxis(),\n          yAxis: this._panes.get(CANDLE_PANE_ID).yAxis(),\n          styles\n        })\n        if (isFunction(drawExtend)) {\n          annotationInstance.drawExtend = drawExtend\n        }\n        if (isFunction(checkPointInCustomSymbol)) {\n          annotationInstance.checkPointInCustomSymbol = checkPointInCustomSymbol\n        }\n        if (isFunction(drawCustomSymbol)) {\n          annotationInstance.drawCustomSymbol = drawCustomSymbol\n        }\n        if (isFunction(onClick)) {\n          annotationInstance.onClick = onClick\n        }\n        if (isFunction(onRightClick)) {\n          annotationInstance.onRightClick = onRightClick\n        }\n        if (isFunction(onMouseEnter)) {\n          annotationInstance.onMouseEnter = onMouseEnter\n        }\n        if (isFunction(onMouseLeave)) {\n          annotationInstance.onMouseLeave = onMouseLeave\n        }\n        instances.push(annotationInstance)\n      }\n    })\n    if (instances.length > 0) {\n      this._chartData.addAnnotations(instances)\n    }\n  }\n\n  /**\n   * 创建标签\n   * @param tags\n   */\n  createTag (tags) {\n    const instances = []\n    let shouldUpdate = false\n    let shouldAdd = false\n    tags.forEach(({ id, point, text, mark, styles }) => {\n      if (isValid(id)) {\n        const tag = this._chartData.getTag(id)\n        if (tag) {\n          const updateSuccess = tag.update({ point, text, mark, styles })\n          if (!shouldUpdate) {\n            shouldUpdate = updateSuccess\n          }\n        } else {\n          shouldAdd = true\n          instances.push(new Tag({\n            id,\n            point,\n            text,\n            mark,\n            styles,\n            chartData: this._chartData,\n            xAxis: this._xAxisPane.xAxis(),\n            yAxis: this._panes.get(CANDLE_PANE_ID).yAxis()\n          }))\n        }\n      }\n    })\n    if (shouldAdd) {\n      this._chartData.addTags(instances)\n    } else {\n      if (shouldUpdate) {\n        this._invalidatePane(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 设置窗体参数\n   * @param options\n   * @param forceShouldAdjust\n   */\n  setPaneOptions (options, forceShouldAdjust) {\n    let shouldAdjust = forceShouldAdjust\n    let shouldMeasureHeight = false\n    if (options.id !== CANDLE_PANE_ID) {\n      const pane = this._panes.get(options.id)\n      if (pane) {\n        if (isNumber(options.height) && options.height > 0 && pane.height() !== options.height) {\n          shouldAdjust = true\n          pane.setHeight(options.height)\n          shouldMeasureHeight = true\n        }\n        if (isBoolean(options.dragEnabled)) {\n          this._separators.get(options.id).setDragEnabled(options.dragEnabled)\n        }\n      }\n    }\n    if (shouldAdjust) {\n      this.adjustPaneViewport(shouldMeasureHeight, true, true, true)\n    }\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    this._chartData.setTimezone(timezone)\n    this._xAxisPane.xAxis().computeAxis(true)\n    this._xAxisPane.invalidate(InvalidateLevel.FULL)\n  }\n\n  /**\n   * 将值装换成像素\n   * @param timestamp\n   * @param value\n   * @param paneId\n   * @param dataIndexXAxis\n   * @param absoluteYAxis\n   */\n  convertToPixel (value, { paneId = CANDLE_PANE_ID, dataIndexXAxis, absoluteYAxis }) {\n    const values = [].concat(value)\n    let coordinates = []\n    const separatorSize = this._chartData.styleOptions().separator.size\n    let absoluteTop = 0\n    const panes = this._panes.values()\n    for (const pane of panes) {\n      if (pane.id() === paneId) {\n        coordinates = values.map(({ xAxisValue, yAxisValue }) => {\n          const coordinate = {}\n          if (isValid(xAxisValue)) {\n            const dataIndex = dataIndexXAxis ? xAxisValue : this._chartData.timestampToDataIndex(xAxisValue)\n            coordinate.x = this._xAxisPane.xAxis().convertToPixel(dataIndex)\n          }\n          if (isValid(yAxisValue)) {\n            const y = pane.yAxis().convertToPixel(yAxisValue)\n            coordinate.y = absoluteYAxis ? absoluteTop + y : y\n          }\n          return coordinate\n        })\n        break\n      }\n      absoluteTop += (pane.height() + separatorSize)\n    }\n    return isArray(value) ? coordinates : (coordinates[0] || {})\n  }\n\n  /**\n   * 将像素转换成值\n   * @param coordinate\n   * @param paneId\n   * @param dataIndexXAxis\n   * @param absoluteYAxis\n   * @return {{}[]|*[]}\n   */\n  convertFromPixel (coordinate, { paneId = CANDLE_PANE_ID, dataIndexXAxis, absoluteYAxis }) {\n    const coordinates = [].concat(coordinate)\n    let values = []\n    const separatorSize = this._chartData.styleOptions().separator.size\n    let absoluteTop = 0\n    const panes = this._panes.values()\n    for (const pane of panes) {\n      if (pane.id() === paneId) {\n        values = coordinates.map(({ x, y }) => {\n          const value = {}\n          if (isValid(x)) {\n            const v = this._xAxisPane.xAxis().convertFromPixel(x)\n            value.xAxisValue = dataIndexXAxis ? v : this._chartData.dataIndexToTimestamp(v)\n          }\n          if (isValid(y)) {\n            const ry = absoluteYAxis ? y - absoluteTop : y\n            value.yAxisValue = pane.yAxis().convertFromPixel(ry)\n          }\n          return value\n        })\n        break\n      }\n      absoluteTop += pane.height() + separatorSize\n    }\n    return isArray(coordinate) ? values : (values[0] || {})\n  }\n\n  /**\n   * 图表宽度\n   * @return {*|{}}\n   */\n  chartWidth () {\n    return this._chartWidth\n  }\n\n  /**\n   * 图表高度\n   * @return {*|{}}\n   */\n  chartHeight () {\n    return this._chartHeight\n  }\n\n  /**\n   * 获取图表转换为图片后url\n   * @param includeOverlay,\n   * @param type\n   * @param backgroundColor\n   */\n  getConvertPictureUrl (includeOverlay, type, backgroundColor) {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    const width = this._chartContainer.offsetWidth\n    const height = this._chartContainer.offsetHeight\n    canvas.style.width = `${width}px`\n    canvas.style.height = `${height}px`\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    ctx.fillStyle = backgroundColor\n    ctx.fillRect(0, 0, width, height)\n    let offsetTop = 0\n    this._panes.forEach((pane, paneId) => {\n      if (paneId !== CANDLE_PANE_ID) {\n        const separator = this._separators.get(paneId)\n        ctx.drawImage(\n          separator.getImage(),\n          0, offsetTop, width, separator.height()\n        )\n        offsetTop += separator.height()\n      }\n      ctx.drawImage(\n        pane.getImage(includeOverlay),\n        0, offsetTop, width, pane.height()\n      )\n      offsetTop += pane.height()\n    })\n    ctx.drawImage(\n      this._xAxisPane.getImage(includeOverlay),\n      0, offsetTop, width, this._xAxisPane.height()\n    )\n    return canvas.toDataURL(`image/${type}`)\n  }\n\n  destroy () {\n    this._panes.forEach(pane => {\n      pane.destroy()\n    })\n    this._separators.forEach(pane => {\n      pane.destroy()\n    })\n    this._panes.clear()\n    this._separators.clear()\n    this._xAxisPane.destroy()\n    this._container.removeChild(this._chartContainer)\n    this._chartEvent.destroy()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChartPane from './pane/ChartPane'\nimport { clone, isNumber, isObject, isArray, isFunction } from './utils/typeChecks'\nimport { logWarn } from './utils/logger'\nimport { requestAnimationFrame } from './utils/compatible'\n\nexport default class Chart {\n  constructor (container, styleOptions) {\n    this._chartPane = new ChartPane(container, styleOptions)\n  }\n\n  /**\n   * 获取宽尺寸\n   * @return {*|{}}\n   */\n  getWidth () {\n    return this._chartPane.chartWidth()\n  }\n\n  /**\n   * 获取高度尺寸\n   * @return {*|{}}\n   */\n  getHeight () {\n    return this._chartPane.chartHeight()\n  }\n\n  /**\n   * 设置样式配置\n   * @param options\n   */\n  setStyleOptions (options) {\n    if (!isObject(options)) {\n      logWarn('setStyleOptions', 'options')\n      return\n    }\n    this._chartPane.chartData().applyStyleOptions(options)\n    this._chartPane.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 获取样式配置\n   * @returns {[]|*[]}\n   */\n  getStyleOptions () {\n    return clone(this._chartPane.chartData().styleOptions())\n  }\n\n  /**\n   * 覆盖技术指标\n   * @param override\n   */\n  overrideTechnicalIndicator (override) {\n    if (!isObject(override)) {\n      logWarn('overrideTechnicalIndicator', 'override', 'override must be an object!!!')\n      return\n    }\n    const tech = this._chartPane.chartData().getTechnicalIndicatorInstance(override.name)\n    if (!tech) {\n      logWarn('overrideTechnicalIndicator', 'override.name', 'can not find the corresponding technical indicator!!!')\n      return\n    }\n    this._chartPane.overrideTechnicalIndicator(tech, override)\n  }\n\n  /**\n   * 获取技术指标名字获取技术指标\n   * @param name\n   * @return {{}|{series: *, calcParams: *, precision: *, name: *}}\n   */\n  getTechnicalIndicatorByName (name) {\n    return this._chartPane.chartData().getTechnicalIndicatorInfo(name)\n  }\n\n  /**\n   * 获取窗口上的技术指标\n   * @param paneId\n   * @return {{}}\n   */\n  getTechnicalIndicatorByPaneId (paneId) {\n    return this._chartPane.getPaneTechnicalIndicator(paneId)\n  }\n\n  /**\n   * 设置价格数量精度\n   * @param pricePrecision\n   * @param volumePrecision\n   */\n  setPriceVolumePrecision (pricePrecision, volumePrecision) {\n    if (!isNumber(pricePrecision) || pricePrecision < 0) {\n      logWarn('setPriceVolumePrecision', 'pricePrecision', 'pricePrecision must be a number and greater than zero!!!')\n      return\n    }\n    if (!isNumber(volumePrecision) || volumePrecision < 0) {\n      logWarn('setPriceVolumePrecision', 'volumePrecision', 'volumePrecision must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartData().setPriceVolumePrecision(pricePrecision, volumePrecision)\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    this._chartPane.setTimezone(timezone)\n  }\n\n  /**\n   * 获取当前时区\n   */\n  getTimezone () {\n    return this._chartPane.chartData().timezone()\n  }\n\n  /**\n   * 重置尺寸，总是会填充父容器\n   */\n  resize () {\n    this._chartPane.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 设置右边间距\n   * @param space\n   */\n  setOffsetRightSpace (space) {\n    if (!isNumber(space)) {\n      logWarn('setOffsetRightSpace', 'space', 'space must be a number!!!')\n      return\n    }\n    this._chartPane.chartData().setOffsetRightSpace(space, true)\n  }\n\n  /**\n   * 设置左边可见的最小bar数量\n   * @param barCount\n   */\n  setLeftMinVisibleBarCount (barCount) {\n    if (!isNumber(barCount) || barCount <= 0) {\n      logWarn('setLeftMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartData().setLeftMinVisibleBarCount(Math.ceil(barCount))\n  }\n\n  /**\n   * 设置右边可见的最小bar数量\n   * @param barCount\n   */\n  setRightMinVisibleBarCount (barCount) {\n    if (!isNumber(barCount) || barCount <= 0) {\n      logWarn('setRightMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartData().setRightMinVisibleBarCount(Math.ceil(barCount))\n  }\n\n  /**\n   * 设置一条数据的空间\n   * @param space\n   */\n  setDataSpace (space) {\n    if (!isNumber(space)) {\n      logWarn('setDataSpace', 'space', 'space must be a number!!!')\n      return\n    }\n    this._chartPane.chartData().setDataSpace(space)\n  }\n\n  /**\n   * 清空数据\n   */\n  clearData () {\n    this._chartPane.chartData().clearDataList()\n  }\n\n  /**\n   * 获取数据源\n   */\n  getDataList () {\n    return this._chartPane.chartData().dataList()\n  }\n\n  /**\n   * 添加新数据\n   * @param dataList\n   * @param more\n   */\n  applyNewData (dataList, more) {\n    if (!isArray(dataList)) {\n      logWarn('applyNewData', 'dataList', 'dataList must be an array!!!')\n      return\n    }\n    this._chartPane.applyNewData(dataList, more)\n  }\n\n  /**\n   * 添加历史更多数据\n   * @param dataList\n   * @param more\n   */\n  applyMoreData (dataList, more) {\n    if (!isArray(dataList)) {\n      logWarn('applyMoreData', 'dataList', 'dataList must be an array!!!')\n      return\n    }\n    this._chartPane.applyMoreData(dataList, more)\n  }\n\n  /**\n   * 更新数据\n   * @param data\n   */\n  updateData (data) {\n    if (!isObject(data) || isArray(data)) {\n      logWarn('updateData', 'data')\n      return\n    }\n    this._chartPane.updateData(data)\n  }\n\n  /**\n   * 设置加载更多回调\n   * @param cb\n   */\n  loadMore (cb) {\n    if (!isFunction(cb)) {\n      logWarn('loadMore', 'cb', 'cb must be a method!!!')\n      return\n    }\n    this._chartPane.chartData().setLoadMoreCallback(cb)\n  }\n\n  /**\n   * 创建一个技术指标\n   * @param name 指标名\n   * @param isStack 是否覆盖\n   * @param paneOptions\n   * @returns {string|null}\n   */\n  createTechnicalIndicator (name, isStack, paneOptions) {\n    const tech = this._chartPane.chartData().getTechnicalIndicatorInstance(name)\n    if (!tech) {\n      logWarn('createTechnicalIndicator', 'name', 'can not find the corresponding technical indicator!!!')\n      return null\n    }\n    return this._chartPane.createTechnicalIndicator(tech, isStack, paneOptions)\n  }\n\n  /**\n   * 添加自定义技术指标\n   * @param tech\n   */\n  addCustomTechnicalIndicator (tech) {\n    if (!isObject(tech)) {\n      logWarn('addCustomTechnicalIndicator', 'technicalIndicator', 'technicalIndicator must be an object or array!!!')\n      return\n    }\n    const techs = [].concat(tech)\n    this._chartPane.chartData().addCustomTechnicalIndicator(techs)\n  }\n\n  /**\n   * 移除一个技术指标\n   * @param paneId\n   * @param name\n   */\n  removeTechnicalIndicator (paneId, name) {\n    this._chartPane.removeTechnicalIndicator(paneId, name)\n  }\n\n  /**\n   * 创建图形标记\n   * @param name\n   * @param options\n   */\n  createGraphicMark (name, options) {\n    const graphicMarkMapping = this._chartPane.chartData().graphicMarkMapping()\n    const GraphicMark = graphicMarkMapping[name]\n    if (!GraphicMark) {\n      logWarn('createGraphicMark', 'name', 'can not find the corresponding graphic mark!!!')\n      return null\n    }\n    const id = this._chartPane.createGraphicMark(GraphicMark, options)\n    if (!id) {\n      logWarn('createGraphicMark', 'options.id', 'duplicate id!!!')\n    }\n    return id\n  }\n\n  /**\n   * 获取图形标记\n   * @param id\n   * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n   */\n  getGraphicMark (id) {\n    return this._chartPane.chartData().getGraphicMark(id)\n  }\n\n  /**\n   * 设置图形标记配置\n   * @param id\n   * @param options\n   */\n  setGraphicMarkOptions (id, options) {\n    this._chartPane.chartData().setGraphicMarkOptions(id, options)\n  }\n\n  /**\n   * 添加自定义图形标记\n   * @param graphicMark\n   */\n  addCustomGraphicMark (graphicMark) {\n    if (!isObject(graphicMark)) {\n      logWarn('addCustomGraphicMark', 'graphicMark', 'graphicMark must be an object or array!!!')\n      return\n    }\n    const graphicMarks = [].concat(graphicMark)\n    this._chartPane.chartData().addCustomGraphicMark(graphicMarks)\n  }\n\n  /**\n   * 移除图形标记\n   * @param graphicMarkId\n   */\n  removeGraphicMark (graphicMarkId) {\n    this._chartPane.chartData().removeGraphicMarkInstance(graphicMarkId)\n  }\n\n  /**\n   * 创建注解\n   * @param annotation\n   */\n  createAnnotation (annotation) {\n    if (!isObject(annotation)) {\n      logWarn('createAnnotation', 'annotation', 'annotation must be an object or array!!!')\n      return\n    }\n    const annotations = [].concat(annotation)\n    this._chartPane.createAnnotation(annotations)\n  }\n\n  /**\n   * 移除注解\n   */\n  removeAnnotation (points) {\n    this._chartPane.chartData().removeAnnotation(points)\n  }\n\n  /**\n   * 创建标签\n   * @param tag\n   */\n  createTag (tag) {\n    if (!isObject(tag)) {\n      logWarn('createTag', 'tag', 'tag must be an object or array!!!')\n      return\n    }\n    const tags = [].concat(tag)\n    this._chartPane.createTag(tags)\n  }\n\n  /**\n   * 移除标签\n   * @param id\n   */\n  removeTag (id) {\n    this._chartPane.chartData().removeTag(id)\n  }\n\n  /**\n   * 设置窗口属性\n   * @param options\n   */\n  setPaneOptions (options = {}) {\n    this._chartPane.setPaneOptions(options, false)\n  }\n\n  /**\n   * 设置是否可以缩放\n   * @param enabled\n   */\n  setZoomEnabled (enabled) {\n    this._chartPane.chartData().setZoomEnabled(enabled)\n  }\n\n  /**\n   * 是否可以缩放\n   * @return {boolean}\n   */\n  isZoomEnabled () {\n    return this._chartPane.chartData().zoomEnabled()\n  }\n\n  /**\n   * 设置是否可以拖拽滚动\n   * @param enabled\n   */\n  setScrollEnabled (enabled) {\n    this._chartPane.chartData().setScrollEnabled(enabled)\n  }\n\n  /**\n   * 是否可以拖拽滚动\n   * @return {boolean}\n   */\n  isScrollEnabled () {\n    return this._chartPane.chartData().scrollEnabled()\n  }\n\n  /**\n   * 按距离滚动\n   * @param distance\n   * @param animationDuration\n   */\n  scrollByDistance (distance, animationDuration) {\n    if (!isNumber(distance)) {\n      logWarn('scrollByDistance', 'distance', 'distance must be a number!!!')\n      return\n    }\n    if (isNumber(animationDuration) && animationDuration > 0) {\n      this._chartPane.chartData().startScroll()\n      const startTime = new Date().getTime()\n      const animation = () => {\n        const progress = (new Date().getTime() - startTime) / animationDuration\n        const finished = progress >= 1\n        const dis = finished ? distance : distance * progress\n        this._chartPane.chartData().scroll(dis)\n        if (!finished) {\n          requestAnimationFrame(animation)\n        }\n      }\n      animation()\n    } else {\n      this._chartPane.chartData().startScroll()\n      this._chartPane.chartData().scroll(distance)\n    }\n  }\n\n  /**\n   * 滚动到实时位置\n   * @param animationDuration\n   */\n  scrollToRealTime (animationDuration) {\n    const difBarCount = this._chartPane.chartData().offsetRightBarCount() - this._chartPane.chartData().offsetRightSpace() / this._chartPane.chartData().dataSpace()\n    const distance = difBarCount * this._chartPane.chartData().dataSpace()\n    this.scrollByDistance(distance, animationDuration)\n  }\n\n  /**\n   * 滚动到指定位置\n   * @param position\n   * @param animationDuration\n   */\n  scrollToPosition (position, animationDuration) {\n    if (!isNumber(position)) {\n      logWarn('scrollToPosition', 'position', 'position must be a number!!!')\n      return\n    }\n    const distance = (this._chartPane.chartData().dataList().length - 1 - position) * this._chartPane.chartData().dataSpace()\n    this.scrollByDistance(distance, animationDuration)\n  }\n\n  /**\n   * 在某个坐标点缩放\n   * @param scale\n   * @param coordinate\n   * @param animationDuration\n   */\n  zoomAtCoordinate (scale, coordinate, animationDuration) {\n    if (!isNumber(scale)) {\n      logWarn('zoomAtCoordinate', 'scale', 'scale must be a number!!!')\n      return\n    }\n    if (isNumber(animationDuration) && animationDuration > 0) {\n      const dataSpace = this._chartPane.chartData().dataSpace()\n      const scaleDataSpace = dataSpace * scale\n      const difSpace = scaleDataSpace - dataSpace\n      const startTime = new Date().getTime()\n      const animation = () => {\n        const progress = (new Date().getTime() - startTime) / animationDuration\n        const finished = progress >= 1\n        const progressDataSpace = finished ? difSpace : difSpace * progress\n        this._chartPane.chartData().zoom(progressDataSpace / dataSpace, coordinate)\n        if (!finished) {\n          requestAnimationFrame(animation)\n        }\n      }\n      animation()\n    } else {\n      this._chartPane.chartData().zoom(scale, coordinate)\n    }\n  }\n\n  /**\n   * 在某个位置缩放\n   * @param scale\n   * @param position\n   * @param animationDuration\n   */\n  zoomAtPosition (scale, position, animationDuration) {\n    if (!isNumber(scale)) {\n      logWarn('zoomAtPosition', 'scale', 'scale must be a number!!!')\n      return\n    }\n    if (!isNumber(position)) {\n      logWarn('zoomAtPosition', 'position', 'position must be a number!!!')\n      return\n    }\n    const x = this._chartPane.chartData().dataIndexToCoordinate(position)\n    this.zoomAtCoordinate(scale, { x }, animationDuration)\n  }\n\n  /**\n   * 将值装换成像素\n   * @param value\n   * @param finder\n   */\n  convertToPixel (value, finder) {\n    return this._chartPane.convertToPixel(value, finder)\n  }\n\n  /**\n   * 将像素转换成值\n   * @param coordinate\n   * @param finder\n   */\n  convertFromPixel (coordinate, finder) {\n    return this._chartPane.convertFromPixel(coordinate, finder)\n  }\n\n  /**\n   * 订阅图表动作\n   * @param type\n   * @param callback\n   */\n  subscribeAction (type, callback) {\n    if (type === 'drawCandle' || type === 'drawTechnicalIndicator') {\n      logWarn('subscribeAction', '', 'the types drawCandle and drawTechnicalIndicator have been deprecated, please use createAnnotation instead!!!')\n    }\n    if (!this._chartPane.chartData().subscribeAction(type, callback)) {\n      logWarn('subscribeAction', 'type', 'type does not exist!!!')\n    }\n  }\n\n  /**\n   * 取消订阅图表动作\n   * @param type\n   * @param callback\n   */\n  unsubscribeAction (type, callback) {\n    if (!this._chartPane.chartData().unsubscribeAction(type, callback)) {\n      logWarn('unsubscribeAction', 'type', 'type does not exist!!!')\n    }\n  }\n\n  /**\n   * 获取将图表装换成图片后的url\n   * @param includeTooltip\n   * @param includeGraphicMark\n   * @param type\n   * @param backgroundColor\n   */\n  getConvertPictureUrl (includeTooltip, includeGraphicMark, type = 'jpeg', backgroundColor = '#FFFFFF') {\n    if (type !== 'png' && type !== 'jpeg' && type !== 'bmp') {\n      logWarn('getConvertPictureUrl', 'type', 'type only supports jpeg, png and bmp!!!')\n      return\n    }\n    return this._chartPane.getConvertPictureUrl(includeTooltip, type, backgroundColor)\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._chartPane.destroy()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Chart from './Chart'\nimport { logError, logTag, logWarn } from './utils/logger'\nimport { isString, isContainerDom } from './utils/typeChecks'\n\nconst instances = {}\nlet chartBaseId = 1\nconst CHART_NAME_PREFIX = 'k_line_chart_'\n\n/**\n * 获取版本号\n * @returns {string}\n */\nfunction version () {\n  return '__BUILD_VERSION__'\n}\n\n/**\n * 初始化\n * @param ds\n * @param style\n * @returns {Chart}\n */\nfunction init (ds, style = {}) {\n  logTag()\n  const errorMessage = 'The chart cannot be initialized correctly. Please check the parameters. The chart container cannot be null and child elements need to be added!!!'\n  let dom\n  if (!ds) {\n    logError('', '', errorMessage)\n    return null\n  }\n  if (isString(ds)) {\n    dom = document.getElementById(ds)\n  } else {\n    dom = ds\n  }\n  if (!isContainerDom(dom)) {\n    logError('', '', errorMessage)\n    return null\n  }\n  let chart = instances[dom.chartId || '']\n  if (chart) {\n    logWarn('', '', 'The chart has been initialized on the dom！！！')\n    return chart\n  }\n  const id = `${CHART_NAME_PREFIX}${chartBaseId++}`\n  chart = new Chart(dom, style)\n  chart.id = id\n  dom.chartId = id\n  instances[id] = chart\n  return chart\n}\n\n/**\n * 销毁\n * @param dcs\n */\nfunction dispose (dcs) {\n  if (dcs) {\n    let id\n    if (isString(dcs)) {\n      const dom = document.getElementById(dcs)\n      id = dom && dom.chartId\n    } else if (isContainerDom(dcs)) {\n      id = dcs.chartId\n    } else if (dcs instanceof Chart) {\n      id = dcs.id\n    }\n    if (id) {\n      instances[id].destroy()\n      delete instances[id]\n    }\n  }\n}\n\nexport { version, init, dispose }\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport averagePrice from './extension/technicalindicator/directionalmovement/averagePrice'\nimport bullAndBearIndex from './extension/technicalindicator/directionalmovement/bullAndBearIndex'\nimport differentOfMovingAverage from './extension/technicalindicator/directionalmovement/differentOfMovingAverage'\nimport directionalMovementIndex from './extension/technicalindicator/directionalmovement/directionalMovementIndex'\nimport easeOfMovementValue from './extension/technicalindicator/directionalmovement/easeOfMovementValue'\nimport exponentialMovingAverage from './extension/technicalindicator/directionalmovement/exponentialMovingAverage'\nimport movingAverage from './extension/technicalindicator/directionalmovement/movingAverage'\nimport movingAverageConvergenceDivergence from './extension/technicalindicator/directionalmovement/movingAverageConvergenceDivergence'\nimport simpleMovingAverage from './extension/technicalindicator/directionalmovement/simpleMovingAverage'\nimport tripleExponentiallySmoothedAverage from './extension/technicalindicator/directionalmovement/tripleExponentiallySmoothedAverage'\n\nimport brar from './extension/technicalindicator/momentum/brar'\nimport currentRatio from './extension/technicalindicator/momentum/currentRatio'\nimport momentum from './extension/technicalindicator/momentum/momentum'\nimport psychologicalLine from './extension/technicalindicator/momentum/psychologicalLine'\nimport rateOfChange from './extension/technicalindicator/momentum/rateOfChange'\nimport volumeRatio from './extension/technicalindicator/momentum/volumeRatio'\n\nimport awesomeOscillator from './extension/technicalindicator/oscillators/awesomeOscillator'\nimport bias from './extension/technicalindicator/oscillators/bias'\nimport commodityChannelIndex from './extension/technicalindicator/oscillators/commodityChannelIndex'\nimport relativeStrengthIndex from './extension/technicalindicator/oscillators/relativeStrengthIndex'\nimport stockIndicatorKDJ from './extension/technicalindicator/oscillators/stockIndicatorKDJ'\nimport williamsR from './extension/technicalindicator/oscillators/williamsR'\n\nimport bollingerBands from './extension/technicalindicator/volatility/bollingerBands'\nimport stopAndReverse from './extension/technicalindicator/volatility/stopAndReverse'\n\nimport onBalanceVolume from './extension/technicalindicator/volume/onBalanceVolume'\nimport priceAndVolumeTrend from './extension/technicalindicator/volume/priceAndVolumeTrend'\nimport volume from './extension/technicalindicator/volume/volume'\n\nimport extension from './data/extension'\nimport { version, init, dispose } from './core'\n\nextension.addTechnicalIndicator([\n  averagePrice, bullAndBearIndex, differentOfMovingAverage, directionalMovementIndex, easeOfMovementValue,\n  exponentialMovingAverage, movingAverage, movingAverageConvergenceDivergence, simpleMovingAverage, tripleExponentiallySmoothedAverage,\n  brar, currentRatio, momentum, psychologicalLine, rateOfChange, volumeRatio,\n  awesomeOscillator, bias, commodityChannelIndex, relativeStrengthIndex, stockIndicatorKDJ, williamsR,\n  bollingerBands, stopAndReverse,\n  onBalanceVolume, priceAndVolumeTrend, volume\n])\n\nexport { version, init, dispose, extension }\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnRayLine } from './graphicHelper'\n\nexport default {\n  name: 'horizontalRayLine',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    const point = { x: 0, y: coordinates[0].y }\n    if (coordinates[1] && coordinates[0].x < coordinates[1].x) {\n      point.x = viewport.width\n    }\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[coordinates[0], point]]\n      }\n    ]\n  },\n  performMousePressedMove: (points, pressedPointIndex, { price }) => {\n    points[0].price = price\n    points[1].price = price\n  },\n  performMouseMoveForDrawing: (step, points, { price }) => {\n    if (step === 2) {\n      points[0].price = price\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnSegment } from './graphicHelper'\n\nexport default {\n  name: 'horizontalSegment',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnSegment(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates) => {\n    let lines = []\n    if (coordinates.length === 2) {\n      lines = [coordinates]\n    }\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: lines\n      }\n    ]\n  },\n  performMousePressedMove: (points, pressedPointIndex, { price }) => {\n    points[0].price = price\n    points[1].price = price\n  },\n  performMouseMoveForDrawing: (step, points, { price }) => {\n    if (step === 2) {\n      points[0].price = price\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnStraightLine } from './graphicHelper'\n\nexport default {\n  name: 'horizontalStraightLine',\n  totalStep: 2,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[\n          {\n            x: 0,\n            y: coordinates[0].y\n          }, {\n            x: viewport.width,\n            y: coordinates[0].y\n          }\n        ]]\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnRayLine } from './graphicHelper'\n\nexport default {\n  name: 'verticalRayLine',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    const point = { x: coordinates[0].x, y: 0 }\n    if (coordinates[1] && coordinates[0].y < coordinates[1].y) {\n      point.y = viewport.height\n    }\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[coordinates[0], point]]\n      }\n    ]\n  },\n  performMousePressedMove: (points, pressedPointIndex, { dataIndex, timestamp }) => {\n    points[0].timestamp = timestamp\n    points[0].dataIndex = dataIndex\n    points[1].timestamp = timestamp\n    points[1].dataIndex = dataIndex\n  },\n  performMouseMoveForDrawing: (step, points, { timestamp, dataIndex }) => {\n    if (step === 2) {\n      points[0].timestamp = timestamp\n      points[0].dataIndex = dataIndex\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnSegment } from './graphicHelper'\n\nexport default {\n  name: 'verticalSegment',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnSegment(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates) => {\n    let lines = []\n    if (coordinates.length === 2) {\n      lines = [coordinates]\n    }\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: lines\n      }\n    ]\n  },\n  performMousePressedMove: (points, pressedPointIndex, { dataIndex, timestamp }) => {\n    points[0].timestamp = timestamp\n    points[0].dataIndex = dataIndex\n    points[1].timestamp = timestamp\n    points[1].dataIndex = dataIndex\n  },\n  performMouseMoveForDrawing: (step, points, { timestamp, dataIndex }) => {\n    if (step === 2) {\n      points[0].timestamp = timestamp\n      points[0].dataIndex = dataIndex\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnStraightLine } from './graphicHelper'\n\nexport default {\n  name: 'verticalStraightLine',\n  totalStep: 2,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[\n          {\n            x: coordinates[0].x,\n            y: 0\n          }, {\n            x: coordinates[0].x,\n            y: viewport.height\n          }\n        ]]\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnRayLine, getRayLine } from './graphicHelper'\n\nexport default {\n  name: 'rayLine',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [getRayLine(coordinates[0], coordinates[1], { x: viewport.width, y: viewport.height })]\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnSegment } from './graphicHelper'\n\nexport default {\n  name: 'segment',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnSegment(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates) => {\n    let lines = []\n    if (coordinates.length === 2) {\n      lines = [coordinates]\n    }\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: lines\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnStraightLine, getLinearYFromPoints } from './graphicHelper'\n\nexport default {\n  name: 'straightLine',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    if (coordinates.length < 2 || coordinates[0].x === coordinates[1].x) {\n      return [\n        {\n          type: 'line',\n          isDraw: true,\n          isCheck: true,\n          dataSource: [[\n            {\n              x: coordinates[0].x,\n              y: 0\n            }, {\n              x: coordinates[0].x,\n              y: viewport.height\n            }\n          ]]\n        }\n      ]\n    }\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[\n          {\n            x: 0,\n            y: getLinearYFromPoints(coordinates[0], coordinates[1], { x: 0, y: coordinates[0].y })\n          }, {\n            x: viewport.width,\n            y: getLinearYFromPoints(coordinates[0], coordinates[1], { x: viewport.width, y: coordinates[0].y })\n          }\n        ]]\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnStraightLine, getParallelLines } from './graphicHelper'\n\nexport default {\n  name: 'parallelStraightLine',\n  totalStep: 4,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: getParallelLines(coordinates, { x: viewport.width, y: viewport.height })\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnStraightLine, getParallelLines } from './graphicHelper'\n\nexport default {\n  name: 'priceChannelLine',\n  totalStep: 4,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport) => {\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: getParallelLines(coordinates, { x: viewport.width, y: viewport.height }, 1)\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnRayLine } from './graphicHelper'\n\nexport default {\n  name: 'priceLine',\n  totalStep: 2,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnRayLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport, precision, xAxis, yAxis) => {\n    return [\n      {\n        type: 'line',\n        isDraw: true,\n        isCheck: true,\n        dataSource: [[coordinates[0], { x: viewport.width, y: coordinates[0].y }]]\n      },\n      {\n        type: 'text',\n        isDraw: true,\n        isCheck: false,\n        dataSource: [\n          { x: coordinates[0].x, y: coordinates[0].y, text: yAxis.convertFromPixel(coordinates[0].y).toFixed(precision.price) }\n        ]\n      }\n    ]\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { checkPointOnStraightLine } from './graphicHelper'\n\nexport default {\n  name: 'fibonacciLine',\n  totalStep: 3,\n  checkMousePointOn: (key, type, coordinates, mouseCoordinate) => {\n    return checkPointOnStraightLine(coordinates[0], coordinates[1], mouseCoordinate)\n  },\n  createGraphicDataSource: (step, points, coordinates, viewport, precision) => {\n    if (coordinates.length > 0) {\n      const lines = []\n      const texts = []\n      const startX = 0\n      const endX = viewport.width\n      if (coordinates.length > 1) {\n        const percents = [1, 0.786, 0.618, 0.5, 0.382, 0.236, 0]\n        const yDif = coordinates[0].y - coordinates[1].y\n        const priceDif = points[0].price - points[1].price\n        percents.forEach(percent => {\n          const y = coordinates[1].y + yDif * percent\n          const price = (points[1].price + priceDif * percent).toFixed(precision.price)\n          lines.push([{ x: startX, y }, { x: endX, y }])\n          texts.push({\n            x: startX,\n            y,\n            text: `${price} (${(percent * 100).toFixed(1)}%)`\n          })\n        })\n      }\n      return [\n        {\n          type: 'line',\n          isDraw: true,\n          isCheck: true,\n          dataSource: lines\n        }, {\n          type: 'text',\n          isDraw: true,\n          isCheck: false,\n          dataSource: texts\n        }\n      ]\n    }\n    return []\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { version, init, dispose, extension } from './index.blank'\n\nimport horizontalRayLine from './extension/mark/horizontalRayLine'\nimport horizontalSegment from './extension/mark/horizontalSegment'\nimport horizontalStraightLine from './extension/mark/horizontalStraightLine'\n\nimport verticalRayLine from './extension/mark/verticalRayLine'\nimport verticalSegment from './extension/mark/verticalSegment'\nimport verticalStraightLine from './extension/mark/verticalStraightLine'\n\nimport rayLine from './extension/mark/rayLine'\nimport segment from './extension/mark/segment'\nimport straightLine from './extension/mark/straightLine'\n\nimport parallelStraightLine from './extension/mark/parallelStraightLine'\nimport priceChannelLine from './extension/mark/priceChannelLine'\nimport priceLine from './extension/mark/priceLine'\nimport fibonacciLine from './extension/mark/fibonacciLine'\n\nextension.addGraphicMark([\n  horizontalRayLine, horizontalSegment, horizontalStraightLine,\n  verticalRayLine, verticalSegment, verticalStraightLine,\n  rayLine, segment, straightLine,\n  parallelStraightLine, priceChannelLine, priceLine, fibonacciLine\n])\n\nexport { version, init, dispose, extension }\n"]},"metadata":{},"sourceType":"script"}
{"version":3,"file":"klinecharts.simple.js","sources":["../src/data/extension.js","../src/utils/typeChecks.js","../src/data/options/styleOptions.js","../src/utils/format.js","../src/utils/number.js","../src/utils/logger.js","../src/base/technicalindicator/TechnicalIndicator.js","../src/base/technicalindicator/technicalIndicatorControl.js","../src/base/overlay/Overlay.js","../src/renderer/circle.js","../src/extension/mark/graphicHelper.js","../src/renderer/line.js","../src/base/overlay/mark/GraphicMark.js","../src/data/delegate/Delegate.js","../src/base/overlay/mark/graphicMarkControl.js","../src/data/constants.js","../src/data/ChartData.js","../src/utils/canvas.js","../src/pane/Pane.js","../src/widget/Widget.js","../src/utils/compatible.js","../src/view/View.js","../src/view/TechnicalIndicatorView.js","../src/renderer/text.js","../src/view/TechnicalIndicatorOverlayView.js","../src/widget/TechnicalIndicatorWidget.js","../src/renderer/rect.js","../src/view/YAxisView.js","../src/view/YAxisOverlayView.js","../src/widget/YAxisWidget.js","../src/component/Axis.js","../src/component/YAxis.js","../src/pane/TechnicalIndicatorPane.js","../src/view/CandleView.js","../src/view/CandleOverlayView.js","../src/widget/CandleWidget.js","../src/pane/CandlePane.js","../src/view/XAxisView.js","../src/view/XAxisOverlayView.js","../src/widget/XAxisWidget.js","../src/component/XAxis.js","../src/pane/XAxisPane.js","../src/event/EventBase.js","../src/pane/SeparatorPane.js","../src/event/EventHandler.js","../src/event/ZoomScrollEventHandler.js","../src/event/OverlayEventHandler.js","../src/event/KeyBoardEventHandler.js","../src/event/ChartEvent.js","../src/utils/performance.js","../src/renderer/diamond.js","../src/renderer/triangle.js","../src/base/overlay/annotation/Annotation.js","../src/base/overlay/tag/Tag.js","../src/pane/ChartPane.js","../src/Chart.js","../src/core.js"],"sourcesContent":["/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  technicalIndicatorExtensions: {},\n  graphicMarkExtensions: {},\n  addTechnicalIndicator (technicalIndicators) {\n    if (technicalIndicators) {\n      ([].concat(technicalIndicators)).forEach(\n        technicalIndicator => {\n          if (technicalIndicator.name) {\n            this.technicalIndicatorExtensions[technicalIndicator.name] = technicalIndicator\n          }\n        }\n      )\n    }\n  },\n  addGraphicMark (graphicMarks) {\n    if (graphicMarks) {\n      ([].concat(graphicMarks)).forEach(\n        graphicMark => {\n          if (graphicMark.name) {\n            this.graphicMarkExtensions[graphicMark.name] = graphicMark\n          }\n        }\n      )\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 合并\n * @param target\n * @param source\n */\nexport function merge (target, source) {\n  if (!isObject(target) || !isObject(source)) {\n    return\n  }\n  for (const key in source) {\n    if (key in target) {\n      const targetProp = target[key]\n      const sourceProp = source[key]\n      if (\n        isObject(sourceProp) &&\n        isObject(targetProp) &&\n        !isArray(sourceProp) &&\n        !isArray(targetProp)\n      ) {\n        merge(targetProp, sourceProp)\n      } else {\n        if (isValid(source[key])) {\n          target[key] = source[key]\n        }\n      }\n    }\n  }\n}\n\n/**\n * 克隆\n * @param target\n * @return {{}|*}\n */\nexport function clone (target) {\n  if (!isObject(target)) {\n    return target\n  }\n\n  let copy\n  if (isArray(target)) {\n    copy = []\n  } else {\n    copy = {}\n  }\n  for (const key in target) {\n    if (target.hasOwnProperty(key)) {\n      const v = target[key]\n      if (isObject(v)) {\n        copy[key] = clone(v)\n      } else {\n        copy[key] = v\n      }\n    }\n  }\n  return copy\n}\n\n/**\n * 是否是数组\n * @param value\n * @return {boolean}\n */\nexport function isArray (value) {\n  return Object.prototype.toString.call(value) === '[object Array]'\n}\n\n/**\n * 是否是方法\n * @param {*} value\n * @return {boolean}\n */\nexport function isFunction (value) {\n  return typeof value === 'function'\n}\n\n/**\n * 是否是对象\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject (value) {\n  return (!!value && typeof value === 'object')\n}\n\n/**\n * 判断是否是数字\n * @param value\n * @returns {boolean}\n */\nexport function isNumber (value) {\n  return typeof value === 'number' && !isNaN(value)\n}\n\n/**\n * 判断是否有效\n * @param value\n * @returns {boolean}\n */\nexport function isValid (value) {\n  return value !== null && value !== undefined\n}\n\n/**\n * 判断是否是boolean\n * @param value\n * @returns {boolean}\n */\nexport function isBoolean (value) {\n  return typeof value === 'boolean'\n}\n\n/**\n * 是否是字符串\n * @param value\n * @return {boolean}\n */\nexport function isString (value) {\n  return typeof value === 'string'\n}\n\n/**\n * 是否是容器元素\n * @param dom\n * @return {boolean}\n */\nexport function isContainerDom (dom) {\n  return dom && (dom instanceof HTMLElement) && dom.appendChild && (typeof dom.appendChild === 'function')\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 线的样式\n * @type {{DASH: string, SOLID: string}}\n */\nexport const LineStyle = {\n  DASH: 'dash',\n  SOLID: 'solid'\n}\n\n/**\n * y轴位置\n * @type {{LEFT: string, RIGHT: string}}\n */\nexport const YAxisPosition = {\n  LEFT: 'left',\n  RIGHT: 'right'\n}\n\n/**\n * y轴类型\n * @type {{PERCENTAGE: string, NORMAL: string}}\n */\nexport const YAxisType = {\n  NORMAL: 'normal',\n  PERCENTAGE: 'percentage',\n  LOG: 'log'\n}\n\n/**\n * 蜡烛图样式\n * @type {{AREA: string, OHLC: string, CANDLE_STROKE: string, CANDLE_SOLID: string, CANDLE_DOWN_STROKE: string, CANDLE_UP_STROKE: string}}\n */\nexport const CandleType = {\n  CANDLE_SOLID: 'candle_solid',\n  CANDLE_STROKE: 'candle_stroke',\n  CANDLE_UP_STROKE: 'candle_up_stroke',\n  CANDLE_DOWN_STROKE: 'candle_down_stroke',\n  OHLC: 'ohlc',\n  AREA: 'area'\n}\n\n/**\n * 说明显示规则\n * @type {{FOLLOW_CROSS: string, NONE: string, ALWAYS: string}}\n */\nexport const TooltipShowRule = {\n  ALWAYS: 'always',\n  FOLLOW_CROSS: 'follow_cross',\n  NONE: 'none'\n}\n\n/**\n * 数据提示显示类型\n * @type {{RECT: string, STANDARD: string}}\n */\nexport const TooltipShowType = {\n  RECT: 'rect',\n  STANDARD: 'standard'\n}\n\n/**\n * 注解标识类似\n * @type {{RECT: string, TRIANGLE: string, DIAMOND: string, CUSTOM: string, NONE: string, CIRCLE: string}}\n */\nexport const AnnotationSymbolType = {\n  CIRCLE: 'circle',\n  RECT: 'rect',\n  TRIANGLE: 'triangle',\n  DIAMOND: 'diamond',\n  CUSTOM: 'custom',\n  NONE: 'none'\n}\n\n/**\n * 覆盖物位置\n * @type {{TOP: string, BOTTOM: string, POINT: string}}\n */\nexport const OverlayPosition = {\n  POINT: 'point',\n  TOP: 'top',\n  BOTTOM: 'bottom'\n}\n\n/**\n * 默认网格配置\n * @type {{horizontal: {size: number, color: string, dashValue: number[], show: boolean, style: string}, show: boolean, vertical: {size: number, color: string, dashValue: number[], show: boolean, style: string}}}\n */\nconst defaultGrid = {\n  show: true,\n  horizontal: {\n    show: true,\n    size: 1,\n    color: '#EDEDED',\n    style: LineStyle.DASH,\n    dashValue: [2, 2]\n  },\n  vertical: {\n    show: true,\n    size: 1,\n    color: '#EDEDED',\n    style: LineStyle.DASH,\n    dashValue: [2, 2]\n  }\n}\n\n/**\n * 默认蜡烛柱图样式配置\n * @type {{area: {fillColor: [{offset: number, color: string}, {offset: number, color: string}], lineColor: string, lineSize: number, value: string}, bar: {noChangeColor: string, upColor: string, downColor: string}, tooltip: {rect: {offsetTop: number, fillColor: string, borderColor: string, paddingBottom: number, borderRadius: number, paddingRight: number, borderSize: number, offsetLeft: number, paddingTop: number, paddingLeft: number, offsetRight: number}, showRule: string, values: null, showType: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, labels: string[]}, type: string, priceMark: {high: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, last: {noChangeColor: string, upColor: string, line: {dashValue: number[], size: number, show: boolean, style: string}, show: boolean, text: {paddingBottom: number, size: number, color: string, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}, downColor: string}, low: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, show: boolean}}}\n */\nconst defaultCandle = {\n  margin: {\n    top: 0.2,\n    bottom: 0.1\n  },\n  type: CandleType.CANDLE_SOLID,\n  bar: {\n    /**\n     * 上涨颜色\n     */\n    upColor: '#26A69A',\n    /**\n     * 下跌颜色\n     */\n    downColor: '#EF5350',\n    /**\n     * 无变化时颜色\n     */\n    noChangeColor: '#999999'\n  },\n  area: {\n    lineSize: 2,\n    lineColor: '#2196F3',\n    value: 'close',\n    fillColor: [{\n      offset: 0,\n      color: 'rgba(33, 150, 243, 0.01)'\n    }, {\n      offset: 1,\n      color: 'rgba(33, 150, 243, 0.2)'\n    }]\n  },\n  priceMark: {\n    show: true,\n    high: {\n      show: true,\n      color: '#76808F',\n      textMargin: 5,\n      textSize: 10,\n      textFamily: 'Helvetica Neue',\n      textWeight: 'normal'\n    },\n    low: {\n      show: true,\n      color: '#76808F',\n      textMargin: 5,\n      textSize: 10,\n      textFamily: 'Helvetica Neue',\n      textWeight: 'normal'\n    },\n    last: {\n      show: true,\n      upColor: '#26A69A',\n      downColor: '#EF5350',\n      noChangeColor: '#888888',\n      line: {\n        show: true,\n        style: LineStyle.DASH,\n        dashValue: [4, 4],\n        size: 1\n      },\n      text: {\n        show: true,\n        size: 12,\n        paddingLeft: 2,\n        paddingTop: 2,\n        paddingRight: 2,\n        paddingBottom: 2,\n        color: '#FFFFFF',\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        borderRadius: 2\n      }\n    }\n  },\n  tooltip: {\n    showRule: TooltipShowRule.ALWAYS,\n    showType: TooltipShowType.STANDARD,\n    labels: ['时间: ', '开: ', '收: ', '高: ', '低: ', '成交量: '],\n    values: null,\n    defaultValue: 'n/a',\n    rect: {\n      paddingLeft: 0,\n      paddingRight: 0,\n      paddingTop: 0,\n      paddingBottom: 6,\n      offsetLeft: 8,\n      offsetTop: 8,\n      offsetRight: 8,\n      borderRadius: 4,\n      borderSize: 1,\n      borderColor: '#F2F3F5',\n      fillColor: '#FEFEFE'\n    },\n    text: {\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      color: '#76808F',\n      marginLeft: 8,\n      marginTop: 6,\n      marginRight: 8,\n      marginBottom: 0\n    }\n  }\n}\n\n/**\n * 默认的技术指标样式配置\n * @type {{bar: {noChangeColor: string, upColor: string, downColor: string}, line: {size: number, colors: [string, string, string, string, string]}, tooltip: {showParams: boolean, showName: boolean, showRule: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}}, circle: {noChangeColor: string, upColor: string, downColor: string}, lastValueMark: {show: boolean, text: {paddingBottom: number, color: string, size: number, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}}}}\n */\nconst defaultTechnicalIndicator = {\n  margin: {\n    top: 0.2,\n    bottom: 0.1\n  },\n  bar: {\n    upColor: 'rgba(38, 166, 154, .65)',\n    downColor: 'rgba(239, 83, 80, .65)',\n    noChangeColor: '#888888'\n  },\n  line: {\n    size: 1,\n    colors: ['#FF9600', '#9D65C9', '#2196F3', '#E11D74', '#01C5C4']\n  },\n  circle: {\n    upColor: 'rgba(38, 166, 154, .65)',\n    downColor: 'rgba(239, 83, 80, .65)',\n    noChangeColor: '#888888'\n  },\n  lastValueMark: {\n    show: false,\n    text: {\n      show: false,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 3,\n      paddingTop: 2,\n      paddingRight: 3,\n      paddingBottom: 2,\n      borderRadius: 2\n    }\n  },\n  tooltip: {\n    showRule: TooltipShowRule.ALWAYS,\n    showType: TooltipShowType.STANDARD,\n    showName: true,\n    showParams: true,\n    defaultValue: 'n/a',\n    text: {\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      color: '#76808F',\n      marginTop: 6,\n      marginRight: 8,\n      marginBottom: 0,\n      marginLeft: 8\n    }\n  }\n}\n\n/**\n * 默认x轴配置\n * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, tickText: {paddingBottom: number, color: string, size: number, show: boolean, weight: string, paddingTop: number, family: string}, height: null, tickLine: {size: number, color: string, show: boolean, length: number}}}\n */\nconst defaultXAxis = {\n  /**\n   * 是否显示整个轴\n   */\n  show: true,\n  /**\n   * 高度\n   */\n  height: null,\n  /**\n   * 轴线配置\n   */\n  axisLine: {\n    show: true,\n    color: '#DDDDDD',\n    size: 1\n  },\n\n  /**\n   * tick文字\n   */\n  tickText: {\n    show: true,\n    color: '#76808F',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingTop: 3,\n    paddingBottom: 6\n  },\n  // tick线\n  tickLine: {\n    show: true,\n    size: 1,\n    length: 3,\n    color: '#DDDDDD'\n  }\n}\n\n/**\n * 默认y轴配置\n * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, width: null, position: string, tickText: {color: string, size: number, paddingRight: number, show: boolean, weight: string, family: string, paddingLeft: number}, type: string, inside: boolean, tickLine: {size: number, color: string, show: boolean, length: number}}}\n */\nconst defaultYAxis = {\n  /**\n   * 是否显示整个轴\n   */\n  show: true,\n  /**\n   * 宽度\n   */\n  width: null,\n  /**\n   * y轴类型\n   */\n  type: YAxisType.NORMAL,\n  /**\n   * 轴位置\n   */\n  position: YAxisPosition.RIGHT,\n  /**\n   * 轴是否在内部\n   */\n  inside: false,\n  /**\n   * 轴线配置\n   */\n  axisLine: {\n    show: true,\n    color: '#DDDDDD',\n    size: 1\n  },\n\n  /**\n   * tick文字\n   */\n  tickText: {\n    show: true,\n    color: '#76808F',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 3,\n    paddingRight: 6\n  },\n  // tick线\n  tickLine: {\n    show: true,\n    size: 1,\n    length: 3,\n    color: '#DDDDDD'\n  }\n}\n\nconst defaultCrosshair = {\n  show: true,\n  horizontal: {\n    show: true,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#76808F'\n    },\n    text: {\n      show: true,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderSize: 1,\n      borderColor: '#686D76',\n      borderRadius: 2,\n      backgroundColor: '#686D76'\n    }\n  },\n  vertical: {\n    show: true,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#76808F'\n    },\n    text: {\n      show: true,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderSize: 1,\n      borderRadius: 2,\n      borderColor: '#686D76',\n      backgroundColor: '#686D76'\n    }\n  }\n}\n\n/**\n * 默认图形标记配置\n * @type {{arc: {fill: {color: string}, stroke: {size: number, color: string}}, polygon: {fill: {color: string}, stroke: {size: number, color: string}}, line: {color: string, size: number}, text: {marginRight: number, color: string, size: number, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, point: {backgroundColor: string, borderColor: string, activeBorderSize: number, activeRadius: number, activeBorderColor: string, activeBackgroundColor: string, borderSize: number, radius: number}}}\n */\nconst defaultGraphicMark = {\n  point: {\n    backgroundColor: '#2196F3',\n    borderColor: 'rgba(33, 150, 243, 0.35)',\n    borderSize: 1,\n    radius: 5,\n    activeBackgroundColor: '#2196F3',\n    activeBorderColor: 'rgba(33, 150, 243, 0.35)',\n    activeBorderSize: 3,\n    activeRadius: 5\n  },\n  line: {\n    color: '#2196F3',\n    size: 1,\n    dashValue: [2, 2]\n  },\n  polygon: {\n    stroke: {\n      size: 1,\n      color: '#2196F3'\n    },\n    fill: {\n      color: 'rgba(33, 150, 243, 0.1)'\n    }\n  },\n  arc: {\n    stroke: {\n      size: 1,\n      color: '#2196F3'\n    },\n    fill: {\n      color: 'rgba(33, 150, 243, 0.1)'\n    }\n  },\n  text: {\n    color: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    marginLeft: 2,\n    marginRight: 2,\n    marginTop: 2,\n    marginBottom: 6\n  }\n}\n\n/**\n * 默认注解信息配置\n * @type {{}}\n */\nconst defaultAnnotation = {\n  symbol: {\n    type: AnnotationSymbolType.DIAMOND,\n    position: OverlayPosition.TOP,\n    size: 8,\n    color: '#2196F3',\n    activeSize: 10,\n    activeColor: '#FF9600',\n    offset: [0, 20]\n  }\n}\n\nconst defaultTag = {\n  position: OverlayPosition.POINT,\n  offset: 0,\n  line: {\n    show: true,\n    style: LineStyle.DASH,\n    dashValue: [4, 2],\n    size: 1,\n    color: '#2196F3'\n  },\n  text: {\n    color: '#FFFFFF',\n    backgroundColor: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 2,\n    paddingRight: 2,\n    paddingTop: 2,\n    paddingBottom: 2,\n    borderRadius: 2\n  },\n  mark: {\n    color: '#FFFFFF',\n    backgroundColor: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 2,\n    paddingRight: 2,\n    paddingTop: 2,\n    paddingBottom: 2,\n    borderRadius: 2\n  }\n}\n\n/**\n * 图表之间默认分割配置\n * @type {{size: number, color: string}}\n */\nconst defaultSeparator = {\n  size: 1,\n  color: '#DDDDDD',\n  fill: true,\n  activeBackgroundColor: 'rgba(33, 150, 243, 0.08)'\n}\n\nexport const defaultStyleOptions = {\n  grid: defaultGrid,\n  candle: defaultCandle,\n  technicalIndicator: defaultTechnicalIndicator,\n  xAxis: defaultXAxis,\n  yAxis: defaultYAxis,\n  separator: defaultSeparator,\n  crosshair: defaultCrosshair,\n  graphicMark: defaultGraphicMark,\n  annotation: defaultAnnotation,\n  tag: defaultTag\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNumber, isObject, isValid } from './typeChecks'\n\n/**\n * 格式化值\n * @param data\n * @param key\n * @param defaultValue\n * @returns {string|*}\n */\nexport function formatValue (data, key, defaultValue = '--') {\n  if (isObject(data)) {\n    const value = data[key]\n    if (isValid(value)) {\n      return value\n    }\n  }\n  return defaultValue\n}\n\n/**\n * 格式化时间\n * @param dateTimeFormat\n * @param timestamp\n * @param format\n * @returns {string}\n */\nexport function formatDate (dateTimeFormat, timestamp, format = 'MM-DD hh:mm') {\n  if (isNumber(timestamp)) {\n    const dateTimeString = dateTimeFormat.format(new Date(timestamp))\n    const dateTimeStringArray = dateTimeString.split(', ')\n    const dateStringArray = dateTimeStringArray[0].split('/')\n    const date = {\n      YYYY: dateStringArray[2],\n      MM: dateStringArray[0],\n      DD: dateStringArray[1],\n      'hh:mm': dateTimeStringArray[1].match(/^[\\d]{2}/)[0] === '24'\n        ? dateTimeStringArray[1].replace(/^[\\d]{2}/, '00')\n        : dateTimeStringArray[1]\n    }\n    return format.replace(/YYYY|MM|DD|(hh:mm)/g, key => date[key])\n  }\n  return '--'\n}\n\n/**\n * 格式化精度\n */\nexport function formatPrecision (value, precision = 2) {\n  const v = +value\n  if ((v || v === 0) && isNumber(v)) {\n    return v.toFixed(precision)\n  }\n  return `${v}`\n}\n\n/**\n * 格式化大数据\n * @param value\n */\nexport function formatBigNumber (value) {\n  if (isNumber(+value)) {\n    if (value > 1000000000) {\n      return `${+((value / 1000000000).toFixed(3))}B`\n    }\n    if (value > 1000000) {\n      return `${+((value / 1000000).toFixed(3))}M`\n    }\n    if (value > 1000) {\n      return `${+((value / 1000).toFixed(3))}K`\n    }\n    return value\n  }\n  return '--'\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 二分查找最接近的数\n * @param dataList\n * @param valueKey\n * @param targetNumber\n * @return {number}\n */\nexport function binarySearchNearest (dataList, valueKey, targetNumber) {\n  let left = 0\n  let right = 0\n  for (right = dataList.length - 1; left !== right;) {\n    const midIndex = Math.floor((right + left) / 2)\n    const mid = right - left\n    const midValue = dataList[midIndex][valueKey]\n    if (targetNumber === dataList[left][valueKey]) {\n      return left\n    }\n    if (targetNumber === dataList[right][valueKey]) {\n      return right\n    }\n    if (targetNumber === midValue) {\n      return midIndex\n    }\n\n    if (targetNumber > midValue) {\n      left = midIndex\n    } else {\n      right = midIndex\n    }\n\n    if (mid <= 2) {\n      break\n    }\n  }\n  return left\n}\n\n/**\n * 优化数字\n * @param value\n * @return {number|number}\n */\nexport function nice (value) {\n  const exponent = Math.floor(log10(value))\n  const exp10 = index10(exponent)\n  const f = value / exp10 // 1 <= f < 10\n  let nf = 0\n  if (f < 1.5) {\n    nf = 1\n  } else if (f < 2.5) {\n    nf = 2\n  } else if (f < 3.5) {\n    nf = 3\n  } else if (f < 4.5) {\n    nf = 4\n  } else if (f < 5.5) {\n    nf = 5\n  } else if (f < 6.5) {\n    nf = 6\n  } else {\n    nf = 8\n  }\n  value = nf * exp10\n  return exponent >= -20 ? +value.toFixed(exponent < 0 ? -exponent : 0) : value\n}\n\n/**\n * 四和五入\n * @param value\n * @param precision\n * @return {number}\n */\nexport function round (value, precision) {\n  if (precision == null) {\n    precision = 10\n  }\n  precision = Math.min(Math.max(0, precision), 20)\n  value = (+value).toFixed(precision)\n  return +value\n}\n\n/**\n * 获取小数位数\n * @param value\n * @return {number|number}\n */\nexport function getPrecision (value) {\n  const str = value.toString()\n  const eIndex = str.indexOf('e')\n  if (eIndex > 0) {\n    const precision = +str.slice(eIndex + 1)\n    return precision < 0 ? -precision : 0\n  } else {\n    const dotIndex = str.indexOf('.')\n    return dotIndex < 0 ? 0 : str.length - 1 - dotIndex\n  }\n}\n\n/**\n * 10为低的对数函数\n * @param value\n * @return {number}\n */\nexport function log10 (value) {\n  return Math.log(value) / Math.log(10)\n}\n\n/**\n * 10的指数函数\n * @param value\n * @return {number}\n */\nexport function index10 (value) {\n  return Math.pow(10, value)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEV = '__BUILD_ENV__' === 'development'\n\n/**\n * 打印警告日志\n * @param api\n * @param invalidParam\n * @param append\n */\nexport function logWarn (api, invalidParam, append = '') {\n  if (DEV) {\n    console.log(\n      '%c😑 klinecharts warning: \\n%s%s%s',\n      'color:#fcaf17;font-weight:bold',\n      api ? `Call api ${api}${invalidParam || append ? ', ' : '.'}` : '',\n      invalidParam ? `invalid parameter ${invalidParam}${append ? ', ' : '.'}` : '',\n      append ? `${append}` : ''\n    )\n  }\n}\n\n/**\n * 打印错误日志\n * @param api\n * @param invalidParam\n * @param append\n */\nexport function logError (api, invalidParam, append = '') {\n  if (DEV) {\n    console.log(\n      '%c😟 klinecharts error: \\n%s%s%s',\n      'color:#ed1941;font-weight:bold',\n      api ? `Call api ${api}${invalidParam || append ? ', ' : '.'},` : '',\n      invalidParam ? `invalid parameter ${invalidParam}${append ? ', ' : '.'}` : '',\n      append ? `${append}` : ''\n    )\n  }\n}\n\n/**\n * 打印标识\n */\nexport function logTag () {\n  if (DEV) {\n    console.log(\n      '%c❤️ Welcome to klinecharts. Version is __BUILD_VERSION__',\n      'border-radius:2px;border:dashed 1px #2196F3;padding:26px 20px;font-size:14px;color:#2196F3'\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clone, isArray, isBoolean, isNumber, merge, isObject } from '../../utils/typeChecks'\n\n/**\n * 技术指标系列\n * @type {{PRICE: string, VOLUME: string, NORMAL: string}}\n */\nexport const TechnicalIndicatorSeries = {\n  PRICE: 'price',\n  VOLUME: 'volume',\n  NORMAL: 'normal'\n}\n\n/**\n * 绘制类型\n * @type {{BAR: string, LINE: string, CIRCLE: string}}\n */\nexport const TechnicalIndicatorPlotType = {\n  LINE: 'line',\n  BAR: 'bar',\n  CIRCLE: 'circle'\n}\n\nexport default class TechnicalIndicator {\n  constructor ({\n    name, series, calcParams, plots, precision,\n    calcParamsAllowDecimal, shouldCheckParamCount,\n    shouldOhlc, shouldFormatBigNumber,\n    baseValue, minValue, maxValue, styles\n  }) {\n    // 指标名\n    this.name = name || ''\n    // 指标系列，值有 'price', 'volume', 'normal\n    this.series = series || 'normal'\n    // 精度\n    this.precision = isNumber(precision) && precision >= 0 ? precision : 4\n    // 计算参数\n    this.calcParams = isArray(calcParams) ? calcParams : []\n    // 数据信息\n    this.plots = isArray(plots) ? plots : []\n    // 计算参数是否允许小数\n    this.calcParamsAllowDecimal = isObject(calcParamsAllowDecimal) ? calcParamsAllowDecimal : {}\n    // 是否需要检查参数\n    this.shouldCheckParamCount = isBoolean(shouldCheckParamCount) ? shouldCheckParamCount : true\n    // 是否需要ohlc\n    this.shouldOhlc = shouldOhlc\n    // 是否需要格式化大数据值，从1000开始格式化，比如100000是否需要格式化100K\n    this.shouldFormatBigNumber = shouldFormatBigNumber\n    // 基础比对数据\n    this.baseValue = isNumber(baseValue) ? baseValue : null\n    // 指定的最小值\n    this.minValue = minValue\n    // 指定的最大值\n    this.maxValue = maxValue\n    // 样式\n    this.styles = styles\n  }\n\n  setPrecision (precision) {\n    if (isNumber(precision) && precision >= 0) {\n      this.precision = parseInt(precision, 10)\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 设置计算参数是否允许小数\n   * @param calcParamsAllowDecimal\n   */\n  setCalcParamsAllowDecimal (calcParamsAllowDecimal) {\n    if (isObject(calcParamsAllowDecimal)) {\n      this.calcParamsAllowDecimal = calcParamsAllowDecimal\n    }\n  }\n\n  setCalcParams (params) {\n    if (!isArray(params)) {\n      return false\n    }\n    if (this.shouldCheckParamCount && params.length !== this.calcParams.length) {\n      return false\n    }\n    for (let i = 0; i < params.length; i++) {\n      const v = params[i]\n      if (!isNumber(v) || v <= 0 || (!this.calcParamsAllowDecimal[i] && parseInt(v, 10) !== v)) {\n        return false\n      }\n    }\n    this.calcParams = clone(params)\n    const plots = this.regeneratePlots(params)\n    if (plots && isArray(plots)) {\n      this.plots = plots\n    }\n    return true\n  }\n\n  setStyles (styles, defaultStyles) {\n    if (!isObject(styles)) {\n      return false\n    }\n    if (!this.styles) {\n      this.styles = {\n        bar: clone(defaultStyles.bar),\n        line: clone(defaultStyles.line),\n        circle: clone(defaultStyles.circle)\n      }\n    }\n    merge(this.styles, styles)\n    return true\n  }\n\n  /**\n   * 计算技术指标\n   */\n  calcTechnicalIndicator (dataList, calcParams) {}\n\n  /**\n   * 重新生成各项数据\n   * @private\n   */\n  regeneratePlots (params) {}\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicator from './TechnicalIndicator'\n\nimport extension from '../../data/extension'\n\nimport { isFunction, isValid } from '../../utils/typeChecks'\nimport { formatBigNumber, formatPrecision } from '../../utils/format'\nimport { logWarn } from '../../utils/logger'\n\n/**\n * 创建技术指标映射\n * @return {{}}\n */\nexport function createTechnicalIndicatorMapping () {\n  const mapping = {}\n  const technicalIndicatorExtensions = extension.technicalIndicatorExtensions\n  for (const name in technicalIndicatorExtensions) {\n    const technicalIndicatorInstance = createTechnicalIndicatorInstance(technicalIndicatorExtensions[name])\n    if (technicalIndicatorInstance) {\n      mapping[name] = technicalIndicatorInstance\n    }\n  }\n  return mapping\n}\n\n/**\n * 创建一个新的技术指标\n * @param name\n * @param series\n * @param calcParams\n * @param plots\n * @param precision\n * @param calcParamsAllowDecimal\n * @param shouldCheckParamCount\n * @param shouldOhlc\n * @param shouldFormatBigNumber\n * @param baseValue\n * @param minValue\n * @param maxValue\n * @param styles\n * @param calcTechnicalIndicator\n * @param regeneratePlots\n * @param render\n * @returns {TechnicalIndicatorClass|null}\n */\nexport function createTechnicalIndicatorInstance ({\n  name, series, calcParams, plots, precision,\n  calcParamsAllowDecimal, shouldCheckParamCount,\n  shouldOhlc, shouldFormatBigNumber, baseValue, minValue, maxValue, styles,\n  calcTechnicalIndicator, regeneratePlots, render\n}) {\n  if (!name || !isFunction(calcTechnicalIndicator)) {\n    logWarn('', '', 'The required attribute \"name\" and method \"calcTechnicalIndicator\" are missing, and new technical indicator cannot be generated!!!')\n    return null\n  }\n  class TechnicalIndicatorClass extends TechnicalIndicator {\n    constructor () {\n      super(\n        {\n          name,\n          series,\n          calcParams,\n          plots,\n          precision,\n          calcParamsAllowDecimal,\n          shouldCheckParamCount,\n          shouldOhlc,\n          shouldFormatBigNumber,\n          baseValue,\n          minValue,\n          maxValue,\n          styles\n        }\n      )\n    }\n  }\n  TechnicalIndicatorClass.prototype.calcTechnicalIndicator = calcTechnicalIndicator\n  if (regeneratePlots && isFunction(regeneratePlots)) {\n    TechnicalIndicatorClass.prototype.regeneratePlots = regeneratePlots\n  }\n  if (render && isFunction(render)) {\n    TechnicalIndicatorClass.prototype.render = render\n  }\n  return new TechnicalIndicatorClass()\n}\n\n/**\n * 获取技术指标信息\n * @param technicalIndicator\n * @return {{series, calcParams, precision, name, styles}}\n */\nexport function createTechnicalIndicatorInfo (technicalIndicator) {\n  return {\n    name: technicalIndicator.name,\n    series: technicalIndicator.series,\n    calcParams: technicalIndicator.calcParams,\n    calcParamsAllowDecimal: technicalIndicator.calcParamsAllowDecimal,\n    shouldCheckParamCount: technicalIndicator.shouldCheckParamCount,\n    shouldOhlc: technicalIndicator.shouldOhlc,\n    shouldFormatBigNumber: technicalIndicator.shouldFormatBigNumber,\n    precision: technicalIndicator.precision,\n    styles: technicalIndicator.styles,\n    result: technicalIndicator.result || []\n  }\n}\n\n/**\n * 获取技术指标提示数据\n * @param technicalIndicatorData\n * @param technicalIndicator\n * @return {{calcParamText: string, values: [], name: string}}\n */\nexport function getTechnicalIndicatorTooltipData (technicalIndicatorData = {}, technicalIndicator) {\n  const calcParams = technicalIndicator.calcParams\n  const plots = technicalIndicator.plots\n  const precision = technicalIndicator.precision\n  const shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n\n  const values = []\n  let name = ''\n  let calcParamText = ''\n  if (plots.length > 0) {\n    name = technicalIndicator.name\n  }\n  if (calcParams.length > 0) {\n    calcParamText = `(${calcParams.join(',')})`\n  }\n  plots.forEach(plot => {\n    const data = {}\n    if (isValid(plot.title)) {\n      let value = technicalIndicatorData[plot.key]\n      if (isValid(value)) {\n        value = formatPrecision(value, precision)\n        if (shouldFormatBigNumber) {\n          value = formatBigNumber(value)\n        }\n      }\n      data.title = plot.title\n      data.value = value\n    }\n    values.push(data)\n  })\n  return { values, name, calcParamText }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isObject, clone, merge } from '../../utils/typeChecks'\n\n/**\n * 覆盖物\n */\nexport default class Overlay {\n  constructor ({\n    id, chartData, xAxis, yAxis\n  }) {\n    this._id = id\n    this._chartData = chartData\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._styles = null\n  }\n\n  /**\n   * 绘制\n   * @param ctx\n   */\n  draw (ctx) {}\n\n  /**\n   * 设置样式\n   * @param styles\n   * @param defaultStyles\n   */\n  setStyles (styles, defaultStyles) {\n    if (!isObject(styles)) {\n      return false\n    }\n    if (!this._styles) {\n      this._styles = clone(defaultStyles)\n    }\n    merge(this._styles, styles)\n    return true\n  }\n\n  /**\n   * 获取id\n   * @return {*}\n   */\n  id () {\n    return this._id\n  }\n\n  /**\n   * 获取样式\n   * @return {null}\n   */\n  styles () {\n    return this._styles\n  }\n\n  /**\n   * 检查鼠标点是否在图形上\n   * @param point\n   */\n  checkMousePointOnGraphic (point) {}\n\n  // -------------------- 事件开始 -------------------\n\n  /**\n   * 点击事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onClick ({ id, points, event }) {}\n\n  /**\n   * 右击事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onRightClick ({ id, points, event }) {}\n\n  /**\n   * 鼠标进入事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onMouseEnter ({ id, points, event }) {}\n\n  /**\n   * 鼠标离开事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onMouseLeave ({ id, points, event }) {}\n\n  // -------------------- 事件结束 -------------------\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制边框圆\n * @param ctx\n * @param borderColor\n * @param borderSize\n * @param circlePoint\n * @param radius\n */\nexport function renderStrokeCircle (ctx, borderColor, borderSize, circlePoint, radius) {\n  ctx.lineWidth = borderSize\n  ctx.strokeStyle = borderColor\n  ctx.beginPath()\n  ctx.arc(circlePoint.x, circlePoint.y, radius, 0, Math.PI * 2)\n  ctx.closePath()\n  ctx.stroke()\n}\n\n/**\n * 绘制实心圆\n * @param ctx\n * @param fillColor\n * @param circlePoint\n * @param radius\n */\nexport function renderFillCircle (ctx, fillColor, circlePoint, radius) {\n  ctx.fillStyle = fillColor\n  ctx.beginPath()\n  ctx.arc(circlePoint.x, circlePoint.y, radius, 0, Math.PI * 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEVIATION = 2\n\n/**\n * 获取两点之间的距离\n * @param point1\n * @param point2\n * @return {number}\n */\nexport function getDistance (point1, point2) {\n  const xDif = point1.x - point2.x\n  const yDif = point1.y - point2.y\n  return Math.sqrt(xDif * xDif + yDif * yDif)\n}\n\n/**\n * 根据三角形三个点获取三角形面积\n * @param point1\n * @param point2\n * @param point3\n * @return {number}\n */\nexport function getTriangleSquare (point1, point2, point3) {\n  const x1 = Math.abs(point2.x - point1.x)\n  const y1 = Math.abs(point2.y - point1.y)\n  const x2 = Math.abs(point3.x - point1.x)\n  const y2 = Math.abs(point3.y - point1.y)\n  return Math.abs(x1 * y2 - x2 * y1) / 2\n}\n\n/**\n * 获取一点绕另一点旋转一定角度后新的点坐标\n * @param point 旋转点\n * @param targetPoint 参照点\n * @param angle 角度\n * @return {{x: *, y: *}}\n */\nexport function getRotatePoint (point, targetPoint, angle) {\n  const x = (point.x - targetPoint.x) * Math.cos(angle) - (point.y - targetPoint.y) * Math.sin(angle) + targetPoint.x\n  const y = (point.x - targetPoint.x) * Math.sin(angle) + (point.y - targetPoint.y) * Math.cos(angle) + targetPoint.y\n  return { x, y }\n}\n\n/**\n * 获取一次函数斜率和截距，即 y = kx + b 中的k值和b值\n * @param point1\n * @param point2\n */\nexport function getLinearSlopeIntercept (point1, point2) {\n  const difX = (point1.x - point2.x)\n  if (difX !== 0) {\n    const k = (point1.y - point2.y) / difX\n    const b = point1.y - k * point1.x\n    return { k, b }\n  }\n}\n\n/**\n * 获取点在两点决定的一次函数上的y值\n * @param point1\n * @param point2\n * @param targetPoint\n */\nexport function getLinearYFromPoints (point1, point2, targetPoint) {\n  const kb = getLinearSlopeIntercept(point1, point2)\n  return getLinearYFromSlopeIntercept(kb, targetPoint)\n}\n\n/**\n * 获取点在斜率和截距确定的线上的y值\n * @param kb\n * @param targetPoint\n */\nexport function getLinearYFromSlopeIntercept (kb, targetPoint) {\n  if (kb) {\n    return targetPoint.x * kb.k + kb.b\n  }\n  return targetPoint.y\n}\n\n/**\n * 点是否在线上\n * @param point1\n * @param point2\n * @param targetPoint\n */\nexport function checkPointOnStraightLine (point1, point2, targetPoint) {\n  if (!targetPoint || !point1 || !point2) {\n    return false\n  }\n  if (point1.x === point2.x) {\n    return Math.abs(targetPoint.x - point1.x) < DEVIATION\n  }\n  const kb = getLinearSlopeIntercept(point1, point2)\n  const y = getLinearYFromSlopeIntercept(kb, targetPoint)\n  const yDif = Math.abs(y - targetPoint.y)\n  return yDif * yDif / (kb.k * kb.k + 1) < DEVIATION * DEVIATION\n}\n\n/**\n * 点是否在线段上\n * @param point1\n * @param point2\n * @param targetPoint\n * @returns {boolean}\n */\nexport function checkPointOnRayLine (point1, point2, targetPoint) {\n  if (checkPointOnStraightLine(point1, point2, targetPoint)) {\n    if (point1.x === point2.x) {\n      if (point1.y < point2.y) {\n        return point1.y - targetPoint.y < DEVIATION\n      } else {\n        return targetPoint.y - point1.y < DEVIATION\n      }\n    }\n    if (point1.x < point2.x) {\n      return point1.x - targetPoint.x < DEVIATION\n    } else {\n      return targetPoint.x - point1.x < DEVIATION\n    }\n  }\n  return false\n}\n\n/**\n * 判断点是否在线段上面\n * @param point1\n * @param point2\n * @param targetPoint\n */\nexport function checkPointOnSegment (point1, point2, targetPoint) {\n  if (checkPointOnStraightLine(point1, point2, targetPoint)) {\n    if (point1.x === point2.x) {\n      return Math.abs(point1.y - targetPoint.y) + Math.abs(point2.y - targetPoint.y) - Math.abs(point1.y - point2.y) < DEVIATION * 2\n    }\n    return Math.abs(point1.x - targetPoint.x) + Math.abs(point2.x - targetPoint.x) - Math.abs(point1.x - point2.x) < DEVIATION * 2\n  }\n  return false\n}\n\n/**\n * 点是否在圆内\n * @param circleCenterPoint\n * @param radius\n * @param targetPoint\n * @returns {boolean}\n */\nexport function checkPointInCircle (circleCenterPoint, radius, targetPoint) {\n  if (!targetPoint) {\n    return false\n  }\n  const difX = targetPoint.x - circleCenterPoint.x\n  const difY = targetPoint.y - circleCenterPoint.y\n  return !(difX * difX + difY * difY > radius * radius)\n}\n\n/**\n * 点是否在圆上\n * @param circleCenterPoint\n * @param radius\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointOnCircle (circleCenterPoint, radius, targetPoint) {\n  if (!targetPoint) {\n    return false\n  }\n  return Math.abs(getDistance(targetPoint, circleCenterPoint) - radius) < DEVIATION\n}\n\n/**\n * 检查点是否在圆弧上\n * @param circleCenterPoint\n * @param radius\n * @param startAngle\n * @param endAngle\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointOnArc (circleCenterPoint, radius, startAngle, endAngle, targetPoint) {\n  if (checkPointOnCircle(circleCenterPoint, radius, targetPoint)) {\n    const startPointX = radius * Math.cos(startAngle) + circleCenterPoint.x\n    const startPointY = radius * Math.sin(startAngle) + circleCenterPoint.y\n    const endPointX = radius * Math.cos(endAngle) + circleCenterPoint.x\n    const endPointY = radius * Math.sin(endAngle) + circleCenterPoint.y\n    return (\n      targetPoint.x <= Math.max(startPointX, endPointX) + DEVIATION &&\n      targetPoint.x >= Math.min(startPointX, endPointX) - DEVIATION &&\n      targetPoint.y <= Math.max(startPointY, endPointY) + DEVIATION &&\n      targetPoint.y >= Math.min(startPointY, endPointY) - DEVIATION\n    )\n  }\n}\n\n/**\n * 检查点是否在三角形内部\n * @param trianglePoints\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointInTriangle (trianglePoints, targetPoint) {\n  const square = getTriangleSquare(trianglePoints[0], trianglePoints[1], trianglePoints[2])\n  const compareSquare =\n    getTriangleSquare(trianglePoints[0], trianglePoints[1], targetPoint) +\n    getTriangleSquare(trianglePoints[0], trianglePoints[2], targetPoint) +\n    getTriangleSquare(trianglePoints[1], trianglePoints[2], targetPoint)\n  return Math.abs(square - compareSquare) < DEVIATION\n}\n\n/**\n * 检查点是否在三角形菱形内部\n * @param centerPoint\n * @param width\n * @param height\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointInDiamond (centerPoint, width, height, targetPoint) {\n  const xDis = Math.abs(centerPoint.x - targetPoint.x)\n  const yDis = Math.abs(centerPoint.y - targetPoint.y)\n  return xDis * height + yDis * width < width * height / 2 + DEVIATION\n}\n\n/**\n * 检查点是否在矩形内部\n * @param point1\n * @param point2\n * @param targetPoint\n * @return {boolean}\n */\nexport function checkPointInRect (point1, point2, targetPoint) {\n  return targetPoint.x >= point1.x && targetPoint.x <= point2.x && targetPoint.y >= point1.y && targetPoint.y <= point2.y\n}\n\n/**\n * 根据两点获取一条射线\n * @param point1\n * @param point2\n * @param xyMax\n * @return {(*|{x: *, y: *})[]|*[]}\n */\nexport function getRayLine (point1, point2, xyMax) {\n  if (point1 && point2) {\n    let point\n    if (point1.x === point2.x && point1.y !== point2.y) {\n      if (point1.y < point2.y) {\n        point = {\n          x: point1.x,\n          y: xyMax.y\n        }\n      } else {\n        point = {\n          x: point1.x,\n          y: 0\n        }\n      }\n    } else if (point1.x > point2.x) {\n      point = {\n        x: 0,\n        y: getLinearYFromPoints(point1, point2, { x: 0, y: point1.y })\n      }\n    } else {\n      point = {\n        x: xyMax.x,\n        y: getLinearYFromPoints(point1, point2, { x: xyMax.x, y: point1.y })\n      }\n    }\n    return [point1, point]\n  }\n  return []\n}\n\n/**\n * 获取平行线\n * @param points\n * @param xyMax\n * @param extendParallelLineCount\n * @returns {Array}\n */\nexport function getParallelLines (points, xyMax, extendParallelLineCount = 0) {\n  const lines = []\n  if (points.length > 1) {\n    if (points[0].x === points[1].x) {\n      const startY = 0\n      const endY = xyMax.y\n      lines.push([{ x: points[0].x, y: startY }, { x: points[0].x, y: endY }])\n      if (points.length > 2) {\n        lines.push([{ x: points[2].x, y: startY }, { x: points[2].x, y: endY }])\n        const distance = points[0].x - points[2].x\n        for (let i = 0; i < extendParallelLineCount; i++) {\n          const d = distance * (i + 1)\n          lines.push([{ x: points[0].x + d, y: startY }, { x: points[0].x + d, y: endY }])\n        }\n      }\n    } else {\n      const startX = 0\n      const endX = xyMax.x\n      const kb = getLinearSlopeIntercept(points[0], points[1])\n      const k = kb.k\n      const b = kb.b\n      lines.push([{ x: startX, y: startX * k + b }, { x: endX, y: endX * k + b }])\n      if (points.length > 2) {\n        const b1 = points[2].y - k * points[2].x\n        lines.push([{ x: startX, y: startX * k + b1 }, { x: endX, y: endX * k + b1 }])\n        const distance = b - b1\n        for (let i = 0; i < extendParallelLineCount; i++) {\n          const b2 = b + distance * (i + 1)\n          lines.push([{ x: startX, y: startX * k + b2 }, { x: endX, y: endX * k + b2 }])\n        }\n      }\n    }\n  }\n  return lines\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制水平直线\n * @param ctx\n * @param y\n * @param left\n * @param right\n */\nexport function renderHorizontalLine (ctx, y, left, right) {\n  ctx.beginPath()\n  const correction = (ctx.lineWidth % 2) ? 0.5 : 0\n  ctx.moveTo(left, y + correction)\n  ctx.lineTo(right, y + correction)\n  ctx.stroke()\n  ctx.closePath()\n}\n\n/**\n * 绘制垂直直线\n * @param ctx\n * @param x\n * @param top\n * @param bottom\n */\nexport function renderVerticalLine (ctx, x, top, bottom) {\n  ctx.beginPath()\n  const correction = (ctx.lineWidth % 2) ? 0.5 : 0\n  ctx.moveTo(x + correction, top)\n  ctx.lineTo(x + correction, bottom)\n  ctx.stroke()\n  ctx.closePath()\n}\n\n/**\n * 绘制线\n * @param ctx\n * @param renderFuc\n */\nexport function renderLine (ctx, renderFuc) {\n  ctx.save()\n  if (ctx.lineWidth % 2) {\n    ctx.translate(0.5, 0.5)\n  }\n  renderFuc()\n  ctx.restore()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from '../Overlay'\n\nimport { renderFillCircle } from '../../../renderer/circle'\nimport { checkPointInCircle } from '../../../extension/mark/graphicHelper'\nimport { renderHorizontalLine, renderLine, renderVerticalLine } from '../../../renderer/line'\nimport { isValid, isArray, clone } from '../../../utils/typeChecks'\n\n// 标记图形绘制步骤开始\nconst GRAPHIC_MARK_DRAW_STEP_START = 1\n\n// 标记图形绘制步骤结束\nconst GRAPHIC_MARK_DRAW_STEP_FINISHED = -1\n\n/**\n * 图形标记鼠标操作元素类型\n * @type {{OTHER: string, POINT: string, NONE: string}}\n */\nexport const GraphicMarkMouseOperateElement = {\n  OTHER: 'other',\n  POINT: 'point',\n  NONE: 'none'\n}\n\n/**\n * 绘制类型\n * @type {{ARC: string, POLYGON: string, LINE: string, CONTINUOUS_LINE: string, TEXT: string}}\n */\nconst GraphicMarkDrawType = {\n  LINE: 'line',\n  TEXT: 'text',\n  CONTINUOUS_LINE: 'continuous_line',\n  POLYGON: 'polygon',\n  ARC: 'arc'\n}\n\n/**\n * 绘制风格\n * @type {{STROKE: string, FILL: string, SOLID: string, DASH: string}}\n */\nconst GraphicMarkDrawStyle = {\n  STROKE: 'stroke',\n  FILL: 'fill',\n  SOLID: 'solid',\n  DASH: 'dash'\n}\n\n/**\n * 线类型\n * @type {{VERTICAL: number, COMMON: number, HORIZONTAL: number}}\n */\nconst LineType = {\n  COMMON: 0,\n  HORIZONTAL: 1,\n  VERTICAL: 2\n}\n\n/**\n * 获取绘制线类型\n * @param point1\n * @param point2\n * @private\n */\nfunction getLineType (point1, point2) {\n  if (point1.x === point2.x) {\n    return LineType.VERTICAL\n  }\n  if (point1.y === point2.y) {\n    return LineType.HORIZONTAL\n  }\n  return LineType.COMMON\n}\n\n/**\n * 标记图形\n */\nexport default class GraphicMark extends Overlay {\n  constructor ({\n    id, name, totalStep,\n    chartData, xAxis, yAxis,\n    points, styles, lock\n  }) {\n    super({ id, chartData, xAxis, yAxis })\n    this._name = name\n    this._totalStep = totalStep\n    this._lock = lock\n    this._drawStep = GRAPHIC_MARK_DRAW_STEP_START\n    this._points = []\n    this.setPoints(points)\n    this.setStyles(styles, chartData.styleOptions().graphicMark)\n  }\n\n  /**\n   * 加载点\n   * @param points\n   */\n  setPoints (points) {\n    if (isArray(points) && points.length > 0) {\n      let repeatTotalStep\n      if (points.length >= this._totalStep - 1) {\n        this._drawStep = GRAPHIC_MARK_DRAW_STEP_FINISHED\n        this._points = points.slice(0, this._totalStep - 1)\n        repeatTotalStep = this._totalStep - 1\n      } else {\n        this._drawStep = points.length + 1\n        this._points = clone(points)\n        repeatTotalStep = points.length\n      }\n      // 重新演练绘制一遍，防止因为点不对而绘制出错误的图形\n      for (let i = 0; i < repeatTotalStep; i++) {\n        this.performMouseMoveForDrawing(i + 2, this.points, this._points[i], this._xAxis, this._yAxis)\n      }\n      if (this._drawStep === GRAPHIC_MARK_DRAW_STEP_FINISHED) {\n        this.performMousePressedMove(this._points, this._points.length - 1, this._points[this._points.length - 1], this._xAxis, this._yAxis)\n      }\n    }\n  }\n\n  /**\n   * 时间戳转换成x轴上点的位置\n   * @param point\n   * @return {*|number}\n   * @private\n   */\n  _timestampOrDataIndexToPointX ({ timestamp, dataIndex }) {\n    return timestamp\n      ? this._xAxis.convertToPixel(this._chartData.timestampToDataIndex(timestamp))\n      : this._xAxis.convertToPixel(dataIndex)\n  }\n\n  /**\n   * 绘制线\n   * @param ctx\n   * @param lines\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawLines (ctx, lines, style, markOptions) {\n    ctx.save()\n    ctx.strokeStyle = markOptions.line.color\n    ctx.lineWidth = markOptions.line.size\n    if (style === GraphicMarkDrawStyle.DASH) {\n      ctx.setLineDash(markOptions.line.dashValue)\n    }\n    lines.forEach(points => {\n      if (points.length > 1) {\n        const lineType = getLineType(points[0], points[1])\n        switch (lineType) {\n          case LineType.COMMON: {\n            renderLine(ctx, () => {\n              ctx.beginPath()\n              ctx.moveTo(points[0].x, points[0].y)\n              ctx.lineTo(points[1].x, points[1].y)\n              ctx.stroke()\n              ctx.closePath()\n            })\n            break\n          }\n          case LineType.HORIZONTAL: {\n            renderHorizontalLine(ctx, points[0].y, points[0].x, points[1].x)\n            break\n          }\n          case LineType.VERTICAL: {\n            renderVerticalLine(ctx, points[0].x, points[0].y, points[1].y)\n            break\n          }\n          default: { break }\n        }\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制连续线\n   * @param ctx\n   * @param continuousLines\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawContinuousLines (ctx, continuousLines, style, markOptions) {\n    ctx.save()\n    ctx.strokeStyle = markOptions.line.color\n    ctx.lineWidth = markOptions.line.size\n    if (style === GraphicMarkDrawStyle.DASH) {\n      ctx.setLineDash(markOptions.line.dashValue)\n    }\n    continuousLines.forEach(points => {\n      if (points.length > 0) {\n        renderLine(ctx, () => {\n          ctx.beginPath()\n          ctx.moveTo(points[0].x, points[0].y)\n          for (let i = 1; i < points.length; i++) {\n            ctx.lineTo(points[i].x, points[i].y)\n          }\n          ctx.stroke()\n          ctx.closePath()\n        })\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制多边形\n   * @param ctx\n   * @param polygons\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawPolygons (ctx, polygons, style, markOptions) {\n    ctx.save()\n    let fillStroke\n    if (style === GraphicMarkDrawStyle.FILL) {\n      ctx.fillStyle = markOptions.polygon.fill.color\n      fillStroke = ctx.fill\n    } else {\n      ctx.lineWidth = markOptions.polygon.stroke.size\n      ctx.strokeStyle = markOptions.polygon.stroke.color\n      fillStroke = ctx.stroke\n    }\n    polygons.forEach(points => {\n      if (points.length > 0) {\n        renderLine(ctx, () => {\n          ctx.beginPath()\n          ctx.moveTo(points[0].x, points[0].y)\n          for (let i = 1; i < points.length; i++) {\n            ctx.lineTo(points[i].x, points[i].y)\n          }\n          ctx.closePath()\n          fillStroke.call(ctx)\n        })\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 画圆弧\n   * @param ctx\n   * @param arcs\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawArcs (ctx, arcs, style, markOptions) {\n    ctx.save()\n    if (style === GraphicMarkDrawStyle.FILL) {\n      ctx.fillStyle = markOptions.arc.fill.color\n    } else {\n      ctx.lineWidth = markOptions.arc.stroke.size\n      ctx.strokeStyle = markOptions.arc.stroke.color\n    }\n    arcs.forEach(({ x, y, radius, startAngle, endAngle }) => {\n      ctx.beginPath()\n      ctx.arc(x, y, radius, startAngle, endAngle)\n      if (style === GraphicMarkDrawStyle.FILL) {\n        ctx.closePath()\n        ctx.fill()\n      } else {\n        ctx.stroke()\n        ctx.closePath()\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制文字\n   * @param ctx\n   * @param texts\n   * @param style\n   * @param markOptions\n   * @private\n   */\n  _drawText (ctx, texts, style, markOptions) {\n    ctx.save()\n    let fillStroke\n    if (style === GraphicMarkDrawStyle.STROKE) {\n      ctx.strokeStyle = markOptions.text.color\n      fillStroke = ctx.strokeText\n    } else {\n      ctx.fillStyle = markOptions.text.color\n      fillStroke = ctx.fillText\n    }\n    ctx.font = `${markOptions.text.weight} ${markOptions.text.size}px ${markOptions.text.family}`\n    texts.forEach(({ x, y, text }) => {\n      fillStroke.call(ctx, text, x + markOptions.text.marginLeft, y - markOptions.text.marginBottom)\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制\n   * @param ctx\n   */\n  draw (ctx) {\n    const coordinates = this._points.map(({ timestamp, price, dataIndex }) => {\n      return {\n        x: this._timestampOrDataIndexToPointX({ timestamp, dataIndex }),\n        y: this._yAxis.convertToPixel(price)\n      }\n    })\n    const markOptions = this._styles || this._chartData.styleOptions().graphicMark\n    if (this._drawStep !== GRAPHIC_MARK_DRAW_STEP_START && coordinates.length > 0) {\n      const viewport = { width: this._xAxis.width(), height: this._yAxis.height() }\n      const precision = { price: this._chartData.pricePrecision(), volume: this._chartData.volumePrecision() }\n      const graphicDataSources = this.createGraphicDataSource(\n        this._drawStep, this._points, coordinates, viewport,\n        precision, this._xAxis, this._yAxis\n      ) || []\n      graphicDataSources.forEach(({ type, isDraw, style, dataSource = [] }) => {\n        if (!isValid(isDraw) || isDraw) {\n          switch (type) {\n            case GraphicMarkDrawType.LINE: {\n              this._drawLines(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.CONTINUOUS_LINE: {\n              this._drawContinuousLines(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.POLYGON: {\n              this._drawPolygons(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.ARC: {\n              this._drawArcs(ctx, dataSource, style, markOptions)\n              break\n            }\n            case GraphicMarkDrawType.TEXT: {\n              this._drawText(ctx, dataSource, style, markOptions)\n              break\n            }\n            default: { break }\n          }\n        }\n      })\n      if (this.drawExtend) {\n        ctx.save()\n        this.drawExtend(\n          ctx, graphicDataSources, markOptions,\n          viewport, precision, this._xAxis, this._yAxis\n        )\n        ctx.restore()\n      }\n    }\n    const graphicMarkMouseOperate = this._chartData.graphicMarkMouseOperate()\n    if (\n      (graphicMarkMouseOperate.hover.id === this._id && graphicMarkMouseOperate.hover.element !== GraphicMarkMouseOperateElement.NONE) ||\n      (graphicMarkMouseOperate.click.id === this._id && graphicMarkMouseOperate.click.element !== GraphicMarkMouseOperateElement.NONE)\n    ) {\n      coordinates.forEach(({ x, y }, index) => {\n        let radius = markOptions.point.radius\n        let color = markOptions.point.backgroundColor\n        let borderColor = markOptions.point.borderColor\n        let borderSize = markOptions.point.borderSize\n        if (\n          graphicMarkMouseOperate.hover.id === this._id &&\n          graphicMarkMouseOperate.hover.element === GraphicMarkMouseOperateElement.POINT &&\n          index === graphicMarkMouseOperate.hover.elementIndex\n        ) {\n          radius = markOptions.point.activeRadius\n          color = markOptions.point.activeBackgroundColor\n          borderColor = markOptions.point.activeBorderColor\n          borderSize = markOptions.point.activeBorderSize\n        }\n        renderFillCircle(ctx, borderColor, { x, y }, radius + borderSize)\n        renderFillCircle(ctx, color, { x, y }, radius)\n      })\n    }\n  }\n\n  /**\n   * 设置是否锁定\n   * @param lock\n   */\n  setLock (lock) {\n    this._lock = lock\n  }\n\n  /**\n   * 获取名字\n   * @return {*}\n   */\n  name () {\n    return this._name\n  }\n\n  /**\n   * 是否锁定\n   * @return {*}\n   */\n  lock () {\n    return this._lock\n  }\n\n  /**\n   * 总步骤数\n   * @return {*}\n   */\n  totalStep () {\n    return this._totalStep\n  }\n\n  /**\n   * 获取点\n   * @return {[]}\n   */\n  points () {\n    return this._points\n  }\n\n  /**\n   * 是否在绘制中\n   * @return {boolean}\n   */\n  isDrawing () {\n    return this._drawStep !== GRAPHIC_MARK_DRAW_STEP_FINISHED\n  }\n\n  /**\n   * 检查鼠标点是否在图形上\n   * @param mouseCoordinate\n   * @return {{id: *, elementIndex: number, element: string}}\n   */\n  checkMousePointOnGraphic (mouseCoordinate) {\n    const markOptions = this._styles || this._chartData.styleOptions().graphicMark\n    const coordinates = []\n    // 检查鼠标点是否在图形的点上\n    for (let i = 0; i < this._points.length; i++) {\n      const { timestamp, price, dataIndex } = this._points[i]\n      const coordinate = {\n        x: this._timestampOrDataIndexToPointX({ timestamp, dataIndex }),\n        y: this._yAxis.convertToPixel(price)\n      }\n      coordinates.push(coordinate)\n      if (checkPointInCircle(coordinate, markOptions.point.radius, mouseCoordinate)) {\n        return {\n          id: this._id,\n          element: GraphicMarkMouseOperateElement.POINT,\n          elementIndex: i,\n          instance: this\n        }\n      }\n    }\n    // 检查鼠标点是否在点构成的其它图形上\n    const graphicDataSources = this.createGraphicDataSource(\n      this._drawStep,\n      this._points,\n      coordinates,\n      {\n        width: this._xAxis.width(),\n        height: this._yAxis.height()\n      },\n      {\n        price: this._chartData.pricePrecision(),\n        volume: this._chartData.volumePrecision()\n      },\n      this._xAxis,\n      this._yAxis\n    ) || []\n    for (const { key, type, isCheck, dataSource = [] } of graphicDataSources) {\n      if (isCheck) {\n        for (let i = 0; i < dataSource.length; i++) {\n          const sources = dataSource[i]\n          if (this.checkMousePointOn(key, type, sources, mouseCoordinate)) {\n            return {\n              id: this._id,\n              element: GraphicMarkMouseOperateElement.OTHER,\n              elementIndex: i,\n              instance: this\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * 绘制过程中鼠标移动事件\n   * @param point\n   */\n  mouseMoveForDrawing (point) {\n    const dataIndex = this._xAxis.convertFromPixel(point.x)\n    const timestamp = this._chartData.dataIndexToTimestamp(dataIndex)\n    const price = this._yAxis.convertFromPixel(point.y)\n    this._points[this._drawStep - 1] = { timestamp, price, dataIndex }\n    this.performMouseMoveForDrawing(this._drawStep, this._points, { timestamp, price, dataIndex }, this._xAxis, this._yAxis)\n    this.onDrawing({ id: this._id, step: this._drawStep, points: this._points })\n  }\n\n  /**\n   * 鼠标左边按钮点击事件\n   */\n  mouseLeftButtonDownForDrawing () {\n    if (this._drawStep === this._totalStep - 1) {\n      this._drawStep = GRAPHIC_MARK_DRAW_STEP_FINISHED\n      this.onDrawEnd({ id: this._id, points: this._points })\n    } else {\n      this._drawStep++\n    }\n  }\n\n  /**\n   * 鼠标按住移动方法\n   * @param point\n   * @param event\n   */\n  mousePressedMove (point, event) {\n    const graphicMarkMouseOperate = this._chartData.graphicMarkMouseOperate()\n    const elementIndex = graphicMarkMouseOperate.click.elementIndex\n    if (\n      !this._lock &&\n      graphicMarkMouseOperate.click.id === this._id &&\n      graphicMarkMouseOperate.click.element === GraphicMarkMouseOperateElement.POINT &&\n      elementIndex !== -1\n    ) {\n      const dataIndex = this._xAxis.convertFromPixel(point.x)\n      const timestamp = this._chartData.dataIndexToTimestamp(dataIndex)\n      const price = this._yAxis.convertFromPixel(point.y)\n      this._points[elementIndex].timestamp = timestamp\n      this._points[elementIndex].dataIndex = dataIndex\n      this._points[elementIndex].price = price\n      this.performMousePressedMove(this._points, elementIndex, { dataIndex, timestamp, price }, this._xAxis, this._yAxis)\n      this.onPressedMove({\n        id: graphicMarkMouseOperate.click.id,\n        points: this._points,\n        event\n      })\n    }\n  }\n\n  // -------------------- 事件开始 -------------------\n\n  /**\n   * 开始绘制事件回调\n   * @param id\n   */\n  onDrawStart ({ id }) {}\n\n  /**\n   * 绘制过程中事件回调\n   * @param id\n   * @param step\n   * @param points\n   */\n  onDrawing ({ id, step, points }) {}\n\n  /**\n   * 绘制结束事件回调\n   * @param id\n   * @param points\n   */\n  onDrawEnd ({ id, points }) {}\n\n  /**\n   * 按住移动事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onPressedMove ({ id, points, event }) {}\n\n  /**\n   * 移除事件回调\n   * @param id\n   */\n  onRemove ({ id }) {}\n\n  // -------------------- 事件结束 -------------------\n\n  // --------------------- 自定义时需要实现的一些方法开始 ----------------------\n\n  /**\n   * 检查鼠标点在其它图形上\n   * @param key\n   * @param type\n   * @param points\n   * @param mousePoint\n   */\n  checkMousePointOn (key, type, points, mousePoint) {}\n\n  /**\n   * 创建图形配置\n   * @param step\n   * @param points\n   * @param coordinates\n   * @param viewport\n   * @param precision\n   * @param xAxis\n   * @param yAxis\n   */\n  createGraphicDataSource (step, points, coordinates, viewport, precision, xAxis, yAxis) {}\n\n  /**\n   * 处理绘制过程中鼠标移动\n   * @param step\n   * @param points\n   * @param point\n   * @param xAxis\n   * @param yAxis\n   */\n  performMouseMoveForDrawing (step, points, point, xAxis, yAxis) {}\n\n  /**\n   * 处理鼠标按住移动\n   * @param points\n   * @param pressedPointIndex\n   * @param point\n   * @param xAxis\n   * @param yAxis\n   */\n  performMousePressedMove (points, pressedPointIndex, point, xAxis, yAxis) {}\n\n  // --------------------- 自定义时需要实现的一些方法结束 ----------------------\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default class Delegate {\n  constructor () {\n    this._observers = []\n  }\n\n  subscribe (observer) {\n    if (this._observers.indexOf(observer) < 0) {\n      this._observers.push(observer)\n    }\n  }\n\n  unsubscribe (observer) {\n    const index = this._observers.indexOf(observer)\n    if (index > -1) {\n      this._observers.splice(index, 1)\n    } else {\n      this._observers = []\n    }\n  }\n\n  execute (data) {\n    this._observers.forEach(observer => {\n      observer(data)\n    })\n  }\n\n  hasObservers () {\n    return this._observers.length > 0\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFunction, isNumber } from '../../../utils/typeChecks'\nimport { logWarn } from '../../../utils/logger'\n\nimport extension from '../../../data/extension'\n\nimport GraphicMark from './GraphicMark'\n\n/**\n * 创建图形标记映射\n * @return {{}}\n */\nexport function createGraphicMarkMapping () {\n  const mapping = {}\n  const graphicMarkExtensions = extension.graphicMarkExtensions\n  for (const name in graphicMarkExtensions) {\n    const graphicMarkClass = createGraphicMarkClass(graphicMarkExtensions[name])\n    if (graphicMarkClass) {\n      mapping[name] = graphicMarkClass\n    }\n  }\n  return mapping\n}\n\n/**\n * 创建图形标记类\n * @param name\n * @param series\n * @param checkMousePointOn\n * @param createGraphicDataSource\n * @param performMousePressedMove\n * @param performMouseMoveForDrawing\n * @param drawExtend\n * @return {Mark|null}\n */\nexport function createGraphicMarkClass ({\n  name, totalStep, checkMousePointOn, createGraphicDataSource,\n  performMousePressedMove, performMouseMoveForDrawing, drawExtend\n}) {\n  if (\n    !name ||\n    !isNumber(totalStep) ||\n    !isFunction(checkMousePointOn) ||\n    !isFunction(createGraphicDataSource)\n  ) {\n    logWarn('', '', 'Required attribute \"name\" and \"totalStep\", method \"checkMousePointOn\" and \"createGraphicDataSource\", new graphic mark cannot be generated!!!')\n    return null\n  }\n  class Mark extends GraphicMark {\n    constructor ({\n      id, chartData, xAxis, yAxis, points, styles, lock\n    }) {\n      super({\n        id, name, totalStep, chartData, xAxis, yAxis, points, styles, lock\n      })\n    }\n  }\n  Mark.prototype.checkMousePointOn = checkMousePointOn\n  Mark.prototype.createGraphicDataSource = createGraphicDataSource\n  if (isFunction(performMousePressedMove)) {\n    Mark.prototype.performMousePressedMove = performMousePressedMove\n  }\n  if (isFunction(performMouseMoveForDrawing)) {\n    Mark.prototype.performMouseMoveForDrawing = performMouseMoveForDrawing\n  }\n  if (isFunction(drawExtend)) {\n    Mark.prototype.drawExtend = drawExtend\n  }\n  return Mark\n}\n\n/**\n * 获取图形标记信息\n * @param graphicMark\n * @return {{name, lock: *, styles, id, points: (*|*[])}}\n */\nexport function getGraphicMarkInfo (graphicMark) {\n  return {\n    name: graphicMark.name(),\n    id: graphicMark.id(),\n    totalStep: graphicMark.totalStep(),\n    lock: graphicMark.lock(),\n    points: graphicMark.tpPoints(),\n    styles: graphicMark.styles()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// 默认技术指标窗口高度\nexport const DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT = 100\n\n// 技术指标窗口id前缀\nexport const TECHNICAL_INDICATOR_PANE_ID_PREFIX = 'technical_indicator_pane_'\n\n// 图形标记id前缀\nexport const GRAPHIC_MARK_ID_PREFIX = 'graphic_mark_'\n\n// 蜡烛图窗口id\nexport const CANDLE_PANE_ID = 'candle_pane'\n\n// 最小单条数据宽度\nexport const MIN_DATA_SPACE = 1\n\n// 最大单条数据宽度\nexport const MAX_DATA_SPACE = 50\n\n/**\n * 刷新层级\n * @type {{OVERLAY: number, MAIN: number, NONE: number, FULL: number}}\n */\nexport const InvalidateLevel = {\n  NONE: 0,\n  OVERLAY: 1,\n  MAIN: 2,\n  FULL: 3\n}\n\n/**\n * 图表动作\n * @type {{DRAW_CANDLE: string, SCROLL: string, PANE_DRAG: string, ZOOM: string, CROSSHAIR: string, DRAW_TECHNICAL_INDICATOR: string}}\n */\nexport const ActionType = {\n  DRAW_CANDLE: 'drawCandle',\n  DRAW_TECHNICAL_INDICATOR: 'drawTechnicalIndicator',\n  ZOOM: 'zoom',\n  SCROLL: 'scroll',\n  CROSSHAIR: 'crosshair',\n  PANE_DRAG: 'pane_drag'\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  isArray, isObject,\n  isFunction, isBoolean,\n  isValid, merge, clone\n} from '../utils/typeChecks'\nimport { defaultStyleOptions } from './options/styleOptions'\n\nimport { formatValue } from '../utils/format'\nimport { binarySearchNearest } from '../utils/number'\nimport { logWarn } from '../utils/logger'\n\nimport {\n  createTechnicalIndicatorInstance,\n  createTechnicalIndicatorMapping,\n  createTechnicalIndicatorInfo\n} from '../base/technicalindicator/technicalIndicatorControl'\nimport { TechnicalIndicatorSeries } from '../base/technicalindicator/TechnicalIndicator'\nimport { GraphicMarkMouseOperateElement } from '../base/overlay/mark/GraphicMark'\nimport Delegate from './delegate/Delegate'\nimport {\n  createGraphicMarkClass,\n  createGraphicMarkMapping,\n  getGraphicMarkInfo\n} from '../base/overlay/mark/graphicMarkControl'\n\nimport { MIN_DATA_SPACE, MAX_DATA_SPACE, InvalidateLevel, ActionType } from './constants'\n\nexport default class ChartData {\n  constructor (styleOptions, handler) {\n    // 持有者\n    this._handler = handler\n    // 样式配置\n    this._styleOptions = clone(defaultStyleOptions)\n    merge(this._styleOptions, styleOptions)\n    // 所有技术指标映射\n    this._technicalIndicatorMapping = createTechnicalIndicatorMapping()\n    // 是否可以缩放\n    this._zoomEnabled = true\n    // 是否可以拖拽滑动\n    this._scrollEnabled = true\n\n    // 价格精度\n    this._pricePrecision = 2\n    // 数量精度\n    this._volumePrecision = 0\n\n    this._dateTimeFormat = new Intl.DateTimeFormat(\n      'en', {\n        hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit'\n      }\n    )\n\n    // 数据源\n    this._dataList = []\n    // 可见的数据(需要绘制的数据)\n    this._visibleDataList = []\n\n    // 是否在加载中\n    this._loading = true\n    // 加载更多回调\n    this._loadMoreCallback = null\n    // 还有更多\n    this._more = true\n\n    // 可见区域数据占用的空间\n    this._totalDataSpace = 0\n    // 每一条数据的空间\n    this._dataSpace = 6\n    // bar的空间\n    this._barSpace = this._calcBarSpace()\n    // 向右偏移的空间\n    this._offsetRightSpace = 50\n    // 向右偏移的数量\n    this._offsetRightBarCount = this._offsetRightSpace / this._dataSpace\n    // 左边最小可见bar的个数\n    this._leftMinVisibleBarCount = 2\n    // 右边最小可见bar的个数\n    this._rightMinVisibleBarCount = 2\n    // 开始绘制的索引\n    this._from = 0\n    // 结束的索引\n    this._to = 0\n\n    // 十字光标信息\n    this._crosshair = {}\n    // 用来记录开始拖拽时向右偏移的数量\n    this._preOffsetRightBarCount = 0\n\n    // 拖拽标记图形标记\n    this._dragGraphicMarkFlag = false\n    // 图形标记映射\n    this._graphicMarkMapping = createGraphicMarkMapping()\n    // 图形标记鼠标操作信息\n    this._graphicMarkMouseOperate = {\n      click: {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      },\n      hover: {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    }\n    // 绘图标记数据\n    this._graphicMarks = []\n\n    // 注解标记\n    this._annotations = new Map()\n    // 可见的注解标记\n    this._visibleAnnotations = []\n    // 注解鼠标操作信息\n    this._annotationMouseOperate = { id: '' }\n\n    // 标签\n    this._tags = new Map()\n\n    // 调整pane标记\n    this._dragPaneFlag = false\n\n    // 事件代理\n    this._actionDelegate = new Map()\n  }\n\n  /**\n   * 计算一条柱子的空间\n   * @returns {number}\n   * @private\n   */\n  _calcBarSpace () {\n    const rateBarSpace = Math.floor(this._dataSpace * 0.82)\n    const floorBarSpace = Math.floor(this._dataSpace)\n    const optimalBarSpace = Math.min(rateBarSpace, floorBarSpace - 1)\n    return Math.max(1, optimalBarSpace)\n  }\n\n  /**\n   * 调整可见数据\n   * @private\n   */\n  _adjustVisibleDataList () {\n    // 处理需要绘制的数据\n    const dataSize = this._dataList.length\n    this._visibleDataList = []\n    this._visibleAnnotations = []\n    for (let i = this._from; i < this._to; i++) {\n      const kLineData = this._dataList[i]\n      const deltaFromRight = dataSize + this._offsetRightBarCount - i\n      const x = this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace\n      this._visibleDataList.push({\n        index: i,\n        x,\n        data: kLineData\n      })\n      const annotation = this._annotations.get(kLineData.timestamp) || []\n      if (annotation.length > 0) {\n        for (const an of annotation) {\n          an.createSymbolCoordinate(x)\n          this._visibleAnnotations.push(an)\n        }\n      }\n    }\n  }\n\n  /**\n   * 调整绘制起点终点位置\n   * @private\n   */\n  _adjustFromTo () {\n    const dataSize = this._dataList.length\n    const barLength = this._totalDataSpace / this._dataSpace\n    const maxRightOffsetBarCount = barLength - Math.min(this._leftMinVisibleBarCount, dataSize)\n    if (this._offsetRightBarCount > maxRightOffsetBarCount) {\n      this._offsetRightBarCount = maxRightOffsetBarCount\n    }\n\n    const minRightOffsetBarCount = -dataSize + Math.min(this._rightMinVisibleBarCount, dataSize)\n\n    if (this._offsetRightBarCount < minRightOffsetBarCount) {\n      this._offsetRightBarCount = minRightOffsetBarCount\n    }\n    this._to = Math.round(this._offsetRightBarCount + dataSize + 0.5)\n    this._from = Math.round(this._to - barLength) - 1\n    if (this._to > dataSize) {\n      this._to = dataSize\n    }\n    if (this._from < 0) {\n      this._from = 0\n    }\n    this._adjustVisibleDataList()\n    // 处理加载更多，有更多并且没有在加载则去加载更多\n    if (this._from === 0 && this._more && !this._loading && this._loadMoreCallback && isFunction(this._loadMoreCallback)) {\n      this._loading = true\n      this._loadMoreCallback(formatValue(this._dataList[0], 'timestamp'))\n    }\n  }\n\n  /**\n   * 获取样式配置\n   * @return {{}}\n   */\n  styleOptions () {\n    return this._styleOptions\n  }\n\n  /**\n   * 设置样式配置\n   * @param options\n   */\n  applyStyleOptions (options) {\n    merge(this._styleOptions, options)\n  }\n\n  /**\n   * 获取技术指标信息\n   * @param name\n   * @return {{}|{series: *, calcParams: *, precision: *, name: *}}\n   */\n  getTechnicalIndicatorInfo (name) {\n    if (isValid(name)) {\n      const tech = this.getTechnicalIndicatorInstance(name)\n      if (tech) {\n        return createTechnicalIndicatorInfo(tech)\n      }\n    } else {\n      const techs = {}\n      for (const name in this._technicalIndicatorMapping) {\n        const instance = this._technicalIndicatorMapping[name]\n        techs[name] = createTechnicalIndicatorInfo(instance)\n      }\n      return techs\n    }\n    return {}\n  }\n\n  /**\n   * 根据指标类型获取指标类\n   * @param name\n   * @return {*}\n   */\n  getTechnicalIndicatorInstance (name) {\n    return this._technicalIndicatorMapping[name]\n  }\n\n  /**\n   * 价格精度\n   * @returns {number}\n   */\n  pricePrecision () {\n    return this._pricePrecision\n  }\n\n  /**\n   * 数量精度\n   * @returns {number}\n   */\n  volumePrecision () {\n    return this._volumePrecision\n  }\n\n  /**\n   * 获取时间格式化\n   * @returns {Intl.DateTimeFormat | Intl.DateTimeFormat}\n   */\n  dateTimeFormat () {\n    return this._dateTimeFormat\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    let dateTimeFormat\n    try {\n      dateTimeFormat = new Intl.DateTimeFormat(\n        'en', {\n          hour12: false, timeZone: timezone, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit'\n        }\n      )\n    } catch (e) {\n      logWarn('', '', 'Timezone is error!!!')\n    }\n    if (dateTimeFormat) {\n      this._dateTimeFormat = dateTimeFormat\n    }\n  }\n\n  /**\n   * 获取时区\n   * @returns {null}\n   */\n  timezone () {\n    return this._dateTimeFormat.resolvedOptions().timeZone\n  }\n\n  /**\n   * 设置价格和数量精度\n   * @param pricePrecision\n   * @param volumePrecision\n   */\n  setPriceVolumePrecision (pricePrecision, volumePrecision) {\n    this._pricePrecision = pricePrecision\n    this._volumePrecision = volumePrecision\n    for (const name in this._technicalIndicatorMapping) {\n      const series = this._technicalIndicatorMapping[name].series\n      switch (series) {\n        case TechnicalIndicatorSeries.PRICE: {\n          this._technicalIndicatorMapping[name].setPrecision(pricePrecision)\n          break\n        }\n        case TechnicalIndicatorSeries.VOLUME: {\n          this._technicalIndicatorMapping[name].setPrecision(volumePrecision)\n          break\n        }\n        default: { break }\n      }\n    }\n  }\n\n  /**\n   * 获取数据源\n   * @returns {[]|*[]}\n   */\n  dataList () {\n    return this._dataList\n  }\n\n  /**\n   * 获取可见数据源\n   * @returns {[]|*[]}\n   */\n  visibleDataList () {\n    return this._visibleDataList\n  }\n\n  /**\n   * 清空数据源\n   */\n  clearDataList () {\n    this._more = true\n    this._loading = true\n    this._dataList = []\n    this._visibleDataList = []\n    this._from = 0\n    this._to = 0\n  }\n\n  /**\n   * 添加数据\n   * @param data\n   * @param pos\n   * @param more\n   */\n  addData (data, pos, more) {\n    if (isObject(data)) {\n      if (isArray(data)) {\n        this._loading = false\n        this._more = isBoolean(more) ? more : true\n        const isFirstAdd = this._dataList.length === 0\n        this._dataList = data.concat(this._dataList)\n        if (isFirstAdd) {\n          this.setOffsetRightSpace(this._offsetRightSpace)\n        }\n        this._adjustFromTo()\n      } else {\n        const dataSize = this._dataList.length\n        if (pos >= dataSize) {\n          this._dataList.push(data)\n          if (this._offsetRightBarCount < 0) {\n            this._offsetRightBarCount -= 1\n          }\n          this._adjustFromTo()\n        } else {\n          this._dataList[pos] = data\n          this._adjustVisibleDataList()\n        }\n      }\n      this.setCrosshair(this._crosshair, true)\n    }\n  }\n\n  /**\n   * 获取一条数据的空间\n   * @returns {number}\n   */\n  dataSpace () {\n    return this._dataSpace\n  }\n\n  /**\n   * 获取绘制一条数据的空间（不包括bar之间的间隙）\n   * @returns {*}\n   */\n  barSpace () {\n    return this._barSpace\n  }\n\n  /**\n   * 设置一条数据的空间\n   * @param dataSpace\n   * @param adjustBeforeFuc\n   */\n  setDataSpace (dataSpace, adjustBeforeFuc) {\n    if (dataSpace < MIN_DATA_SPACE || dataSpace > MAX_DATA_SPACE || this._dataSpace === dataSpace) {\n      return\n    }\n    this._dataSpace = dataSpace\n    this._barSpace = this._calcBarSpace()\n    adjustBeforeFuc && adjustBeforeFuc()\n    this._adjustFromTo()\n    this.setCrosshair(this._crosshair, true)\n    this.invalidate()\n  }\n\n  /**\n   * 设置可见区域数据占用的总空间\n   * @param totalSpace\n   */\n  setTotalDataSpace (totalSpace) {\n    if (this._totalDataSpace === totalSpace) {\n      return\n    }\n    this._totalDataSpace = totalSpace\n    this._adjustFromTo()\n    this.setCrosshair(this._crosshair, true)\n  }\n\n  /**\n   * 设置右边可以偏移的空间\n   * @param space\n   * @param invalidate\n   */\n  setOffsetRightSpace (space, invalidate) {\n    this._offsetRightSpace = space\n    this._offsetRightBarCount = space / this._dataSpace\n    if (invalidate) {\n      this._adjustFromTo()\n      this.setCrosshair(this._crosshair, true)\n      this.invalidate()\n    }\n  }\n\n  /**\n   * 右偏移距离\n   * @return {number}\n   */\n  offsetRightSpace () {\n    return this._offsetRightSpace\n  }\n\n  /**\n   * 右偏移bar数量\n   * @return {*|number}\n   */\n  offsetRightBarCount () {\n    return this._offsetRightBarCount\n  }\n\n  /**\n   * 设置左边可见的最小bar数量\n   * @param barCount\n   */\n  setLeftMinVisibleBarCount (barCount) {\n    this._leftMinVisibleBarCount = barCount\n  }\n\n  /**\n   * 设置右边可见的最小bar数量\n   * @param barCount\n   */\n  setRightMinVisibleBarCount (barCount) {\n    this._rightMinVisibleBarCount = barCount\n  }\n\n  /**\n   * 获取数据绘制起点\n   * @returns {number}\n   */\n  from () {\n    return this._from\n  }\n\n  /**\n   * 获取数据绘制终点\n   * @returns {number}\n   */\n  to () {\n    return this._to\n  }\n\n  /**\n   * 获取十字光标信息\n   * @returns {{}}\n   */\n  crosshair () {\n    return this._crosshair\n  }\n\n  /**\n   * 设置十字光标点信息\n   * @param crosshair\n   * @param notInvalidate\n   */\n  setCrosshair (crosshair, notInvalidate) {\n    const cr = crosshair || {}\n    let realDataIndex\n    let dataIndex\n    if (isValid(cr.x)) {\n      realDataIndex = this.coordinateToDataIndex(cr.x)\n      if (realDataIndex < 0) {\n        dataIndex = 0\n      } else if (realDataIndex > this._dataList.length - 1) {\n        dataIndex = this._dataList.length - 1\n      } else {\n        dataIndex = realDataIndex\n      }\n    } else {\n      realDataIndex = this._dataList.length - 1\n      dataIndex = realDataIndex\n    }\n    const kLineData = this._dataList[dataIndex]\n    const realX = this.dataIndexToCoordinate(realDataIndex)\n    const prevCrosshair = { x: this._crosshair.x, y: this._crosshair.y, paneId: this._crosshair.paneId }\n    this._crosshair = { ...cr, realX, kLineData, realDataIndex, dataIndex }\n    if (cr.paneId && kLineData) {\n      this._handler.crosshair({\n        realDataIndex,\n        dataIndex,\n        kLineData,\n        x: cr.x,\n        y: cr.y\n      })\n    }\n    if (\n      (prevCrosshair.x !== cr.x || prevCrosshair.y !== cr.y || prevCrosshair.paneId !== cr.paneId) && !notInvalidate\n    ) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 开始滚动\n   */\n  startScroll () {\n    this._preOffsetRightBarCount = this._offsetRightBarCount\n  }\n\n  /**\n   * 滚动\n   * @param distance\n   * @param crosshair\n   */\n  scroll (distance, crosshair) {\n    if (!this._scrollEnabled) {\n      return\n    }\n    const distanceBarCount = distance / this._dataSpace\n    this.actionExecute(ActionType.SCROLL, { barCount: distanceBarCount, distance })\n    this._offsetRightBarCount = this._preOffsetRightBarCount - distanceBarCount\n    this._adjustFromTo()\n    const cross = crosshair || this._crosshair\n    this.setCrosshair(cross, true)\n    this.invalidate()\n  }\n\n  /**\n   * x转换成浮点数的位置\n   * @param x\n   * @returns {number}\n   */\n  coordinateToFloatIndex (x) {\n    const dataSize = this._dataList.length\n    const deltaFromRight = (this._totalDataSpace - x) / this._dataSpace\n    const index = dataSize + this._offsetRightBarCount - deltaFromRight\n    return Math.round(index * 1000000) / 1000000\n  }\n\n  /**\n   * 数据索引转换成时间戳\n   * @param dataIndex\n   * @return {*}\n   */\n  dataIndexToTimestamp (dataIndex) {\n    const data = this._dataList[dataIndex]\n    if (data) {\n      return data.timestamp\n    }\n  }\n\n  /**\n   * 将时间戳转换成数据索引位置\n   * @param timestamp\n   * @return {number}\n   */\n  timestampToDataIndex (timestamp) {\n    if (this._dataList.length === 0) {\n      return 0\n    }\n    return binarySearchNearest(this._dataList, 'timestamp', timestamp)\n  }\n\n  /**\n   * 数据索引转换成坐标\n   * @param dataIndex\n   */\n  dataIndexToCoordinate (dataIndex) {\n    const dataSize = this._dataList.length\n    const deltaFromRight = dataSize + this._offsetRightBarCount - dataIndex\n    // return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace + this._barSpace / 2\n    return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace\n  }\n\n  /**\n   * 坐标换成数据索引转\n   * @param pixel\n   */\n  coordinateToDataIndex (pixel) {\n    return Math.ceil(this.coordinateToFloatIndex(pixel)) - 1\n  }\n\n  /**\n   * 缩放\n   * @param scale\n   * @param point\n   */\n  zoom (scale, point) {\n    if (!this._zoomEnabled) {\n      return\n    }\n    if (!point || !isValid(point.x)) {\n      point = { x: isValid(this._crosshair.x) ? this._crosshair.x : this._totalDataSpace / 2 }\n    }\n    this.actionExecute(ActionType.ZOOM, { point, scale })\n    const floatIndex = this.coordinateToFloatIndex(point.x)\n    const dataSpace = this._dataSpace + scale * (this._dataSpace / 10)\n    this.setDataSpace(dataSpace, () => {\n      this._offsetRightBarCount += (floatIndex - this.coordinateToFloatIndex(point.x))\n    })\n  }\n\n  /**\n   * 刷新\n   * @param invalidateLevel\n   */\n  invalidate (invalidateLevel) {\n    this._handler.invalidate(invalidateLevel)\n  }\n\n  /**\n   * 设置是否可以缩放\n   * @param enabled\n   */\n  setZoomEnabled (enabled) {\n    this._zoomEnabled = enabled\n  }\n\n  /**\n   * 获取是否可以缩放\n   * @return {boolean}\n   */\n  zoomEnabled () {\n    return this._zoomEnabled\n  }\n\n  /**\n   * 设置是否可以拖拽滚动\n   * @param enabled\n   */\n  setScrollEnabled (enabled) {\n    this._scrollEnabled = enabled\n  }\n\n  /**\n   * 获取是否可以拖拽滚动\n   * @return {boolean}\n   */\n  scrollEnabled () {\n    return this._scrollEnabled\n  }\n\n  /**\n   * 设置加载更多\n   * @param callback\n   */\n  setLoadMoreCallback (callback) {\n    this._loadMoreCallback = callback\n  }\n\n  /**\n   * 添加标记实例\n   * @param graphicMark\n   */\n  addGraphicMarkInstance (graphicMark) {\n    if (this._graphicMarks.find(gm => gm.id() === graphicMark.id())) {\n      return false\n    }\n    const lastGraphicMark = this._graphicMarks[this._graphicMarks.length - 1]\n    if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n      this._graphicMarks[this._graphicMarks.length - 1] = graphicMark\n    } else {\n      this._graphicMarks.push(graphicMark)\n    }\n    this.invalidate(InvalidateLevel.OVERLAY)\n    return true\n  }\n\n  /**\n   * 添加自定义标记图形\n   * @param graphicMarks\n   */\n  addCustomGraphicMark (graphicMarks) {\n    graphicMarks.forEach(mark => {\n      const GraphicMarkClass = createGraphicMarkClass(mark)\n      if (GraphicMarkClass) {\n        this._graphicMarkMapping[mark.name] = GraphicMarkClass\n      }\n    })\n  }\n\n  /**\n   * 设置图形标记配置\n   * @param id\n   * @param options\n   */\n  setGraphicMarkOptions (id, options = {}) {\n    const { styles, lock } = options\n    const graphicMark = this._graphicMarks.find(gm => gm.id() === id)\n    if (graphicMark) {\n      graphicMark.setLock(lock)\n      if (graphicMark.setStyles(styles, this._styleOptions.graphicMark)) {\n        this.invalidate(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 获取图形标记信息\n   * @param id\n   * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n   */\n  getGraphicMark (id) {\n    if (id) {\n      const graphicMark = this._graphicMarks.find(gm => gm.id() === id)\n      if (graphicMark) {\n        return getGraphicMarkInfo(graphicMark)\n      }\n    } else {\n      return this._graphicMarks.map(graphicMark => {\n        return getGraphicMarkInfo(graphicMark)\n      })\n    }\n    return null\n  }\n\n  /**\n   * 移除图形实例\n   * @param id 参数\n   */\n  removeGraphicMarkInstance (id) {\n    const graphicMarks = this._graphicMarks\n    if (isValid(id)) {\n      const removeIndex = graphicMarks.findIndex(gm => gm.id() === id)\n      if (removeIndex > -1) {\n        graphicMarks[removeIndex].onRemove({ id: graphicMarks[removeIndex].id() })\n        graphicMarks.splice(removeIndex, 1)\n        this.invalidate(InvalidateLevel.OVERLAY)\n      }\n    } else {\n      if (graphicMarks.length > 0) {\n        graphicMarks.forEach(gm => {\n          gm.onRemove({ id: gm.id() })\n        })\n        this._graphicMarks = []\n        this.invalidate(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 获取图形标记拖拽标记\n   * @returns {boolean}\n   */\n  dragGraphicMarkFlag () {\n    return this._dragGraphicMarkFlag\n  }\n\n  /**\n   * 设置图形标记拖拽标记\n   * @param flag\n   */\n  setDragGraphicMarkFlag (flag) {\n    this._dragGraphicMarkFlag = flag\n  }\n\n  /**\n   * 获取图形标记鼠标操作信息\n   * @return {{hover: {id: string, elementIndex: number, element: string}, click: {id: string, elementIndex: number, element: string}}}\n   */\n  graphicMarkMouseOperate () {\n    return this._graphicMarkMouseOperate\n  }\n\n  /**\n   * 获取拖拽Pane标记\n   * @return {boolean}\n   */\n  dragPaneFlag () {\n    return this._dragPaneFlag\n  }\n\n  /**\n   * 设置拖拽Pane标记\n   * @param flag\n   */\n  setDragPaneFlag (flag) {\n    this._dragPaneFlag = flag\n  }\n\n  /**\n   * 获取图形标记映射\n   * @returns {{}}\n   */\n  graphicMarkMapping () {\n    return this._graphicMarkMapping\n  }\n\n  /**\n   * 获取图形标记的数据\n   * @returns {{}}\n   */\n  graphicMarks () {\n    return this._graphicMarks\n  }\n\n  /**\n   * 获取可见的注解\n   * @return {[]}\n   */\n  visibleAnnotations () {\n    return this._visibleAnnotations\n  }\n\n  /**\n   * 获取注解鼠标操作信息\n   * @return {null}\n   */\n  annotationMouseOperate () {\n    return this._annotationMouseOperate\n  }\n\n  /**\n   * 创建注解\n   * @param annotations\n   */\n  addAnnotations (annotations) {\n    annotations.forEach(annotation => {\n      if (this._annotations.has(annotation.id())) {\n        this._annotations.get(annotation.id()).push(annotation)\n      } else {\n        this._annotations.set(annotation.id(), [annotation])\n      }\n    })\n    this._adjustVisibleDataList()\n    this.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n   * 移除注解\n   * @param points\n   */\n  removeAnnotation (points) {\n    let shouldAdjust = false\n    if (isValid(points)) {\n      ([].concat(points)).forEach(({ timestamp }) => {\n        if (this._annotations.has(timestamp)) {\n          shouldAdjust = true\n          this._annotations.delete(timestamp)\n        }\n      })\n      if (shouldAdjust) {\n        this._adjustVisibleDataList()\n      }\n    } else {\n      shouldAdjust = true\n      this._annotations.clear()\n      this._visibleAnnotations = []\n    }\n    if (shouldAdjust) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 获取标签\n   * @return {Map<any, any>}\n   */\n  tags () {\n    return this._tags\n  }\n\n  /**\n   * 根据id获取标签实例\n   * @param id\n   * @return\n   */\n  getTag (id) {\n    return this._tags.get(id)\n  }\n\n  /**\n   * 添加标签\n   * @param tags\n   */\n  addTags (tags) {\n    tags.forEach(tag => {\n      this._tags.set(tag.id(), tag)\n    })\n    this.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n   * 移除标签\n   * @param id\n   */\n  removeTag (id) {\n    let shouldInvalidate = false\n    if (isValid(id)) {\n      const ids = [].concat(id)\n      ids.forEach(id => {\n        if (this._tags.has(id)) {\n          shouldInvalidate = true\n          this._tags.delete(id)\n        }\n      })\n    } else {\n      shouldInvalidate = true\n      this._tags.clear()\n    }\n    if (shouldInvalidate) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 设置覆盖物鼠标操作信息\n   * @param graphicMarkOperate\n   * @param annotationOperate\n   */\n  setOverlayMouseOperate (graphicMarkOperate, annotationOperate) {\n    const { hover, click } = this._graphicMarkMouseOperate\n    const { id } = this._annotationMouseOperate\n    const lastGraphicMark = this._graphicMarks[this._graphicMarks.length - 1]\n    let shouldInvalidate = false\n    if (graphicMarkOperate.hover &&\n      (hover.id !== graphicMarkOperate.hover.id || hover.element !== graphicMarkOperate.hover.element || hover.elementIndex !== graphicMarkOperate.hover.elementIndex)\n    ) {\n      this._graphicMarkMouseOperate.hover = { ...graphicMarkOperate.hover }\n      shouldInvalidate = true\n    }\n    if (graphicMarkOperate.click &&\n      (click.id !== graphicMarkOperate.click.id || click.element !== graphicMarkOperate.click.element || click.elementIndex !== graphicMarkOperate.click.elementIndex)\n    ) {\n      this._graphicMarkMouseOperate.click = { ...graphicMarkOperate.click }\n      shouldInvalidate = true\n    }\n    if (annotationOperate && id !== annotationOperate.id) {\n      this._annotationMouseOperate = { ...annotationOperate }\n      shouldInvalidate = true\n    }\n    if (shouldInvalidate || (lastGraphicMark && lastGraphicMark.isDrawing())) {\n      this.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 添加一个自定义指标\n   * @param techs\n   */\n  addCustomTechnicalIndicator (techs) {\n    techs.forEach(tech => {\n      const instance = createTechnicalIndicatorInstance(tech || {})\n      if (instance) {\n        // 将生成的新的指标类放入集合\n        this._technicalIndicatorMapping[instance.name] = instance\n      }\n    })\n  }\n\n  /**\n   * 事件执行\n   * @param type\n   * @param data\n   * @param executeBeforeFun\n   * @param executeAfterFun\n   */\n  actionExecute (type, data, executeBeforeFun, executeAfterFun) {\n    if (this.hasAction(type)) {\n      executeBeforeFun && executeBeforeFun()\n      this._actionDelegate.get(type).execute(data)\n      executeAfterFun && executeAfterFun()\n    }\n  }\n\n  /**\n   * 是否有事件监听\n   * @param type\n   * @return {boolean}\n   */\n  hasAction (type) {\n    return this._actionDelegate.has(type) && this._actionDelegate.get(type).hasObservers()\n  }\n\n  /**\n   * 订阅事件\n   * @param type\n   * @param callback\n   * @return {boolean}\n   */\n  subscribeAction (type, callback) {\n    if (Object.values(ActionType).indexOf(type) < 0) {\n      return false\n    }\n    if (!this._actionDelegate.has(type)) {\n      this._actionDelegate.set(type, new Delegate())\n    }\n    this._actionDelegate.get(type).subscribe(callback)\n    return true\n  }\n\n  /**\n   * 取消事件订阅\n   * @param type\n   * @param callback\n   * @return {boolean}\n   */\n  unsubscribeAction (type, callback) {\n    if (Object.values(ActionType).indexOf(type) < 0) {\n      return false\n    }\n    if (this._actionDelegate.has(type)) {\n      const delegate = this._actionDelegate.get(type)\n      delegate.unsubscribe(callback)\n      if (!delegate.hasObservers()) {\n        this._actionDelegate.delete(type)\n      }\n      return true\n    }\n    return false\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 获取屏幕比\n * @param canvas\n * @returns {number}\n */\nexport function getPixelRatio (canvas) {\n  return (canvas.ownerDocument && canvas.ownerDocument.defaultView && canvas.ownerDocument.defaultView.devicePixelRatio) || 2\n}\n\n/**\n * 测量文字的宽度\n * @param ctx\n * @param text\n * @returns {number}\n */\nexport function calcTextWidth (ctx, text) {\n  return Math.round(ctx.measureText(text).width)\n}\n\n/**\n * 创建字体\n * @param fontSize\n * @param fontFamily\n * @param fontWeight\n * @returns {string}\n */\nexport function createFont (fontSize = 12, fontWeight = 'normal', fontFamily = 'Helvetica Neue') {\n  return `${fontWeight} ${fontSize}px ${fontFamily}`\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\n\nexport default class Pane {\n  constructor (props) {\n    this._height = -1\n    this._container = props.container\n    this._chartData = props.chartData\n    this._initBefore(props)\n    this._initElement()\n    this._mainWidget = this._createMainWidget(this._element, props)\n    this._yAxisWidget = this._createYAxisWidget(this._element, props)\n  }\n\n  _initBefore (props) {}\n\n  _initElement () {\n    this._element = document.createElement('div')\n    this._element.style.margin = '0'\n    this._element.style.padding = '0'\n    this._element.style.position = 'relative'\n    this._element.style.overflow = 'hidden'\n    this._element.style.width = '100%'\n    const lastElement = this._container.lastChild\n    if (lastElement) {\n      this._container.insertBefore(this._element, lastElement)\n    } else {\n      this._container.appendChild(this._element)\n    }\n  }\n\n  /**\n   * 创建主组件\n   * @param container\n   * @param props\n   * @private\n   */\n  _createMainWidget (container, props) {}\n\n  /**\n   * 创建y轴组件\n   * @param container\n   * @param props\n   * @private\n   */\n  _createYAxisWidget (container, props) {}\n\n  /**\n   * 获取宽度\n   * @returns {number}\n   */\n  width () {\n    return this._element.offsetWidth\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    this._mainWidget.setWidth(mainWidgetWidth)\n    this._yAxisWidget && this._yAxisWidget.setWidth(yAxisWidgetWidth)\n  }\n\n  /**\n   * 获取高度\n   */\n  height () {\n    return this._height\n  }\n\n  /**\n   * 设置临时高度\n   * @param height\n   */\n  setHeight (height) {\n    this._height = height\n    this._mainWidget.setHeight(height)\n    this._yAxisWidget && this._yAxisWidget.setHeight(height)\n  }\n\n  setOffsetLeft (mainWidgetOffsetLeft, yAxisWidgetOffsetLeft) {\n    this._mainWidget.setOffsetLeft(mainWidgetOffsetLeft)\n    this._yAxisWidget && this._yAxisWidget.setOffsetLeft(yAxisWidgetOffsetLeft)\n  }\n\n  layout () {\n    if (this._element.offsetHeight !== this._height) {\n      this._element.style.height = `${this._height}px`\n    }\n    this._mainWidget.layout()\n    this._yAxisWidget && this._yAxisWidget.layout()\n  }\n\n  /**\n   * 刷新\n   * @param level\n   */\n  invalidate (level) {\n    this._yAxisWidget && this._yAxisWidget.invalidate(level)\n    this._mainWidget.invalidate(level)\n  }\n\n  /**\n   * 将canvas转换成图片\n   * @param includeOverlay\n   * @return {HTMLCanvasElement}\n   */\n  getImage (includeOverlay) {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    const width = this._element.offsetWidth\n    const height = this._element.offsetHeight\n    canvas.style.width = `${width}px`\n    canvas.style.height = `${height}px`\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    const mainWidgetElement = this._mainWidget.getElement()\n    const mainWidgetWidth = mainWidgetElement.offsetWidth\n    const mainWidgetHeight = mainWidgetElement.offsetHeight\n    const mainWidgetOffsetLeft = parseInt(mainWidgetElement.style.left, 10)\n\n    ctx.drawImage(\n      this._mainWidget.getImage(includeOverlay),\n      mainWidgetOffsetLeft, 0,\n      mainWidgetWidth, mainWidgetHeight\n    )\n    if (this._yAxisWidget) {\n      const yAxisWidgetElement = this._yAxisWidget.getElement()\n      const yAxisWidgetWidth = yAxisWidgetElement.offsetWidth\n      const yAxisWidgetHeight = yAxisWidgetElement.offsetHeight\n      const yAxisWidgetOffsetLeft = parseInt(yAxisWidgetElement.style.left, 10)\n      ctx.drawImage(\n        this._yAxisWidget.getImage(includeOverlay),\n        yAxisWidgetOffsetLeft, 0,\n        yAxisWidgetWidth, yAxisWidgetHeight\n      )\n    }\n    return canvas\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._container.removeChild(this._element)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InvalidateLevel } from '../data/constants'\nimport { getPixelRatio } from '../utils/canvas'\n\nexport default class Widget {\n  constructor (props) {\n    this._width = 0\n    this._height = 0\n    this._initElement(props.container)\n    this._mainView = this._createMainView(this._element, props)\n    this._overlayView = this._createOverlayView(this._element, props)\n  }\n\n  /**\n   * 初始化element\n   * @param container\n   * @private\n   */\n  _initElement (container) {\n    this._element = document.createElement('div')\n    this._element.style.top = '0'\n    this._element.style.margin = '0'\n    this._element.style.padding = '0'\n    this._element.style.position = 'absolute'\n    this._element.style.overflow = 'hidden'\n    container.appendChild(this._element)\n  }\n\n  /**\n   * 创建主view\n   * @param container\n   * @param props\n   * @private\n   */\n  _createMainView (container, props) {}\n\n  /**\n   * 创建浮层view\n   * @param container\n   * @param props\n   * @private\n   */\n  _createOverlayView (container, props) {}\n\n  getElement () {\n    return this._element\n  }\n\n  setWidth (width) {\n    this._width = width\n    this._mainView.setWidth(width)\n    this._overlayView.setWidth(width)\n  }\n\n  setHeight (height) {\n    this._height = height\n    this._mainView.setHeight(height)\n    this._overlayView.setHeight(height)\n  }\n\n  setOffsetLeft (offsetLeft) {\n    this._element.style.left = `${offsetLeft}px`\n  }\n\n  layout () {\n    if (this._element.offsetWidth !== this._width) {\n      this._element.style.width = `${this._width}px`\n    }\n    if (this._element.offsetHeight !== this._height) {\n      this._element.style.height = `${this._height}px`\n    }\n    this._mainView.layout()\n    this._overlayView.layout()\n  }\n\n  /**\n   * 更新\n   * @param level\n   */\n  invalidate (level) {\n    switch (level) {\n      case InvalidateLevel.OVERLAY: {\n        this._overlayView.flush()\n        break\n      }\n      case InvalidateLevel.MAIN:\n      case InvalidateLevel.FULL: {\n        this._mainView.flush()\n        this._overlayView.flush()\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  /**\n   * 将widget转换成图片\n   * @param includeOverlay\n   * @returns {HTMLCanvasElement}\n   */\n  getImage (includeOverlay) {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    canvas.style.width = `${this._width}px`\n    canvas.style.height = `${this._height}px`\n    canvas.width = this._width * pixelRatio\n    canvas.height = this._height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    ctx.drawImage(this._mainView.getImage(), 0, 0, this._width, this._height)\n\n    if (includeOverlay && this._overlayView) {\n      ctx.drawImage(this._overlayView.getImage(), 0, 0, this._width, this._height)\n    }\n    return canvas\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * requestAnimationFrame兼容\n * @param fn\n */\nexport function requestAnimationFrame (fn) {\n  if (!window.requestAnimationFrame) {\n    return window.setTimeout(fn, 20)\n  }\n  return window.requestAnimationFrame(fn)\n}\n\n/**\n * cancelAnimationFrame兼容\n * @param id\n */\nexport function cancelAnimationFrame (id) {\n  if (!window.cancelAnimationFrame) {\n    clearTimeout(id)\n  }\n  window.cancelAnimationFrame(id)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\nimport { cancelAnimationFrame, requestAnimationFrame } from '../utils/compatible'\n\nclass View {\n  constructor (container, chartData) {\n    this._chartData = chartData\n    this._initCanvas(container)\n  }\n\n  /**\n   * 初始化画布\n   * @param container\n   * @private\n   */\n  _initCanvas (container) {\n    this._canvas = document.createElement('canvas')\n    this._canvas.style.position = 'absolute'\n    this._canvas.style.top = '0'\n    this._canvas.style.left = '0'\n    this._canvas.style.zIndex = '2'\n    this._ctx = this._canvas.getContext('2d')\n    container.appendChild(this._canvas)\n  }\n\n  /**\n   * 重新绘制\n   * @param extendFun\n   * @private\n   */\n  _redraw (extendFun) {\n    this._ctx.clearRect(0, 0, this._canvas.offsetWidth, this._canvas.offsetHeight)\n    extendFun && extendFun()\n    this._draw()\n  }\n\n  /**\n   * 绘制\n   */\n  _draw () {\n  }\n\n  setWidth (width) {\n    this._width = width\n  }\n\n  setHeight (height) {\n    this._height = height\n  }\n\n  layout () {\n    if (this._height !== this._canvas.offsetHeight || this._width !== this._canvas.offsetWidth) {\n      this._redraw(() => {\n        const pixelRatio = getPixelRatio(this._canvas)\n        this._canvas.style.width = `${this._width}px`\n        this._canvas.style.height = `${this._height}px`\n        this._canvas.width = Math.floor(this._width * pixelRatio)\n        this._canvas.height = Math.floor(this._height * pixelRatio)\n        this._ctx.scale(pixelRatio, pixelRatio)\n      })\n    } else {\n      this.flush()\n    }\n  }\n\n  /**\n   * 刷新\n   */\n  flush () {\n    if (this.requestAnimationId) {\n      cancelAnimationFrame(this.requestAnimationId)\n      this.requestAnimationId = null\n    }\n    this.requestAnimationId = requestAnimationFrame(() => {\n      this._redraw()\n    })\n  }\n\n  /**\n   * 获取图片\n   * @returns {HTMLCanvasElement}\n   */\n  getImage () {\n    return this._canvas\n  }\n}\n\nexport default View\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\n\nimport { CandleType, LineStyle } from '../data/options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { renderHorizontalLine, renderVerticalLine, renderLine } from '../renderer/line'\nimport { isValid } from '../utils/typeChecks'\nimport { ActionType } from '../data/constants'\n\nexport default class TechnicalIndicatorView extends View {\n  constructor (container, chartData, xAxis, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    this._drawGrid()\n    this._drawTechnicalIndicators()\n  }\n\n  /**\n   * 绘制网格\n   * @private\n   */\n  _drawGrid () {\n    const gridOptions = this._chartData.styleOptions().grid\n    if (!gridOptions.show) {\n      return\n    }\n    const gridHorizontalOptions = gridOptions.horizontal\n    this._ctx.save()\n    if (gridHorizontalOptions.show) {\n      this._ctx.strokeStyle = gridHorizontalOptions.color\n      this._ctx.lineWidth = gridHorizontalOptions.size\n      if (gridHorizontalOptions.style === LineStyle.DASH) {\n        this._ctx.setLineDash(gridHorizontalOptions.dashValue)\n      } else {\n        this._ctx.setLineDash([])\n      }\n      this._yAxis.ticks().forEach(tick => {\n        renderHorizontalLine(this._ctx, tick.y, 0, this._width)\n      })\n    }\n\n    const gridVerticalOptions = gridOptions.vertical\n    if (gridVerticalOptions.show) {\n      this._ctx.strokeStyle = gridVerticalOptions.color\n      this._ctx.lineWidth = gridVerticalOptions.size\n      if (gridVerticalOptions.style === LineStyle.DASH) {\n        this._ctx.setLineDash(gridVerticalOptions.dashValue)\n      } else {\n        this._ctx.setLineDash([])\n      }\n      this._xAxis.ticks().forEach(tick => {\n        renderVerticalLine(this._ctx, tick.x, 0, this._height)\n      })\n    }\n    this._ctx.restore()\n  }\n\n  /**\n   * 绘制指标\n   * @private\n   */\n  _drawTechnicalIndicators () {\n    const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    technicalIndicators.forEach(technicalIndicator => {\n      const plots = technicalIndicator.plots\n      const lines = []\n      const dataList = this._chartData.dataList()\n      const technicalIndicatorResult = technicalIndicator.result\n      const styles = technicalIndicator.styles || technicalIndicatorOptions\n      // 技术指标自定义绘制\n      if (technicalIndicator.render) {\n        this._ctx.save()\n        technicalIndicator.render(\n          this._ctx,\n          {\n            from: this._chartData.from(),\n            to: this._chartData.to(),\n            kLineDataList: this._chartData.dataList(),\n            technicalIndicatorDataList: technicalIndicatorResult\n          },\n          {\n            width: this._width,\n            height: this._height,\n            dataSpace: this._chartData.dataSpace(),\n            barSpace: this._chartData.barSpace()\n          },\n          styles,\n          {\n            convertFromPixel: this._xAxis.convertFromPixel.bind(this._xAxis),\n            convertToPixel: this._xAxis.convertToPixel.bind(this._xAxis)\n          },\n          {\n            convertFromPixel: this._yAxis.convertFromPixel.bind(this._yAxis),\n            convertToPixel: this._yAxis.convertToPixel.bind(this._yAxis)\n          },\n          this._yAxis.isCandleYAxis()\n        )\n        this._ctx.restore()\n      }\n\n      let baseValue = technicalIndicator.baseValue\n      if (!isValid(baseValue)) {\n        baseValue = this._yAxis.min()\n      }\n      const baseValueY = this._yAxis.convertToPixel(baseValue)\n      const isCandleYAxis = this._yAxis.isCandleYAxis()\n\n      this._ctx.lineWidth = 1\n\n      this._drawGraphics(\n        (x, i, kLineData, halfBarSpace, barSpace) => {\n          const technicalIndicatorData = technicalIndicatorResult[i] || {}\n          let lineValueIndex = 0\n          if (technicalIndicator.shouldOhlc && !isCandleYAxis) {\n            this._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, styles.bar, CandleType.OHLC)\n          }\n          const coordinateY = {}\n          plots.forEach(plot => {\n            const value = technicalIndicatorData[plot.key]\n            const valueY = this._yAxis.convertToPixel(value)\n            coordinateY[plot.key] = valueY\n            switch (plot.type) {\n              case TechnicalIndicatorPlotType.CIRCLE: {\n                if (isValid(value)) {\n                  const cbData = {\n                    preData: { kLineData: dataList[i - 1], technicalIndicatorData: technicalIndicatorResult[i - 1] },\n                    currentData: { kLineData, technicalIndicatorData },\n                    nextData: { kLineData: dataList[i + 1], technicalIndicatorData: technicalIndicatorResult[i + 1] }\n                  }\n                  const circle = {\n                    x,\n                    y: valueY,\n                    radius: halfBarSpace,\n                    color: (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor,\n                    isStroke: plot.isStroke ? plot.isStroke(cbData) : true\n                  }\n                  this._drawCircle(circle)\n                }\n                break\n              }\n              case TechnicalIndicatorPlotType.BAR: {\n                if (isValid(value)) {\n                  const cbData = {\n                    preData: { kLineData: dataList[i - 1], technicalIndicatorData: technicalIndicatorResult[i - 1] },\n                    currentData: { kLineData, technicalIndicatorData },\n                    nextData: { kLineData: dataList[i + 1], technicalIndicatorData: technicalIndicatorResult[i + 1] }\n                  }\n                  const height = Math.abs(baseValueY - valueY)\n                  const bar = {\n                    x: x - halfBarSpace,\n                    width: halfBarSpace * 2,\n                    height: Math.max(1, height)\n                  }\n                  if (valueY > baseValueY) {\n                    bar.y = baseValueY\n                  } else {\n                    bar.y = height < 1 ? baseValueY - 1 : valueY\n                  }\n                  bar.color = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n                  bar.isStroke = plot.isStroke ? plot.isStroke(cbData) : false\n                  this._drawBar(bar)\n                }\n                break\n              }\n              case TechnicalIndicatorPlotType.LINE: {\n                let line = null\n                if (isValid(value)) {\n                  line = { x: x, y: valueY }\n                }\n                if (lines[lineValueIndex]) {\n                  lines[lineValueIndex].push(line)\n                } else {\n                  lines[lineValueIndex] = [line]\n                }\n                lineValueIndex++\n                break\n              }\n              default: { break }\n            }\n            this._drawActionExecute(ActionType.DRAW_TECHNICAL_INDICATOR, {\n              ctx: this._ctx,\n              kLineData,\n              dataIndex: i,\n              technicalIndicatorData,\n              technicalIndicatorName: technicalIndicator.name,\n              coordinate: { x, ...coordinateY },\n              viewport: { width: this._width, height: this._height },\n              barSpace,\n              halfBarSpace,\n              isCandle: isCandleYAxis\n            })\n          })\n        },\n        () => {\n          this._drawLines(lines, styles)\n        }\n      )\n    })\n  }\n\n  /**\n   * 绘制图形\n   * @param onDrawing\n   * @param onDrawEnd\n   * @private\n   */\n  _drawGraphics (onDrawing, onDrawEnd) {\n    const visibleDataList = this._chartData.visibleDataList()\n    const barSpace = this._chartData.barSpace()\n    const halfBarSpace = barSpace / 2\n    visibleDataList.forEach(({ x, index, data }, n) => {\n      onDrawing(x, index, data, halfBarSpace, barSpace, n)\n    })\n    onDrawEnd && onDrawEnd()\n  }\n\n  /**\n   * 绘制线\n   * @param lines\n   * @param technicalIndicatorOptions\n   */\n  _drawLines (lines, technicalIndicatorOptions) {\n    const colors = technicalIndicatorOptions.line.colors || []\n    const colorSize = colors.length\n    this._ctx.lineWidth = technicalIndicatorOptions.line.size\n    renderLine(this._ctx, () => {\n      lines.forEach((lineItem, i) => {\n        this._ctx.strokeStyle = colors[i % colorSize]\n        this._ctx.beginPath()\n        let isStart = true\n        lineItem.forEach(line => {\n          if (isValid(line)) {\n            if (isStart) {\n              this._ctx.moveTo(line.x, line.y)\n              isStart = false\n            } else {\n              this._ctx.lineTo(line.x, line.y)\n            }\n          }\n        })\n        this._ctx.stroke()\n        this._ctx.closePath()\n      })\n    })\n  }\n\n  /**\n   * 绘制柱\n   */\n  _drawBar (bar) {\n    if (bar.isStroke) {\n      this._ctx.strokeStyle = bar.color\n      this._ctx.strokeRect(bar.x + 0.5, bar.y, bar.width - 1, bar.height)\n    } else {\n      this._ctx.fillStyle = bar.color\n      this._ctx.fillRect(bar.x, bar.y, bar.width, bar.height)\n    }\n  }\n\n  /**\n   * 绘制圆点\n   * @param circle\n   * @private\n   */\n  _drawCircle (circle) {\n    this._ctx.strokeStyle = circle.color\n    this._ctx.fillStyle = circle.color\n    this._ctx.beginPath()\n    this._ctx.arc(circle.x, circle.y, circle.radius, Math.PI * 2, 0, true)\n    if (circle.isStroke) {\n      this._ctx.stroke()\n    } else {\n      this._ctx.fill()\n    }\n    this._ctx.closePath()\n  }\n\n  /**\n   * 绘制蜡烛柱\n   * @param x\n   * @param halfBarSpace\n   * @param barSpace\n   * @param dataIndex\n   * @param kLineData\n   * @param barOptions\n   * @param barStyle\n   * @private\n   */\n  _drawCandleBar (x, halfBarSpace, barSpace, dataIndex, kLineData, barOptions, barStyle) {\n    const { open, close, high, low } = kLineData\n    if (close > open) {\n      this._ctx.strokeStyle = barOptions.upColor\n      this._ctx.fillStyle = barOptions.upColor\n    } else if (close < open) {\n      this._ctx.strokeStyle = barOptions.downColor\n      this._ctx.fillStyle = barOptions.downColor\n    } else {\n      this._ctx.strokeStyle = barOptions.noChangeColor\n      this._ctx.fillStyle = barOptions.noChangeColor\n    }\n    const openY = this._yAxis.convertToPixel(open)\n    const closeY = this._yAxis.convertToPixel(close)\n    const highY = this._yAxis.convertToPixel(high)\n    const lowY = this._yAxis.convertToPixel(low)\n\n    const highEndY = Math.min(openY, closeY)\n    const lowStartY = Math.max(openY, closeY)\n    this._ctx.fillRect(x - 0.5, highY, 1, highEndY - highY)\n    this._ctx.fillRect(x - 0.5, lowStartY, 1, lowY - lowStartY)\n\n    const barHeight = Math.max(1, lowStartY - highEndY)\n    switch (barStyle) {\n      case CandleType.CANDLE_SOLID: {\n        this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        break\n      }\n      case CandleType.CANDLE_STROKE: {\n        this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        break\n      }\n      case CandleType.CANDLE_UP_STROKE: {\n        if (close > open) {\n          this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        } else {\n          this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        }\n        break\n      }\n      case CandleType.CANDLE_DOWN_STROKE: {\n        if (close > open) {\n          this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        } else {\n          this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        }\n        break\n      }\n      default: {\n        this._ctx.fillRect(x - 0.5, highY, 1, lowY - highY)\n        this._ctx.fillRect(x - halfBarSpace, openY - 0.5, halfBarSpace, 1)\n        this._ctx.fillRect(x, closeY - 0.5, halfBarSpace, 1)\n        break\n      }\n    }\n    this._drawActionExecute(ActionType.DRAW_CANDLE, {\n      ctx: this._ctx,\n      dataIndex,\n      kLineData,\n      coordinate: { x, open: openY, close: closeY, high: highY, low: lowY },\n      viewport: { width: this._width, height: this._height },\n      barSpace,\n      halfBarSpace,\n      isCandle: this._yAxis.isCandleYAxis()\n    })\n  }\n\n  /**\n   * 执行绘制事件监听\n   * @param type\n   * @param data\n   * @private\n   */\n  _drawActionExecute (type, data) {\n    this._chartData.actionExecute(\n      type,\n      data,\n      () => {\n        this._ctx.save()\n      },\n      () => {\n        this._ctx.restore()\n      }\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制文字\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param text\n */\nexport function renderText (ctx, color, x, y, text) {\n  ctx.fillStyle = color\n  ctx.fillText(text, x, y)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { TooltipShowRule, LineStyle } from '../data/options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { isValid } from '../utils/typeChecks'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { getTechnicalIndicatorTooltipData } from '../base/technicalindicator/technicalIndicatorControl'\nimport { renderText } from '../renderer/text'\n\nexport default class TechnicalIndicatorOverlayView extends View {\n  constructor (container, chartData, xAxis, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    this._drawCover()\n    const crosshair = this._chartData.crosshair()\n    if (crosshair.kLineData) {\n      const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n      const styleOptions = this._chartData.styleOptions()\n      const crosshairOptions = styleOptions.crosshair\n      if (crosshair.paneId === this._additionalDataProvider.id()) {\n        // 绘制十字光标水平线\n        this._drawCrosshairLine(crosshairOptions, 'horizontal', crosshair.y, 0, this._width, renderHorizontalLine)\n      }\n      if (crosshair.paneId) {\n        // 绘制十字光标垂直线\n        this._drawCrosshairLine(crosshairOptions, 'vertical', crosshair.realX, 0, this._height, renderVerticalLine)\n      }\n      this._drawTooltip(crosshair, technicalIndicators)\n    }\n  }\n\n  /**\n   * 绘制覆盖物\n   * @private\n   */\n  _drawCover () {}\n\n  /**\n   * 绘制图例\n   * @param crosshair\n   * @param technicalIndicators\n   * @private\n   */\n  _drawTooltip (crosshair, technicalIndicators) {\n    const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n    this._drawBatchTechnicalIndicatorToolTip(\n      crosshair,\n      technicalIndicators,\n      technicalIndicatorOptions,\n      0,\n      this._shouldDrawTooltip(crosshair, technicalIndicatorOptions.tooltip)\n    )\n  }\n\n  /**\n   * 绘制十字光标线\n   * @param crosshairOptions\n   * @param optionsKey\n   * @param fixedCoordinate\n   * @param startCoordinate\n   * @param endCoordinate\n   * @param drawLine\n   * @private\n   */\n  _drawCrosshairLine (crosshairOptions, optionsKey, fixedCoordinate, startCoordinate, endCoordinate, drawLine) {\n    const crosshairDirectionOptions = crosshairOptions[optionsKey]\n    const crosshairLineOptions = crosshairDirectionOptions.line\n    if (!crosshairOptions.show || !crosshairDirectionOptions.show || !crosshairLineOptions.show) {\n      return\n    }\n    this._ctx.save()\n    this._ctx.lineWidth = crosshairLineOptions.size\n    this._ctx.strokeStyle = crosshairLineOptions.color\n\n    if (crosshairLineOptions.style === LineStyle.DASH) {\n      this._ctx.setLineDash(crosshairLineOptions.dashValue)\n    }\n    drawLine(this._ctx, fixedCoordinate, startCoordinate, endCoordinate)\n    this._ctx.restore()\n  }\n\n  /**\n   * 批量绘制技术指标提示\n   * @param crosshair\n   * @param technicalIndicators\n   * @param technicalIndicatorOptions\n   * @param offsetTop\n   * @param isDrawTechnicalIndicatorTooltip\n   * @private\n   */\n  _drawBatchTechnicalIndicatorToolTip (crosshair, technicalIndicators, technicalIndicatorOptions, offsetTop = 0, isDrawTechnicalIndicatorTooltip) {\n    if (!isDrawTechnicalIndicatorTooltip) {\n      return\n    }\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n    let top = offsetTop\n    technicalIndicators.forEach(technicalIndicator => {\n      this._drawTechnicalIndicatorTooltip(crosshair, technicalIndicator, technicalIndicatorOptions, top)\n      top += (\n        technicalIndicatorTooltipOptions.text.marginTop +\n        technicalIndicatorTooltipOptions.text.size +\n        technicalIndicatorTooltipOptions.text.marginBottom\n      )\n    })\n  }\n\n  /**\n   * 绘制指标图例\n   * @param crosshair\n   * @param technicalIndicator\n   * @param technicalIndicatorOptions\n   * @param offsetTop\n   * @private\n   */\n  _drawTechnicalIndicatorTooltip (crosshair, technicalIndicator, technicalIndicatorOptions, offsetTop = 0) {\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n    const styles = technicalIndicator.styles || technicalIndicatorOptions\n    const technicalIndicatorResult = technicalIndicator.result\n    const technicalIndicatorData = technicalIndicatorResult[crosshair.dataIndex]\n    const tooltipData = getTechnicalIndicatorTooltipData(technicalIndicatorData, technicalIndicator)\n    const colors = styles.line.colors\n    const dataList = this._chartData.dataList()\n    const cbData = {\n      preData: { kLineData: dataList[crosshair.dataIndex - 1], technicalIndicatorData: technicalIndicatorResult[crosshair.dataIndex - 1] },\n      currentData: { kLineData: dataList[crosshair.dataIndex], technicalIndicatorData },\n      nextData: { kLineData: dataList[crosshair.dataIndex + 1], technicalIndicatorData: technicalIndicatorResult[crosshair.dataIndex + 1] }\n    }\n    const plots = technicalIndicator.plots\n    const technicalIndicatorTooltipTextOptions = technicalIndicatorTooltipOptions.text\n    const values = tooltipData.values\n    const textMarginLeft = technicalIndicatorTooltipTextOptions.marginLeft\n    const textMarginRight = technicalIndicatorTooltipTextOptions.marginRight\n    let labelX = 0\n    const labelY = technicalIndicatorTooltipTextOptions.marginTop + offsetTop\n    const textSize = technicalIndicatorTooltipTextOptions.size\n    const textColor = technicalIndicatorTooltipTextOptions.color\n    const colorSize = colors.length\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(textSize, technicalIndicatorTooltipTextOptions.weight, technicalIndicatorTooltipTextOptions.family)\n\n    if (technicalIndicatorTooltipOptions.showName) {\n      const nameText = tooltipData.name\n      const nameTextWidth = calcTextWidth(this._ctx, nameText)\n      labelX += textMarginLeft\n      renderText(this._ctx, textColor, labelX, labelY, nameText)\n      labelX += nameTextWidth\n      if (!technicalIndicatorTooltipOptions.showParams) {\n        labelX += textMarginRight\n      }\n    }\n    if (technicalIndicatorTooltipOptions.showParams) {\n      const calcParamText = tooltipData.calcParamText\n      const calcParamTextWidth = calcTextWidth(this._ctx, calcParamText)\n      if (!technicalIndicatorTooltipOptions.showName) {\n        labelX += textMarginLeft\n      }\n      renderText(this._ctx, textColor, labelX, labelY, calcParamText)\n      labelX += (calcParamTextWidth + textMarginRight)\n    }\n    let lineCount = 0\n    let valueColor\n    plots.forEach((plot, i) => {\n      switch (plot.type) {\n        case TechnicalIndicatorPlotType.CIRCLE: {\n          valueColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n          break\n        }\n        case TechnicalIndicatorPlotType.BAR: {\n          valueColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n          break\n        }\n        case TechnicalIndicatorPlotType.LINE: {\n          valueColor = colors[lineCount % colorSize] || textColor\n          lineCount++\n          break\n        }\n        default: { break }\n      }\n      const title = values[i].title\n      if (isValid(title)) {\n        labelX += textMarginLeft\n        const text = `${title}${values[i].value || technicalIndicatorTooltipOptions.defaultValue}`\n        const textWidth = calcTextWidth(this._ctx, text)\n        renderText(this._ctx, valueColor, labelX, labelY, text)\n        labelX += (textWidth + textMarginRight)\n      }\n    })\n  }\n\n  /**\n   * 是否需要绘制图例\n   * @param crosshair\n   * @param tooltipOptions\n   * @return {boolean|boolean|*}\n   * @private\n   */\n  _shouldDrawTooltip (crosshair, tooltipOptions) {\n    const showRule = tooltipOptions.showRule\n    return showRule === TooltipShowRule.ALWAYS ||\n      (showRule === TooltipShowRule.FOLLOW_CROSS && (!!crosshair.paneId))\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport TechnicalIndicatorView from '../view/TechnicalIndicatorView'\nimport TechnicalIndicatorOverlayView from '../view/TechnicalIndicatorOverlayView'\n\nexport default class TechnicalIndicatorWidget extends Widget {\n  _createMainView (container, props) {\n    return new TechnicalIndicatorView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n\n  _createOverlayView (container, props) {\n    return new TechnicalIndicatorOverlayView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制带边框的圆角填充矩形\n * @param ctx\n * @param fillColor\n * @param borderColor\n * @param borderSize\n * @param x\n * @param y\n * @param width\n * @param height\n * @param borderRadius\n */\nexport function renderStrokeFillRoundRect (\n  ctx, fillColor, borderColor, borderSize,\n  x, y, width, height, borderRadius\n) {\n  renderFillRoundRect(ctx, fillColor, x, y, width, height, borderRadius)\n  renderStrokeRoundRect(ctx, borderColor, borderSize, x, y, width, height, borderRadius)\n}\n\n/**\n * 绘制填充的矩形\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param width\n * @param height\n */\nexport function renderFillRect (ctx, color, x, y, width, height) {\n  ctx.fillStyle = color\n  ctx.fillRect(x, y, width, height)\n}\n\n/**\n * 绘制圆角空心矩形\n * @param ctx\n * @param borderColor\n * @param borderSize\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderStrokeRoundRect (ctx, borderColor, borderSize, x, y, w, h, r) {\n  ctx.lineWidth = borderSize\n  ctx.strokeStyle = borderColor\n  renderRoundRect(ctx, x, y, w, h, r)\n  ctx.stroke()\n}\n\n/**\n * 绘制填充圆角矩形\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderFillRoundRect (ctx, color, x, y, w, h, r) {\n  ctx.fillStyle = color\n  renderRoundRect(ctx, x, y, w, h, r)\n  ctx.fill()\n}\n\n/**\n * 绘制圆角矩形\n * @param ctx\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderRoundRect (ctx, x, y, w, h, r) {\n  ctx.beginPath()\n  ctx.moveTo(x + r, y)\n  ctx.arcTo(x + w, y, x + w, y + h, r)\n  ctx.arcTo(x + w, y + h, x, y + h, r)\n  ctx.arcTo(x, y + h, x, y, r)\n  ctx.arcTo(x, y, x + w, y, r)\n  ctx.closePath()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { YAxisType } from '../data/options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { isValid } from '../utils/typeChecks'\nimport { renderFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class YAxisView extends View {\n  constructor (container, chartData, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    const yAxisOptions = this._chartData.styleOptions().yAxis\n    if (yAxisOptions.show) {\n      this._drawAxisLine(yAxisOptions)\n      this._drawTickLines(yAxisOptions)\n      this._drawTickLabels(yAxisOptions)\n      this._drawTechnicalIndicatorLastValue(yAxisOptions)\n      this._drawLastPriceLabel(yAxisOptions)\n    }\n  }\n\n  _drawAxisLine (yAxisOptions) {\n    const axisLine = yAxisOptions.axisLine\n    if (!axisLine.show) {\n      return\n    }\n    this._ctx.strokeStyle = axisLine.color\n    this._ctx.lineWidth = axisLine.size\n    let x\n    if (this._yAxis.isFromYAxisZero()) {\n      x = 0\n    } else {\n      x = this._width - 1\n    }\n    renderVerticalLine(this._ctx, x, 0, this._height)\n  }\n\n  _drawTickLines (yAxisOptions) {\n    const tickLine = yAxisOptions.tickLine\n    if (!tickLine.show) {\n      return\n    }\n    this._ctx.lineWidth = tickLine.size\n    this._ctx.strokeStyle = tickLine.color\n\n    const tickLineLength = tickLine.length\n\n    let startX\n    let endX\n    if (this._yAxis.isFromYAxisZero()) {\n      startX = 0\n      if (yAxisOptions.axisLine.show) {\n        startX += yAxisOptions.axisLine.size\n      }\n      endX = startX + tickLineLength\n    } else {\n      startX = this._width\n      if (yAxisOptions.axisLine.show) {\n        startX -= yAxisOptions.axisLine.size\n      }\n      endX = startX - tickLineLength\n    }\n    this._yAxis.ticks().forEach(tick => {\n      renderHorizontalLine(this._ctx, tick.y, startX, endX)\n    })\n  }\n\n  _drawTickLabels (yAxisOptions) {\n    const tickText = yAxisOptions.tickText\n    if (!tickText.show) {\n      return\n    }\n    const tickLine = yAxisOptions.tickLine\n    const tickLineShow = tickLine.show\n    const tickLineLength = tickLine.length\n    let labelX\n    if (this._yAxis.isFromYAxisZero()) {\n      labelX = tickText.paddingLeft\n      if (yAxisOptions.axisLine.show) {\n        labelX += yAxisOptions.axisLine.size\n      }\n      if (tickLineShow) {\n        labelX += tickLineLength\n      }\n      this._ctx.textAlign = 'left'\n    } else {\n      labelX = this._width - tickText.paddingRight\n      if (yAxisOptions.axisLine.show) {\n        labelX -= yAxisOptions.axisLine.size\n      }\n      if (tickLineShow) {\n        labelX -= tickLineLength\n      }\n      this._ctx.textAlign = 'right'\n    }\n    this._ctx.textBaseline = 'middle'\n    this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family)\n    this._ctx.fillStyle = tickText.color\n    this._yAxis.ticks().forEach(tick => {\n      this._ctx.fillText(tick.v, labelX, tick.y)\n    })\n    this._ctx.textAlign = 'left'\n  }\n\n  /**\n   * 绘制技术指标最后值\n   * @param yAxisOptions\n   * @private\n   */\n  _drawTechnicalIndicatorLastValue (yAxisOptions) {\n    const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n    const lastValueMarkOptions = technicalIndicatorOptions.lastValueMark\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    if (!lastValueMarkOptions.show || !lastValueMarkOptions.text.show) {\n      return\n    }\n    const dataList = this._chartData.dataList()\n    technicalIndicators.forEach(technicalIndicator => {\n      const technicalIndicatorResult = technicalIndicator.result || []\n      const dataSize = technicalIndicatorResult.length\n      const technicalIndicatorData = technicalIndicatorResult[dataSize - 1] || {}\n      const plots = technicalIndicator.plots\n      const cbData = {\n        preData: { kLineData: dataList[dataSize - 2], technicalIndicatorData: technicalIndicatorResult[dataSize - 2] },\n        currentData: { kLineData: dataList[dataSize - 1], technicalIndicatorData },\n        nextData: { kLineData: null, technicalIndicatorData: null }\n      }\n      const precision = technicalIndicator.precision\n      const styles = technicalIndicator.styles || technicalIndicatorOptions\n      const colors = styles.line.colors || []\n      const colorSize = colors.length\n      let lineCount = 0\n      plots.forEach(plot => {\n        const value = technicalIndicatorData[plot.key]\n        let backgroundColor\n        switch (plot.type) {\n          case TechnicalIndicatorPlotType.CIRCLE: {\n            backgroundColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n            break\n          }\n          case TechnicalIndicatorPlotType.BAR: {\n            backgroundColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n            break\n          }\n          case TechnicalIndicatorPlotType.LINE: {\n            backgroundColor = colors[lineCount % colorSize]\n            lineCount++\n            break\n          }\n          default: { break }\n        }\n        if (isValid(value)) {\n          this._drawMarkLabel(\n            yAxisOptions, value, precision, technicalIndicator.shouldFormatBigNumber,\n            {\n              ...lastValueMarkOptions.text, backgroundColor\n            }\n          )\n        }\n      })\n    })\n  }\n\n  /**\n   * 绘制最新价文字\n   * @private\n   */\n  _drawLastPriceLabel (yAxisOptions) {\n    if (!this._yAxis.isCandleYAxis()) {\n      return\n    }\n    const priceMarkOptions = this._chartData.styleOptions().candle.priceMark\n    const lastPriceMarkOptions = priceMarkOptions.last\n    if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.text.show) {\n      return\n    }\n    const dataList = this._chartData.dataList()\n    const kLineData = dataList[dataList.length - 1]\n    if (!kLineData) {\n      return\n    }\n    const close = kLineData.close\n    const open = kLineData.open\n    let backgroundColor\n    if (close > open) {\n      backgroundColor = lastPriceMarkOptions.upColor\n    } else if (close < open) {\n      backgroundColor = lastPriceMarkOptions.downColor\n    } else {\n      backgroundColor = lastPriceMarkOptions.noChangeColor\n    }\n    this._drawMarkLabel(\n      yAxisOptions, close, this._chartData.pricePrecision(), false,\n      {\n        ...lastPriceMarkOptions.text, backgroundColor\n      }\n    )\n  }\n\n  /**\n   * 绘制标记label\n   * @param yAxisOptions\n   * @param value\n   * @param precision\n   * @param shouldFormatBigNumber\n   * @param size\n   * @param weight\n   * @param family\n   * @param color\n   * @param backgroundColor\n   * @param borderRadius\n   * @param paddingLeft\n   * @param paddingTop\n   * @param paddingRight\n   * @param paddingBottom\n   * @private\n   */\n  _drawMarkLabel (\n    yAxisOptions, value, precision, shouldFormatBigNumber,\n    {\n      size, weight, family, color, backgroundColor, borderRadius,\n      paddingLeft, paddingTop, paddingRight, paddingBottom\n    }\n  ) {\n    const valueY = this._yAxis.convertToNicePixel(value)\n    let text\n    if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n      const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n      const fromClose = fromData.close\n      text = `${((value - fromClose) / fromClose * 100).toFixed(2)}%`\n    } else {\n      text = formatPrecision(value, precision)\n      if (shouldFormatBigNumber) {\n        text = formatBigNumber(text)\n      }\n    }\n    this._ctx.font = createFont(size, weight, family)\n    const rectWidth = calcTextWidth(this._ctx, text) + paddingLeft + paddingRight\n    const rectHeight = paddingTop + size + paddingBottom\n    let rectStartX\n    if (this._yAxis.isFromYAxisZero()) {\n      rectStartX = 0\n    } else {\n      rectStartX = this._width - rectWidth\n    }\n    renderFillRoundRect(\n      this._ctx, backgroundColor,\n      rectStartX, valueY - paddingTop - size / 2, rectWidth, rectHeight, borderRadius\n    )\n    this._ctx.textBaseline = 'middle'\n    renderText(this._ctx, color, rectStartX + paddingLeft, valueY, text)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { YAxisType } from '../data/options/styleOptions'\nimport { renderStrokeFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class YAxisOverlayView extends View {\n  constructor (container, chartData, yAxis, additionalDataProvider) {\n    super(container, chartData)\n    this._yAxis = yAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _draw () {\n    this._ctx.textBaseline = 'middle'\n    if (this._yAxis.isCandleYAxis()) {\n      // 绘制标签\n      const tags = this._chartData.tags()\n      tags.forEach(tag => {\n        tag.drawText(this._ctx)\n      })\n    }\n    this._drawCrossHairLabel()\n  }\n\n  _drawCrossHairLabel () {\n    const crosshair = this._chartData.crosshair()\n    if (crosshair.paneId !== this._additionalDataProvider.id() || this._chartData.dataList().length === 0) {\n      return\n    }\n    const styleOptions = this._chartData.styleOptions()\n    const crosshairOptions = styleOptions.crosshair\n    const crosshairHorizontalOptions = crosshairOptions.horizontal\n    const crosshairHorizontalTextOptions = crosshairHorizontalOptions.text\n    if (!crosshairOptions.show || !crosshairHorizontalOptions.show || !crosshairHorizontalTextOptions.show) {\n      return\n    }\n    const value = this._yAxis.convertFromPixel(crosshair.y)\n    let text\n    if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n      const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n      text = `${((value - fromData.close) / fromData.close * 100).toFixed(2)}%`\n    } else {\n      const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n      let precision = 0\n      let shouldFormatBigNumber = false\n      if (this._yAxis.isCandleYAxis()) {\n        precision = this._chartData.pricePrecision()\n      } else {\n        technicalIndicators.forEach(technicalIndicator => {\n          precision = Math.max(technicalIndicator.precision, precision)\n          if (!shouldFormatBigNumber) {\n            shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n          }\n        })\n      }\n      text = formatPrecision(value, precision)\n      if (shouldFormatBigNumber) {\n        text = formatBigNumber(text)\n      }\n    }\n    const textSize = crosshairHorizontalTextOptions.size\n    this._ctx.font = createFont(textSize, crosshairHorizontalTextOptions.weight, crosshairHorizontalTextOptions.family)\n    const yAxisDataLabelWidth = calcTextWidth(this._ctx, text)\n    let rectStartX\n\n    const paddingLeft = crosshairHorizontalTextOptions.paddingLeft\n    const paddingRight = crosshairHorizontalTextOptions.paddingRight\n    const paddingTop = crosshairHorizontalTextOptions.paddingTop\n    const paddingBottom = crosshairHorizontalTextOptions.paddingBottom\n    const borderSize = crosshairHorizontalTextOptions.borderSize\n\n    const rectWidth = yAxisDataLabelWidth + borderSize * 2 + paddingLeft + paddingRight\n    const rectHeight = textSize + borderSize * 2 + paddingTop + paddingBottom\n    if (this._yAxis.isFromYAxisZero()) {\n      rectStartX = 0\n    } else {\n      rectStartX = this._width - rectWidth\n    }\n\n    const rectY = crosshair.y - borderSize - paddingTop - textSize / 2\n    // 绘制y轴文字外的边框\n    renderStrokeFillRoundRect(\n      this._ctx, crosshairHorizontalTextOptions.backgroundColor,\n      crosshairHorizontalTextOptions.borderColor, borderSize,\n      rectStartX, rectY, rectWidth, rectHeight, crosshairHorizontalTextOptions.borderRadius\n    )\n    renderText(\n      this._ctx,\n      crosshairHorizontalTextOptions.color,\n      rectStartX + borderSize + paddingLeft,\n      crosshair.y,\n      text\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport YAxisView from '../view/YAxisView'\nimport YAxisOverlayView from '../view/YAxisOverlayView'\n\nexport default class YAxisWidget extends Widget {\n  _createMainView (container, props) {\n    return new YAxisView(container, props.chartData, props.yAxis, props.additionalDataProvider)\n  }\n\n  _createOverlayView (container, props) {\n    return new YAxisOverlayView(container, props.chartData, props.yAxis, props.additionalDataProvider)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\nimport { getPrecision, nice, round } from '../utils/number'\n\nexport default class Axis {\n  constructor (chartData) {\n    this._chartData = chartData\n    this._width = 0\n    this._height = 0\n    this._cacheMinValue = 0\n    this._cacheMaxValue = 0\n    this._minValue = 0\n    this._maxValue = 0\n    this._range = 0\n    this._ticks = []\n    this._initMeasureCanvas()\n  }\n\n  _initMeasureCanvas () {\n    const measureCanvas = document.createElement('canvas')\n    const pixelRatio = getPixelRatio(measureCanvas)\n    this._measureCtx = measureCanvas.getContext('2d')\n    this._measureCtx.scale(pixelRatio, pixelRatio)\n  }\n\n  min () {\n    return this._minValue\n  }\n\n  max () {\n    return this._maxValue\n  }\n\n  width () {\n    return this._width\n  }\n\n  height () {\n    return this._height\n  }\n\n  setWidth (width) {\n    this._width = width\n  }\n\n  setHeight (height) {\n    this._height = height\n  }\n\n  /**\n   * 获取ticks\n   * @returns {[]|*[]}\n   */\n  ticks () {\n    return this._ticks\n  }\n\n  /**\n   * 计算轴\n   * @param forceCompute\n   */\n  computeAxis (forceCompute) {\n    const minMax = this._optimalMinMax(this._computeMinMax())\n    this._minValue = minMax.min\n    this._maxValue = minMax.max\n    this._range = minMax.range\n    if (this._cacheMinValue !== minMax.min || this._cacheMaxValue !== minMax.max || forceCompute) {\n      this._cacheMinValue = minMax.min\n      this._cacheMaxValue = minMax.max\n      this._ticks = this._optimalTicks(this._computeTicks())\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 计算最大最小值\n   * @private\n   */\n  _computeMinMax () {}\n\n  /**\n   * 优化最大最小值\n   * @param min\n   * @param max\n   * @param precision\n   * @private\n   */\n  _optimalMinMax ({ min, max, precision }) {}\n\n  /**\n   * 计算轴上的tick值\n   */\n  _computeTicks () {\n    const ticks = []\n    if (this._range >= 0) {\n      const intervalPrecision = this._computeInterval(this._range)\n      const interval = intervalPrecision.interval\n      const precision = intervalPrecision.precision\n      const first = round(Math.ceil(this._minValue / interval) * interval, precision)\n      const last = round(Math.floor(this._maxValue / interval) * interval, precision)\n      let n = 0\n      let f = first\n\n      if (interval !== 0) {\n        while (f <= last) {\n          ticks[n] = { v: f.toFixed(precision) }\n          ++n\n          f += interval\n        }\n      }\n    }\n    return ticks\n  }\n\n  /**\n   * 计算最佳的tick\n   * @param ticks\n   */\n  _optimalTicks (ticks) {}\n\n  /**\n   * 计算间隔\n   * @private\n   */\n  _computeInterval (range) {\n    const interval = nice(range / 8.0)\n    const precision = getPrecision(interval)\n    return {\n      interval, precision\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Axis from './Axis'\nimport { CandleType, YAxisPosition, YAxisType } from '../data/options/styleOptions'\nimport { isNumber, isValid } from '../utils/typeChecks'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { round, log10, index10 } from '../utils/number'\n\nexport default class YAxis extends Axis {\n  constructor (chartData, isCandleYAxis, additionalDataProvider) {\n    super(chartData)\n    this._realRange = 0\n    this._isCandleYAxis = isCandleYAxis\n    this._additionalDataProvider = additionalDataProvider\n  }\n\n  _computeMinMax () {\n    const minMaxArray = [Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER]\n    const plotsResult = []\n    let shouldOhlc = false\n    let minValue = Number.MAX_SAFE_INTEGER\n    let maxValue = Number.MIN_SAFE_INTEGER\n    let technicalIndicatorPrecision = Number.MAX_SAFE_INTEGER\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    technicalIndicators.forEach(tech => {\n      if (!shouldOhlc) {\n        shouldOhlc = tech.shouldOhlc\n      }\n      technicalIndicatorPrecision = Math.min(technicalIndicatorPrecision, tech.precision)\n      if (isNumber(tech.minValue)) {\n        minValue = Math.min(minValue, tech.minValue)\n      }\n      if (isNumber(tech.maxValue)) {\n        maxValue = Math.max(maxValue, tech.maxValue)\n      }\n      plotsResult.push({\n        plots: tech.plots,\n        result: tech.result\n      })\n    })\n\n    let precision = 4\n    if (this._isCandleYAxis) {\n      const pricePrecision = this._chartData.pricePrecision()\n      if (technicalIndicatorPrecision !== Number.MAX_SAFE_INTEGER) {\n        precision = Math.min(technicalIndicatorPrecision, pricePrecision)\n      } else {\n        precision = pricePrecision\n      }\n    } else {\n      if (technicalIndicatorPrecision !== Number.MAX_SAFE_INTEGER) {\n        precision = technicalIndicatorPrecision\n      }\n    }\n    const visibleDataList = this._chartData.visibleDataList()\n    const candleOptions = this._chartData.styleOptions().candle\n    const isArea = candleOptions.type === CandleType.AREA\n    const areaValueKey = candleOptions.area.value\n    const shouldCompareHighLow = (this._isCandleYAxis && !isArea) || (!this._isCandleYAxis && shouldOhlc)\n    visibleDataList.forEach(({ index, data }) => {\n      if (shouldCompareHighLow) {\n        minMaxArray[0] = Math.min(minMaxArray[0], data.low)\n        minMaxArray[1] = Math.max(minMaxArray[1], data.high)\n      }\n      if (this._isCandleYAxis && isArea) {\n        minMaxArray[0] = Math.min(minMaxArray[0], data[areaValueKey])\n        minMaxArray[1] = Math.max(minMaxArray[1], data[areaValueKey])\n      }\n      plotsResult.forEach(({ plots, result }) => {\n        const technicalIndicatorData = result[index] || {}\n        plots.forEach(plot => {\n          const value = technicalIndicatorData[plot.key]\n          if (isValid(value)) {\n            minMaxArray[0] = Math.min(minMaxArray[0], value)\n            minMaxArray[1] = Math.max(minMaxArray[1], value)\n          }\n        })\n      })\n    })\n    if (minMaxArray[0] !== Number.MAX_SAFE_INTEGER && minMaxArray[1] !== Number.MIN_SAFE_INTEGER) {\n      minMaxArray[0] = Math.min(minValue, minMaxArray[0])\n      minMaxArray[1] = Math.max(maxValue, minMaxArray[1])\n    } else {\n      minMaxArray[0] = 0\n      minMaxArray[1] = 10\n    }\n    return { min: minMaxArray[0], max: minMaxArray[1], precision, specifyMin: minValue, specifyMax: maxValue }\n  }\n\n  _optimalMinMax ({ min, max, precision, specifyMin, specifyMax }) {\n    let minValue = min\n    let maxValue = max\n    const yAxisType = this.yAxisType()\n    let dif\n    switch (yAxisType) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          minValue = (minValue - fromData.close) / fromData.close * 100\n          maxValue = (maxValue - fromData.close) / fromData.close * 100\n        }\n        dif = Math.pow(10, -2)\n        break\n      }\n      case YAxisType.LOG: {\n        minValue = log10(minValue)\n        maxValue = log10(maxValue)\n        dif = 0.05 * index10(-precision)\n        break\n      }\n      default: {\n        dif = index10(-precision)\n      }\n    }\n    if (\n      minValue === maxValue ||\n      Math.abs(minValue - maxValue) < dif\n    ) {\n      const minCheck = specifyMin === minValue\n      const maxCheck = specifyMax === maxValue\n      minValue = minCheck ? minValue : (maxCheck ? minValue - 8 * dif : minValue - 4 * dif)\n      maxValue = maxCheck ? maxValue : (minCheck ? maxValue + 8 * dif : maxValue + 4 * dif)\n    }\n    let marginOptions\n    if (this._isCandleYAxis) {\n      marginOptions = this._chartData.styleOptions().candle.margin\n    } else {\n      marginOptions = this._chartData.styleOptions().technicalIndicator.margin\n    }\n    let topRate\n    let bottomRate\n    if (marginOptions.top > 1) {\n      topRate = marginOptions.top / this._height\n    } else {\n      topRate = isNumber(marginOptions.top) ? marginOptions.top : 0.2\n    }\n    if (marginOptions.bottom > 1) {\n      bottomRate = marginOptions.bottom / this._height\n    } else {\n      bottomRate = isNumber(marginOptions.bottom) ? marginOptions.bottom : 0.1\n    }\n    let range = Math.abs(maxValue - minValue)\n    // 保证每次图形绘制上下都留间隙\n    minValue = minValue - range * bottomRate\n    maxValue = maxValue + range * topRate\n\n    range = Math.abs(maxValue - minValue)\n    if (yAxisType === YAxisType.LOG) {\n      this._realRange = Math.abs(index10(maxValue) - index10(minValue))\n    } else {\n      this._realRange = range\n    }\n    return {\n      min: minValue,\n      max: maxValue,\n      range\n    }\n  }\n\n  _optimalTicks (ticks) {\n    const optimalTicks = []\n    const yAxisType = this.yAxisType()\n    const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n    let precision = 0\n    let shouldFormatBigNumber = false\n    if (this._isCandleYAxis) {\n      precision = this._chartData.pricePrecision()\n    } else {\n      technicalIndicators.forEach(technicalIndicator => {\n        precision = Math.max(precision, technicalIndicator.precision)\n        if (!shouldFormatBigNumber) {\n          shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n        }\n      })\n    }\n    const textHeight = this._chartData.styleOptions().xAxis.tickText.size\n    let intervalPrecision\n    if (yAxisType === YAxisType.LOG) {\n      intervalPrecision = this._computeInterval(this._realRange)\n    }\n    let validY\n    ticks.forEach(({ v }) => {\n      let value\n      let y = this._innerConvertToPixel(+v)\n      switch (yAxisType) {\n        case YAxisType.PERCENTAGE: {\n          value = `${formatPrecision(v, 2)}%`\n          break\n        }\n        case YAxisType.LOG: {\n          value = round(index10(v), intervalPrecision.precision)\n          y = this._innerConvertToPixel(log10(value))\n          value = formatPrecision(value, precision)\n          break\n        }\n        default: {\n          value = formatPrecision(v, precision)\n          if (shouldFormatBigNumber) {\n            value = formatBigNumber(value)\n          }\n          break\n        }\n      }\n      if (y > textHeight && y < this._height - textHeight && ((validY && (validY - y > textHeight * 2)) || !validY)) {\n        optimalTicks.push({ v: value, y })\n        validY = y\n      }\n    })\n    return optimalTicks\n  }\n\n  /**\n   * 内部值转换成坐标\n   * @param value\n   * @return {number}\n   * @private\n   */\n  _innerConvertToPixel (value) {\n    return Math.round((1.0 - (value - this._minValue) / this._range) * this._height)\n  }\n\n  /**\n   * 是否是蜡烛图轴\n   * @return {*}\n   */\n  isCandleYAxis () {\n    return this._isCandleYAxis\n  }\n\n  /**\n   * y轴类型\n   * @return {string|*}\n   */\n  yAxisType () {\n    if (this._isCandleYAxis) {\n      return this._chartData.styleOptions().yAxis.type\n    }\n    return YAxisType.NORMAL\n  }\n\n  /**\n   * 是否从y轴0开始\n   * @return {boolean|*|boolean}\n   */\n  isFromYAxisZero () {\n    const yAxisOptions = this._chartData.styleOptions().yAxis\n    return (\n      (yAxisOptions.position === YAxisPosition.LEFT && yAxisOptions.inside) ||\n      (yAxisOptions.position === YAxisPosition.RIGHT && !yAxisOptions.inside)\n    )\n  }\n\n  /**\n   * 获取自身宽度\n   * @return {number}\n   */\n  getSelfWidth () {\n    const styleOptions = this._chartData.styleOptions()\n    const yAxisOptions = styleOptions.yAxis\n    const width = yAxisOptions.width\n    if (isNumber(width)) {\n      return width\n    }\n    let yAxisWidth = 0\n    if (yAxisOptions.show) {\n      if (yAxisOptions.axisLine.show) {\n        yAxisWidth += yAxisOptions.axisLine.size\n      }\n      if (yAxisOptions.tickLine.show) {\n        yAxisWidth += yAxisOptions.tickLine.length\n      }\n      if (yAxisOptions.tickText.show) {\n        let textWidth = 0\n        this._measureCtx.font = createFont(yAxisOptions.tickText.size, yAxisOptions.tickText.weight, yAxisOptions.tickText.family)\n        this._ticks.forEach(tick => {\n          textWidth = Math.max(textWidth, calcTextWidth(this._measureCtx, tick.v))\n        })\n        yAxisWidth += (yAxisOptions.tickText.paddingLeft + yAxisOptions.tickText.paddingRight + textWidth)\n      }\n    }\n    const crosshairOptions = styleOptions.crosshair\n    let crosshairVerticalTextWidth = 0\n    if (\n      crosshairOptions.show &&\n      crosshairOptions.horizontal.show &&\n      crosshairOptions.horizontal.text.show\n    ) {\n      const technicalIndicators = this._additionalDataProvider.technicalIndicators()\n      let technicalIndicatorPrecision = 0\n      let shouldFormatBigNumber = false\n      technicalIndicators.forEach(technicalIndicator => {\n        technicalIndicatorPrecision = Math.max(technicalIndicator.precision, technicalIndicatorPrecision)\n        if (!shouldFormatBigNumber) {\n          shouldFormatBigNumber = technicalIndicator.shouldFormatBigNumber\n        }\n      })\n      this._measureCtx.font = createFont(\n        crosshairOptions.horizontal.text.size,\n        crosshairOptions.horizontal.text.weight,\n        crosshairOptions.horizontal.text.family\n      )\n      let precision = 2\n      if (this.yAxisType() !== YAxisType.PERCENTAGE) {\n        if (this._isCandleYAxis) {\n          const pricePrecision = this._chartData.pricePrecision()\n          const lastValueMarkOptions = styleOptions.technicalIndicator.lastValueMark\n          if (lastValueMarkOptions.show && lastValueMarkOptions.text.show) {\n            precision = Math.max(technicalIndicatorPrecision, pricePrecision)\n          } else {\n            precision = pricePrecision\n          }\n        } else {\n          precision = technicalIndicatorPrecision\n        }\n      }\n      let valueText = formatPrecision(this._maxValue, precision)\n      if (shouldFormatBigNumber) {\n        valueText = formatBigNumber(valueText)\n      }\n      crosshairVerticalTextWidth += (\n        crosshairOptions.horizontal.text.paddingLeft +\n        crosshairOptions.horizontal.text.paddingRight +\n        crosshairOptions.horizontal.text.borderSize * 2 +\n        calcTextWidth(this._measureCtx, valueText)\n      )\n    }\n    return Math.max(yAxisWidth, crosshairVerticalTextWidth)\n  }\n\n  convertFromPixel (pixel) {\n    const value = (1.0 - pixel / this._height) * this._range + this._minValue\n    switch (this.yAxisType()) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          return fromData.close * value / 100 + fromData.close\n        }\n        break\n      }\n      case YAxisType.LOG: {\n        return index10(value)\n      }\n      default: {\n        return value\n      }\n    }\n  }\n\n  convertToPixel (value) {\n    let v\n    switch (this.yAxisType()) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartData.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          v = (value - fromData.close) / fromData.close * 100\n        }\n        break\n      }\n      case YAxisType.LOG: {\n        v = log10(value)\n        break\n      }\n      default: {\n        v = value\n      }\n    }\n    return this._innerConvertToPixel(v)\n  }\n\n  /**\n   * 将值转换成坐标，即使坐标不在范围内，也会显示在顶部或者底部\n   * @param value\n   * @return {number}\n   */\n  convertToNicePixel (value) {\n    const y = this.convertToPixel(value)\n    return Math.round(Math.max(this._height * 0.05, Math.min(y, this._height * 0.98)))\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Pane from './Pane'\nimport TechnicalIndicatorWidget from '../widget/TechnicalIndicatorWidget'\nimport YAxisWidget from '../widget/YAxisWidget'\nimport YAxis from '../component/YAxis'\n\nexport default class TechnicalIndicatorPane extends Pane {\n  constructor (props) {\n    super(props)\n    this._techs = new Map()\n    if ('height' in props) {\n      this.setHeight(props.height)\n    }\n    this.setTechnicalIndicator(this._chartData.getTechnicalIndicatorInstance(props.name))\n  }\n\n  _initBefore (props) {\n    this._id = props.id\n    this._yAxis = this._createYAxis(props)\n  }\n\n  _createYAxis (props) {\n    return new YAxis(\n      props.chartData,\n      false,\n      { technicalIndicators: this.technicalIndicators.bind(this) })\n  }\n\n  _createMainWidget (container, props) {\n    return new TechnicalIndicatorWidget({\n      container,\n      chartData: props.chartData,\n      xAxis: props.xAxis,\n      yAxis: this._yAxis,\n      additionalDataProvider: {\n        technicalIndicators: this.technicalIndicators.bind(this),\n        id: this.id.bind(this)\n      }\n    })\n  }\n\n  _createYAxisWidget (container, props) {\n    return new YAxisWidget({\n      container,\n      chartData: props.chartData,\n      yAxis: this._yAxis,\n      additionalDataProvider: {\n        technicalIndicators: this.technicalIndicators.bind(this),\n        id: this.id.bind(this)\n      }\n    })\n  }\n\n  setHeight (height) {\n    super.setHeight(height)\n    this._yAxis.setHeight(height)\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    super.setWidth(mainWidgetWidth, yAxisWidgetWidth)\n    this._yAxis.setWidth(yAxisWidgetWidth)\n  }\n\n  /**\n   * 获取id\n   * @returns {string}\n   */\n  id () {\n    return this._id\n  }\n\n  yAxis () {\n    return this._yAxis\n  }\n\n  /**\n   * 获取技术指标\n   * @return {Map<any, any>}\n   */\n  technicalIndicators () {\n    return this._techs\n  }\n\n  /**\n   * 是否无指标\n   * @return {boolean}\n   */\n  isEmptyTechnicalIndicator () {\n    return this._techs.size === 0\n  }\n\n  /**\n   * 移除技术指标\n   * @param name\n   * @return {boolean}\n   */\n  removeTechnicalIndicator (name) {\n    if (name) {\n      if (this._techs.has(name)) {\n        this._techs.delete(name)\n        return true\n      }\n    } else {\n      this._techs.clear()\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 设置技术指标类型\n   * @param technicalIndicator\n   * @param isStack\n   */\n  setTechnicalIndicator (technicalIndicator, isStack) {\n    if (technicalIndicator) {\n      if (this._techs.has(technicalIndicator.name)) {\n        return false\n      }\n      const cloneInstance = Object.create(technicalIndicator)\n      if (isStack) {\n        this._techs.set(cloneInstance.name, cloneInstance)\n      } else {\n        this._techs = new Map([[cloneInstance.name, cloneInstance]])\n      }\n      this.calcTechnicalIndicator(cloneInstance)\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 计算单个技术指标\n   * @param technicalIndicator\n   */\n  calcTechnicalIndicator (technicalIndicator) {\n    technicalIndicator.result = technicalIndicator.calcTechnicalIndicator(this._chartData.dataList(), technicalIndicator.calcParams, technicalIndicator.plots) || []\n  }\n\n  /**\n   * 计算所有技术指标\n   */\n  calcAllTechnicalIndicator () {\n    this._techs.forEach(technicalIndicator => {\n      this.calcTechnicalIndicator(technicalIndicator)\n    })\n    return this._yAxis.computeAxis()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorView from './TechnicalIndicatorView'\nimport { CandleType, LineStyle } from '../data/options/styleOptions'\nimport { renderHorizontalLine, renderLine } from '../renderer/line'\nimport { createFont } from '../utils/canvas'\nimport { formatPrecision, formatValue } from '../utils/format'\nimport { isArray, isNumber } from '../utils/typeChecks'\n\nexport default class CandleView extends TechnicalIndicatorView {\n  _draw () {\n    this._drawGrid()\n    const candleOptions = this._chartData.styleOptions().candle\n    if (candleOptions.type === CandleType.AREA) {\n      this._drawArea(candleOptions)\n    } else {\n      this._drawCandle(candleOptions)\n      this._drawLowHighPrice(\n        candleOptions.priceMark,\n        'high',\n        'high',\n        Number.MIN_SAFE_INTEGER,\n        [-2, -5],\n        (price, comparePrice) => {\n          if (price > comparePrice) {\n            return price\n          }\n        }\n      )\n      this._drawLowHighPrice(\n        candleOptions.priceMark,\n        'low',\n        'low',\n        Number.MAX_SAFE_INTEGER,\n        [2, 5],\n        (price, comparePrice) => {\n          if (price < comparePrice) {\n            return price\n          }\n        }\n      )\n    }\n    this._drawTechnicalIndicators()\n    this._drawLastPriceLine(candleOptions.priceMark)\n  }\n\n  /**\n   * 绘制面积图\n   * @param candleOptions\n   * @private\n   */\n  _drawArea (candleOptions) {\n    const linePoints = []\n    const areaPoints = []\n    let minY = Number.MAX_SAFE_INTEGER\n    const areaOptions = candleOptions.area\n    const onDrawing = (x, i, kLineData, halfBarSpace, barSpace, n) => {\n      const value = kLineData[areaOptions.value]\n      if (isNumber(value)) {\n        const y = this._yAxis.convertToPixel(value)\n        if (n === 0) {\n          const startX = x - halfBarSpace\n          areaPoints.push({ x: startX, y: this._height })\n          areaPoints.push({ x: startX, y })\n          linePoints.push({ x: startX, y })\n        }\n        linePoints.push({ x, y })\n        areaPoints.push({ x, y })\n        minY = Math.min(minY, y)\n      }\n    }\n    const onDrawEnd = () => {\n      const areaPointLength = areaPoints.length\n      if (areaPointLength > 0) {\n        const lastPoint = areaPoints[areaPointLength - 1]\n        const halfBarSpace = this._chartData.barSpace() / 2\n        const endX = lastPoint.x + halfBarSpace\n        linePoints.push({ x: endX, y: lastPoint.y })\n        areaPoints.push({ x: endX, y: lastPoint.y })\n        areaPoints.push({ x: endX, y: this._height })\n      }\n\n      if (linePoints.length > 0) {\n        // 绘制分时线\n        this._ctx.lineWidth = areaOptions.lineSize\n        this._ctx.strokeStyle = areaOptions.lineColor\n        renderLine(this._ctx, () => {\n          this._ctx.beginPath()\n          this._ctx.moveTo(linePoints[0].x, linePoints[0].y)\n          for (let i = 1; i < linePoints.length; i++) {\n            this._ctx.lineTo(linePoints[i].x, linePoints[i].y)\n          }\n          this._ctx.stroke()\n          this._ctx.closePath()\n        })\n      }\n\n      if (areaPoints.length > 0) {\n        // 绘制分时线填充区域\n        const fillColor = areaOptions.fillColor\n        if (isArray(fillColor)) {\n          const gradient = this._ctx.createLinearGradient(0, this._height, 0, minY)\n          try {\n            fillColor.forEach(({ offset, color }) => {\n              gradient.addColorStop(offset, color)\n            })\n          } catch (e) {\n          }\n          this._ctx.fillStyle = gradient\n        } else {\n          this._ctx.fillStyle = fillColor\n        }\n        this._ctx.beginPath()\n        this._ctx.moveTo(areaPoints[0].x, areaPoints[0].y)\n        for (let i = 1; i < areaPoints.length; i++) {\n          this._ctx.lineTo(areaPoints[i].x, areaPoints[i].y)\n        }\n        this._ctx.closePath()\n        this._ctx.fill()\n      }\n    }\n    this._drawGraphics(onDrawing, onDrawEnd)\n  }\n\n  /**\n   * 绘制蜡烛\n   * @param candleOptions\n   * @private\n   */\n  _drawCandle (candleOptions) {\n    this._drawGraphics((x, i, kLineData, halfBarSpace, barSpace) => {\n      this._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, candleOptions.bar, candleOptions.type)\n    })\n  }\n\n  /**\n   * 渲染最高最低价格\n   * @param priceMarkOptions\n   * @param optionKey\n   * @param priceKey\n   * @param initPriceValue\n   * @param offsets\n   * @param compare\n   * @private\n   */\n  _drawLowHighPrice (priceMarkOptions, optionKey, priceKey, initPriceValue, offsets, compare) {\n    const lowHighPriceMarkOptions = priceMarkOptions[optionKey]\n    if (!priceMarkOptions.show || !lowHighPriceMarkOptions.show) {\n      return\n    }\n    const visibleDataList = this._chartData.visibleDataList()\n    let price = initPriceValue\n    let pos = -1\n    visibleDataList.forEach(({ index, data }) => {\n      const comparePrice = compare(formatValue(data, priceKey, initPriceValue), price)\n      if (comparePrice) {\n        price = comparePrice\n        pos = index\n      }\n    })\n    const pricePrecision = this._chartData.pricePrecision()\n    const priceY = this._yAxis.convertToPixel(price)\n    const startX = this._xAxis.convertToPixel(pos)\n    const startY = priceY + offsets[0]\n    this._ctx.textAlign = 'left'\n    this._ctx.lineWidth = 1\n    this._ctx.strokeStyle = lowHighPriceMarkOptions.color\n    this._ctx.fillStyle = lowHighPriceMarkOptions.color\n\n    renderLine(this._ctx, () => {\n      this._ctx.beginPath()\n      this._ctx.moveTo(startX - 2, startY + offsets[0])\n      this._ctx.lineTo(startX, startY)\n      this._ctx.lineTo(startX + 2, startY + offsets[0])\n      this._ctx.stroke()\n      this._ctx.closePath()\n    })\n\n    // 绘制竖线\n    const y = startY + offsets[1]\n    renderLine(this._ctx, () => {\n      this._ctx.beginPath()\n      this._ctx.moveTo(startX, startY)\n      this._ctx.lineTo(startX, y)\n      this._ctx.lineTo(startX + 5, y)\n      this._ctx.stroke()\n      this._ctx.closePath()\n    })\n\n    this._ctx.font = createFont(lowHighPriceMarkOptions.textSize, lowHighPriceMarkOptions.textWeight, lowHighPriceMarkOptions.textFamily)\n    const text = formatPrecision(price, pricePrecision)\n    this._ctx.textBaseline = 'middle'\n    this._ctx.fillText(text, startX + 5 + lowHighPriceMarkOptions.textMargin, y)\n  }\n\n  /**\n   * 绘制最新价线\n   * @param priceMarkOptions\n   * @private\n   */\n  _drawLastPriceLine (priceMarkOptions) {\n    const lastPriceMarkOptions = priceMarkOptions.last\n    if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.line.show) {\n      return\n    }\n    const dataList = this._chartData.dataList()\n    const kLineData = dataList[dataList.length - 1]\n    if (!kLineData) {\n      return\n    }\n    const close = kLineData.close\n    const open = kLineData.open\n    const priceY = this._yAxis.convertToNicePixel(close)\n    let color\n    if (close > open) {\n      color = lastPriceMarkOptions.upColor\n    } else if (close < open) {\n      color = lastPriceMarkOptions.downColor\n    } else {\n      color = lastPriceMarkOptions.noChangeColor\n    }\n    this._ctx.save()\n    this._ctx.strokeStyle = color\n    this._ctx.lineWidth = lastPriceMarkOptions.line.size\n    if (lastPriceMarkOptions.line.style === LineStyle.DASH) {\n      this._ctx.setLineDash(lastPriceMarkOptions.line.dashValue)\n    }\n    renderHorizontalLine(this._ctx, priceY, 0, this._width)\n    this._ctx.restore()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorOverlayView from './TechnicalIndicatorOverlayView'\nimport { isFunction, isObject, isArray, isValid } from '../utils/typeChecks'\nimport { formatBigNumber, formatDate, formatPrecision, formatValue } from '../utils/format'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { TooltipShowType } from '../data/options/styleOptions'\nimport { getTechnicalIndicatorTooltipData } from '../base/technicalindicator/technicalIndicatorControl'\nimport { TechnicalIndicatorPlotType } from '../base/technicalindicator/TechnicalIndicator'\nimport { renderFillRoundRect, renderStrokeRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class CandleOverlayView extends TechnicalIndicatorOverlayView {\n  _drawCover () {\n    this._ctx.textBaseline = 'alphabetic'\n    // 绘制标签\n    const tags = this._chartData.tags()\n    tags.forEach(tag => {\n      tag.drawMarkLine(this._ctx)\n    })\n    // 绘制图形标记\n    const graphicMarks = this._chartData.graphicMarks()\n    graphicMarks.forEach(graphicMark => {\n      graphicMark.draw(this._ctx)\n    })\n    // 绘制注解\n    const annotations = this._chartData.visibleAnnotations()\n    annotations.forEach(annotation => {\n      annotation.draw(this._ctx)\n    })\n  }\n\n  _drawTooltip (crosshair, technicalIndicators) {\n    const styleOptions = this._chartData.styleOptions()\n    const candleOptions = styleOptions.candle\n    const candleTooltipOptions = candleOptions.tooltip\n    const technicalIndicatorOptions = styleOptions.technicalIndicator\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n    const isDrawCandleTooltip = this._shouldDrawTooltip(crosshair, candleTooltipOptions)\n    const isDrawTechnicalIndicatorTooltip = this._shouldDrawTooltip(crosshair, technicalIndicatorTooltipOptions)\n    if (\n      candleTooltipOptions.showType === TooltipShowType.RECT &&\n      technicalIndicatorTooltipOptions.showType === TooltipShowType.RECT\n    ) {\n      this._drawCandleTooltipWithRect(\n        crosshair,\n        technicalIndicators,\n        candleOptions,\n        isDrawCandleTooltip,\n        technicalIndicatorOptions,\n        isDrawTechnicalIndicatorTooltip\n      )\n    } else {\n      if (candleTooltipOptions.showType === TooltipShowType.STANDARD) {\n        this._drawCandleTooltipWithStandard(crosshair.kLineData, candleOptions, isDrawCandleTooltip)\n        if (technicalIndicatorTooltipOptions.showType === TooltipShowType.STANDARD) {\n          const offsetTop = isDrawCandleTooltip ? candleTooltipOptions.text.size + candleTooltipOptions.text.marginTop : 0\n          this._drawBatchTechnicalIndicatorToolTip(\n            crosshair,\n            technicalIndicators,\n            technicalIndicatorOptions,\n            offsetTop,\n            isDrawTechnicalIndicatorTooltip\n          )\n        } else {\n          this._drawCandleTooltipWithRect(\n            crosshair,\n            technicalIndicators,\n            candleOptions,\n            false,\n            technicalIndicatorOptions,\n            isDrawTechnicalIndicatorTooltip\n          )\n        }\n      } else {\n        this._drawCandleTooltipWithRect(\n          crosshair,\n          technicalIndicators,\n          candleOptions,\n          isDrawCandleTooltip,\n          technicalIndicatorOptions,\n          false\n        )\n        this._drawBatchTechnicalIndicatorToolTip(\n          crosshair,\n          technicalIndicators,\n          technicalIndicatorOptions,\n          0,\n          isDrawTechnicalIndicatorTooltip\n        )\n      }\n    }\n  }\n\n  /**\n   * 绘制蜡烛默认的图例\n   * @param kLineData\n   * @param candleOptions\n   * @param isDrawCandleTooltip\n   * @private\n   */\n  _drawCandleTooltipWithStandard (kLineData, candleOptions, isDrawCandleTooltip) {\n    if (!isDrawCandleTooltip) {\n      return\n    }\n    const values = this._getCandleTooltipData(kLineData, candleOptions)\n    const candleTooltipOptions = candleOptions.tooltip\n    const textMarginLeft = candleTooltipOptions.text.marginLeft\n    const textMarginRight = candleTooltipOptions.text.marginRight\n    const textSize = candleTooltipOptions.text.size\n    const textColor = candleTooltipOptions.text.color\n    const labels = candleTooltipOptions.labels\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(textSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family)\n    let labelX = textMarginLeft\n    const labelY = candleTooltipOptions.text.marginTop\n    labels.forEach((label, i) => {\n      const labelWidth = calcTextWidth(this._ctx, label)\n      renderText(this._ctx, textColor, labelX, labelY, label)\n      labelX += labelWidth\n\n      const value = values[i] || candleTooltipOptions.defaultValue\n      let valueText\n      let valueColor\n      if (isObject(value)) {\n        valueText = value.value || candleTooltipOptions.defaultValue\n        valueColor = value.color || textColor\n      } else {\n        valueColor = textColor\n        valueText = value\n      }\n      const textWidth = calcTextWidth(this._ctx, valueText)\n      renderText(this._ctx, valueColor, labelX, labelY, valueText)\n      labelX += (textWidth + textMarginLeft + textMarginRight)\n    })\n  }\n\n  /**\n   * 绘制蜡烛图矩形类型图例\n   * @param crosshair\n   * @param technicalIndicators\n   * @param candleOptions\n   * @param isDrawCandleTooltip\n   * @param technicalIndicatorOptions\n   * @param isDrawTechnicalIndicatorTooltip\n   * @private\n   */\n  _drawCandleTooltipWithRect (\n    crosshair, technicalIndicators, candleOptions, isDrawCandleTooltip,\n    technicalIndicatorOptions, isDrawTechnicalIndicatorTooltip\n  ) {\n    if (!isDrawCandleTooltip && !isDrawTechnicalIndicatorTooltip) {\n      return\n    }\n    const candleTooltipOptions = candleOptions.tooltip\n    const baseLabels = candleTooltipOptions.labels\n    const baseValues = this._getCandleTooltipData(crosshair.kLineData, candleOptions)\n    const baseTextMarginLeft = candleTooltipOptions.text.marginLeft\n    const baseTextMarginRight = candleTooltipOptions.text.marginRight\n    const baseTextMarginTop = candleTooltipOptions.text.marginTop\n    const baseTextMarginBottom = candleTooltipOptions.text.marginBottom\n    const baseTextSize = candleTooltipOptions.text.size\n    const baseTextColor = candleTooltipOptions.text.color\n\n    const rectOptions = candleTooltipOptions.rect\n    const rectBorderSize = rectOptions.borderSize\n    const rectPaddingLeft = rectOptions.paddingLeft\n    const rectPaddingRight = rectOptions.paddingRight\n    const rectPaddingTop = rectOptions.paddingTop\n    const rectPaddingBottom = rectOptions.paddingBottom\n    const rectLeft = rectOptions.offsetLeft\n    const rectRight = rectOptions.offsetRight\n\n    let maxLabelWidth = 0\n    let rectWidth = 0\n    let rectHeight = 0\n    this._ctx.save()\n    this._ctx.textBaseline = 'top'\n    if (isDrawCandleTooltip) {\n      this._ctx.font = createFont(baseTextSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family)\n      baseLabels.forEach((label, i) => {\n        const value = baseValues[i]\n        let v\n        if (isObject(value)) {\n          v = value.value || candleTooltipOptions.defaultValue\n        } else {\n          v = value\n        }\n        const text = `${label}${v}`\n        const labelWidth = calcTextWidth(this._ctx, text) + baseTextMarginLeft + baseTextMarginRight\n        maxLabelWidth = Math.max(maxLabelWidth, labelWidth)\n      })\n      rectHeight += ((baseTextMarginBottom + baseTextMarginTop + baseTextSize) * baseLabels.length)\n    }\n\n    const technicalIndicatorTooltipOptions = technicalIndicatorOptions.tooltip\n\n    const indicatorTextMarginLeft = technicalIndicatorTooltipOptions.text.marginLeft\n    const indicatorTextMarginRight = technicalIndicatorTooltipOptions.text.marginRight\n    const indicatorTextMarginTop = technicalIndicatorTooltipOptions.text.marginTop\n    const indicatorTextMarginBottom = technicalIndicatorTooltipOptions.text.marginBottom\n    const indicatorTextSize = technicalIndicatorTooltipOptions.text.size\n\n    const indicatorTooltipDataList = []\n    const dataList = this._chartData.dataList()\n    technicalIndicators.forEach(tech => {\n      const result = tech.result\n      indicatorTooltipDataList.push({\n        name: tech.name,\n        tooltipData: getTechnicalIndicatorTooltipData(result[crosshair.dataIndex], tech),\n        cbData: {\n          preData: { kLineData: dataList[crosshair.dataIndex - 1], technicalIndicatorData: result[crosshair.dataIndex - 1] },\n          currentData: { kLineData: dataList[crosshair.dataIndex], technicalIndicatorData: result[crosshair.dataIndex] },\n          nextData: { kLineData: dataList[crosshair.dataIndex + 1], technicalIndicatorData: result[crosshair.dataIndex + 1] }\n        }\n      })\n    })\n    if (isDrawTechnicalIndicatorTooltip) {\n      this._ctx.font = createFont(\n        indicatorTextSize,\n        technicalIndicatorTooltipOptions.text.weight,\n        technicalIndicatorTooltipOptions.text.family\n      )\n      indicatorTooltipDataList.forEach(({ tooltipData }) => {\n        tooltipData.values.forEach(({ title, value }) => {\n          if (isValid(title)) {\n            const v = value || technicalIndicatorTooltipOptions.defaultValue\n            const text = `${title}${v}`\n            const labelWidth = calcTextWidth(this._ctx, text) + indicatorTextMarginLeft + indicatorTextMarginRight\n            maxLabelWidth = Math.max(maxLabelWidth, labelWidth)\n            rectHeight += (indicatorTextMarginTop + indicatorTextMarginBottom + indicatorTextSize)\n          }\n        })\n      })\n    }\n    rectWidth += maxLabelWidth\n    if (rectWidth === 0 || rectHeight === 0) {\n      return\n    }\n    rectWidth += (rectBorderSize * 2 + rectPaddingLeft + rectPaddingRight)\n    rectHeight += (rectBorderSize * 2 + rectPaddingTop + rectPaddingBottom)\n    const centerX = this._width / 2\n    let rectX\n    if (crosshair.realX < centerX) {\n      rectX = this._width - rectRight - rectWidth\n    } else {\n      rectX = rectLeft\n    }\n    const rectY = rectOptions.offsetTop\n    const radius = rectOptions.borderRadius\n    renderFillRoundRect(this._ctx, rectOptions.fillColor, rectX, rectY, rectWidth, rectHeight, radius)\n    renderStrokeRoundRect(this._ctx, rectOptions.borderColor, rectBorderSize, rectX, rectY, rectWidth, rectHeight, radius)\n    const baseLabelX = rectX + rectBorderSize + rectPaddingLeft + baseTextMarginLeft\n    let labelY = rectY + rectBorderSize + rectPaddingTop\n    if (isDrawCandleTooltip) {\n      // 开始渲染基础数据文字\n      this._ctx.font = createFont(\n        baseTextSize,\n        candleTooltipOptions.text.weight,\n        candleTooltipOptions.text.family\n      )\n      baseLabels.forEach((label, i) => {\n        labelY += baseTextMarginTop\n        this._ctx.textAlign = 'left'\n        renderText(this._ctx, baseTextColor, baseLabelX, labelY, label)\n\n        const value = baseValues[i]\n        let text\n        let color\n        if (isObject(value)) {\n          color = value.color || baseTextColor\n          text = value.value || candleTooltipOptions.defaultValue\n        } else {\n          color = baseTextColor\n          text = value || candleTooltipOptions.defaultValue\n        }\n        this._ctx.textAlign = 'right'\n        renderText(\n          this._ctx,\n          color,\n          rectX + rectWidth - rectBorderSize - baseTextMarginRight - rectPaddingRight,\n          labelY,\n          text\n        )\n        labelY += (baseTextSize + baseTextMarginBottom)\n      })\n    }\n    if (isDrawTechnicalIndicatorTooltip) {\n      // 开始渲染指标数据文字\n      const technicalIndicatorOptions = this._chartData.styleOptions().technicalIndicator\n      const indicatorLabelX = rectX + rectBorderSize + rectPaddingLeft + indicatorTextMarginLeft\n      this._ctx.font = createFont(\n        indicatorTextSize,\n        technicalIndicatorTooltipOptions.text.weight,\n        technicalIndicatorTooltipOptions.text.family\n      )\n      indicatorTooltipDataList.forEach(({ name, tooltipData, cbData }) => {\n        const tech = technicalIndicators.get(name)\n        const styles = tech.styles || technicalIndicatorOptions\n        const colors = styles.line.colors\n        const colorSize = colors.length\n        const plots = tech.plots\n        let lineCount = 0\n        let valueColor\n        plots.forEach((plot, i) => {\n          switch (plot.type) {\n            case TechnicalIndicatorPlotType.CIRCLE: {\n              valueColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n              break\n            }\n            case TechnicalIndicatorPlotType.BAR: {\n              valueColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n              break\n            }\n            case TechnicalIndicatorPlotType.LINE: {\n              valueColor = colors[lineCount % colorSize] || styles.text.color\n              lineCount++\n              break\n            }\n            default: { break }\n          }\n          const value = tooltipData.values[i]\n          if (isValid(value.title)) {\n            labelY += indicatorTextMarginTop\n            this._ctx.textAlign = 'left'\n            this._ctx.fillStyle = valueColor\n            this._ctx.fillText(`${value.title}`, indicatorLabelX, labelY)\n\n            this._ctx.textAlign = 'right'\n            this._ctx.fillText(\n              value.value || technicalIndicatorTooltipOptions.defaultValue,\n              rectX + rectWidth - rectBorderSize - indicatorTextMarginRight - rectPaddingRight,\n              labelY\n            )\n            labelY += (indicatorTextSize + indicatorTextMarginBottom)\n          }\n        })\n      })\n    }\n    this._ctx.restore()\n  }\n\n  /**\n   * 获取蜡烛提示数据\n   * @param kLineData\n   * @param candleOptions\n   * @returns {*}\n   * @private\n   */\n  _getCandleTooltipData (kLineData, candleOptions) {\n    const baseValues = candleOptions.tooltip.values\n    let values = []\n    if (baseValues) {\n      if (isFunction(baseValues)) {\n        values = baseValues(kLineData, candleOptions) || []\n      } else if (isArray(baseValues)) {\n        values = baseValues\n      }\n    } else {\n      const pricePrecision = this._chartData.pricePrecision()\n      const volumePrecision = this._chartData.volumePrecision()\n      values = [\n        formatValue(kLineData, 'timestamp'),\n        formatValue(kLineData, 'open'),\n        formatValue(kLineData, 'close'),\n        formatValue(kLineData, 'high'),\n        formatValue(kLineData, 'low'),\n        formatValue(kLineData, 'volume')\n      ]\n      values.forEach((value, index) => {\n        switch (index) {\n          case 0: {\n            values[index] = formatDate(this._chartData.dateTimeFormat(), value, 'YYYY-MM-DD hh:mm')\n            break\n          }\n          case values.length - 1: {\n            values[index] = formatBigNumber(formatPrecision(value, volumePrecision))\n            break\n          }\n          default: {\n            values[index] = formatPrecision(value, pricePrecision)\n            break\n          }\n        }\n      })\n    }\n    return values\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CandleView from '../view/CandleView'\nimport CandleOverlayView from '../view/CandleOverlayView'\nimport TechnicalIndicatorWidget from './TechnicalIndicatorWidget'\n\nexport default class CandleWidget extends TechnicalIndicatorWidget {\n  _createMainView (container, props) {\n    return new CandleView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n\n  _createOverlayView (container, props) {\n    return new CandleOverlayView(container, props.chartData, props.xAxis, props.yAxis, props.additionalDataProvider)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorPane from './TechnicalIndicatorPane'\nimport CandleWidget from '../widget/CandleWidget'\nimport YAxis from '../component/YAxis'\n\nexport default class CandlePane extends TechnicalIndicatorPane {\n  _createYAxis (props) {\n    return new YAxis(\n      props.chartData, true,\n      { technicalIndicators: this.technicalIndicators.bind(this) }\n    )\n  }\n\n  _createMainWidget (container, props) {\n    return new CandleWidget({\n      container,\n      chartData: props.chartData,\n      xAxis: props.xAxis,\n      yAxis: this._yAxis,\n      additionalDataProvider: {\n        technicalIndicators: this.technicalIndicators.bind(this),\n        id: this.id.bind(this)\n      }\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { createFont } from '../utils/canvas'\n\nexport default class XAxisView extends View {\n  constructor (container, chartData, xAxis) {\n    super(container, chartData)\n    this._xAxis = xAxis\n  }\n\n  _draw () {\n    const xAxisOptions = this._chartData.styleOptions().xAxis\n    if (xAxisOptions.show) {\n      this._drawAxisLine(xAxisOptions)\n      this._drawTickLines(xAxisOptions)\n      this._drawTickLabels(xAxisOptions)\n    }\n  }\n\n  _drawAxisLine (xAxisOptions) {\n    const xAxisLine = xAxisOptions.axisLine\n    if (!xAxisLine.show) {\n      return\n    }\n    this._ctx.strokeStyle = xAxisLine.color\n    this._ctx.lineWidth = xAxisLine.size\n    renderHorizontalLine(this._ctx, 0, 0, this._width)\n  }\n\n  _drawTickLines (xAxisOptions) {\n    const tickLine = xAxisOptions.tickLine\n    if (!tickLine.show) {\n      return\n    }\n    this._ctx.lineWidth = tickLine.size\n    this._ctx.strokeStyle = tickLine.color\n\n    const startY = xAxisOptions.axisLine.show ? xAxisOptions.axisLine.size : 0\n\n    const endY = startY + tickLine.length\n    this._xAxis.ticks().forEach(tick => {\n      renderVerticalLine(this._ctx, tick.x, startY, endY)\n    })\n  }\n\n  _drawTickLabels (xAxisOptions) {\n    const tickText = xAxisOptions.tickText\n    if (!tickText.show) {\n      return\n    }\n    const tickLine = xAxisOptions.tickLine\n\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family)\n    this._ctx.textAlign = 'center'\n    this._ctx.fillStyle = tickText.color\n\n    let labelY = tickText.paddingTop\n    if (xAxisOptions.axisLine.show) {\n      labelY += (xAxisOptions.axisLine.size)\n    }\n    if (tickLine.show) {\n      labelY += (tickLine.length)\n    }\n    const ticks = this._xAxis.ticks()\n    const tickLength = ticks.length\n    for (let i = 0; i < tickLength; i++) {\n      this._ctx.fillText(ticks[i].v, ticks[i].x, labelY)\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\n\nimport { formatDate } from '../utils/format'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { renderStrokeFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class XAxisOverlayView extends View {\n  constructor (container, chartData, xAxis) {\n    super(container, chartData)\n    this._xAxis = xAxis\n  }\n\n  _draw () {\n    this._drawCrosshairLabel()\n  }\n\n  _drawCrosshairLabel () {\n    const crosshair = this._chartData.crosshair()\n    if (!crosshair.paneId) {\n      return\n    }\n    const crosshairOptions = this._chartData.styleOptions().crosshair\n    const crosshairVerticalOptions = crosshairOptions.vertical\n    const crosshairVerticalTextOptions = crosshairVerticalOptions.text\n    if (\n      !crosshairOptions.show ||\n      !crosshairVerticalOptions.show ||\n      !crosshairVerticalTextOptions.show ||\n      crosshair.dataIndex !== crosshair.realDataIndex\n    ) {\n      return\n    }\n    const x = crosshair.realX\n    const timestamp = crosshair.kLineData.timestamp\n    const text = formatDate(this._chartData.dateTimeFormat(), timestamp, 'YYYY-MM-DD hh:mm')\n\n    const textSize = crosshairVerticalTextOptions.size\n    this._ctx.font = createFont(textSize, crosshairVerticalTextOptions.weight, crosshairVerticalTextOptions.family)\n    const labelWidth = calcTextWidth(this._ctx, text)\n    let labelX = x - labelWidth / 2\n\n    const paddingLeft = crosshairVerticalTextOptions.paddingLeft\n    const paddingRight = crosshairVerticalTextOptions.paddingRight\n    const paddingTop = crosshairVerticalTextOptions.paddingTop\n    const paddingBottom = crosshairVerticalTextOptions.paddingBottom\n    const borderSize = crosshairVerticalTextOptions.borderSize\n\n    // 保证整个x轴上的提示文字总是完全显示\n    if (labelX < paddingLeft + borderSize) {\n      labelX = paddingLeft + borderSize\n    } else if (labelX > this._width - labelWidth - borderSize - paddingRight) {\n      labelX = this._width - labelWidth - borderSize - paddingRight\n    }\n\n    const rectX = labelX - borderSize - paddingLeft\n    const rectWidth = labelWidth + borderSize * 2 + paddingRight + paddingLeft\n    const rectHeight = textSize + borderSize * 2 + paddingTop + paddingBottom\n\n    renderStrokeFillRoundRect(\n      this._ctx, crosshairVerticalTextOptions.backgroundColor,\n      crosshairVerticalTextOptions.borderColor, borderSize,\n      rectX, 0, rectWidth, rectHeight, crosshairVerticalTextOptions.borderRadius\n    )\n    // 绘制轴上的提示文字\n    this._ctx.textBaseline = 'top'\n    renderText(\n      this._ctx, crosshairVerticalTextOptions.color,\n      labelX, borderSize + paddingTop, text\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport XAxisView from '../view/XAxisView'\nimport XAxisOverlayView from '../view/XAxisOverlayView'\n\nexport default class XAxisWidget extends Widget {\n  _createMainView (container, props) {\n    return new XAxisView(container, props.chartData, props.xAxis)\n  }\n\n  _createOverlayView (container, props) {\n    return new XAxisOverlayView(container, props.chartData, props.xAxis)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Axis from './Axis'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { formatDate } from '../utils/format'\nimport { isNumber } from '../utils/typeChecks'\n\nexport default class XAxis extends Axis {\n  _computeMinMax () {\n    return { min: this._chartData.from(), max: this._chartData.to() - 1 }\n  }\n\n  _optimalMinMax ({ min, max }) {\n    return {\n      min,\n      max,\n      range: max - min + 1\n    }\n  }\n\n  _optimalTicks (ticks) {\n    const optimalTicks = []\n    const tickLength = ticks.length\n    const dataList = this._chartData.dataList()\n    if (tickLength > 0) {\n      const dateTimeFormat = this._chartData.dateTimeFormat()\n      const tickText = this._chartData.styleOptions().xAxis.tickText\n      this._measureCtx.font = createFont(tickText.size, tickText.weight, tickText.family)\n      const defaultLabelWidth = calcTextWidth(this._measureCtx, '00-00 00:00')\n      const pos = parseInt(ticks[0].v, 10)\n      const x = this.convertToPixel(pos)\n      let tickCountDif = 1\n      if (tickLength > 1) {\n        const nextPos = parseInt(ticks[1].v, 10)\n        const nextX = this.convertToPixel(nextPos)\n        const xDif = Math.abs(nextX - x)\n        if (xDif < defaultLabelWidth) {\n          tickCountDif = Math.ceil(defaultLabelWidth / xDif)\n        }\n      }\n      for (let i = 0; i < tickLength; i += tickCountDif) {\n        const pos = parseInt(ticks[i].v, 10)\n        const kLineData = dataList[pos]\n        const timestamp = kLineData.timestamp\n        let label = formatDate(dateTimeFormat, timestamp, 'hh:mm')\n        if (i !== 0) {\n          const prePos = parseInt(ticks[i - tickCountDif].v, 10)\n          const preKLineData = dataList[prePos]\n          const preTimestamp = preKLineData.timestamp\n          label = this._optimalTickLabel(dateTimeFormat, timestamp, preTimestamp) || label\n        }\n        const x = this.convertToPixel(pos)\n        optimalTicks.push({ v: label, x, oV: timestamp })\n      }\n      const optimalTickLength = optimalTicks.length\n      if (optimalTickLength === 1) {\n        optimalTicks[0].v = formatDate(dateTimeFormat, optimalTicks[0].oV, 'YYYY-MM-DD hh:mm')\n      } else {\n        const firstTimestamp = optimalTicks[0].oV\n        const secondTimestamp = optimalTicks[1].oV\n        if (optimalTicks[2]) {\n          const thirdV = optimalTicks[2].v\n          if (/^[0-9]{2}-[0-9]{2}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'MM-DD')\n          } else if (/^[0-9]{4}-[0-9]{2}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY-MM')\n          } else if (/^[0-9]{4}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY')\n          }\n        } else {\n          optimalTicks[0].v = this._optimalTickLabel(dateTimeFormat, firstTimestamp, secondTimestamp) || optimalTicks[0].v\n        }\n      }\n    }\n    return optimalTicks\n  }\n\n  _optimalTickLabel (dateTimeFormat, timestamp, comparedTimestamp) {\n    const year = formatDate(dateTimeFormat, timestamp, 'YYYY')\n    const month = formatDate(dateTimeFormat, timestamp, 'YYYY-MM')\n    const day = formatDate(dateTimeFormat, timestamp, 'MM-DD')\n    if (year !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY')) {\n      return year\n    } else if (month !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY-MM')) {\n      return month\n    } else if (day !== formatDate(dateTimeFormat, comparedTimestamp, 'MM-DD')) {\n      return day\n    }\n    return null\n  }\n\n  /**\n   * 获取自身高度\n   */\n  getSelfHeight () {\n    const stylOptions = this._chartData.styleOptions()\n    const xAxisOptions = stylOptions.xAxis\n    const height = xAxisOptions.height\n    if (isNumber(height)) {\n      return height\n    }\n    const crosshairOptions = stylOptions.crosshair\n    let xAxisHeight = 0\n    if (xAxisOptions.show) {\n      if (xAxisOptions.axisLine.show) {\n        xAxisHeight += xAxisOptions.axisLine.size\n      }\n      if (xAxisOptions.tickLine.show) {\n        xAxisHeight += xAxisOptions.tickLine.length\n      }\n      if (xAxisOptions.tickText.show) {\n        xAxisHeight += (xAxisOptions.tickText.paddingTop + xAxisOptions.tickText.paddingBottom + xAxisOptions.tickText.size)\n      }\n    }\n    let crosshairVerticalTextHeight = 0\n    if (\n      crosshairOptions.show &&\n      crosshairOptions.vertical.show &&\n      crosshairOptions.vertical.text.show\n    ) {\n      crosshairVerticalTextHeight += (\n        crosshairOptions.vertical.text.paddingTop +\n        crosshairOptions.vertical.text.paddingBottom +\n        crosshairOptions.vertical.text.borderSize * 2 +\n        crosshairOptions.vertical.text.size\n      )\n    }\n    return Math.max(xAxisHeight, crosshairVerticalTextHeight)\n  }\n\n  convertFromPixel (pixel) {\n    return this._chartData.coordinateToDataIndex(pixel)\n  }\n\n  convertToPixel (value) {\n    return this._chartData.dataIndexToCoordinate(value)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Pane from './Pane'\nimport XAxisWidget from '../widget/XAxisWidget'\nimport XAxis from '../component/XAxis'\n\nexport default class XAxisPane extends Pane {\n  _initBefore () {\n    this._xAxis = new XAxis(this._chartData)\n  }\n\n  _createMainWidget (container, props) {\n    return new XAxisWidget({ container, chartData: props.chartData, xAxis: this._xAxis })\n  }\n\n  xAxis () {\n    return this._xAxis\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    super.setWidth(mainWidgetWidth, yAxisWidgetWidth)\n    this._xAxis.setWidth(mainWidgetWidth)\n  }\n\n  setHeight (height) {\n    super.setHeight(height)\n    this._xAxis.setHeight(height)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The file comes from tradingview/lightweight-charts\n * https://www.tradingview.com/\n * Convert files from typescript to javascript.\n * Modified the class name.\n * The use of the source code of this file is also subject to the terms\n * and consitions of the license of \"lightweight-charts\" (Apache License V2, see\n * </licenses/LICENSE-lightweight-charts>).\n */\n\nconst MouseEventButton = {\n  LEFT: 0,\n  RIGHT: 2\n}\n\nconst DELAY_RESET_CLICK = 500\nconst DELAY_LONG_TAG = 600\n\nfunction getBoundingClientRect (element) {\n  return element.getBoundingClientRect() || { left: 0, top: 0 }\n}\n\nfunction isTouchEvent (event) {\n  return Boolean(event.touches)\n}\n\nfunction preventDefault (event) {\n  if (event.cancelable) {\n    event.preventDefault()\n  }\n}\n\nfunction checkTouchEvents () {\n  if ('ontouchstart' in window) {\n    return true\n  }\n\n  return Boolean(window.DocumentTouch && document instanceof window.DocumentTouch)\n}\n\nconst touch = !!navigator.maxTouchPoints || !!navigator.msMaxTouchPoints || checkTouchEvents()\nconst mobileTouch = 'onorientationchange' in window && touch\n\nfunction getDistance (p1, p2) {\n  const xDiff = p1.clientX - p2.clientX\n  const yDiff = p1.clientY - p2.clientY\n  return Math.sqrt(xDiff * xDiff + yDiff * yDiff)\n}\n\nexport const EventType = {\n  MOUSE: 'mouse',\n  TOUCH: 'touch'\n}\n\nexport default class EventBase {\n  constructor (target, eventHandler, options) {\n    this._target = target\n    this._handler = eventHandler\n    this._options = options\n\n    this._clickCount = 0\n    this._clickTimeoutId = null\n    this._longTapTimeoutId = null\n    this._longTapActive = false\n    this._mouseMoveStartPosition = null\n    this._moveExceededManhattanDistance = false\n    this._cancelClick = false\n    this._unsubscribeOutsideEvents = null\n    this._unsubscribeMousemove = null\n    this._unsubscribeRoot = null\n\n    this._startPinchMiddlePoint = null\n    this._startPinchDistance = 0\n    this._pinchPrevented = false\n    this._preventDragProcess = false\n\n    this._mousePressed = false\n\n    this._init()\n  }\n\n  destroy () {\n    if (this._unsubscribeOutsideEvents !== null) {\n      this._unsubscribeOutsideEvents()\n      this._unsubscribeOutsideEvents = null\n    }\n\n    if (this._unsubscribeMousemove !== null) {\n      this._unsubscribeMousemove()\n      this._unsubscribeMousemove = null\n    }\n\n    if (this._unsubscribeRoot !== null) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    this._clearLongTapTimeout()\n    this._resetClickTimeout()\n  }\n\n  _mouseEnterHandler (enterEvent) {\n    if (this._unsubscribeMousemove) {\n      this._unsubscribeMousemove()\n    }\n\n    {\n      const boundMouseMoveHandler = this._mouseMoveHandler.bind(this)\n      const boundMouseWheelHandler = this._mouseWheelHandler.bind(this)\n      this._unsubscribeMousemove = () => {\n        this._target.removeEventListener('mousemove', boundMouseMoveHandler)\n        this._target.removeEventListener('wheel', boundMouseWheelHandler)\n      }\n      this._target.addEventListener('mousemove', boundMouseMoveHandler)\n      this._target.addEventListener('wheel', boundMouseWheelHandler, { passive: false })\n    }\n\n    if (isTouchEvent(enterEvent)) {\n      this._mouseMoveHandler(enterEvent)\n    }\n\n    const compatEvent = this._makeCompatEvent(enterEvent)\n    this._processEvent(compatEvent, this._handler.mouseEnterEvent)\n  }\n\n  _resetClickTimeout () {\n    if (this._clickTimeoutId !== null) {\n      clearTimeout(this._clickTimeoutId)\n    }\n\n    this._clickCount = 0\n    this._clickTimeoutId = null\n  }\n\n  _mouseMoveHandler (moveEvent) {\n    if (this._mousePressed && !isTouchEvent(moveEvent)) {\n      return\n    }\n\n    const compatEvent = this._makeCompatEvent(moveEvent)\n    this._processEvent(compatEvent, this._handler.mouseMoveEvent)\n  }\n\n  _mouseWheelHandler (wheelEvent) {\n    const compatEvent = this._makeCompatEvent(wheelEvent)\n    wheelEvent.localX = compatEvent.localX\n    wheelEvent.localY = compatEvent.localY\n    this._processEvent(wheelEvent, this._handler.mouseWheelEvent)\n  }\n\n  _mouseMoveWithDownHandler (moveEvent) {\n    if ('button' in moveEvent && moveEvent.button !== MouseEventButton.LEFT) {\n      return\n    }\n\n    if (this._startPinchMiddlePoint !== null) {\n      return\n    }\n\n    const isTouch = isTouchEvent(moveEvent)\n    if (this._preventDragProcess && isTouch) {\n      return\n    }\n\n    this._pinchPrevented = true\n\n    const compatEvent = this._makeCompatEvent(moveEvent)\n\n    const startMouseMovePos = this._mouseMoveStartPosition\n    const xOffset = Math.abs(startMouseMovePos.x - compatEvent.pageX)\n    const yOffset = Math.abs(startMouseMovePos.y - compatEvent.pageY)\n\n    const moveExceededManhattanDistance = xOffset + yOffset > 5\n\n    if (!moveExceededManhattanDistance && isTouch) {\n      return\n    }\n\n    if (moveExceededManhattanDistance && !this._moveExceededManhattanDistance && isTouch) {\n      // vertical drag is more important than horizontal drag\n      // because we scroll the page vertically often than horizontally\n      const correctedXOffset = xOffset * 0.5\n\n      // a drag can be only if touch page scroll isn't allowed\n      const isVertDrag = yOffset >= correctedXOffset && !this._options.treatVertTouchDragAsPageScroll\n      const isHorzDrag = correctedXOffset > yOffset && !this._options.treatHorzTouchDragAsPageScroll\n\n      // if drag event happened then we should revert preventDefault state to original one\n      // and try to process the drag event\n      // else we shouldn't prevent default of the event and ignore processing the drag event\n      if (!isVertDrag && !isHorzDrag) {\n        this._preventDragProcess = true\n      }\n    }\n\n    if (moveExceededManhattanDistance) {\n      this._moveExceededManhattanDistance = true\n\n      // if manhattan distance is more that 5 - we should cancel click event\n      this._cancelClick = true\n\n      if (isTouch) {\n        this._clearLongTapTimeout()\n      }\n    }\n\n    if (!this._preventDragProcess) {\n      this._processEvent(compatEvent, this._handler.pressedMouseMoveEvent)\n\n      // we should prevent default in case of touch only\n      // to prevent scroll of the page\n      if (isTouch) {\n        preventDefault(moveEvent)\n      }\n    }\n  }\n\n  _mouseUpHandler (mouseUpEvent) {\n    if ('button' in mouseUpEvent && mouseUpEvent.button !== MouseEventButton.LEFT) {\n      return\n    }\n    const compatEvent = this._makeCompatEvent(mouseUpEvent)\n\n    this._clearLongTapTimeout()\n\n    this._mouseMoveStartPosition = null\n\n    this._mousePressed = false\n\n    if (this._unsubscribeRoot) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    if (isTouchEvent(mouseUpEvent)) {\n      this._mouseLeaveHandler(mouseUpEvent)\n    }\n\n    this._processEvent(compatEvent, this._handler.mouseUpEvent)\n    ++this._clickCount\n    if (this._clickTimeoutId && this._clickCount > 1) {\n      this._processEvent(compatEvent, this._handler.mouseDoubleClickEvent)\n      this._resetClickTimeout()\n    } else {\n      if (!this._cancelClick) {\n        this._processEvent(compatEvent, this._handler.mouseClickEvent)\n      }\n    }\n\n    // prevent safari's dblclick-to-zoom\n    // we handle mouseDoubleClickEvent here ourself\n    if (isTouchEvent(mouseUpEvent)) {\n      preventDefault(mouseUpEvent)\n\n      this._mouseLeaveHandler(mouseUpEvent)\n\n      if (mouseUpEvent.touches.length === 0) {\n        this._longTapActive = false\n      }\n    }\n  }\n\n  _clearLongTapTimeout () {\n    if (this._longTapTimeoutId === null) {\n      return\n    }\n\n    clearTimeout(this._longTapTimeoutId)\n    this._longTapTimeoutId = null\n  }\n\n  _mouseDownHandler (downEvent) {\n    if ('button' in downEvent && downEvent.button !== MouseEventButton.LEFT && downEvent.button !== MouseEventButton.RIGHT) {\n      return\n    }\n    const compatEvent = this._makeCompatEvent(downEvent)\n    if ('button' in downEvent && downEvent.button === MouseEventButton.RIGHT) {\n      this._processEvent(compatEvent, this._handler.mouseRightDownEvent)\n      return\n    }\n    this._cancelClick = false\n    this._moveExceededManhattanDistance = false\n    this._preventDragProcess = false\n\n    if (isTouchEvent(downEvent)) {\n      this._mouseEnterHandler(downEvent)\n    }\n\n    this._mouseMoveStartPosition = {\n      x: compatEvent.pageX,\n      y: compatEvent.pageY\n    }\n\n    if (this._unsubscribeRoot) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    {\n      const boundMouseMoveWithDownHandler = this._mouseMoveWithDownHandler.bind(this)\n      const boundMouseUpHandler = this._mouseUpHandler.bind(this)\n      const rootElement = this._target.ownerDocument.documentElement\n\n      this._unsubscribeRoot = () => {\n        rootElement.removeEventListener('touchmove', boundMouseMoveWithDownHandler)\n        rootElement.removeEventListener('touchend', boundMouseUpHandler)\n\n        rootElement.removeEventListener('mousemove', boundMouseMoveWithDownHandler)\n        rootElement.removeEventListener('mouseup', boundMouseUpHandler)\n      }\n\n      rootElement.addEventListener('touchmove', boundMouseMoveWithDownHandler, { passive: false })\n      rootElement.addEventListener('touchend', boundMouseUpHandler, { passive: false })\n\n      this._clearLongTapTimeout()\n\n      if (isTouchEvent(downEvent) && downEvent.touches.length === 1) {\n        this._longTapTimeoutId = setTimeout(this._longTapHandler.bind(this, downEvent), DELAY_LONG_TAG)\n      } else {\n        rootElement.addEventListener('mousemove', boundMouseMoveWithDownHandler)\n        rootElement.addEventListener('mouseup', boundMouseUpHandler)\n      }\n    }\n\n    this._mousePressed = true\n    this._processEvent(compatEvent, this._handler.mouseDownEvent)\n\n    if (!this._clickTimeoutId) {\n      this._clickCount = 0\n      this._clickTimeoutId = setTimeout(this._resetClickTimeout.bind(this), DELAY_RESET_CLICK)\n    }\n  }\n\n  _init () {\n    this._target.addEventListener('mouseenter', this._mouseEnterHandler.bind(this))\n\n    this._target.addEventListener('touchcancel', this._clearLongTapTimeout.bind(this))\n\n    {\n      const doc = this._target.ownerDocument\n\n      const outsideHandler = (event) => {\n        if (!this._handler.mouseDownOutsideEvent) {\n          return\n        }\n        if (event.target && this._target.contains(event.target)) {\n          return\n        }\n        this._handler.mouseDownOutsideEvent()\n      }\n\n      this._unsubscribeOutsideEvents = () => {\n        doc.removeEventListener('mousedown', outsideHandler)\n        doc.removeEventListener('touchstart', outsideHandler)\n      }\n\n      doc.addEventListener('mousedown', outsideHandler)\n      doc.addEventListener('touchstart', outsideHandler, { passive: true })\n    }\n\n    this._target.addEventListener('mouseleave', this._mouseLeaveHandler.bind(this))\n\n    this._target.addEventListener('touchstart', this._mouseDownHandler.bind(this), { passive: true })\n    if (!mobileTouch) {\n      this._target.addEventListener('mousedown', this._mouseDownHandler.bind(this))\n    }\n\n    this._initPinch()\n\n    // Hey mobile Safari, what's up?\n    // If mobile Safari doesn't have any touchmove handler with passive=false\n    // it treats a touchstart and the following touchmove events as cancelable=false,\n    // so we can't prevent them (as soon we subscribe on touchmove inside handler of touchstart).\n    // And we'll get scroll of the page along with chart's one instead of only chart's scroll.\n    this._target.addEventListener('touchmove', () => {}, { passive: false })\n  }\n\n  _initPinch () {\n    if (this._handler.pinchStartEvent === undefined &&\n      this._handler.pinchEvent === undefined &&\n      this._handler.pinchEndEvent === undefined\n    ) {\n      return\n    }\n\n    this._target.addEventListener(\n      'touchstart',\n      (event) => this._checkPinchState(event.touches),\n      { passive: true }\n    )\n\n    this._target.addEventListener(\n      'touchmove',\n      (event) => {\n        if (event.touches.length !== 2 || this._startPinchMiddlePoint === null) {\n          return\n        }\n\n        if (this._handler.pinchEvent !== undefined) {\n          const currentDistance = getDistance(event.touches[0], event.touches[1])\n          const scale = currentDistance / this._startPinchDistance\n          this._handler.pinchEvent(this._startPinchMiddlePoint, scale)\n          preventDefault(event)\n        }\n      },\n      { passive: false }\n    )\n\n    this._target.addEventListener('touchend', (event) => {\n      this._checkPinchState(event.touches)\n    })\n  }\n\n  _checkPinchState (touches) {\n    if (touches.length === 1) {\n      this._pinchPrevented = false\n    }\n\n    if (touches.length !== 2 || this._pinchPrevented || this._longTapActive) {\n      this._stopPinch()\n    } else {\n      this._startPinch(touches)\n    }\n  }\n\n  _startPinch (touches) {\n    const box = getBoundingClientRect(this._target)\n    this._startPinchMiddlePoint = {\n      x: ((touches[0].clientX - box.left) + (touches[1].clientX - box.left)) / 2,\n      y: ((touches[0].clientY - box.top) + (touches[1].clientY - box.top)) / 2\n    }\n\n    this._startPinchDistance = getDistance(touches[0], touches[1])\n\n    if (this._handler.pinchStartEvent !== undefined) {\n      this._handler.pinchStartEvent()\n    }\n\n    this._clearLongTapTimeout()\n  }\n\n  _stopPinch () {\n    if (this._startPinchMiddlePoint === null) {\n      return\n    }\n\n    this._startPinchMiddlePoint = null\n\n    if (this._handler.pinchEndEvent !== undefined) {\n      this._handler.pinchEndEvent()\n    }\n  }\n\n  _mouseLeaveHandler (event) {\n    if (this._unsubscribeMousemove) {\n      this._unsubscribeMousemove()\n    }\n    const compatEvent = this._makeCompatEvent(event)\n    this._processEvent(compatEvent, this._handler.mouseLeaveEvent)\n  }\n\n  _longTapHandler (event) {\n    const compatEvent = this._makeCompatEvent(event)\n    this._processEvent(compatEvent, this._handler.longTapEvent)\n    this._cancelClick = true\n\n    // long tap is active untill touchend event with 0 touches occured\n    this._longTapActive = true\n  }\n\n  _processEvent (event, callback) {\n    if (!callback) {\n      return\n    }\n    callback.call(this._handler, event)\n  }\n\n  _makeCompatEvent (event) {\n  // TouchEvent has no clientX/Y coordinates:\n  // We have to use the last Touch instead\n    let eventLike\n    if ('touches' in event && event.touches.length) {\n      eventLike = event.touches[0]\n    } else if ('changedTouches' in event && event.changedTouches.length) {\n      eventLike = event.changedTouches[0]\n    } else {\n      eventLike = event\n    }\n\n    const box = getBoundingClientRect(this._target)\n\n    return {\n      clientX: eventLike.clientX,\n      clientY: eventLike.clientY,\n      pageX: eventLike.pageX,\n      pageY: eventLike.pageY,\n      screenX: eventLike.screenX,\n      screenY: eventLike.screenY,\n      localX: eventLike.clientX - box.left,\n      localY: eventLike.clientY - box.top,\n\n      ctrlKey: event.ctrlKey,\n      altKey: event.altKey,\n      shiftKey: event.shiftKey,\n      metaKey: event.metaKey,\n\n      type: event.type.startsWith('mouse') ? EventType.MOUSE : EventType.TOUCH,\n\n      target: eventLike.target,\n      view: event.view\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventBase from '../event/EventBase'\nimport { getPixelRatio } from '../utils/canvas'\nimport { isValid } from '../utils/typeChecks'\n\nexport default class SeparatorPane {\n  constructor (container, chartData, topPaneId, bottomPaneId, dragEnabled, dragEventHandler) {\n    this._chartData = chartData\n    this._topPaneId = topPaneId\n    this._bottomPaneId = bottomPaneId\n    this._dragEnabled = dragEnabled\n    this._width = 0\n    this._offsetLeft = 0\n    this._dragEventHandler = dragEventHandler\n    this._dragFlag = false\n    this._initElement(container)\n    this._initEvent(dragEnabled)\n  }\n\n  /**\n   * 初始化dom元素\n   * @param container\n   * @private\n   */\n  _initElement (container) {\n    this._container = container\n    this._wrapper = this._createElement()\n    this._wrapper.style.position = 'relative'\n    this._element = this._createElement()\n    this._element.style.width = '100%'\n    this._element.style.position = 'absolute'\n    this._element.style.zIndex = '20'\n    this._element.style.top = '-3px'\n    this._element.style.height = '7px'\n    this._wrapper.appendChild(this._element)\n    const lastElement = container.lastChild\n    if (lastElement) {\n      container.insertBefore(this._wrapper, lastElement)\n    } else {\n      container.appendChild(this._wrapper)\n    }\n  }\n\n  /**\n   * 初始化事件\n   * @param dragEnabled\n   * @private\n   */\n  _initEvent (dragEnabled) {\n    if (dragEnabled) {\n      this._element.style.cursor = 'ns-resize'\n      this._dragEvent = new EventBase(this._element, {\n        mouseDownEvent: this._mouseDownEvent.bind(this),\n        mouseUpEvent: this._mouseUpEvent.bind(this),\n        pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n        mouseEnterEvent: this._mouseEnterEvent.bind(this),\n        mouseLeaveEvent: this._mouseLeaveEvent.bind(this)\n      }, {\n        treatVertTouchDragAsPageScroll: false,\n        treatHorzTouchDragAsPageScroll: true\n      })\n    }\n  }\n\n  /**\n   * 创建div节点\n   * @return {HTMLDivElement}\n   * @private\n   */\n  _createElement () {\n    const element = document.createElement('div')\n    element.style.margin = '0'\n    element.style.padding = '0'\n    return element\n  }\n\n  _mouseDownEvent (event) {\n    this._dragFlag = true\n    this._startY = event.pageY\n    this._dragEventHandler.startDrag(this._topPaneId, this._bottomPaneId)\n  }\n\n  _mouseUpEvent () {\n    this._dragFlag = false\n    this._chartData.setDragPaneFlag(false)\n  }\n\n  _pressedMouseMoveEvent (event) {\n    const dragDistance = event.pageY - this._startY\n    this._dragEventHandler.drag(dragDistance, this._topPaneId, this._bottomPaneId)\n    this._chartData.setDragPaneFlag(true)\n    this._chartData.setCrosshair()\n  }\n\n  _mouseEnterEvent () {\n    const separatorOptions = this._chartData.styleOptions().separator\n    this._element.style.background = separatorOptions.activeBackgroundColor\n    this._chartData.setDragPaneFlag(true)\n    this._chartData.setCrosshair()\n  }\n\n  _mouseLeaveEvent () {\n    if (!this._dragFlag) {\n      this._element.style.background = null\n      this._chartData.setDragPaneFlag(false)\n    }\n  }\n\n  /**\n   * 获取高度\n   * @returns {number}\n   */\n  height () {\n    return this._wrapper.offsetHeight\n  }\n\n  /**\n   * 设置尺寸\n   * 用于fill属性\n   * @param offsetLeft\n   * @param width\n   */\n  setSize (offsetLeft, width) {\n    this._offsetLeft = offsetLeft\n    this._width = width\n    this.invalidate()\n  }\n\n  /**\n   * 设置是否可以拖拽\n   * @param dragEnabled\n   */\n  setDragEnabled (dragEnabled) {\n    if (dragEnabled !== this._dragEnabled) {\n      this._dragEnabled = dragEnabled\n      if (dragEnabled) {\n        !this._dragEvent && this._initEvent(dragEnabled)\n      } else {\n        this._element.style.cursor = 'default'\n        this._dragEvent && this._dragEvent.destroy()\n        this._dragEvent = null\n      }\n    }\n  }\n\n  /**\n   * 顶部paneId\n   * @return {*}\n   */\n  topPaneId () {\n    return this._topPaneId\n  }\n\n  /**\n   * 底部paneId\n   * @return {*}\n   */\n  bottomPaneId () {\n    return this._bottomPaneId\n  }\n\n  /**\n   * 更新上下两个图表的索引\n   * @param topPaneId\n   * @param bottomPaneId\n   */\n  updatePaneId (topPaneId, bottomPaneId) {\n    if (isValid(topPaneId)) {\n      this._topPaneId = topPaneId\n    }\n    if (isValid(bottomPaneId)) {\n      this._bottomPaneId = bottomPaneId\n    }\n  }\n\n  /**\n   * 刷新\n   */\n  invalidate () {\n    const separatorOptions = this._chartData.styleOptions().separator\n    this._element.style.top = `${-Math.floor((7 - separatorOptions.size) / 2)}px`\n    this._wrapper.style.backgroundColor = separatorOptions.color\n    this._wrapper.style.height = `${separatorOptions.size}px`\n    this._wrapper.style.marginLeft = `${separatorOptions.fill ? 0 : this._offsetLeft}px`\n    this._wrapper.style.width = separatorOptions.fill ? '100%' : `${this._width}px`\n  }\n\n  /**\n   * 将图形转换成图片\n   * @returns {HTMLCanvasElement}\n   */\n  getImage () {\n    const separatorOptions = this._chartData.styleOptions().separator\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    const width = this._wrapper.offsetWidth\n    const height = separatorOptions.size\n    canvas.style.width = `${width}px`\n    canvas.style.height = `${height}px`\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n    ctx.fillStyle = separatorOptions.color\n    ctx.fillRect(this._offsetLeft, 0, width, height)\n    return canvas\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    if (this._dragEvent) {\n      this._dragEvent.destroy()\n    }\n    this._container.removeChild(this._wrapper)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EventType } from './EventBase'\n\nexport function isTouch (event) {\n  return event.type === EventType.TOUCH\n}\n\nexport function isMouse (event) {\n  return event.type === EventType.MOUSE\n}\n\nexport default class EventHandler {\n  constructor (chartData) {\n    this._chartData = chartData\n    this._chartContentSize = {}\n    this._paneContentSize = {}\n  }\n\n  _checkEventPointX (x) {\n    return x > 0 && x < this._chartContentSize.contentRight - this._chartContentSize.contentLeft\n  }\n\n  setChartContentSize (chartContentSize) {\n    this._chartContentSize = chartContentSize\n  }\n\n  setPaneContentSize (paneContentSize) {\n    this._paneContentSize = paneContentSize\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler, { isMouse, isTouch } from './EventHandler'\n\nconst TOUCH_MIN_RADIUS = 10\n\nexport default class ZoomScrollEventHandler extends EventHandler {\n  constructor (chartData) {\n    super(chartData)\n    // 开始滚动时坐标点\n    this._startScrollPoint = {}\n    // 开始触摸时坐标\n    this._touchPoint = null\n    // 是否是取消了十字光标\n    this._touchCancelCrossHair = false\n    // 是否缩放过\n    this._touchZoomed = false\n    // 用来记录捏合缩放的尺寸\n    this._pinchScale = 1\n  }\n\n  pinchStartEvent () {\n    this._pinchScale = 1\n    this._touchZoomed = true\n  }\n\n  pinchEvent (middlePoint, scale) {\n    const zoomScale = (scale - this._pinchScale) * 5\n    this._pinchScale = scale\n    this._chartData.zoom(zoomScale, middlePoint)\n  }\n\n  mouseLeaveEvent (event) {\n    if (isMouse(event)) {\n      this._chartData.setCrosshair()\n    }\n  }\n\n  mouseMoveEvent (event) {\n    if (!isMouse(event)) {\n      return\n    }\n    this._performCross(event, false, cross => {\n      this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n    }, () => {\n      this._chartData.setCrosshair()\n    })\n  }\n\n  mouseWheelEvent (event) {\n    if (!this._checkEventPointX(event.localX)) {\n      return\n    }\n    if (Math.abs(event.deltaX) > Math.abs(event.deltaY)) {\n      if (event.cancelable) {\n        event.preventDefault()\n      }\n      if (Math.abs(event.deltaX) === 0) {\n        return\n      }\n      this._chartData.startScroll()\n      this._chartData.scroll(-event.deltaX)\n    } else {\n      let deltaY = -(event.deltaY / 100)\n      if (deltaY === 0) {\n        return\n      }\n      if (event.cancelable) {\n        event.preventDefault()\n      }\n\n      switch (event.deltaMode) {\n        case event.DOM_DELTA_PAGE:\n          deltaY *= 120\n          break\n\n        case event.DOM_DELTA_LINE:\n          deltaY *= 32\n          break\n      }\n\n      if (deltaY !== 0) {\n        const scale = Math.sign(deltaY) * Math.min(1, Math.abs(deltaY))\n        this._chartData.zoom(scale, { x: event.localX, y: event.localY })\n      }\n    }\n  }\n\n  mouseClickEvent (event) {\n    this._performCross(event, true, cross => {\n      if (!this._touchPoint && !this._touchCancelCrossHair && !this._touchZoomed) {\n        this._touchPoint = { x: event.localX, y: event.localY }\n        this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n      }\n    })\n  }\n\n  mouseDownEvent (event) {\n    this._startScrollPoint = { x: event.localX, y: event.localY }\n    this._chartData.startScroll()\n    this._performCross(event, true, cross => {\n      this._touchZoomed = false\n      if (this._touchPoint) {\n        const xDif = event.localX - this._touchPoint.x\n        const yDif = event.localY - this._touchPoint.y\n        const radius = Math.sqrt(xDif * xDif + yDif * yDif)\n        if (radius < TOUCH_MIN_RADIUS) {\n          this._touchPoint = { x: event.localX, y: event.localY }\n          this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n        } else {\n          this._touchCancelCrossHair = true\n          this._touchPoint = null\n          this._chartData.setCrosshair()\n        }\n      } else {\n        this._touchCancelCrossHair = false\n      }\n    })\n  }\n\n  pressedMouseMoveEvent (event) {\n    this._performCross(event, false, cross => {\n      let crosshair = { x: event.localX, y: cross.y, paneId: cross.paneId }\n      if (isTouch(event)) {\n        if (this._touchPoint) {\n          this._touchPoint = { x: event.localX, y: event.localY }\n          this._chartData.setCrosshair(crosshair)\n          return\n        } else {\n          crosshair = null\n        }\n      }\n      const distance = event.localX - this._startScrollPoint.x\n      this._chartData.scroll(distance, crosshair)\n    })\n  }\n\n  longTapEvent (event) {\n    this._performCross(event, true, cross => {\n      this._touchPoint = { x: event.localX, y: event.localY }\n      this._chartData.setCrosshair({ x: event.localX, y: cross.y, paneId: cross.paneId })\n    })\n  }\n\n  /**\n   * 处理十字光标\n   * @param event\n   * @param checkTouchEvent\n   * @param performFuc\n   * @param extendFun\n   * @private\n   */\n  _performCross (event, checkTouchEvent, performFuc, extendFun) {\n    if (checkTouchEvent && !isTouch(event)) {\n      return\n    }\n    if (!this._checkEventPointX(event.localX)) {\n      if (extendFun) {\n        extendFun()\n      }\n      return\n    }\n    let isPerform = false\n    for (const paneId in this._paneContentSize) {\n      const size = this._paneContentSize[paneId]\n      if (event.localY > size.contentTop && event.localY < size.contentBottom) {\n        isPerform = true\n        if (performFuc) {\n          performFuc({ paneId, y: event.localY - size.contentTop })\n        }\n        break\n      }\n    }\n    if (!isPerform && extendFun) {\n      extendFun()\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler, { isMouse } from './EventHandler'\nimport { CANDLE_PANE_ID, InvalidateLevel } from '../data/constants'\nimport { GraphicMarkMouseOperateElement } from '../base/overlay/mark/GraphicMark'\n\nexport default class OverlayEventHandler extends EventHandler {\n  constructor (chartData) {\n    super(chartData)\n    this._pressedGraphicMark = null\n  }\n\n  /**\n   * 处理覆盖物鼠标hover事件\n   * @param overlays\n   * @param preHoverOperate\n   * @param coordinate\n   * @param event\n   * @return {*}\n   * @private\n   */\n  _performOverlayMouseHover (overlays, preHoverOperate, coordinate, event) {\n    let hoverOperate\n    for (const overlay of overlays) {\n      hoverOperate = overlay.checkMousePointOnGraphic(coordinate)\n      if (hoverOperate) {\n        break\n      }\n    }\n    if (!hoverOperate || preHoverOperate.id !== hoverOperate.id) {\n      if (preHoverOperate.id && preHoverOperate.instance && isMouse(event)) {\n        preHoverOperate.instance.onMouseLeave({\n          id: preHoverOperate.id,\n          points: preHoverOperate.instance.points(),\n          event\n        })\n      }\n      if (hoverOperate && hoverOperate.id !== preHoverOperate.id && hoverOperate.instance && isMouse(event)) {\n        hoverOperate.instance.onMouseEnter({\n          id: hoverOperate.id,\n          points: hoverOperate.instance.points(),\n          event\n        })\n      }\n    }\n    return hoverOperate\n  }\n\n  /**\n   * 鼠标抬起事件\n   * @param event\n   */\n  mouseUpEvent (event) {\n    if (this._pressedGraphicMark) {\n      this._pressedGraphicMark = null\n      this._chartData.setDragGraphicMarkFlag(false)\n    }\n  }\n\n  mouseMoveEvent (event) {\n    if (!this._checkEventPointX(event.localX) || !this._checkEventPointY(event.localY) || this._waitingForMouseMoveAnimationFrame) {\n      return\n    }\n    this._waitingForMouseMoveAnimationFrame = true\n    const coordinate = { x: event.localX, y: event.localY }\n    const graphicMarks = this._chartData.graphicMarks()\n    const visibleAnnotations = this._chartData.visibleAnnotations()\n    const lastGraphicMark = graphicMarks[graphicMarks.length - 1]\n    const preGraphicMarkHoverOperate = this._chartData.graphicMarkMouseOperate().hover\n    const preAnnotationHoverOperate = this._chartData.annotationMouseOperate()\n    let graphicMarkHoverOperate\n    let graphicMarkClickOperate\n    let annotationHoverOperate\n    if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n      lastGraphicMark.mouseMoveForDrawing(coordinate)\n      graphicMarkHoverOperate = lastGraphicMark.checkMousePointOnGraphic(coordinate)\n      graphicMarkClickOperate = {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    } else {\n      graphicMarkHoverOperate = this._performOverlayMouseHover(graphicMarks, preGraphicMarkHoverOperate, coordinate, event)\n      annotationHoverOperate = this._performOverlayMouseHover(visibleAnnotations, preAnnotationHoverOperate, coordinate, event)\n    }\n    this._chartData.setOverlayMouseOperate({\n      hover: graphicMarkHoverOperate || {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      },\n      click: graphicMarkClickOperate\n    }, annotationHoverOperate || { id: '' })\n    this._waitingForMouseMoveAnimationFrame = false\n  }\n\n  /**\n   * 鼠标按下事件\n   * @param event\n   */\n  mouseDownEvent (event) {\n    if (!this._checkEventPointX(event.localX) || !this._checkEventPointY(event.localY)) {\n      return\n    }\n    const coordinate = { x: event.localX, y: event.localY }\n    const graphicMarks = this._chartData.graphicMarks()\n    const lastGraphicMark = graphicMarks[graphicMarks.length - 1]\n    let graphicMarkHoverOperate = {\n      id: '',\n      element: GraphicMarkMouseOperateElement.NONE,\n      elementIndex: -1\n    }\n    let graphicMarkClickOperate\n    if (lastGraphicMark && lastGraphicMark.isDrawing()) {\n      lastGraphicMark.mouseLeftButtonDownForDrawing(coordinate)\n      graphicMarkClickOperate = lastGraphicMark.checkMousePointOnGraphic(coordinate)\n    } else {\n      for (const graphicMark of graphicMarks) {\n        graphicMarkClickOperate = graphicMark.checkMousePointOnGraphic(coordinate)\n        if (graphicMarkClickOperate) {\n          if (graphicMarkClickOperate.element === GraphicMarkMouseOperateElement.POINT) {\n            this._pressedGraphicMark = graphicMark\n            this._chartData.setDragGraphicMarkFlag(true)\n            graphicMarkHoverOperate = {\n              ...graphicMarkClickOperate\n            }\n          }\n          graphicMark.onClick({\n            id: graphicMarkClickOperate.id,\n            points: graphicMark.points(),\n            event\n          })\n          break\n        }\n      }\n      const visibleAnnotations = this._chartData.visibleAnnotations()\n      for (const annotation of visibleAnnotations) {\n        const annotationOperate = annotation.checkMousePointOnGraphic(coordinate)\n        if (annotationOperate) {\n          annotation.onClick({\n            id: annotationOperate.id,\n            points: annotation.points(),\n            event\n          })\n          break\n        }\n      }\n    }\n    this._chartData.setOverlayMouseOperate({\n      hover: graphicMarkHoverOperate,\n      click: graphicMarkClickOperate || {\n        id: '',\n        element: GraphicMarkMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    })\n  }\n\n  mouseRightDownEvent (event) {\n    const graphicMark = this._chartData.graphicMarks().find(gm => gm.checkMousePointOnGraphic({ x: event.localX, y: event.localY }))\n    if (graphicMark && !graphicMark.onRightClick({ id: graphicMark.id(), points: graphicMark.points(), event })) {\n      this._chartData.removeGraphicMarkInstance(graphicMark.id())\n    }\n    const annotation = this._chartData.visibleAnnotations().find(an => an.checkMousePointOnGraphic({ x: event.localX, y: event.localY }))\n    if (annotation) {\n      annotation.onRightClick({ id: annotation.id(), points: annotation.points(), event })\n    }\n  }\n\n  pressedMouseMoveEvent (event) {\n    const graphicMarks = this._chartData.graphicMarks()\n    const lastGraphicMark = graphicMarks[graphicMarks.length - 1]\n    if ((!lastGraphicMark || !lastGraphicMark.isDrawing()) && this._pressedGraphicMark) {\n      this._pressedGraphicMark.mousePressedMove({ x: event.localX, y: event.localY }, event)\n      this._chartData.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  _checkEventPointY (y) {\n    const size = this._paneContentSize[CANDLE_PANE_ID]\n    return y > size.contentTop && y < size.contentBottom\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler from './EventHandler'\n\nconst KeyBoardCode = {\n  EQUAL: 'Equal',\n  MINUS: 'Minus',\n  ARROW_LEFT: 'ArrowLeft',\n  ARROW_RIGHT: 'ArrowRight'\n}\n\nexport default class KeyBoardEventHandler extends EventHandler {\n  /**\n   * 键盘事件\n   * @param event\n   */\n  keyBoardDownEvent (event) {\n    if (event.shiftKey) {\n      switch (event.code) {\n        case KeyBoardCode.EQUAL: {\n          this._chartData.zoom(0.5)\n          break\n        }\n        case KeyBoardCode.MINUS: {\n          this._chartData.zoom(-0.5)\n          break\n        }\n        case KeyBoardCode.ARROW_LEFT: {\n          this._chartData.startScroll()\n          this._chartData.scroll(-3 * this._chartData.dataSpace())\n          break\n        }\n        case KeyBoardCode.ARROW_RIGHT: {\n          this._chartData.startScroll()\n          this._chartData.scroll(3 * this._chartData.dataSpace())\n          break\n        }\n        default: {\n          break\n        }\n      }\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventBase from './EventBase'\nimport ZoomScrollEventHandler from './ZoomScrollEventHandler'\nimport OverlayEventHandler from './OverlayEventHandler'\nimport KeyBoardEventHandler from './KeyBoardEventHandler'\n\nexport default class ChartEvent {\n  constructor (target, chartData) {\n    this._target = target\n    this._chartData = chartData\n    this._chartContentSize = {}\n    this._event = new EventBase(this._target, {\n      pinchStartEvent: this._pinchStartEvent.bind(this),\n      pinchEvent: this._pinchEvent.bind(this),\n      mouseUpEvent: this._mouseUpEvent.bind(this),\n      mouseClickEvent: this._mouseClickEvent.bind(this),\n      mouseDownEvent: this._mouseDownEvent.bind(this),\n      mouseRightDownEvent: this._mouseRightDownEvent.bind(this),\n      mouseLeaveEvent: this._mouseLeaveEvent.bind(this),\n      mouseMoveEvent: this._mouseMoveEvent.bind(this),\n      mouseWheelEvent: this._mouseWheelEvent.bind(this),\n      pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n      longTapEvent: this._longTapEvent.bind(this)\n    }, {\n      treatVertTouchDragAsPageScroll: false,\n      treatHorzTouchDragAsPageScroll: false\n    })\n    this._boundKeyBoardDownEvent = this._keyBoardDownEvent.bind(this)\n    this._target.addEventListener('keydown', this._boundKeyBoardDownEvent)\n    this._boundContextMenuEvent = (e) => { e.preventDefault() }\n    this._target.addEventListener('contextmenu', this._boundContextMenuEvent, false)\n    this._zoomScrollEventHandler = new ZoomScrollEventHandler(chartData)\n    this._overlayEventHandler = new OverlayEventHandler(chartData)\n    this._keyBoardEventHandler = new KeyBoardEventHandler(chartData)\n  }\n\n  _keyBoardDownEvent (event) {\n    this._keyBoardEventHandler.keyBoardDownEvent(event)\n  }\n\n  _pinchStartEvent () {\n    this._zoomScrollEventHandler.pinchStartEvent()\n  }\n\n  _pinchEvent (middlePoint, scale) {\n    this._zoomScrollEventHandler.pinchEvent(middlePoint, scale)\n  }\n\n  _mouseUpEvent (event) {\n    this._target.style.cursor = 'crosshair'\n    if (this._shouldPerformOverlayEvent()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._overlayEventHandler.mouseUpEvent(event)\n    }\n  }\n\n  _mouseLeaveEvent (event) {\n    if (this._checkZoomScroll()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._zoomScrollEventHandler.mouseLeaveEvent(event)\n    }\n  }\n\n  _mouseMoveEvent (event) {\n    event.localX -= this._chartContentSize.contentLeft\n    if (this._shouldPerformOverlayEvent()) {\n      this._overlayEventHandler.mouseMoveEvent(event)\n    }\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.mouseMoveEvent(event)\n    }\n  }\n\n  _mouseWheelEvent (event) {\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.mouseWheelEvent(event)\n    }\n  }\n\n  _mouseClickEvent (event) {\n    if (this._checkZoomScroll()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._zoomScrollEventHandler.mouseClickEvent(event)\n    }\n  }\n\n  _mouseDownEvent (event) {\n    this._target.style.cursor = 'pointer'\n    event.localX -= this._chartContentSize.contentLeft\n    if (this._shouldPerformOverlayEvent()) {\n      this._overlayEventHandler.mouseDownEvent(event)\n    }\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.mouseDownEvent(event)\n    }\n  }\n\n  _mouseRightDownEvent (event) {\n    if (this._shouldPerformOverlayEvent()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._overlayEventHandler.mouseRightDownEvent(event)\n    }\n  }\n\n  _pressedMouseMoveEvent (event) {\n    event.localX -= this._chartContentSize.contentLeft\n    if (this._chartData.dragGraphicMarkFlag()) {\n      this._overlayEventHandler.pressedMouseMoveEvent(event)\n      // 这里判断一下，如果是在拖拽图形标记，让十字光标不显示\n      if (this._chartData.crosshair().paneId) {\n        this._chartData.setCrosshair()\n      }\n    }\n    if (this._checkZoomScroll()) {\n      this._zoomScrollEventHandler.pressedMouseMoveEvent(event)\n    }\n  }\n\n  _longTapEvent (event) {\n    if (this._checkZoomScroll()) {\n      event.localX -= this._chartContentSize.contentLeft\n      this._zoomScrollEventHandler.longTapEvent(event)\n    }\n  }\n\n  _checkZoomScroll () {\n    const graphicMarks = this._chartData.graphicMarks()\n    const graphicMarkCount = graphicMarks.length\n    return !this._chartData.dragPaneFlag() && !this._chartData.dragGraphicMarkFlag() && (graphicMarkCount === 0 || !graphicMarks[graphicMarkCount - 1].isDrawing())\n  }\n\n  /**\n   * 是否需要处理图形标记事件\n   * @return {boolean}\n   * @private\n   */\n  _shouldPerformOverlayEvent () {\n    return this._chartData.graphicMarks().length > 0 || this._chartData.visibleAnnotations().length > 0\n  }\n\n  setChartContentSize (chartContentSize) {\n    this._chartContentSize = chartContentSize\n    this._zoomScrollEventHandler.setChartContentSize(chartContentSize)\n    this._overlayEventHandler.setChartContentSize(chartContentSize)\n  }\n\n  setPaneContentSize (paneContentSize) {\n    this._zoomScrollEventHandler.setPaneContentSize(paneContentSize)\n    this._overlayEventHandler.setPaneContentSize(paneContentSize)\n  }\n\n  destroy () {\n    this._event.destroy()\n    this._target.removeEventListener('keydown', this._boundKeyBoardDownEvent)\n    this._target.removeEventListener('contextmenu', this._boundContextMenuEvent)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function throttle (func, wait = 20) {\n  let previous = 0\n  return function () {\n    const now = Date.now()\n    const context = this\n    const args = arguments\n    if (now - previous > wait) {\n      func.apply(context, args)\n      previous = now\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 渲染填充菱形\n * @param ctx\n * @param color\n * @param centerPoint\n * @param width\n * @param height\n */\nexport function renderFillDiamond (ctx, color, centerPoint, width, height) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.moveTo(centerPoint.x - width / 2, centerPoint.y)\n  ctx.lineTo(centerPoint.x, centerPoint.y - height / 2)\n  ctx.lineTo(centerPoint.x + width / 2, centerPoint.y)\n  ctx.lineTo(centerPoint.x, centerPoint.y + height / 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 渲染填充菱形\n * @param ctx\n * @param color\n * @param centerPoint\n * @param width\n * @param height\n */\nexport function renderFillTriangle (ctx, color, centerPoint, width, height) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.moveTo(centerPoint.x - width / 2, centerPoint.y + height / 2)\n  ctx.lineTo(centerPoint.x, centerPoint.y - height / 2)\n  ctx.lineTo(centerPoint.x + width / 2, centerPoint.y + height / 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from '../Overlay'\n\nimport { renderFillCircle } from '../../../renderer/circle'\nimport { renderFillRect } from '../../../renderer/rect'\nimport { renderFillDiamond } from '../../../renderer/diamond'\nimport { renderFillTriangle } from '../../../renderer/triangle'\nimport {\n  checkPointInCircle, checkPointInDiamond,\n  checkPointInRect, checkPointInTriangle\n} from '../../../extension/mark/graphicHelper'\n\nimport { isNumber } from '../../../utils/typeChecks'\n\nimport {\n  OverlayPosition,\n  AnnotationSymbolType\n} from '../../../data/options/styleOptions'\n\n/**\n * 注解\n */\nexport default class Annotation extends Overlay {\n  constructor ({\n    id, point, chartData, xAxis, yAxis, styles\n  }) {\n    super({ id, chartData, xAxis, yAxis })\n    this._point = point\n    this._symbolCoordinate = {}\n    this.setStyles(styles, chartData.styleOptions().annotation)\n  }\n\n  /**\n   * 绘制标识\n   * @param ctx\n   * @param isActive\n   * @param styles\n   * @private\n   */\n  _drawSymbol (ctx, isActive, styles) {\n    const barSpace = this._chartData.barSpace()\n    const symbolOptions = styles.symbol\n    const styleSize = symbolOptions.size\n    const styleActiveSize = symbolOptions.activeSize\n    const size = isActive\n      ? (isNumber(styleActiveSize) ? styleActiveSize : barSpace)\n      : (isNumber(styleSize) ? styleSize : barSpace)\n    const color = isActive ? symbolOptions.activeColor : symbolOptions.color\n    switch (symbolOptions.type) {\n      case AnnotationSymbolType.CIRCLE: {\n        renderFillCircle(ctx, color, this._symbolCoordinate, size / 2)\n        break\n      }\n      case AnnotationSymbolType.RECT: {\n        renderFillRect(\n          ctx, color,\n          this._symbolCoordinate.x - size / 2,\n          this._symbolCoordinate.y - size / 2,\n          size, size\n        )\n        break\n      }\n      case AnnotationSymbolType.DIAMOND: {\n        renderFillDiamond(ctx, color, this._symbolCoordinate, size, size)\n        break\n      }\n      case AnnotationSymbolType.TRIANGLE: {\n        renderFillTriangle(ctx, color, this._symbolCoordinate, size, size)\n        break\n      }\n      case AnnotationSymbolType.CUSTOM: {\n        ctx.save()\n        this.drawCustomSymbol({\n          ctx,\n          point: this._point,\n          coordinate: this._symbolCoordinate,\n          viewport: {\n            width: this._xAxis.width(),\n            height: this._yAxis.height(),\n            barSpace\n          },\n          styles: symbolOptions,\n          isActive\n        })\n        ctx.restore()\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  draw (ctx) {\n    const styles = this._styles || this._chartData.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const offset = symbolOptions.offset || []\n    let y = 0\n    switch (symbolOptions.position) {\n      case OverlayPosition.POINT: {\n        y = this._yAxis.convertToPixel(this._point.price)\n        break\n      }\n      case OverlayPosition.TOP: {\n        y = 0\n        break\n      }\n      case OverlayPosition.BOTTOM: {\n        y = this._yAxis.height()\n        break\n      }\n    }\n    this._symbolCoordinate.y = y + (offset[1] || 0)\n    const isActive = this._id === this._chartData.annotationMouseOperate().id\n    this._drawSymbol(ctx, isActive, styles)\n    if (this.drawExtend) {\n      ctx.save()\n      this.drawExtend({\n        ctx,\n        point: this._point,\n        coordinate: this._symbolCoordinate,\n        viewport: {\n          width: this._xAxis.width(),\n          height: this._yAxis.height()\n        },\n        styles,\n        isActive\n      })\n      ctx.restore()\n    }\n  }\n\n  checkMousePointOnGraphic (mouseCoordinate) {\n    const barSpace = this._chartData.barSpace()\n    const styles = this._styles || this._chartData.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const size = isNumber(symbolOptions.size) ? symbolOptions.size : barSpace\n    let isOn\n    switch (symbolOptions.type) {\n      case AnnotationSymbolType.CIRCLE: {\n        isOn = checkPointInCircle(this._symbolCoordinate, size / 2, mouseCoordinate)\n        break\n      }\n      case AnnotationSymbolType.RECT: {\n        const coordinate1 = { x: this._symbolCoordinate.x - size / 2, y: this._symbolCoordinate.y - size / 2 }\n        const coordinate2 = { x: this._symbolCoordinate.x + size / 2, y: this._symbolCoordinate.y + size / 2 }\n        isOn = checkPointInRect(coordinate1, coordinate2, mouseCoordinate)\n        break\n      }\n      case AnnotationSymbolType.DIAMOND: {\n        isOn = checkPointInDiamond(this._symbolCoordinate, size, size, mouseCoordinate)\n        break\n      }\n      case AnnotationSymbolType.TRIANGLE: {\n        isOn = checkPointInTriangle(\n          [\n            { x: this._symbolCoordinate.x - size / 2, y: this._symbolCoordinate.y + size / 2 },\n            { x: this._symbolCoordinate.x, y: this._symbolCoordinate.y - size / 2 },\n            { x: this._symbolCoordinate.x + size / 2, y: this._symbolCoordinate.y + size / 2 }\n          ],\n          mouseCoordinate\n        )\n        break\n      }\n      case AnnotationSymbolType.CUSTOM: {\n        isOn = this.checkPointInCustomSymbol({\n          mouseCoordinate,\n          coordinate: this._symbolCoordinate,\n          size\n        })\n        break\n      }\n      default: {\n        break\n      }\n    }\n    if (isOn) {\n      return {\n        id: this._id,\n        instance: this\n      }\n    }\n  }\n\n  /**\n   * 生成标识坐标\n   * @param x\n   */\n  createSymbolCoordinate (x) {\n    const styles = this._styles || this._chartData.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const offset = symbolOptions.offset || []\n    this._symbolCoordinate = { x: x + (offset[0] || 0) }\n  }\n\n  /**\n   * 获取点\n   * @return {*}\n   */\n  points () {\n    return this._point\n  }\n\n  /**\n   * 检查鼠标点是否在自定义标识内\n   * @param mouseCoordinate\n   * @param coordinate\n   * @param size\n   */\n  checkPointInCustomSymbol ({ mouseCoordinate, coordinate, size }) {}\n\n  /**\n   * 绘制自定义标识\n   * @param ctx\n   * @param point\n   * @param coordinate\n   * @param viewport\n   * @param styles\n   * @param isActive\n   */\n  drawCustomSymbol ({ ctx, point, coordinate, viewport, styles, isActive }) {}\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from '../Overlay'\nimport { LineStyle, OverlayPosition, YAxisPosition } from '../../../data/options/styleOptions'\nimport { renderHorizontalLine } from '../../../renderer/line'\nimport { isValid, isObject } from '../../../utils/typeChecks'\nimport { calcTextWidth, createFont } from '../../../utils/canvas'\nimport { renderFillRoundRect } from '../../../renderer/rect'\nimport { renderText } from '../../../renderer/text'\n\nexport default class Tag extends Overlay {\n  constructor ({\n    id, point, text, mark, chartData, xAxis, yAxis, styles\n  }) {\n    super({ id, chartData, xAxis, yAxis })\n    this._point = point || {}\n    this._text = text\n    this._mark = mark\n    this.setStyles(styles, chartData.styleOptions().tag)\n  }\n\n  /**\n   * 更新\n   * @param point\n   * @param text\n   * @param mark\n   * @param styles\n   * @return {boolean}\n   */\n  update ({ point, text, mark, styles }) {\n    let success = false\n    if (isObject(point)) {\n      this._point = point\n      success = true\n    }\n    if (isValid(text)) {\n      this._text = text\n      success = true\n    }\n    if (isValid(mark)) {\n      this._mark = mark\n      success = true\n    }\n    if (this.setStyles(styles, this._chartData.styleOptions().tag)) {\n      success = true\n    }\n    return success\n  }\n\n  /**\n   * 绘制标记和线\n   * @param ctx\n   */\n  drawMarkLine (ctx) {\n    const options = this._chartData.styleOptions()\n    const yAxisOptions = options.yAxis\n    const tagOptions = this._styles || options.tag\n    const y = this._getY(tagOptions)\n    ctx.save()\n    this._drawLine(ctx, y, tagOptions.line)\n    this._drawMark(ctx, y, tagOptions, yAxisOptions)\n    ctx.restore()\n  }\n\n  /**\n   * 绘制值\n   */\n  drawText (ctx) {\n    if (!isValid(this._text)) {\n      return\n    }\n    const options = this._chartData.styleOptions()\n    const tagOptions = this._styles || options.tag\n    const tagTextOptions = tagOptions.text\n    ctx.save()\n    ctx.font = createFont(tagTextOptions.size, tagTextOptions.weight, tagTextOptions.family)\n    const rectWidth = this._getTextRectWidth(ctx, tagTextOptions)\n    const rectHeight = tagTextOptions.paddingTop + tagTextOptions.paddingBottom + tagTextOptions.size\n    let x\n    if (this._yAxis.isFromYAxisZero()) {\n      x = 0\n    } else {\n      x = this._yAxis.width() - rectWidth\n    }\n    const y = this._getY(tagOptions)\n    renderFillRoundRect(\n      ctx,\n      tagTextOptions.backgroundColor,\n      x,\n      y - rectHeight / 2,\n      rectWidth,\n      rectHeight,\n      tagTextOptions.borderRadius\n    )\n    renderText(ctx, tagTextOptions.color, x + tagTextOptions.paddingLeft, y, this._text)\n    ctx.restore()\n  }\n\n  /**\n   * 绘制线\n   * @param ctx\n   * @param y\n   * @param tagLineOptions\n   * @private\n   */\n  _drawLine (ctx, y, tagLineOptions) {\n    if (!tagLineOptions.show) {\n      return\n    }\n    ctx.strokeStyle = tagLineOptions.color\n    ctx.lineWidth = tagLineOptions.size\n    if (tagLineOptions.style === LineStyle.DASH) {\n      ctx.setLineDash(tagLineOptions.dashValue)\n    }\n    renderHorizontalLine(ctx, y, 0, this._xAxis.width())\n  }\n\n  /**\n   * 绘制标记\n   * @param ctx\n   * @param y\n   * @param tagOptions\n   * @param yAxisOptions\n   * @private\n   */\n  _drawMark (ctx, y, tagOptions, yAxisOptions) {\n    if (!isValid(this._mark)) {\n      return\n    }\n    const tagMarkOptions = tagOptions.mark\n    ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family)\n    const rectWidth = tagMarkOptions.paddingLeft + tagMarkOptions.paddingRight + calcTextWidth(ctx, this._mark)\n    const rectHeight = tagMarkOptions.paddingTop + tagMarkOptions.paddingBottom + tagMarkOptions.size\n    let x\n    if (yAxisOptions.inside) {\n      let valueRectWidth = 0\n      if (isValid(this._text)) {\n        valueRectWidth = this._getTextRectWidth(ctx, tagOptions.text)\n      }\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        x = valueRectWidth\n      } else {\n        x = this._xAxis.width() - valueRectWidth - rectWidth\n      }\n    } else {\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        x = 0\n      } else {\n        x = this._xAxis.width() - rectWidth\n      }\n    }\n    renderFillRoundRect(\n      ctx,\n      tagMarkOptions.backgroundColor,\n      x,\n      y - rectHeight / 2,\n      rectWidth,\n      rectHeight,\n      tagMarkOptions.borderRadius\n    )\n    ctx.textBaseline = 'middle'\n    ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family)\n    renderText(ctx, tagMarkOptions.color, x + tagMarkOptions.paddingLeft, y, this._mark)\n  }\n\n  /**\n   * 获取坐标y值\n   * @param tagOptions\n   * @return {*}\n   * @private\n   */\n  _getY (tagOptions) {\n    const offset = tagOptions.offset\n    switch (tagOptions.position) {\n      case OverlayPosition.TOP: {\n        return offset\n      }\n      case OverlayPosition.BOTTOM: {\n        return this._yAxis.height() + offset\n      }\n      default: {\n        return this._yAxis.convertToNicePixel(this._point.price) + offset\n      }\n    }\n  }\n\n  /**\n   * 获取值的矩形宽度\n   * @param ctx\n   * @param textOptions\n   * @return {*}\n   * @private\n   */\n  _getTextRectWidth (ctx, textOptions) {\n    ctx.font = createFont(textOptions.size, textOptions.weight, textOptions.family)\n    return textOptions.paddingLeft + textOptions.paddingRight + calcTextWidth(ctx, this._text)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChartData from '../data/ChartData'\nimport { createTechnicalIndicatorInfo } from '../base/technicalindicator/technicalIndicatorControl'\n\nimport CandlePane from './CandlePane'\nimport XAxisPane from './XAxisPane'\n\nimport { YAxisPosition } from '../data/options/styleOptions'\nimport { isArray, isBoolean, isFunction, isValid, isNumber } from '../utils/typeChecks'\nimport { formatValue } from '../utils/format'\nimport TechnicalIndicatorPane from './TechnicalIndicatorPane'\nimport SeparatorPane from './SeparatorPane'\n\nimport ChartEvent from '../event/ChartEvent'\nimport { getPixelRatio } from '../utils/canvas'\nimport { throttle } from '../utils/performance'\nimport Annotation from '../base/overlay/annotation/Annotation'\nimport Tag from '../base/overlay/tag/Tag'\n\nimport {\n  CANDLE_PANE_ID,\n  DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT,\n  TECHNICAL_INDICATOR_PANE_ID_PREFIX,\n  GRAPHIC_MARK_ID_PREFIX,\n  ActionType, InvalidateLevel\n} from '../data/constants'\n\nexport default class ChartPane {\n  constructor (container, styleOptions) {\n    this._initChartContainer(container)\n    this._graphicMarkBaseId = 0\n    this._paneBaseId = 0\n    this._separatorDragStartTopPaneHeight = 0\n    this._separatorDragStartBottomPaneHeight = 0\n    this._chartData = new ChartData(styleOptions, {\n      invalidate: this._invalidatePane.bind(this),\n      crosshair: this._crosshairObserver.bind(this)\n    })\n    this._xAxisPane = new XAxisPane({ container: this._chartContainer, chartData: this._chartData })\n    this._panes = new Map([[CANDLE_PANE_ID, new CandlePane({\n      container: this._chartContainer,\n      chartData: this._chartData,\n      xAxis: this._xAxisPane.xAxis(),\n      id: CANDLE_PANE_ID\n    })]])\n    this._separators = new Map()\n    this._chartWidth = {}\n    this._chartHeight = {}\n    this._chartEvent = new ChartEvent(this._chartContainer, this._chartData)\n    this.adjustPaneViewport(true, true, true)\n  }\n\n  /**\n   * 初始化图表容器\n   * @param container\n   * @private\n   */\n  _initChartContainer (container) {\n    this._container = container\n    this._chartContainer = document.createElement('div')\n    this._chartContainer.style.userSelect = 'none'\n    this._chartContainer.style.webkitUserSelect = 'none'\n    this._chartContainer.style.msUserSelect = 'none'\n    this._chartContainer.style.MozUserSelect = 'none'\n    this._chartContainer.style.webkitTapHighlightColor = 'transparent'\n    this._chartContainer.style.position = 'relative'\n    this._chartContainer.style.outline = 'none'\n    this._chartContainer.style.borderStyle = 'none'\n    this._chartContainer.style.width = '100%'\n    this._chartContainer.style.cursor = 'crosshair'\n    this._chartContainer.tabIndex = 1\n    container.appendChild(this._chartContainer)\n  }\n\n  /**\n   * 十字光标观察者\n   * @private\n   */\n  _crosshairObserver ({ dataIndex, kLineData, x, y }) {\n    if (this.chartData().hasAction(ActionType.CROSSHAIR)) {\n      const technicalIndicatorData = {}\n      this._panes.forEach((pane, id) => {\n        const data = {}\n        pane.technicalIndicators().forEach(tech => {\n          const result = tech.result\n          data[tech.name] = result[dataIndex]\n        })\n        technicalIndicatorData[id] = data\n      })\n      this._chartData.actionExecute(ActionType.CROSSHAIR, {\n        coordinate: { x, y },\n        dataIndex,\n        kLineData,\n        technicalIndicatorData\n      })\n    }\n  }\n\n  /**\n   * 分割线拖拽开始\n   * @param topPaneId\n   * @param bottomPaneId\n   * @private\n   */\n  _separatorStartDrag (topPaneId, bottomPaneId) {\n    this._separatorDragStartTopPaneHeight = this._panes.get(topPaneId).height()\n    this._separatorDragStartBottomPaneHeight = this._panes.get(bottomPaneId).height()\n  }\n\n  /**\n   * 分割线拖拽\n   * @param dragDistance\n   * @param topPaneId\n   * @param bottomPaneId\n   * @private\n   */\n  _separatorDrag (dragDistance, topPaneId, bottomPaneId) {\n    let topPaneHeight = this._separatorDragStartTopPaneHeight + dragDistance\n    let bottomPaneHeight = this._separatorDragStartBottomPaneHeight - dragDistance\n    if (topPaneHeight > this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight) {\n      topPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight\n      bottomPaneHeight = 0\n    }\n    if (topPaneHeight < 0) {\n      topPaneHeight = 0\n      bottomPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight\n    }\n    this._panes.get(topPaneId).setHeight(topPaneHeight)\n    this._panes.get(bottomPaneId).setHeight(bottomPaneHeight)\n    this._chartData.actionExecute(ActionType.PANE_DRAG, { topPaneId, bottomPaneId, topPaneHeight, bottomPaneHeight })\n    this.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 更新所有pane\n   * @private\n   */\n  _invalidatePane (invalidateLevel = InvalidateLevel.FULL) {\n    if (invalidateLevel === InvalidateLevel.OVERLAY) {\n      this._xAxisPane.invalidate(invalidateLevel)\n      this._panes.forEach((pane) => {\n        pane.invalidate(invalidateLevel)\n      })\n    } else {\n      let shouldMeasureWidth = false\n      this._panes.forEach((pane) => {\n        const should = pane.yAxis().computeAxis()\n        if (should) {\n          shouldMeasureWidth = should\n        }\n      })\n      this.adjustPaneViewport(false, shouldMeasureWidth, true)\n    }\n  }\n\n  /**\n   * 计算所有pane的指标\n   * @private\n   */\n  _calcAllPaneTechnicalIndicator () {\n    const tasks = []\n    this._panes.forEach(pane => {\n      tasks.push(\n        Promise.resolve(pane.calcAllTechnicalIndicator())\n      )\n    })\n    Promise.all(tasks).then(\n      result => {\n        const shouldMeasureWidth = result.indexOf(true) > -1\n        this.adjustPaneViewport(false, shouldMeasureWidth, true)\n      }\n    )\n  }\n\n  /**\n   * 测量pane高度\n   * @private\n   */\n  _measurePaneHeight () {\n    const styleOptions = this._chartData.styleOptions()\n    const paneHeight = this._container.offsetHeight\n    const separatorSize = styleOptions.separator.size\n    const separatorTotalHeight = separatorSize * this._separators.size\n    const xAxisHeight = this._xAxisPane.xAxis().getSelfHeight()\n    const paneExcludeXAxisSeparatorHeight = paneHeight - xAxisHeight - separatorTotalHeight\n    let techPaneTotalHeight = 0\n    this._panes.forEach(pane => {\n      if (pane.id() !== CANDLE_PANE_ID) {\n        const paneHeight = pane.height()\n        if (techPaneTotalHeight + paneHeight > paneExcludeXAxisSeparatorHeight) {\n          pane.setHeight(paneExcludeXAxisSeparatorHeight - techPaneTotalHeight)\n          techPaneTotalHeight = paneExcludeXAxisSeparatorHeight\n        } else {\n          techPaneTotalHeight += paneHeight\n        }\n      }\n    })\n\n    const candlePaneHeight = paneExcludeXAxisSeparatorHeight - techPaneTotalHeight\n\n    const paneContentSize = {}\n    paneContentSize[CANDLE_PANE_ID] = { contentTop: 0, contentBottom: candlePaneHeight }\n    let contentTop = candlePaneHeight\n    let contentBottom = candlePaneHeight\n    this._panes.get(CANDLE_PANE_ID).setHeight(candlePaneHeight)\n    this._chartHeight[CANDLE_PANE_ID] = candlePaneHeight\n    this._panes.forEach(pane => {\n      if (pane.id() !== CANDLE_PANE_ID) {\n        const paneHeight = pane.height()\n        contentBottom += (paneHeight + separatorSize)\n        paneContentSize[pane.id()] = { contentTop, contentBottom }\n        this._chartHeight[pane.id()] = paneHeight\n        contentTop = contentBottom\n      }\n    })\n    this._xAxisPane.setHeight(xAxisHeight)\n    this._chartHeight.xAxis = xAxisHeight\n    this._chartHeight.total = paneHeight\n    this._chartEvent.setPaneContentSize(paneContentSize)\n  }\n\n  /**\n   * 测量pan宽度\n   * @private\n   */\n  _measurePaneWidth () {\n    const styleOptions = this._chartData.styleOptions()\n    const yAxisOptions = styleOptions.yAxis\n    const isYAxisLeft = yAxisOptions.position === YAxisPosition.LEFT\n    const isOutside = !yAxisOptions.inside\n    const paneWidth = this._container.offsetWidth\n    let mainWidth\n    let yAxisWidth = Number.MIN_SAFE_INTEGER\n    let yAxisOffsetLeft\n    let mainOffsetLeft\n    if (isOutside) {\n      this._panes.forEach(pane => {\n        yAxisWidth = Math.max(yAxisWidth, pane.yAxis().getSelfWidth())\n      })\n      mainWidth = paneWidth - yAxisWidth\n      if (isYAxisLeft) {\n        yAxisOffsetLeft = 0\n        mainOffsetLeft = yAxisWidth\n      } else {\n        mainOffsetLeft = 0\n        yAxisOffsetLeft = paneWidth - yAxisWidth\n      }\n    } else {\n      mainWidth = paneWidth\n      yAxisWidth = paneWidth\n      yAxisOffsetLeft = 0\n      mainOffsetLeft = 0\n    }\n\n    this._chartData.setTotalDataSpace(mainWidth)\n\n    this._panes.forEach((pane, paneId) => {\n      pane.setWidth(mainWidth, yAxisWidth)\n      pane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft)\n      const separator = this._separators.get(paneId)\n      separator && separator.setSize(mainOffsetLeft, mainWidth)\n    })\n    this._chartWidth = { content: mainWidth, yAxis: yAxisWidth, total: paneWidth }\n    this._xAxisPane.setWidth(mainWidth, yAxisWidth)\n    this._xAxisPane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft)\n    this._chartEvent.setChartContentSize({ contentLeft: mainOffsetLeft, contentRight: mainOffsetLeft + mainWidth })\n  }\n\n  /**\n   * 调整窗口尺寸\n   * @param shouldMeasureHeight\n   * @param shouldMeasureWidth\n   * @param shouldLayout\n   * @param shouldComputeAxis\n   * @param shouldForceComputeAxis\n   */\n  adjustPaneViewport (\n    shouldMeasureHeight, shouldMeasureWidth, shouldLayout, shouldComputeAxis, shouldForceComputeAxis\n  ) {\n    if (shouldMeasureHeight) {\n      this._measurePaneHeight()\n    }\n    let isAdjust = false\n    if (shouldComputeAxis) {\n      this._panes.forEach(pane => {\n        const adjust = pane.yAxis().computeAxis(shouldForceComputeAxis)\n        if (!isAdjust) {\n          isAdjust = adjust\n        }\n      })\n    }\n    if ((!shouldComputeAxis && shouldMeasureWidth) || (shouldComputeAxis && isAdjust)) {\n      this._measurePaneWidth()\n    }\n    if (shouldLayout) {\n      this._xAxisPane.xAxis().computeAxis(true)\n      this._xAxisPane.layout()\n      this._panes.forEach(pane => {\n        pane.layout()\n      })\n    }\n  }\n\n  /**\n   * 获取图表上的数据\n   * @returns {ChartData}\n   */\n  chartData () {\n    return this._chartData\n  }\n\n  /**\n   * 覆盖技术指标\n   * @param techInstance\n   * @param name\n   * @param calcParams\n   * @param calcParamsAllowDecimal\n   * @param precision\n   * @param styles\n   */\n  overrideTechnicalIndicator (techInstance, { name, calcParams, calcParamsAllowDecimal, precision, styles }) {\n    techInstance.setCalcParamsAllowDecimal(calcParamsAllowDecimal)\n    const calcParamsSuccess = techInstance.setCalcParams(calcParams)\n    const precisionSuccess = techInstance.setPrecision(precision)\n    const defaultTechnicalStyleOptions = this._chartData.styleOptions().technicalIndicator\n    const styleSuccess = techInstance.setStyles(styles, defaultTechnicalStyleOptions)\n    if (calcParamsSuccess || precisionSuccess || styleSuccess) {\n      let shouldAdjust = false\n      const tasks = []\n      this._panes.forEach(pane => {\n        const techs = pane.technicalIndicators()\n        if (techs.has(name)) {\n          shouldAdjust = true\n          const tech = techs.get(name)\n          if (calcParamsSuccess) {\n            tasks.push(\n              Promise.resolve(pane.calcTechnicalIndicator(tech))\n            )\n          }\n        }\n      })\n      if (shouldAdjust) {\n        Promise.all(tasks).then(\n          _ => {\n            this.adjustPaneViewport(false, true, true, true)\n          }\n        )\n      }\n    }\n  }\n\n  /**\n   * 处理数组数据\n   * @param dataList\n   * @param more\n   * @param extendFun\n   * @private\n   */\n  _applyDataList (dataList, more, extendFun) {\n    if (isArray(dataList)) {\n      if (isFunction(extendFun)) {\n        extendFun()\n      }\n      this._chartData.addData(dataList, 0, more)\n      this._calcAllPaneTechnicalIndicator()\n    }\n  }\n\n  /**\n   * 添加新数据\n   * @param dataList\n   * @param more\n   */\n  applyNewData (dataList, more) {\n    this._applyDataList(dataList, more, () => {\n      this._chartData.clearDataList()\n    })\n  }\n\n  /**\n   * 添加更多数据\n   * @param dataList\n   * @param more\n   */\n  applyMoreData (dataList, more) {\n    this._applyDataList(dataList, more)\n  }\n\n  /**\n   * 更新数据\n   * @param data\n   */\n  updateData (data) {\n    const dataList = this._chartData.dataList()\n    const dataSize = dataList.length\n    // 这里判断单个数据应该添加到哪个位置\n    const timestamp = formatValue(data, 'timestamp', 0)\n    const lastDataTimestamp = formatValue(dataList[dataSize - 1], 'timestamp', 0)\n    if (timestamp >= lastDataTimestamp) {\n      let pos = dataSize\n      if (timestamp === lastDataTimestamp) {\n        pos = dataSize - 1\n      }\n      this._chartData.addData(data, pos)\n      this._calcAllPaneTechnicalIndicator()\n    }\n  }\n\n  /**\n   * 移除指标\n   * @param paneId\n   * @param name\n   */\n  removeTechnicalIndicator (paneId, name) {\n    if (this._panes.has(paneId)) {\n      if (paneId === CANDLE_PANE_ID) {\n        if (this._panes.get(CANDLE_PANE_ID).removeTechnicalIndicator(name)) {\n          this.adjustPaneViewport(false, true, true, true)\n        }\n      } else {\n        const pane = this._panes.get(paneId)\n        const removed = pane.removeTechnicalIndicator(name)\n        if (pane.isEmptyTechnicalIndicator()) {\n          pane.destroy()\n          const deleteSeparatorTopPaneId = this._separators.get(paneId).topPaneId()\n          this._separators.get(paneId).destroy()\n          this._panes.delete(paneId)\n          this._separators.delete(paneId)\n          this._separators.forEach(separator => {\n            const topPaneId = separator.topPaneId()\n            if (!this._separators.has(topPaneId)) {\n              separator.updatePaneId(deleteSeparatorTopPaneId)\n            }\n          })\n          this.adjustPaneViewport(true, true, true, true, true)\n        } else {\n          if (removed) {\n            this.adjustPaneViewport(false, true, true, true)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * 设置指标类型\n   * @param tech 技术指标实例\n   * @param isStack 是否覆盖\n   * @param options 配置\n   */\n  createTechnicalIndicator (tech, isStack, options = {}) {\n    if (this._panes.has(options.id)) {\n      this.setPaneOptions(options, this._panes.get(options.id).setTechnicalIndicator(tech, isStack))\n      return options.id\n    }\n    const id = options.id || `${TECHNICAL_INDICATOR_PANE_ID_PREFIX}${++this._paneBaseId}`\n    const dragEnabled = isBoolean(options.dragEnabled) ? options.dragEnabled : true\n    this._separators.set(id, new SeparatorPane(\n      this._chartContainer,\n      this._chartData,\n      Array.from(this._panes.keys()).pop(),\n      id,\n      dragEnabled,\n      {\n        startDrag: this._separatorStartDrag.bind(this),\n        drag: throttle(this._separatorDrag.bind(this), 50)\n      }\n    ))\n    this._panes.set(id,\n      new TechnicalIndicatorPane({\n        container: this._chartContainer,\n        chartData: this._chartData,\n        xAxis: this._xAxisPane.xAxis(),\n        name: tech.name,\n        id,\n        height: options.height || DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT\n      })\n    )\n    this.adjustPaneViewport(true, true, true, true, true)\n    return id\n  }\n\n  /**\n   * 获取窗口技术指标\n   * @param paneId\n   * @return {{}}\n   */\n  getPaneTechnicalIndicator (paneId) {\n    const technicalIndicatorInfo = (pane) => {\n      const paneTechs = {}\n      pane.technicalIndicators().forEach(tech => {\n        paneTechs[tech.name] = createTechnicalIndicatorInfo(tech)\n      })\n      return paneTechs\n    }\n\n    if (isValid(paneId)) {\n      if (this._panes.has(paneId)) {\n        return technicalIndicatorInfo(this._panes.get(paneId))\n      }\n    } else {\n      const techs = {}\n      this._panes.forEach(pane => {\n        techs[pane.id()] = technicalIndicatorInfo(pane)\n      })\n      return techs\n    }\n    return {}\n  }\n\n  /**\n   * 创建图形标记\n   * @param GraphicMark\n   * @param options\n   */\n  createGraphicMark (GraphicMark, options = {}) {\n    const {\n      id, points, styles, lock,\n      onDrawStart, onDrawing,\n      onDrawEnd, onClick,\n      onRightClick, onPressedMove,\n      onMouseEnter, onMouseLeave,\n      onRemove\n    } = options\n    const graphicMarkId = id || `${GRAPHIC_MARK_ID_PREFIX}${++this._graphicMarkBaseId}`\n    const graphicMarkInstance = new GraphicMark({\n      id: graphicMarkId,\n      chartData: this._chartData,\n      xAxis: this._xAxisPane.xAxis(),\n      yAxis: this._panes.get(CANDLE_PANE_ID).yAxis(),\n      points,\n      styles,\n      lock\n    })\n    if (isFunction(onDrawStart)) {\n      graphicMarkInstance.onDrawStart = onDrawStart\n      graphicMarkInstance.onDrawStart({ id: graphicMarkId })\n    }\n    if (isFunction(onDrawing)) {\n      graphicMarkInstance.onDrawing = onDrawing\n    }\n    if (isFunction(onDrawEnd)) {\n      graphicMarkInstance.onDrawEnd = onDrawEnd\n    }\n    if (isFunction(onClick)) {\n      graphicMarkInstance.onClick = onClick\n    }\n    if (isFunction(onRightClick)) {\n      graphicMarkInstance.onRightClick = onRightClick\n    }\n    if (isFunction(onPressedMove)) {\n      graphicMarkInstance.onPressedMove = onPressedMove\n    }\n    if (isFunction(onMouseEnter)) {\n      graphicMarkInstance.onMouseEnter = onMouseEnter\n    }\n    if (isFunction(onMouseLeave)) {\n      graphicMarkInstance.onMouseLeave = onMouseLeave\n    }\n    if (isFunction(onRemove)) {\n      graphicMarkInstance.onRemove = onRemove\n    }\n    if (this._chartData.addGraphicMarkInstance(graphicMarkInstance)) {\n      return graphicMarkId\n    }\n  }\n\n  /**\n   * 创建注解\n   * @param annotations\n   */\n  createAnnotation (annotations) {\n    const instances = []\n    annotations.forEach(({\n      point,\n      styles,\n      checkPointInCustomSymbol,\n      drawCustomSymbol,\n      drawExtend,\n      onClick,\n      onRightClick,\n      onMouseEnter,\n      onMouseLeave\n    }) => {\n      if (point && point.timestamp) {\n        const annotationInstance = new Annotation({\n          id: point.timestamp,\n          chartData: this._chartData,\n          point,\n          xAxis: this._xAxisPane.xAxis(),\n          yAxis: this._panes.get(CANDLE_PANE_ID).yAxis(),\n          styles\n        })\n        if (isFunction(drawExtend)) {\n          annotationInstance.drawExtend = drawExtend\n        }\n        if (isFunction(checkPointInCustomSymbol)) {\n          annotationInstance.checkPointInCustomSymbol = checkPointInCustomSymbol\n        }\n        if (isFunction(drawCustomSymbol)) {\n          annotationInstance.drawCustomSymbol = drawCustomSymbol\n        }\n        if (isFunction(onClick)) {\n          annotationInstance.onClick = onClick\n        }\n        if (isFunction(onRightClick)) {\n          annotationInstance.onRightClick = onRightClick\n        }\n        if (isFunction(onMouseEnter)) {\n          annotationInstance.onMouseEnter = onMouseEnter\n        }\n        if (isFunction(onMouseLeave)) {\n          annotationInstance.onMouseLeave = onMouseLeave\n        }\n        instances.push(annotationInstance)\n      }\n    })\n    if (instances.length > 0) {\n      this._chartData.addAnnotations(instances)\n    }\n  }\n\n  /**\n   * 创建标签\n   * @param tags\n   */\n  createTag (tags) {\n    const instances = []\n    let shouldUpdate = false\n    let shouldAdd = false\n    tags.forEach(({ id, point, text, mark, styles }) => {\n      if (isValid(id)) {\n        const tag = this._chartData.getTag(id)\n        if (tag) {\n          const updateSuccess = tag.update({ point, text, mark, styles })\n          if (!shouldUpdate) {\n            shouldUpdate = updateSuccess\n          }\n        } else {\n          shouldAdd = true\n          instances.push(new Tag({\n            id,\n            point,\n            text,\n            mark,\n            styles,\n            chartData: this._chartData,\n            xAxis: this._xAxisPane.xAxis(),\n            yAxis: this._panes.get(CANDLE_PANE_ID).yAxis()\n          }))\n        }\n      }\n    })\n    if (shouldAdd) {\n      this._chartData.addTags(instances)\n    } else {\n      if (shouldUpdate) {\n        this._invalidatePane(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 设置窗体参数\n   * @param options\n   * @param forceShouldAdjust\n   */\n  setPaneOptions (options, forceShouldAdjust) {\n    let shouldAdjust = forceShouldAdjust\n    let shouldMeasureHeight = false\n    if (options.id !== CANDLE_PANE_ID) {\n      const pane = this._panes.get(options.id)\n      if (pane) {\n        if (isNumber(options.height) && options.height > 0 && pane.height() !== options.height) {\n          shouldAdjust = true\n          pane.setHeight(options.height)\n          shouldMeasureHeight = true\n        }\n        if (isBoolean(options.dragEnabled)) {\n          this._separators.get(options.id).setDragEnabled(options.dragEnabled)\n        }\n      }\n    }\n    if (shouldAdjust) {\n      this.adjustPaneViewport(shouldMeasureHeight, true, true, true)\n    }\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    this._chartData.setTimezone(timezone)\n    this._xAxisPane.xAxis().computeAxis(true)\n    this._xAxisPane.invalidate(InvalidateLevel.FULL)\n  }\n\n  /**\n   * 将值装换成像素\n   * @param timestamp\n   * @param value\n   * @param paneId\n   * @param dataIndexXAxis\n   * @param absoluteYAxis\n   */\n  convertToPixel (value, { paneId = CANDLE_PANE_ID, dataIndexXAxis, absoluteYAxis }) {\n    const values = [].concat(value)\n    let coordinates = []\n    const separatorSize = this._chartData.styleOptions().separator.size\n    let absoluteTop = 0\n    const panes = this._panes.values()\n    for (const pane of panes) {\n      if (pane.id() === paneId) {\n        coordinates = values.map(({ xAxisValue, yAxisValue }) => {\n          const coordinate = {}\n          if (isValid(xAxisValue)) {\n            const dataIndex = dataIndexXAxis ? xAxisValue : this._chartData.timestampToDataIndex(xAxisValue)\n            coordinate.x = this._xAxisPane.xAxis().convertToPixel(dataIndex)\n          }\n          if (isValid(yAxisValue)) {\n            const y = pane.yAxis().convertToPixel(yAxisValue)\n            coordinate.y = absoluteYAxis ? absoluteTop + y : y\n          }\n          return coordinate\n        })\n        break\n      }\n      absoluteTop += (pane.height() + separatorSize)\n    }\n    return isArray(value) ? coordinates : (coordinates[0] || {})\n  }\n\n  /**\n   * 将像素转换成值\n   * @param coordinate\n   * @param paneId\n   * @param dataIndexXAxis\n   * @param absoluteYAxis\n   * @return {{}[]|*[]}\n   */\n  convertFromPixel (coordinate, { paneId = CANDLE_PANE_ID, dataIndexXAxis, absoluteYAxis }) {\n    const coordinates = [].concat(coordinate)\n    let values = []\n    const separatorSize = this._chartData.styleOptions().separator.size\n    let absoluteTop = 0\n    const panes = this._panes.values()\n    for (const pane of panes) {\n      if (pane.id() === paneId) {\n        values = coordinates.map(({ x, y }) => {\n          const value = {}\n          if (isValid(x)) {\n            const v = this._xAxisPane.xAxis().convertFromPixel(x)\n            value.xAxisValue = dataIndexXAxis ? v : this._chartData.dataIndexToTimestamp(v)\n          }\n          if (isValid(y)) {\n            const ry = absoluteYAxis ? y - absoluteTop : y\n            value.yAxisValue = pane.yAxis().convertFromPixel(ry)\n          }\n          return value\n        })\n        break\n      }\n      absoluteTop += pane.height() + separatorSize\n    }\n    return isArray(coordinate) ? values : (values[0] || {})\n  }\n\n  /**\n   * 图表宽度\n   * @return {*|{}}\n   */\n  chartWidth () {\n    return this._chartWidth\n  }\n\n  /**\n   * 图表高度\n   * @return {*|{}}\n   */\n  chartHeight () {\n    return this._chartHeight\n  }\n\n  /**\n   * 获取图表转换为图片后url\n   * @param includeOverlay,\n   * @param type\n   * @param backgroundColor\n   */\n  getConvertPictureUrl (includeOverlay, type, backgroundColor) {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    const width = this._chartContainer.offsetWidth\n    const height = this._chartContainer.offsetHeight\n    canvas.style.width = `${width}px`\n    canvas.style.height = `${height}px`\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    ctx.fillStyle = backgroundColor\n    ctx.fillRect(0, 0, width, height)\n    let offsetTop = 0\n    this._panes.forEach((pane, paneId) => {\n      if (paneId !== CANDLE_PANE_ID) {\n        const separator = this._separators.get(paneId)\n        ctx.drawImage(\n          separator.getImage(),\n          0, offsetTop, width, separator.height()\n        )\n        offsetTop += separator.height()\n      }\n      ctx.drawImage(\n        pane.getImage(includeOverlay),\n        0, offsetTop, width, pane.height()\n      )\n      offsetTop += pane.height()\n    })\n    ctx.drawImage(\n      this._xAxisPane.getImage(includeOverlay),\n      0, offsetTop, width, this._xAxisPane.height()\n    )\n    return canvas.toDataURL(`image/${type}`)\n  }\n\n  destroy () {\n    this._panes.forEach(pane => {\n      pane.destroy()\n    })\n    this._separators.forEach(pane => {\n      pane.destroy()\n    })\n    this._panes.clear()\n    this._separators.clear()\n    this._xAxisPane.destroy()\n    this._container.removeChild(this._chartContainer)\n    this._chartEvent.destroy()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChartPane from './pane/ChartPane'\nimport { clone, isNumber, isObject, isArray, isFunction } from './utils/typeChecks'\nimport { logWarn } from './utils/logger'\nimport { requestAnimationFrame } from './utils/compatible'\n\nexport default class Chart {\n  constructor (container, styleOptions) {\n    this._chartPane = new ChartPane(container, styleOptions)\n  }\n\n  /**\n   * 获取宽尺寸\n   * @return {*|{}}\n   */\n  getWidth () {\n    return this._chartPane.chartWidth()\n  }\n\n  /**\n   * 获取高度尺寸\n   * @return {*|{}}\n   */\n  getHeight () {\n    return this._chartPane.chartHeight()\n  }\n\n  /**\n   * 设置样式配置\n   * @param options\n   */\n  setStyleOptions (options) {\n    if (!isObject(options)) {\n      logWarn('setStyleOptions', 'options')\n      return\n    }\n    this._chartPane.chartData().applyStyleOptions(options)\n    this._chartPane.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 获取样式配置\n   * @returns {[]|*[]}\n   */\n  getStyleOptions () {\n    return clone(this._chartPane.chartData().styleOptions())\n  }\n\n  /**\n   * 覆盖技术指标\n   * @param override\n   */\n  overrideTechnicalIndicator (override) {\n    if (!isObject(override)) {\n      logWarn('overrideTechnicalIndicator', 'override', 'override must be an object!!!')\n      return\n    }\n    const tech = this._chartPane.chartData().getTechnicalIndicatorInstance(override.name)\n    if (!tech) {\n      logWarn('overrideTechnicalIndicator', 'override.name', 'can not find the corresponding technical indicator!!!')\n      return\n    }\n    this._chartPane.overrideTechnicalIndicator(tech, override)\n  }\n\n  /**\n   * 获取技术指标名字获取技术指标\n   * @param name\n   * @return {{}|{series: *, calcParams: *, precision: *, name: *}}\n   */\n  getTechnicalIndicatorByName (name) {\n    return this._chartPane.chartData().getTechnicalIndicatorInfo(name)\n  }\n\n  /**\n   * 获取窗口上的技术指标\n   * @param paneId\n   * @return {{}}\n   */\n  getTechnicalIndicatorByPaneId (paneId) {\n    return this._chartPane.getPaneTechnicalIndicator(paneId)\n  }\n\n  /**\n   * 设置价格数量精度\n   * @param pricePrecision\n   * @param volumePrecision\n   */\n  setPriceVolumePrecision (pricePrecision, volumePrecision) {\n    if (!isNumber(pricePrecision) || pricePrecision < 0) {\n      logWarn('setPriceVolumePrecision', 'pricePrecision', 'pricePrecision must be a number and greater than zero!!!')\n      return\n    }\n    if (!isNumber(volumePrecision) || volumePrecision < 0) {\n      logWarn('setPriceVolumePrecision', 'volumePrecision', 'volumePrecision must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartData().setPriceVolumePrecision(pricePrecision, volumePrecision)\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    this._chartPane.setTimezone(timezone)\n  }\n\n  /**\n   * 获取当前时区\n   */\n  getTimezone () {\n    return this._chartPane.chartData().timezone()\n  }\n\n  /**\n   * 重置尺寸，总是会填充父容器\n   */\n  resize () {\n    this._chartPane.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 设置右边间距\n   * @param space\n   */\n  setOffsetRightSpace (space) {\n    if (!isNumber(space)) {\n      logWarn('setOffsetRightSpace', 'space', 'space must be a number!!!')\n      return\n    }\n    this._chartPane.chartData().setOffsetRightSpace(space, true)\n  }\n\n  /**\n   * 设置左边可见的最小bar数量\n   * @param barCount\n   */\n  setLeftMinVisibleBarCount (barCount) {\n    if (!isNumber(barCount) || barCount <= 0) {\n      logWarn('setLeftMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartData().setLeftMinVisibleBarCount(Math.ceil(barCount))\n  }\n\n  /**\n   * 设置右边可见的最小bar数量\n   * @param barCount\n   */\n  setRightMinVisibleBarCount (barCount) {\n    if (!isNumber(barCount) || barCount <= 0) {\n      logWarn('setRightMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartData().setRightMinVisibleBarCount(Math.ceil(barCount))\n  }\n\n  /**\n   * 设置一条数据的空间\n   * @param space\n   */\n  setDataSpace (space) {\n    if (!isNumber(space)) {\n      logWarn('setDataSpace', 'space', 'space must be a number!!!')\n      return\n    }\n    this._chartPane.chartData().setDataSpace(space)\n  }\n\n  /**\n   * 清空数据\n   */\n  clearData () {\n    this._chartPane.chartData().clearDataList()\n  }\n\n  /**\n   * 获取数据源\n   */\n  getDataList () {\n    return this._chartPane.chartData().dataList()\n  }\n\n  /**\n   * 添加新数据\n   * @param dataList\n   * @param more\n   */\n  applyNewData (dataList, more) {\n    if (!isArray(dataList)) {\n      logWarn('applyNewData', 'dataList', 'dataList must be an array!!!')\n      return\n    }\n    this._chartPane.applyNewData(dataList, more)\n  }\n\n  /**\n   * 添加历史更多数据\n   * @param dataList\n   * @param more\n   */\n  applyMoreData (dataList, more) {\n    if (!isArray(dataList)) {\n      logWarn('applyMoreData', 'dataList', 'dataList must be an array!!!')\n      return\n    }\n    this._chartPane.applyMoreData(dataList, more)\n  }\n\n  /**\n   * 更新数据\n   * @param data\n   */\n  updateData (data) {\n    if (!isObject(data) || isArray(data)) {\n      logWarn('updateData', 'data')\n      return\n    }\n    this._chartPane.updateData(data)\n  }\n\n  /**\n   * 设置加载更多回调\n   * @param cb\n   */\n  loadMore (cb) {\n    if (!isFunction(cb)) {\n      logWarn('loadMore', 'cb', 'cb must be a method!!!')\n      return\n    }\n    this._chartPane.chartData().setLoadMoreCallback(cb)\n  }\n\n  /**\n   * 创建一个技术指标\n   * @param name 指标名\n   * @param isStack 是否覆盖\n   * @param paneOptions\n   * @returns {string|null}\n   */\n  createTechnicalIndicator (name, isStack, paneOptions) {\n    const tech = this._chartPane.chartData().getTechnicalIndicatorInstance(name)\n    if (!tech) {\n      logWarn('createTechnicalIndicator', 'name', 'can not find the corresponding technical indicator!!!')\n      return null\n    }\n    return this._chartPane.createTechnicalIndicator(tech, isStack, paneOptions)\n  }\n\n  /**\n   * 添加自定义技术指标\n   * @param tech\n   */\n  addCustomTechnicalIndicator (tech) {\n    if (!isObject(tech)) {\n      logWarn('addCustomTechnicalIndicator', 'technicalIndicator', 'technicalIndicator must be an object or array!!!')\n      return\n    }\n    const techs = [].concat(tech)\n    this._chartPane.chartData().addCustomTechnicalIndicator(techs)\n  }\n\n  /**\n   * 移除一个技术指标\n   * @param paneId\n   * @param name\n   */\n  removeTechnicalIndicator (paneId, name) {\n    this._chartPane.removeTechnicalIndicator(paneId, name)\n  }\n\n  /**\n   * 创建图形标记\n   * @param name\n   * @param options\n   */\n  createGraphicMark (name, options) {\n    const graphicMarkMapping = this._chartPane.chartData().graphicMarkMapping()\n    const GraphicMark = graphicMarkMapping[name]\n    if (!GraphicMark) {\n      logWarn('createGraphicMark', 'name', 'can not find the corresponding graphic mark!!!')\n      return null\n    }\n    const id = this._chartPane.createGraphicMark(GraphicMark, options)\n    if (!id) {\n      logWarn('createGraphicMark', 'options.id', 'duplicate id!!!')\n    }\n    return id\n  }\n\n  /**\n   * 获取图形标记\n   * @param id\n   * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n   */\n  getGraphicMark (id) {\n    return this._chartPane.chartData().getGraphicMark(id)\n  }\n\n  /**\n   * 设置图形标记配置\n   * @param id\n   * @param options\n   */\n  setGraphicMarkOptions (id, options) {\n    this._chartPane.chartData().setGraphicMarkOptions(id, options)\n  }\n\n  /**\n   * 添加自定义图形标记\n   * @param graphicMark\n   */\n  addCustomGraphicMark (graphicMark) {\n    if (!isObject(graphicMark)) {\n      logWarn('addCustomGraphicMark', 'graphicMark', 'graphicMark must be an object or array!!!')\n      return\n    }\n    const graphicMarks = [].concat(graphicMark)\n    this._chartPane.chartData().addCustomGraphicMark(graphicMarks)\n  }\n\n  /**\n   * 移除图形标记\n   * @param graphicMarkId\n   */\n  removeGraphicMark (graphicMarkId) {\n    this._chartPane.chartData().removeGraphicMarkInstance(graphicMarkId)\n  }\n\n  /**\n   * 创建注解\n   * @param annotation\n   */\n  createAnnotation (annotation) {\n    if (!isObject(annotation)) {\n      logWarn('createAnnotation', 'annotation', 'annotation must be an object or array!!!')\n      return\n    }\n    const annotations = [].concat(annotation)\n    this._chartPane.createAnnotation(annotations)\n  }\n\n  /**\n   * 移除注解\n   */\n  removeAnnotation (points) {\n    this._chartPane.chartData().removeAnnotation(points)\n  }\n\n  /**\n   * 创建标签\n   * @param tag\n   */\n  createTag (tag) {\n    if (!isObject(tag)) {\n      logWarn('createTag', 'tag', 'tag must be an object or array!!!')\n      return\n    }\n    const tags = [].concat(tag)\n    this._chartPane.createTag(tags)\n  }\n\n  /**\n   * 移除标签\n   * @param id\n   */\n  removeTag (id) {\n    this._chartPane.chartData().removeTag(id)\n  }\n\n  /**\n   * 设置窗口属性\n   * @param options\n   */\n  setPaneOptions (options = {}) {\n    this._chartPane.setPaneOptions(options, false)\n  }\n\n  /**\n   * 设置是否可以缩放\n   * @param enabled\n   */\n  setZoomEnabled (enabled) {\n    this._chartPane.chartData().setZoomEnabled(enabled)\n  }\n\n  /**\n   * 是否可以缩放\n   * @return {boolean}\n   */\n  isZoomEnabled () {\n    return this._chartPane.chartData().zoomEnabled()\n  }\n\n  /**\n   * 设置是否可以拖拽滚动\n   * @param enabled\n   */\n  setScrollEnabled (enabled) {\n    this._chartPane.chartData().setScrollEnabled(enabled)\n  }\n\n  /**\n   * 是否可以拖拽滚动\n   * @return {boolean}\n   */\n  isScrollEnabled () {\n    return this._chartPane.chartData().scrollEnabled()\n  }\n\n  /**\n   * 按距离滚动\n   * @param distance\n   * @param animationDuration\n   */\n  scrollByDistance (distance, animationDuration) {\n    if (!isNumber(distance)) {\n      logWarn('scrollByDistance', 'distance', 'distance must be a number!!!')\n      return\n    }\n    if (isNumber(animationDuration) && animationDuration > 0) {\n      this._chartPane.chartData().startScroll()\n      const startTime = new Date().getTime()\n      const animation = () => {\n        const progress = (new Date().getTime() - startTime) / animationDuration\n        const finished = progress >= 1\n        const dis = finished ? distance : distance * progress\n        this._chartPane.chartData().scroll(dis)\n        if (!finished) {\n          requestAnimationFrame(animation)\n        }\n      }\n      animation()\n    } else {\n      this._chartPane.chartData().startScroll()\n      this._chartPane.chartData().scroll(distance)\n    }\n  }\n\n  /**\n   * 滚动到实时位置\n   * @param animationDuration\n   */\n  scrollToRealTime (animationDuration) {\n    const difBarCount = this._chartPane.chartData().offsetRightBarCount() - this._chartPane.chartData().offsetRightSpace() / this._chartPane.chartData().dataSpace()\n    const distance = difBarCount * this._chartPane.chartData().dataSpace()\n    this.scrollByDistance(distance, animationDuration)\n  }\n\n  /**\n   * 滚动到指定位置\n   * @param position\n   * @param animationDuration\n   */\n  scrollToPosition (position, animationDuration) {\n    if (!isNumber(position)) {\n      logWarn('scrollToPosition', 'position', 'position must be a number!!!')\n      return\n    }\n    const distance = (this._chartPane.chartData().dataList().length - 1 - position) * this._chartPane.chartData().dataSpace()\n    this.scrollByDistance(distance, animationDuration)\n  }\n\n  /**\n   * 在某个坐标点缩放\n   * @param scale\n   * @param coordinate\n   * @param animationDuration\n   */\n  zoomAtCoordinate (scale, coordinate, animationDuration) {\n    if (!isNumber(scale)) {\n      logWarn('zoomAtCoordinate', 'scale', 'scale must be a number!!!')\n      return\n    }\n    if (isNumber(animationDuration) && animationDuration > 0) {\n      const dataSpace = this._chartPane.chartData().dataSpace()\n      const scaleDataSpace = dataSpace * scale\n      const difSpace = scaleDataSpace - dataSpace\n      const startTime = new Date().getTime()\n      const animation = () => {\n        const progress = (new Date().getTime() - startTime) / animationDuration\n        const finished = progress >= 1\n        const progressDataSpace = finished ? difSpace : difSpace * progress\n        this._chartPane.chartData().zoom(progressDataSpace / dataSpace, coordinate)\n        if (!finished) {\n          requestAnimationFrame(animation)\n        }\n      }\n      animation()\n    } else {\n      this._chartPane.chartData().zoom(scale, coordinate)\n    }\n  }\n\n  /**\n   * 在某个位置缩放\n   * @param scale\n   * @param position\n   * @param animationDuration\n   */\n  zoomAtPosition (scale, position, animationDuration) {\n    if (!isNumber(scale)) {\n      logWarn('zoomAtPosition', 'scale', 'scale must be a number!!!')\n      return\n    }\n    if (!isNumber(position)) {\n      logWarn('zoomAtPosition', 'position', 'position must be a number!!!')\n      return\n    }\n    const x = this._chartPane.chartData().dataIndexToCoordinate(position)\n    this.zoomAtCoordinate(scale, { x }, animationDuration)\n  }\n\n  /**\n   * 将值装换成像素\n   * @param value\n   * @param finder\n   */\n  convertToPixel (value, finder) {\n    return this._chartPane.convertToPixel(value, finder)\n  }\n\n  /**\n   * 将像素转换成值\n   * @param coordinate\n   * @param finder\n   */\n  convertFromPixel (coordinate, finder) {\n    return this._chartPane.convertFromPixel(coordinate, finder)\n  }\n\n  /**\n   * 订阅图表动作\n   * @param type\n   * @param callback\n   */\n  subscribeAction (type, callback) {\n    if (type === 'drawCandle' || type === 'drawTechnicalIndicator') {\n      logWarn('subscribeAction', '', 'the types drawCandle and drawTechnicalIndicator have been deprecated, please use createAnnotation instead!!!')\n    }\n    if (!this._chartPane.chartData().subscribeAction(type, callback)) {\n      logWarn('subscribeAction', 'type', 'type does not exist!!!')\n    }\n  }\n\n  /**\n   * 取消订阅图表动作\n   * @param type\n   * @param callback\n   */\n  unsubscribeAction (type, callback) {\n    if (!this._chartPane.chartData().unsubscribeAction(type, callback)) {\n      logWarn('unsubscribeAction', 'type', 'type does not exist!!!')\n    }\n  }\n\n  /**\n   * 获取将图表装换成图片后的url\n   * @param includeTooltip\n   * @param includeGraphicMark\n   * @param type\n   * @param backgroundColor\n   */\n  getConvertPictureUrl (includeTooltip, includeGraphicMark, type = 'jpeg', backgroundColor = '#FFFFFF') {\n    if (type !== 'png' && type !== 'jpeg' && type !== 'bmp') {\n      logWarn('getConvertPictureUrl', 'type', 'type only supports jpeg, png and bmp!!!')\n      return\n    }\n    return this._chartPane.getConvertPictureUrl(includeTooltip, type, backgroundColor)\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._chartPane.destroy()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Chart from './Chart'\nimport { logError, logTag, logWarn } from './utils/logger'\nimport { isString, isContainerDom } from './utils/typeChecks'\n\nconst instances = {}\nlet chartBaseId = 1\nconst CHART_NAME_PREFIX = 'k_line_chart_'\n\n/**\n * 获取版本号\n * @returns {string}\n */\nfunction version () {\n  return '__BUILD_VERSION__'\n}\n\n/**\n * 初始化\n * @param ds\n * @param style\n * @returns {Chart}\n */\nfunction init (ds, style = {}) {\n  logTag()\n  const errorMessage = 'The chart cannot be initialized correctly. Please check the parameters. The chart container cannot be null and child elements need to be added!!!'\n  let dom\n  if (!ds) {\n    logError('', '', errorMessage)\n    return null\n  }\n  if (isString(ds)) {\n    dom = document.getElementById(ds)\n  } else {\n    dom = ds\n  }\n  if (!isContainerDom(dom)) {\n    logError('', '', errorMessage)\n    return null\n  }\n  let chart = instances[dom.chartId || '']\n  if (chart) {\n    logWarn('', '', 'The chart has been initialized on the dom！！！')\n    return chart\n  }\n  const id = `${CHART_NAME_PREFIX}${chartBaseId++}`\n  chart = new Chart(dom, style)\n  chart.id = id\n  dom.chartId = id\n  instances[id] = chart\n  return chart\n}\n\n/**\n * 销毁\n * @param dcs\n */\nfunction dispose (dcs) {\n  if (dcs) {\n    let id\n    if (isString(dcs)) {\n      const dom = document.getElementById(dcs)\n      id = dom && dom.chartId\n    } else if (isContainerDom(dcs)) {\n      id = dcs.chartId\n    } else if (dcs instanceof Chart) {\n      id = dcs.id\n    }\n    if (id) {\n      instances[id].destroy()\n      delete instances[id]\n    }\n  }\n}\n\nexport { version, init, dispose }\n"],"names":["technicalIndicatorExtensions","graphicMarkExtensions","addTechnicalIndicator","technicalIndicators","concat","forEach","technicalIndicator","name","addGraphicMark","graphicMarks","graphicMark","merge","target","source","isObject","key","targetProp","sourceProp","isArray","isValid","clone","copy","hasOwnProperty","v","value","Object","prototype","toString","call","isFunction","isNumber","isNaN","undefined","isBoolean","isString","isContainerDom","dom","HTMLElement","appendChild","LineStyle","DASH","SOLID","YAxisPosition","LEFT","RIGHT","YAxisType","NORMAL","PERCENTAGE","LOG","CandleType","CANDLE_SOLID","CANDLE_STROKE","CANDLE_UP_STROKE","CANDLE_DOWN_STROKE","OHLC","AREA","TooltipShowRule","ALWAYS","FOLLOW_CROSS","NONE","TooltipShowType","RECT","STANDARD","AnnotationSymbolType","CIRCLE","TRIANGLE","DIAMOND","CUSTOM","OverlayPosition","POINT","TOP","BOTTOM","defaultGrid","show","horizontal","size","color","style","dashValue","vertical","defaultCandle","margin","top","bottom","type","bar","upColor","downColor","noChangeColor","area","lineSize","lineColor","fillColor","offset","priceMark","high","textMargin","textSize","textFamily","textWeight","low","last","line","text","paddingLeft","paddingTop","paddingRight","paddingBottom","family","weight","borderRadius","tooltip","showRule","showType","labels","values","defaultValue","rect","offsetLeft","offsetTop","offsetRight","borderSize","borderColor","marginLeft","marginTop","marginRight","marginBottom","defaultTechnicalIndicator","colors","circle","lastValueMark","showName","showParams","defaultXAxis","height","axisLine","tickText","tickLine","length","defaultYAxis","width","position","inside","defaultCrosshair","backgroundColor","defaultGraphicMark","point","radius","activeBackgroundColor","activeBorderColor","activeBorderSize","activeRadius","polygon","stroke","fill","arc","defaultAnnotation","symbol","activeSize","activeColor","defaultTag","mark","defaultSeparator","defaultStyleOptions","grid","candle","xAxis","yAxis","separator","crosshair","annotation","tag","formatValue","data","formatDate","dateTimeFormat","timestamp","format","dateTimeString","Date","dateTimeStringArray","split","dateStringArray","date","YYYY","MM","DD","match","replace","formatPrecision","precision","toFixed","formatBigNumber","binarySearchNearest","dataList","valueKey","targetNumber","left","right","midIndex","Math","floor","mid","midValue","nice","exponent","log10","exp10","index10","f","nf","round","min","max","getPrecision","str","eIndex","indexOf","slice","dotIndex","log","pow","logWarn","api","invalidParam","append","console","logError","logTag","TechnicalIndicatorSeries","PRICE","VOLUME","TechnicalIndicatorPlotType","LINE","BAR","TechnicalIndicator","series","calcParams","plots","calcParamsAllowDecimal","shouldCheckParamCount","shouldOhlc","shouldFormatBigNumber","baseValue","minValue","maxValue","styles","parseInt","params","i","regeneratePlots","defaultStyles","createTechnicalIndicatorMapping","mapping","extension","technicalIndicatorInstance","createTechnicalIndicatorInstance","calcTechnicalIndicator","render","TechnicalIndicatorClass","createTechnicalIndicatorInfo","result","getTechnicalIndicatorTooltipData","technicalIndicatorData","calcParamText","join","plot","title","push","Overlay","id","chartData","_id","_chartData","_xAxis","_yAxis","_styles","ctx","points","event","renderFillCircle","circlePoint","fillStyle","beginPath","x","y","PI","closePath","DEVIATION","getTriangleSquare","point1","point2","point3","x1","abs","y1","x2","y2","checkPointInCircle","circleCenterPoint","targetPoint","difX","difY","checkPointInTriangle","trianglePoints","square","compareSquare","checkPointInDiamond","centerPoint","xDis","yDis","checkPointInRect","renderHorizontalLine","correction","lineWidth","moveTo","lineTo","renderVerticalLine","renderLine","renderFuc","save","translate","restore","GRAPHIC_MARK_DRAW_STEP_START","GRAPHIC_MARK_DRAW_STEP_FINISHED","GraphicMarkMouseOperateElement","OTHER","GraphicMarkDrawType","TEXT","CONTINUOUS_LINE","POLYGON","ARC","GraphicMarkDrawStyle","STROKE","FILL","LineType","COMMON","HORIZONTAL","VERTICAL","getLineType","GraphicMark","totalStep","lock","_name","_totalStep","_lock","_drawStep","_points","setPoints","setStyles","styleOptions","repeatTotalStep","performMouseMoveForDrawing","performMousePressedMove","dataIndex","convertToPixel","timestampToDataIndex","lines","markOptions","strokeStyle","setLineDash","lineType","continuousLines","polygons","fillStroke","arcs","startAngle","endAngle","texts","strokeText","fillText","font","coordinates","map","price","_timestampOrDataIndexToPointX","viewport","pricePrecision","volume","volumePrecision","graphicDataSources","createGraphicDataSource","isDraw","dataSource","_drawLines","_drawContinuousLines","_drawPolygons","_drawArcs","_drawText","drawExtend","graphicMarkMouseOperate","hover","element","click","index","elementIndex","mouseCoordinate","coordinate","instance","isCheck","sources","checkMousePointOn","convertFromPixel","dataIndexToTimestamp","onDrawing","step","onDrawEnd","onPressedMove","mousePoint","pressedPointIndex","Delegate","_observers","observer","splice","createGraphicMarkMapping","graphicMarkClass","createGraphicMarkClass","Mark","getGraphicMarkInfo","tpPoints","DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT","TECHNICAL_INDICATOR_PANE_ID_PREFIX","GRAPHIC_MARK_ID_PREFIX","CANDLE_PANE_ID","MIN_DATA_SPACE","MAX_DATA_SPACE","InvalidateLevel","OVERLAY","MAIN","FULL","ActionType","DRAW_CANDLE","DRAW_TECHNICAL_INDICATOR","ZOOM","SCROLL","CROSSHAIR","PANE_DRAG","ChartData","handler","_handler","_styleOptions","_technicalIndicatorMapping","_zoomEnabled","_scrollEnabled","_pricePrecision","_volumePrecision","_dateTimeFormat","Intl","DateTimeFormat","hour12","year","month","day","hour","minute","_dataList","_visibleDataList","_loading","_loadMoreCallback","_more","_totalDataSpace","_dataSpace","_barSpace","_calcBarSpace","_offsetRightSpace","_offsetRightBarCount","_leftMinVisibleBarCount","_rightMinVisibleBarCount","_from","_to","_crosshair","_preOffsetRightBarCount","_dragGraphicMarkFlag","_graphicMarkMapping","_graphicMarkMouseOperate","_graphicMarks","_annotations","Map","_visibleAnnotations","_annotationMouseOperate","_tags","_dragPaneFlag","_actionDelegate","rateBarSpace","floorBarSpace","optimalBarSpace","dataSize","kLineData","deltaFromRight","get","an","createSymbolCoordinate","barLength","maxRightOffsetBarCount","minRightOffsetBarCount","_adjustVisibleDataList","options","tech","getTechnicalIndicatorInstance","techs","timezone","timeZone","e","resolvedOptions","setPrecision","pos","more","isFirstAdd","setOffsetRightSpace","_adjustFromTo","setCrosshair","dataSpace","adjustBeforeFuc","invalidate","totalSpace","space","barCount","notInvalidate","cr","realDataIndex","coordinateToDataIndex","realX","dataIndexToCoordinate","prevCrosshair","paneId","distance","distanceBarCount","actionExecute","cross","pixel","ceil","coordinateToFloatIndex","scale","floatIndex","setDataSpace","invalidateLevel","enabled","callback","find","gm","lastGraphicMark","isDrawing","GraphicMarkClass","setLock","removeIndex","findIndex","onRemove","flag","annotations","has","set","shouldAdjust","delete","clear","tags","shouldInvalidate","ids","graphicMarkOperate","annotationOperate","executeBeforeFun","executeAfterFun","hasAction","execute","hasObservers","subscribe","delegate","unsubscribe","getPixelRatio","canvas","ownerDocument","defaultView","devicePixelRatio","calcTextWidth","measureText","createFont","fontSize","fontWeight","fontFamily","Pane","props","_height","_container","container","_initBefore","_initElement","_mainWidget","_createMainWidget","_element","_yAxisWidget","_createYAxisWidget","document","createElement","padding","overflow","lastElement","lastChild","insertBefore","offsetWidth","mainWidgetWidth","yAxisWidgetWidth","setWidth","setHeight","mainWidgetOffsetLeft","yAxisWidgetOffsetLeft","setOffsetLeft","offsetHeight","layout","level","includeOverlay","getContext","pixelRatio","mainWidgetElement","getElement","mainWidgetHeight","drawImage","getImage","yAxisWidgetElement","yAxisWidgetHeight","removeChild","Widget","_width","_mainView","_createMainView","_overlayView","_createOverlayView","flush","requestAnimationFrame","fn","window","setTimeout","cancelAnimationFrame","clearTimeout","View","_initCanvas","_canvas","zIndex","_ctx","extendFun","clearRect","_draw","_redraw","requestAnimationId","TechnicalIndicatorView","additionalDataProvider","_additionalDataProvider","_drawGrid","_drawTechnicalIndicators","gridOptions","gridHorizontalOptions","ticks","tick","gridVerticalOptions","technicalIndicatorOptions","technicalIndicatorResult","from","to","kLineDataList","technicalIndicatorDataList","barSpace","bind","isCandleYAxis","baseValueY","_drawGraphics","halfBarSpace","lineValueIndex","_drawCandleBar","coordinateY","valueY","cbData","preData","currentData","nextData","isStroke","_drawCircle","_drawBar","_drawActionExecute","technicalIndicatorName","isCandle","visibleDataList","n","colorSize","lineItem","isStart","strokeRect","fillRect","barOptions","barStyle","open","close","openY","closeY","highY","lowY","highEndY","lowStartY","barHeight","renderText","TechnicalIndicatorOverlayView","_drawCover","crosshairOptions","_drawCrosshairLine","_drawTooltip","_drawBatchTechnicalIndicatorToolTip","_shouldDrawTooltip","optionsKey","fixedCoordinate","startCoordinate","endCoordinate","drawLine","crosshairDirectionOptions","crosshairLineOptions","isDrawTechnicalIndicatorTooltip","technicalIndicatorTooltipOptions","_drawTechnicalIndicatorTooltip","tooltipData","technicalIndicatorTooltipTextOptions","textMarginLeft","textMarginRight","labelX","labelY","textColor","textBaseline","nameText","nameTextWidth","calcParamTextWidth","lineCount","valueColor","textWidth","tooltipOptions","TechnicalIndicatorWidget","renderStrokeFillRoundRect","renderFillRoundRect","renderStrokeRoundRect","renderFillRect","w","h","r","renderRoundRect","arcTo","YAxisView","yAxisOptions","_drawAxisLine","_drawTickLines","_drawTickLabels","_drawTechnicalIndicatorLastValue","_drawLastPriceLabel","isFromYAxisZero","tickLineLength","startX","endX","tickLineShow","textAlign","lastValueMarkOptions","_drawMarkLabel","priceMarkOptions","lastPriceMarkOptions","convertToNicePixel","yAxisType","fromData","fromClose","rectWidth","rectHeight","rectStartX","YAxisOverlayView","drawText","_drawCrossHairLabel","crosshairHorizontalOptions","crosshairHorizontalTextOptions","yAxisDataLabelWidth","rectY","YAxisWidget","Axis","_cacheMinValue","_cacheMaxValue","_minValue","_maxValue","_range","_ticks","_initMeasureCanvas","measureCanvas","_measureCtx","forceCompute","minMax","_optimalMinMax","_computeMinMax","range","_optimalTicks","_computeTicks","intervalPrecision","_computeInterval","interval","first","YAxis","_realRange","_isCandleYAxis","minMaxArray","Number","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","plotsResult","technicalIndicatorPrecision","candleOptions","isArea","areaValueKey","shouldCompareHighLow","specifyMin","specifyMax","dif","minCheck","maxCheck","marginOptions","topRate","bottomRate","optimalTicks","textHeight","validY","_innerConvertToPixel","yAxisWidth","crosshairVerticalTextWidth","valueText","TechnicalIndicatorPane","_techs","setTechnicalIndicator","_createYAxis","isStack","cloneInstance","create","computeAxis","CandleView","_drawArea","_drawCandle","_drawLowHighPrice","comparePrice","_drawLastPriceLine","linePoints","areaPoints","minY","areaOptions","areaPointLength","lastPoint","gradient","createLinearGradient","addColorStop","optionKey","priceKey","initPriceValue","offsets","compare","lowHighPriceMarkOptions","priceY","startY","CandleOverlayView","drawMarkLine","draw","visibleAnnotations","candleTooltipOptions","isDrawCandleTooltip","_drawCandleTooltipWithRect","_drawCandleTooltipWithStandard","_getCandleTooltipData","label","labelWidth","baseLabels","baseValues","baseTextMarginLeft","baseTextMarginRight","baseTextMarginTop","baseTextMarginBottom","baseTextSize","baseTextColor","rectOptions","rectBorderSize","rectPaddingLeft","rectPaddingRight","rectPaddingTop","rectPaddingBottom","rectLeft","rectRight","maxLabelWidth","indicatorTextMarginLeft","indicatorTextMarginRight","indicatorTextMarginTop","indicatorTextMarginBottom","indicatorTextSize","indicatorTooltipDataList","centerX","rectX","baseLabelX","indicatorLabelX","CandleWidget","CandlePane","XAxisView","xAxisOptions","xAxisLine","endY","tickLength","XAxisOverlayView","_drawCrosshairLabel","crosshairVerticalOptions","crosshairVerticalTextOptions","XAxisWidget","XAxis","defaultLabelWidth","tickCountDif","nextPos","nextX","xDif","prePos","preKLineData","preTimestamp","_optimalTickLabel","oV","optimalTickLength","firstTimestamp","secondTimestamp","thirdV","test","comparedTimestamp","stylOptions","xAxisHeight","crosshairVerticalTextHeight","XAxisPane","MouseEventButton","DELAY_RESET_CLICK","DELAY_LONG_TAG","getBoundingClientRect","isTouchEvent","Boolean","touches","preventDefault","cancelable","checkTouchEvents","DocumentTouch","touch","navigator","maxTouchPoints","msMaxTouchPoints","mobileTouch","getDistance","p1","p2","xDiff","clientX","yDiff","clientY","sqrt","EventType","MOUSE","TOUCH","EventBase","eventHandler","_target","_options","_clickCount","_clickTimeoutId","_longTapTimeoutId","_longTapActive","_mouseMoveStartPosition","_moveExceededManhattanDistance","_cancelClick","_unsubscribeOutsideEvents","_unsubscribeMousemove","_unsubscribeRoot","_startPinchMiddlePoint","_startPinchDistance","_pinchPrevented","_preventDragProcess","_mousePressed","_init","_clearLongTapTimeout","_resetClickTimeout","enterEvent","boundMouseMoveHandler","_mouseMoveHandler","boundMouseWheelHandler","_mouseWheelHandler","removeEventListener","addEventListener","passive","compatEvent","_makeCompatEvent","_processEvent","mouseEnterEvent","moveEvent","mouseMoveEvent","wheelEvent","localX","localY","mouseWheelEvent","button","isTouch","startMouseMovePos","xOffset","pageX","yOffset","pageY","moveExceededManhattanDistance","correctedXOffset","isVertDrag","treatVertTouchDragAsPageScroll","isHorzDrag","treatHorzTouchDragAsPageScroll","pressedMouseMoveEvent","mouseUpEvent","_mouseLeaveHandler","mouseDoubleClickEvent","mouseClickEvent","downEvent","mouseRightDownEvent","_mouseEnterHandler","boundMouseMoveWithDownHandler","_mouseMoveWithDownHandler","boundMouseUpHandler","_mouseUpHandler","rootElement","documentElement","_longTapHandler","mouseDownEvent","doc","outsideHandler","mouseDownOutsideEvent","contains","_mouseDownHandler","_initPinch","pinchStartEvent","pinchEvent","pinchEndEvent","_checkPinchState","currentDistance","_stopPinch","_startPinch","box","mouseLeaveEvent","longTapEvent","eventLike","changedTouches","screenX","screenY","ctrlKey","altKey","shiftKey","metaKey","startsWith","view","SeparatorPane","topPaneId","bottomPaneId","dragEnabled","dragEventHandler","_topPaneId","_bottomPaneId","_dragEnabled","_offsetLeft","_dragEventHandler","_dragFlag","_initEvent","_wrapper","_createElement","cursor","_dragEvent","_mouseDownEvent","_mouseUpEvent","_pressedMouseMoveEvent","_mouseEnterEvent","_mouseLeaveEvent","_startY","startDrag","setDragPaneFlag","dragDistance","drag","separatorOptions","background","destroy","isMouse","EventHandler","_chartContentSize","_paneContentSize","contentRight","contentLeft","chartContentSize","paneContentSize","TOUCH_MIN_RADIUS","ZoomScrollEventHandler","_startScrollPoint","_touchPoint","_touchCancelCrossHair","_touchZoomed","_pinchScale","middlePoint","zoomScale","zoom","_performCross","_checkEventPointX","deltaX","deltaY","startScroll","scroll","deltaMode","DOM_DELTA_PAGE","DOM_DELTA_LINE","sign","yDif","checkTouchEvent","performFuc","isPerform","contentTop","contentBottom","OverlayEventHandler","_pressedGraphicMark","overlays","preHoverOperate","hoverOperate","overlay","checkMousePointOnGraphic","onMouseLeave","onMouseEnter","setDragGraphicMarkFlag","_checkEventPointY","_waitingForMouseMoveAnimationFrame","preGraphicMarkHoverOperate","preAnnotationHoverOperate","annotationMouseOperate","graphicMarkHoverOperate","graphicMarkClickOperate","annotationHoverOperate","mouseMoveForDrawing","_performOverlayMouseHover","setOverlayMouseOperate","mouseLeftButtonDownForDrawing","onClick","onRightClick","removeGraphicMarkInstance","mousePressedMove","KeyBoardCode","EQUAL","MINUS","ARROW_LEFT","ARROW_RIGHT","KeyBoardEventHandler","code","ChartEvent","_event","_pinchStartEvent","_pinchEvent","_mouseClickEvent","_mouseRightDownEvent","_mouseMoveEvent","_mouseWheelEvent","_longTapEvent","_boundKeyBoardDownEvent","_keyBoardDownEvent","_boundContextMenuEvent","_zoomScrollEventHandler","_overlayEventHandler","_keyBoardEventHandler","keyBoardDownEvent","_shouldPerformOverlayEvent","_checkZoomScroll","dragGraphicMarkFlag","graphicMarkCount","dragPaneFlag","setChartContentSize","setPaneContentSize","throttle","func","wait","previous","now","context","args","arguments","apply","renderFillDiamond","renderFillTriangle","Annotation","_point","_symbolCoordinate","isActive","symbolOptions","styleSize","styleActiveSize","drawCustomSymbol","_drawSymbol","isOn","coordinate1","coordinate2","checkPointInCustomSymbol","Tag","_text","_mark","success","tagOptions","_getY","_drawLine","_drawMark","tagTextOptions","_getTextRectWidth","tagLineOptions","tagMarkOptions","valueRectWidth","textOptions","ChartPane","_initChartContainer","_graphicMarkBaseId","_paneBaseId","_separatorDragStartTopPaneHeight","_separatorDragStartBottomPaneHeight","_invalidatePane","_crosshairObserver","_xAxisPane","_chartContainer","_panes","_separators","_chartWidth","_chartHeight","_chartEvent","adjustPaneViewport","userSelect","webkitUserSelect","msUserSelect","MozUserSelect","webkitTapHighlightColor","outline","borderStyle","tabIndex","pane","topPaneHeight","bottomPaneHeight","shouldMeasureWidth","should","tasks","Promise","resolve","calcAllTechnicalIndicator","all","then","paneHeight","separatorSize","separatorTotalHeight","getSelfHeight","paneExcludeXAxisSeparatorHeight","techPaneTotalHeight","candlePaneHeight","total","isYAxisLeft","isOutside","paneWidth","mainWidth","yAxisOffsetLeft","mainOffsetLeft","getSelfWidth","setTotalDataSpace","setSize","content","shouldMeasureHeight","shouldLayout","shouldComputeAxis","shouldForceComputeAxis","_measurePaneHeight","isAdjust","adjust","_measurePaneWidth","techInstance","setCalcParamsAllowDecimal","calcParamsSuccess","setCalcParams","precisionSuccess","defaultTechnicalStyleOptions","styleSuccess","_","addData","_calcAllPaneTechnicalIndicator","_applyDataList","clearDataList","lastDataTimestamp","removeTechnicalIndicator","removed","isEmptyTechnicalIndicator","deleteSeparatorTopPaneId","updatePaneId","setPaneOptions","Array","keys","pop","_separatorStartDrag","_separatorDrag","technicalIndicatorInfo","paneTechs","onDrawStart","graphicMarkId","graphicMarkInstance","addGraphicMarkInstance","instances","annotationInstance","addAnnotations","shouldUpdate","shouldAdd","getTag","updateSuccess","update","addTags","forceShouldAdjust","setDragEnabled","setTimezone","dataIndexXAxis","absoluteYAxis","absoluteTop","panes","xAxisValue","yAxisValue","ry","toDataURL","Chart","_chartPane","chartWidth","chartHeight","applyStyleOptions","override","overrideTechnicalIndicator","getTechnicalIndicatorInfo","getPaneTechnicalIndicator","setPriceVolumePrecision","setLeftMinVisibleBarCount","setRightMinVisibleBarCount","applyNewData","applyMoreData","updateData","cb","setLoadMoreCallback","paneOptions","createTechnicalIndicator","addCustomTechnicalIndicator","graphicMarkMapping","createGraphicMark","getGraphicMark","setGraphicMarkOptions","addCustomGraphicMark","createAnnotation","removeAnnotation","createTag","removeTag","setZoomEnabled","zoomEnabled","setScrollEnabled","scrollEnabled","animationDuration","startTime","getTime","animation","progress","finished","dis","difBarCount","offsetRightBarCount","offsetRightSpace","scrollByDistance","scaleDataSpace","difSpace","progressDataSpace","zoomAtCoordinate","finder","subscribeAction","unsubscribeAction","includeTooltip","includeGraphicMark","getConvertPictureUrl","chartBaseId","CHART_NAME_PREFIX","version","init","ds","errorMessage","getElementById","chart","chartId","dispose","dcs"],"mappings":"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"}